var TypeScript;
(function(a){a.hasFlag=function(a,j){return 0!=(a&j)};var e=a.ErrorRecoverySet||(a.ErrorRecoverySet={});e._map=[];e.None=0;e.Comma=1;e.SColon=2;e.Asg=4;e.BinOp=8;e.RBrack=16;e.RCurly=32;e.RParen=64;e.Dot=128;e.Colon=256;e.PrimType=512;e.AddOp=1024;e.LCurly=2048;e.PreOp=4096;e.RegExp=8192;e.LParen=16384;e.LBrack=32768;e.Scope=65536;e.In=131072;e.SCase=262144;e.Else=524288;e.Catch=1048576;e.Var=2097152;e.Stmt=4194304;e.While=8388608;e.ID=16777216;e.Prefix=33554432;e.Literal=67108864;e.RLit=134217728;
e.Func=268435456;e.EOF=536870912;e.TypeScriptS=1073741824;e.ExprStart=e.SColon|e.AddOp|e.LCurly|e.PreOp|e.RegExp|e.LParen|e.LBrack|e.ID|e.Prefix|e.RLit|e.Func|e.Literal;e.StmtStart=e.ExprStart|e.SColon|e.Var|e.Stmt|e.While|e.TypeScriptS;e.Postfix=e.Dot|e.LParen|e.LBrack;e=a.AllowedElements||(a.AllowedElements={});e._map=[];e.None=0;e.Statements=1;e.FunctionDecls=2;e.ModuleDecls=4;e.ClassDecls=8;e.InterfaceDecls=16;e.TypedFuncDecls=32;e.TypedDecls=64;e.TypedFuncSignatures=256;e.TypedSignatures=512;
e.AmbientDecls=1024;e.Properties=2048;e.Block=e.Statements|e.FunctionDecls|e.TypedFuncDecls|e.TypedDecls;e.Global=e.Statements|e.FunctionDecls|e.ModuleDecls|e.ClassDecls|e.InterfaceDecls|e.AmbientDecls;e.FunctionBody=e.Statements|e.FunctionDecls;e.ModuleMembers=e.TypedFuncDecls|e.FunctionDecls|e.ModuleDecls|e.ClassDecls|e.InterfaceDecls|e.TypedDecls|e.Statements|e.AmbientDecls;e.ClassMembers=e.TypedFuncDecls|e.FunctionDecls|e.Statements|e.TypedDecls|e.Properties;e.InterfaceMembers=e.TypedFuncSignatures|
e.TypedSignatures;e.QuickParse=e.Global|e.Properties;e=a.Modifiers||(a.Modifiers={});e._map=[];e.None=0;e.Private=1;e.Public=2;e.Readonly=4;e.Ambient=8;e.Exported=16;e.Getter=32;e.Setter=64;e.Static=128;e=a.ASTFlags||(a.ASTFlags={});e._map=[];e.None=0;e.ExplicitSemicolon=1;e.AutomaticSemicolon=2;e.Writeable=4;e.Error=8;e.DotLHSPartial=16;e.DotLHS=32;e.IsStatement=64;e.StrictMode=128;e.PossibleOptionalParameter=256;e.ClassBaseConstructorCall=512;e.OptionalName=1024;e=a.DeclFlags||(a.DeclFlags={});
e._map=[];e.None=0;e.Exported=1;e.Private=2;e.Public=4;e.Ambient=8;e.Static=16;e.LocalStatic=32;e.GetAccessor=64;e.SetAccessor=128;e=a.ModuleFlags||(a.ModuleFlags={});e._map=[];e.None=0;e.Exported=1;e.Private=2;e.Public=4;e.Ambient=8;e.Static=16;e.LocalStatic=32;e.GetAccessor=64;e.SetAccessor=128;e.IsEnum=256;e.ShouldEmitModuleDecl=512;e.IsWholeFile=1024;e.IsDynamic=2048;e=a.SymbolFlags||(a.SymbolFlags={});e._map=[];e.None=0;e.Exported=1;e.Private=2;e.Public=4;e.Ambient=8;e.Static=16;e.LocalStatic=
32;e.GetAccessor=64;e.SetAccessor=128;e.Property=256;e.Readonly=512;e.ModuleMember=1024;e.InterfaceMember=2048;e.ClassMember=4096;e.BuiltIn=8192;e.TypeSetDuringScopeAssignment=16384;e.Constant=32768;e.Optional=65536;e.RecursivelyReferenced=131072;e.Bound=262144;e=a.VarFlags||(a.VarFlags={});e._map=[];e.None=0;e.Exported=1;e.Private=2;e.Public=4;e.Ambient=8;e.Static=16;e.LocalStatic=32;e.GetAccessor=64;e.SetAccessor=128;e.AutoInit=256;e.Property=512;e.Readonly=1024;e.Class=2048;e.ClassProperty=4096;
e.ClassBodyProperty=8192;e.ClassConstructorProperty=16384;e.ClassSuperMustBeFirstCallInConstructor=32768;e.Constant=65536;e=a.FncFlags||(a.FncFlags={});e._map=[];e.None=0;e.Exported=1;e.Private=2;e.Public=4;e.Ambient=8;e.Static=16;e.LocalStatic=32;e.GetAccessor=64;e.SetAccessor=128;e.Definition=256;e.Signature=512;e.Method=1024;e.HasReturnExpression=2048;e.CallMember=4096;e.ConstructMember=8192;e.HasSelfReference=16384;e.IsFatArrowFunction=32768;e.IndexerMember=65536;e.IsFunctionExpression=131072;
e.ClassMethod=262144;e.ClassPropertyMethodExported=524288;e=a.SignatureFlags||(a.SignatureFlags={});e._map=[];e.None=0;e.IsIndexer=1;e.IsStringIndexer=2;e.IsNumberIndexer=4;a.ToDeclFlags=function(a){return a};e=a.TypeFlags||(a.TypeFlags={});e._map=[];e.None=0;e.HasImplementation=1;e.HasSelfReference=2;e.MergeResult=4;e.IsEnum=8;e.BuildingName=16;e.HasBaseType=32;e.HasBaseTypeOfObject=64;e.IsClass=128;e=a.TypeRelationshipFlags||(a.TypeRelationshipFlags={});e._map=[];e.SuccessfulComparison=0;e.SourceIsNullTargetIsVoidOrUndefined=
1;e.RequiredPropertyIsMissing=2;e.IncompatibleSignatures=4;e.SourceSignatureHasTooManyParameters=3;e.IncompatibleReturnTypes=16;e.IncompatiblePropertyTypes=32;e.IncompatibleParameterTypes=64;e=a.CodeGenTarget||(a.CodeGenTarget={});e._map=[];e.ES3=0;e.ES5=1;var e=a.CodeGenTarget,i=a.ModuleGenTarget||(a.ModuleGenTarget={});i._map=[];i.Synchronous=0;i.Asynchronous=1;i.Local=2;i=a.ModuleGenTarget;a.codeGenTarget=e.ES3;a.moduleGenTarget=i.Synchronous;a.optimizeModuleCodeGen=!0;a.flagsToString=function(a,
j){for(var f="",d=1;-2147483648>d;d<<=1)if(0!=(j&d))for(var l in a)if(a[l]==d){0<f.length&&(f+="|");f+=l;break}return f}})(TypeScript||(TypeScript={}));
(function(a){a=a.NodeType||(a.NodeType={});a._map=[];a._map[0]="None";a.None=0;a._map[1]="Empty";a.Empty=1;a._map[2]="EmptyExpr";a.EmptyExpr=2;a._map[3]="True";a.True=3;a._map[4]="False";a.False=4;a._map[5]="This";a.This=5;a._map[6]="Super";a.Super=6;a._map[7]="QString";a.QString=7;a._map[8]="Regex";a.Regex=8;a._map[9]="Null";a.Null=9;a._map[10]="ArrayLit";a.ArrayLit=10;a._map[11]="ObjectLit";a.ObjectLit=11;a._map[12]="Void";a.Void=12;a._map[13]="Comma";a.Comma=13;a._map[14]="Pos";a.Pos=14;a._map[15]=
"Neg";a.Neg=15;a._map[16]="Delete";a.Delete=16;a._map[17]="Await";a.Await=17;a._map[18]="In";a.In=18;a._map[19]="Dot";a.Dot=19;a._map[20]="From";a.From=20;a._map[21]="Is";a.Is=21;a._map[22]="InstOf";a.InstOf=22;a._map[23]="Typeof";a.Typeof=23;a._map[24]="NumberLit";a.NumberLit=24;a._map[25]="Name";a.Name=25;a._map[26]="TypeRef";a.TypeRef=26;a._map[27]="Index";a.Index=27;a._map[28]="Call";a.Call=28;a._map[29]="New";a.New=29;a._map[30]="Asg";a.Asg=30;a._map[31]="AsgAdd";a.AsgAdd=31;a._map[32]="AsgSub";
a.AsgSub=32;a._map[33]="AsgDiv";a.AsgDiv=33;a._map[34]="AsgMul";a.AsgMul=34;a._map[35]="AsgMod";a.AsgMod=35;a._map[36]="AsgAnd";a.AsgAnd=36;a._map[37]="AsgXor";a.AsgXor=37;a._map[38]="AsgOr";a.AsgOr=38;a._map[39]="AsgLsh";a.AsgLsh=39;a._map[40]="AsgRsh";a.AsgRsh=40;a._map[41]="AsgRs2";a.AsgRs2=41;a._map[42]="QMark";a.QMark=42;a._map[43]="LogOr";a.LogOr=43;a._map[44]="LogAnd";a.LogAnd=44;a._map[45]="Or";a.Or=45;a._map[46]="Xor";a.Xor=46;a._map[47]="And";a.And=47;a._map[48]="Eq";a.Eq=48;a._map[49]=
"Ne";a.Ne=49;a._map[50]="Eqv";a.Eqv=50;a._map[51]="NEqv";a.NEqv=51;a._map[52]="Lt";a.Lt=52;a._map[53]="Le";a.Le=53;a._map[54]="Gt";a.Gt=54;a._map[55]="Ge";a.Ge=55;a._map[56]="Add";a.Add=56;a._map[57]="Sub";a.Sub=57;a._map[58]="Mul";a.Mul=58;a._map[59]="Div";a.Div=59;a._map[60]="Mod";a.Mod=60;a._map[61]="Lsh";a.Lsh=61;a._map[62]="Rsh";a.Rsh=62;a._map[63]="Rs2";a.Rs2=63;a._map[64]="Not";a.Not=64;a._map[65]="LogNot";a.LogNot=65;a._map[66]="IncPre";a.IncPre=66;a._map[67]="DecPre";a.DecPre=67;a._map[68]=
"IncPost";a.IncPost=68;a._map[69]="DecPost";a.DecPost=69;a._map[70]="TypeAssertion";a.TypeAssertion=70;a._map[71]="FuncDecl";a.FuncDecl=71;a._map[72]="Member";a.Member=72;a._map[73]="VarDecl";a.VarDecl=73;a._map[74]="ArgDecl";a.ArgDecl=74;a._map[75]="Return";a.Return=75;a._map[76]="Break";a.Break=76;a._map[77]="Continue";a.Continue=77;a._map[78]="Throw";a.Throw=78;a._map[79]="For";a.For=79;a._map[80]="ForIn";a.ForIn=80;a._map[81]="If";a.If=81;a._map[82]="While";a.While=82;a._map[83]="DoWhile";a.DoWhile=
83;a._map[84]="Block";a.Block=84;a._map[85]="Case";a.Case=85;a._map[86]="Switch";a.Switch=86;a._map[87]="Try";a.Try=87;a._map[88]="TryCatch";a.TryCatch=88;a._map[89]="TryFinally";a.TryFinally=89;a._map[90]="Finally";a.Finally=90;a._map[91]="Catch";a.Catch=91;a._map[92]="List";a.List=92;a._map[93]="Script";a.Script=93;a._map[94]="Class";a.Class=94;a._map[95]="Interface";a.Interface=95;a._map[96]="Module";a.Module=96;a._map[97]="Import";a.Import=97;a._map[98]="With";a.With=98;a._map[99]="Label";a.Label=
99;a._map[100]="LabeledStatement";a.LabeledStatement=100;a._map[101]="EBStart";a.EBStart=101;a._map[102]="GotoEB";a.GotoEB=102;a._map[103]="EndCode";a.EndCode=103;a._map[104]="Error";a.Error=104;a._map[105]="Comment";a.Comment=105;a._map[106]="Debugger";a.Debugger=106;a.GeneralNode=a.FuncDecl;a.LastAsg=a.AsgRs2})(TypeScript||(TypeScript={}));
(function(a){var e;e=function(){this.constructor=this.isPrototypeOf=this.propertyIsEnumerable=this.hasOwnProperty=this.valueOf=this.toLocaleString=this.toString=this.prototype=void 0};a.BlockIntrinsics=e;var i=function(){this.itemCount=0;this.table=new e};i.prototype.getAllKeys=function(){var a=[],b;for(b in this.table)void 0!=this.table[b]&&(a[a.length]=b);return a};i.prototype.add=function(a,b){if(void 0!=this.table[a])return!1;this.table[a]=b;this.itemCount++;return!0};i.prototype.addOrUpdate=
function(a,b){if(void 0!=this.table[a])return this.table[a]=b,!1;this.table[a]=b;this.itemCount++;return!0};i.prototype.map=function(a,b){for(var d in this.table)void 0!=this.table[d]&&a(d,this.table[d],b)};i.prototype.every=function(a,b){for(var d in this.table)if(void 0!=this.table[d]&&!a(d,this.table[d],b))return!1;return!0};i.prototype.some=function(a,b){for(var d in this.table)if(void 0!=this.table[d]&&a(d,this.table[d],b))return!0;return!1};i.prototype.count=function(){return this.itemCount};
i.prototype.lookup=function(a){a=this.table[a];return void 0!=a?a:null};a.StringHashTable=i;i=function(a,b){this.primaryTable=a;this.secondaryTable=b;this.insertPrimary=!0};i.prototype.getAllKeys=function(){return this.primaryTable.getAllKeys().concat(this.secondaryTable.getAllKeys())};i.prototype.add=function(a,b){return this.insertPrimary?this.primaryTable.add(a,b):this.secondaryTable.add(a,b)};i.prototype.addOrUpdate=function(a,b){return this.insertPrimary?this.primaryTable.addOrUpdate(a,b):this.secondaryTable.addOrUpdate(a,
b)};i.prototype.map=function(a,b){this.primaryTable.map(a,b);this.secondaryTable.map(a,b)};i.prototype.every=function(a,b){return this.primaryTable.every(a,b)&&this.secondaryTable.every(a,b)};i.prototype.some=function(a,b){return this.primaryTable.some(a,b)||this.secondaryTable.some(a,b)};i.prototype.count=function(){return this.primaryTable.count()+this.secondaryTable.count()};i.prototype.lookup=function(a){var b=this.primaryTable.lookup(a);return void 0!=b?b:this.secondaryTable.lookup(a)};a.DualStringHashTable=
i;a.numberHashFn=function(a){a=a^61^a>>>16;a+=a<<3;a=668265261*(a^a>>>4);return a^=a>>>15};a.combineHashes=function(a,b){return b^(a>>5)+a};var b;b=function(a,b){this.key=a;this.data=b};a.HashEntry=b;i=function(a,b,d){this.size=a;this.hashFn=b;this.equalsFn=d;this.itemCount=0;this.table=[];for(a=0;a<this.size;a++)this.table[a]=null};i.prototype.add=function(a,f){var d,l=new b(a,f),c=this.hashFn(a),c=c%this.size;for(d=this.table[c];null!=d;d=d.next)if(this.equalsFn(a,d.key))return!1;l.next=this.table[c];
this.table[c]=l;this.itemCount++;return!0};i.prototype.remove=function(a){var b,d=this.hashFn(a),d=d%this.size,l=null,c=null;for(b=this.table[d];null!=b;b=b.next){if(this.equalsFn(a,b.key)){l=b.data;this.itemCount--;c?c.next=b.next:this.table[d]=b.next;break}c=b}return l};i.prototype.count=function(){return this.itemCount};i.prototype.lookup=function(a){var b;b=this.hashFn(a);b%=this.size;for(b=this.table[b];null!=b;b=b.next)if(this.equalsFn(a,b.key))return b.data;return null};a.HashTable=i})(TypeScript||
(TypeScript={}));var __extends=this.__extends||function(a,e){function i(){this.constructor=a}i.prototype=e.prototype;a.prototype=new i};
(function(a){var e=function(c){this.nodeType=c;this.type=null;this.flags=a.ASTFlags.Writeable;this.limChar=this.minChar=-1;this.passCreated=a.CompilerDiagnostics.analysisPass;this.postComments=this.preComments=null;this.isParenthesized=!1};e.prototype.isStatementOrExpression=function(){return!1};e.prototype.isCompoundStatement=function(){return!1};e.prototype.isLeaf=function(){return this.isStatementOrExpression()&&!this.isCompoundStatement()};e.prototype.typeCheck=function(c){switch(this.nodeType){case a.NodeType.Error:case a.NodeType.EmptyExpr:this.type=
c.anyType;break;case a.NodeType.This:return c.typeCheckThis(this);case a.NodeType.Null:this.type=c.nullType;break;case a.NodeType.False:case a.NodeType.True:this.type=c.booleanType;break;case a.NodeType.Super:return c.typeCheckSuper(this);case a.NodeType.EndCode:case a.NodeType.Empty:case a.NodeType.Void:this.type=c.voidType;break;default:throw Error("please implement in derived class");}return this};e.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
switch(this.nodeType){case a.NodeType.This:c.thisFnc&&a.hasFlag(c.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction)?c.writeToOutput("_this"):c.writeToOutput("this");break;case a.NodeType.Null:c.writeToOutput("null");break;case a.NodeType.False:c.writeToOutput("false");break;case a.NodeType.True:c.writeToOutput("true");break;case a.NodeType.Super:c.emitSuperReference();case a.NodeType.EndCode:break;case a.NodeType.Error:case a.NodeType.EmptyExpr:break;case a.NodeType.Empty:c.writeToOutput("; ");break;
case a.NodeType.Void:c.writeToOutput("void ");break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};e.prototype.print=function(c){c.startLine();var d={line:-1,col:-1},h={line:-1,col:-1};null!==c.parser&&(c.parser.getSourceLineCol(d,this.minChar),c.parser.getSourceLineCol(h,this.limChar),c.write("("+d.line+","+d.col+")--("+h.line+","+h.col+"): "));d=this.printLabel();a.hasFlag(this.flags,a.ASTFlags.Error)&&(d+=" (Error)");
c.writeLine(d)};e.prototype.printLabel=function(){return void 0!==a.nodeTypeTable[this.nodeType]?a.nodeTypeTable[this.nodeType]:a.NodeType._map[this.nodeType]};e.prototype.addToControlFlow=function(a){a.walker.options.goChildren=!1;a.addContent(this)};e.prototype.netFreeUses=function(){};e.prototype.treeViewLabel=function(){return a.NodeType._map[this.nodeType]};a.AST=e;var i=function(c,d){e.call(this,a.NodeType.Error);this.minChar=c;this.limChar=d};__extends(i,e);a.IncompleteAST=i;var b=function(){e.call(this,
a.NodeType.List);this.enclosingScope=null;this.members=[]};__extends(b,e);b.prototype.addToControlFlow=function(a){for(var c=this.members.length,d=0;d<c;d++)if(a.noContinuation){a.addUnreachable(this.members[d]);break}else this.members[d]=a.walk(this.members[d],this);a.walker.options.goChildren=!1};b.prototype.append=function(a){this.members[this.members.length]=a;return this};b.prototype.appendAll=function(c){if(c.nodeType==a.NodeType.List)for(var d=0,h=c.members.length;d<h;d++)this.append(c.members[d]);
else this.append(c);return this};b.prototype.emit=function(c,d,h,g){c.emitJavascriptList(this,null,a.TokenID.SColon,h,!1,!1,g)};b.prototype.typeCheck=function(a){var c=this.members.length;a.nestingLevel++;for(var d=0;d<c;d++)this.members[d]&&(this.members[d]=this.members[d].typeCheck(a));a.nestingLevel--;return this};a.ASTList=b;var j=function(c){e.call(this,a.NodeType.Name);this.text=c;this.sym=null;this.cloId=-1};__extends(j,e);j.prototype.isMissing=function(){return!1};j.prototype.isLeaf=function(){return!0};
j.prototype.treeViewLabel=function(){return"id: "+this.text};j.prototype.printLabel=function(){return this.text?"id: "+this.text:"name node"};j.prototype.typeCheck=function(a){return a.typeCheckName(this)};j.prototype.emit=function(a){a.emitJavascriptName(this,!0)};a.Identifier=j;i=function(){j.call(this,"__missing")};__extends(i,j);i.prototype.isMissing=function(){return!0};i.prototype.emit=function(){};a.MissingIdentifier=i;i=function(c){e.call(this,a.NodeType.Label);this.id=c};__extends(i,e);i.prototype.printLabel=
function(){return this.id.text+":"};i.prototype.typeCheck=function(a){this.type=a.voidType;return this};i.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput(this.id.text+":");a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.Label=i;i=function(a,c){e.call(this,a);this.operand=c;this.castTerm=this.targetType=null;this.nty=a};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.addToControlFlow=
function(c){e.prototype.addToControlFlow.call(this,c);this.nodeType==a.NodeType.Throw&&c.returnStmt()};i.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Not:return c.typeCheckBitNot(this);case a.NodeType.LogNot:return c.typeCheckLogNot(this);case a.NodeType.Pos:case a.NodeType.Neg:return c.typeCheckUnaryNumberOperator(this);case a.NodeType.IncPost:case a.NodeType.IncPre:case a.NodeType.DecPost:case a.NodeType.DecPre:return c.typeCheckIncOrDec(this);case a.NodeType.ArrayLit:c.typeCheckArrayLit(this);
break;case a.NodeType.ObjectLit:c.typeCheckObjectLit(this);break;case a.NodeType.Throw:this.operand=c.typeCheck(this.operand);this.type=c.voidType;break;case a.NodeType.Typeof:this.operand=c.typeCheck(this.operand);this.type=c.stringType;break;case a.NodeType.Delete:this.operand=c.typeCheck(this.operand);this.type=c.booleanType;break;case a.NodeType.TypeAssertion:this.castTerm=c.typeCheck(this.castTerm);c.checker.typeCheckWithContextualType(!this.operand.isParenthesized?this.castTerm.type:null,c.checker.inProvisionalTypecheckMode(),
!0,this.operand);c.castWithCoercion(this.operand,this.castTerm.type,!1,!0);this.type=this.castTerm.type;break;case a.NodeType.Void:this.operand=c.typeCheck(this.operand);this.type=c.checker.undefinedType;break;default:throw Error("please implement in derived class");}return this};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);switch(this.nty){case a.NodeType.IncPost:c.emitJavascript(this.operand,a.TokenID.Inc,!1);c.writeToOutput("++");break;case a.NodeType.LogNot:c.writeToOutput("!");
c.emitJavascript(this.operand,a.TokenID.Bang,!1);break;case a.NodeType.DecPost:c.emitJavascript(this.operand,a.TokenID.Dec,!1);c.writeToOutput("--");break;case a.NodeType.ObjectLit:c.emitObjectLiteral(this.operand);break;case a.NodeType.ArrayLit:c.emitArrayLiteral(this.operand);break;case a.NodeType.Not:c.writeToOutput("~");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Neg:c.writeToOutput("-");this.operand.nodeType==a.NodeType.Neg&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,
a.TokenID.Sub,!1);break;case a.NodeType.Pos:c.writeToOutput("+");this.operand.nodeType==a.NodeType.Pos&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,a.TokenID.Add,!1);break;case a.NodeType.IncPre:c.writeToOutput("++");c.emitJavascript(this.operand,a.TokenID.Inc,!1);break;case a.NodeType.DecPre:c.writeToOutput("--");c.emitJavascript(this.operand,a.TokenID.Dec,!1);break;case a.NodeType.Throw:c.writeToOutput("throw ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);c.writeToOutput(";");
break;case a.NodeType.Typeof:c.writeToOutput("typeof ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Delete:c.writeToOutput("delete ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Void:c.writeToOutput("void ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.TypeAssertion:c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.UnaryExpression=i;i=function(a,c,d){e.call(this,a);this.target=c;this.args=d;this.signature=null;this.nty=a;this.minChar=this.target.minChar};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.typeCheck=function(c){return this.nty==a.NodeType.New?c.typeCheckNew(this):c.typeCheckCall(this)};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.New?c.emitNew(this.target,this.args):c.emitCall(this,
this.target,this.args);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.CallExpression=i;i=function(a,c,d){e.call(this,a);this.operand1=c;this.operand2=d;this.nty=a};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Dot:return c.typeCheckDotOperator(this);case a.NodeType.Asg:return c.typeCheckAsgOperator(this);case a.NodeType.Add:case a.NodeType.Sub:case a.NodeType.Mul:case a.NodeType.Div:case a.NodeType.Mod:case a.NodeType.Or:case a.NodeType.And:return c.typeCheckArithmeticOperator(this,
!1);case a.NodeType.Xor:return c.typeCheckBitwiseOperator(this,!1);case a.NodeType.Ne:case a.NodeType.Eq:var d;c.checker.styleSettings.eqeqeq?(d=a.nodeTypeTable[this.nty],c.checker.errorReporter.styleError(this,"use of "+d)):c.checker.styleSettings.eqnull&&(d=a.nodeTypeTable[this.nty],null!==this.operand2&&this.operand2.nodeType==a.NodeType.Null&&c.checker.errorReporter.styleError(this,"use of "+d+" to compare with null"));case a.NodeType.Eqv:case a.NodeType.NEqv:case a.NodeType.Lt:case a.NodeType.Le:case a.NodeType.Ge:case a.NodeType.Gt:return c.typeCheckBooleanOperator(this);
case a.NodeType.Index:return c.typeCheckIndex(this);case a.NodeType.Member:this.type=c.voidType;break;case a.NodeType.LogOr:return c.typeCheckLogOr(this);case a.NodeType.LogAnd:return c.typeCheckLogAnd(this);case a.NodeType.AsgAdd:case a.NodeType.AsgSub:case a.NodeType.AsgMul:case a.NodeType.AsgDiv:case a.NodeType.AsgMod:case a.NodeType.AsgOr:case a.NodeType.AsgAnd:return c.typeCheckArithmeticOperator(this,!0);case a.NodeType.AsgXor:return c.typeCheckBitwiseOperator(this,!0);case a.NodeType.Lsh:case a.NodeType.Rsh:case a.NodeType.Rs2:return c.typeCheckShift(this,
!1);case a.NodeType.AsgLsh:case a.NodeType.AsgRsh:case a.NodeType.AsgRs2:return c.typeCheckShift(this,!0);case a.NodeType.Comma:return c.typeCheckCommaOperator(this);case a.NodeType.InstOf:return c.typeCheckInstOf(this);case a.NodeType.In:return c.typeCheckInOperator(this);case a.NodeType.From:c.checker.errorReporter.simpleError(this,"Illegal use of 'from' keyword in binary expression");break;default:throw Error("please implement in derived class");}return this};i.prototype.emit=function(c){var d=
a.nodeTypeToTokTable[this.nodeType];c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);if(void 0!=d)c.emitJavascript(this.operand1,d,!1),"instanceof"==a.tokenTable[d].text?c.writeToOutput(" instanceof "):"in"==a.tokenTable[d].text?c.writeToOutput(" in "):c.writeToOutputTrimmable(" "+a.tokenTable[d].text+" "),c.emitJavascript(this.operand2,d,!1);else switch(this.nty){case a.NodeType.Dot:c.tryEmitConstant(this)||(c.emitJavascript(this.operand1,a.TokenID.Dot,!1),c.writeToOutput("."),
c.emitJavascriptName(this.operand2,!1));break;case a.NodeType.Index:c.emitIndex(this.operand1,this.operand2);break;case a.NodeType.Member:this.operand2.nodeType==a.NodeType.FuncDecl&&this.operand2.isAccessor()?(a.hasFlag(this.operand2.fncFlags,a.FncFlags.GetAccessor)?c.writeToOutput("get "):c.writeToOutput("set "),c.emitJavascript(this.operand1,a.TokenID.Colon,!1)):(c.emitJavascript(this.operand1,a.TokenID.Colon,!1),c.writeToOutputTrimmable(": "));c.emitJavascript(this.operand2,a.TokenID.Comma,!1);
break;case a.NodeType.Comma:c.emitJavascript(this.operand1,a.TokenID.Comma,!1);c.emitState.inObjectLiteral?c.writeLineToOutput(", "):c.writeToOutput(",");c.emitJavascript(this.operand2,a.TokenID.Comma,!1);break;case a.NodeType.Is:throw Error("should be de-sugared during type check");default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.BinaryExpression=i;i=function(a,c,d,h){e.call(this,a);this.operand1=c;this.operand2=d;
this.operand3=h;this.nty=a};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.typeCheck=function(a){return a.typeCheckQMark(this)};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.operand1,a.TokenID.QMark,!1);c.writeToOutput(" ? ");c.emitJavascript(this.operand2,a.TokenID.QMark,!1);c.writeToOutput(" : ");c.emitJavascript(this.operand3,a.TokenID.QMark,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.TrinaryExpression=i;i=function(c){e.call(this,a.NodeType.NumberLit);this.value=c;this.isNegativeZero=!1};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.typeCheck=function(a){this.type=a.doubleType;return this};i.prototype.treeViewLabel=function(){return"num: "+this.value};i.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);this.isNegativeZero&&a.writeToOutput("-");a.writeToOutput(this.value.toString());a.recordSourceMappingEnd(this);
a.emitParensAndCommentsInPlace(this,!1)};i.prototype.printLabel=function(){return Math.floor(this.value)!=this.value?this.value.toFixed(2).toString():this.value.toString()};a.NumberLiteral=i;i=function(c){e.call(this,a.NodeType.Regex);this.regex=c};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.typeCheck=function(a){this.type=a.regexType;return this};i.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.regex.toString());
a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.RegexLiteral=i;i=function(c){e.call(this,a.NodeType.QString);this.text=c};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.emitStringLiteral(this.text);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){this.type=a.stringType;return this};i.prototype.treeViewLabel=
function(){return"st: "+this.text};i.prototype.printLabel=function(){return this.text};a.StringLiteral=i;i=function(c,d){e.call(this,a.NodeType.Import);this.id=c;this.alias=d;this.varFlags=a.VarFlags.None;this.isDynamicImport=!1};__extends(i,e);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.emit=function(c,d,h,g){g&&c.emitImportDecl(this);if(!this.isDynamicImport||this.id.sym&&!this.id.sym.onlyReferencedAsTypeRef)d=c.modAliasId,h=c.firstModAlias,c.recordSourceMappingStart(this),
c.emitParensAndCommentsInPlace(this,!0),c.writeToOutput("var "+this.id.text+" = "),c.modAliasId=this.id.text,c.firstModAlias=this.firstAliasedModToString(),c.emitJavascript(this.alias,a.TokenID.Tilde,!1,g),this.isDynamicImport||c.writeToOutput(";"),c.emitParensAndCommentsInPlace(this,!1),c.recordSourceMappingEnd(this),c.modAliasId=d,c.firstModAlias=h};i.prototype.typeCheck=function(a){return a.typeCheckImportDecl(this)};i.prototype.getAliasName=function(c){"undefined"===typeof c&&(c=this.alias);return c.nodeType==
a.NodeType.Name?c.text:this.getAliasName(c.operand1)+"."+this.getAliasName(c.operand2)};i.prototype.firstAliasedModToString=function(){return this.alias.nodeType==a.NodeType.Name?this.alias.text:this.alias.operand1.text};a.ImportDecl=i;var f=function(c,d,h){e.call(this,d);this.id=c;this.nestingLevel=h;this.typeExpr=this.init=null;this.varFlags=a.VarFlags.None;this.sym=null};__extends(f,e);f.prototype.isStatementOrExpression=function(){return!0};f.prototype.isPrivate=function(){return a.hasFlag(this.varFlags,
a.VarFlags.Private)};f.prototype.isPublic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Public)};f.prototype.isProperty=function(){return a.hasFlag(this.varFlags,a.VarFlags.Property)};f.prototype.typeCheck=function(a){return a.typeCheckBoundDecl(this)};f.prototype.printLabel=function(){return this.treeViewLabel()};a.BoundDecl=f;i=function(c,d){f.call(this,c,a.NodeType.VarDecl,d)};__extends(i,f);i.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};i.prototype.isExported=
function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};i.prototype.isStatic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Static)};i.prototype.emit=function(a,c,d,h){a.emitJavascriptVarDecl(this,c,h)};i.prototype.treeViewLabel=function(){return"var "+this.id.text};a.VarDecl=i;i=function(c){f.call(this,c,a.NodeType.ArgDecl,0);this.isOptional=!1;this.parameterPropertySym=null};__extends(i,f);i.prototype.isOptionalArg=function(){return this.isOptional||this.init};i.prototype.treeViewLabel=
function(){return"arg: "+this.id.text};i.prototype.emit=function(a,c,d,h){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.id.text);h&&a.emitArgDecl(this);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.ArgDecl=i;var d=0,l=function(c,d,h,g,l,b,j,f){e.call(this,f);this.name=c;this.bod=d;this.isConstructor=h;this.args=g;this.vars=l;this.scopes=b;this.statics=j;this.hint=null;this.fncFlags=a.FncFlags.None;this.returnTypeAnnotation=
null;this.variableArgList=!1;this.internalNameCache=this.jumpRefs=null;this.tmp1Declared=!1;this.enclosingFnc=null;this.freeVariables=[];this.unitIndex=-1;this.boundToProperty=this.classDecl=null;this.isOverload=!1;this.innerStaticFuncs=[];this.isInlineCallLiteral=this.isTargetTypedAsMethod=!1;this.accessorSymbol=null;this.rightCurlyCount=this.leftCurlyCount=0;this.returnStatementsWithExpressions=[];this.scopeType=null};__extends(l,e);l.prototype.internalName=function(){if(null==this.internalNameCache){var a=
this.getNameText();this.internalNameCache=a?"_internal_"+a:"_internal_"+d++}return this.internalNameCache};l.prototype.hasSelfReference=function(){return a.hasFlag(this.fncFlags,a.FncFlags.HasSelfReference)};l.prototype.setHasSelfReference=function(){this.fncFlags|=a.FncFlags.HasSelfReference};l.prototype.addCloRef=function(a,c){null==this.envids&&(this.envids=[]);this.envids[this.envids.length]=a;var d=this.enclosingFnc;if(c)for(;d&&d.type.symbol!=c.container;)d.addJumpRef(c),d=d.enclosingFnc;return this.envids.length-
1};l.prototype.addJumpRef=function(a){null==this.jumpRefs&&(this.jumpRefs=[]);var c=new j(a.name);this.jumpRefs[this.jumpRefs.length]=c;c.sym=a;c.cloId=this.addCloRef(c,null)};l.prototype.buildControlFlow=function(){var c=new a.BasicBlock,d=new a.BasicBlock,c=new a.ControlFlowContext(c,d),d=a.getAstWalkerFactory().getWalker(function(a,c,k){a.addToControlFlow(k.state);return a},null,null,c);c.walker=d;d.walk(this.bod,this);return c};l.prototype.typeCheck=function(a){return a.typeCheckFunction(this)};
l.prototype.emit=function(a,c,d,h){a.emitJavascriptFunction(this,h)};l.prototype.getNameText=function(){return this.name?this.name.text:this.hint};l.prototype.isMethod=function(){return(this.fncFlags&a.FncFlags.Method)!=a.FncFlags.None};l.prototype.isCallMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.CallMember)};l.prototype.isConstructMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.ConstructMember)};l.prototype.isIndexerMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.IndexerMember)};
l.prototype.isSpecialFn=function(){return this.isCallMember()||this.isIndexerMember()||this.isConstructMember()};l.prototype.isAnonymousFn=function(){return null===this.name};l.prototype.isAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)||a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};l.prototype.isGetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)};l.prototype.isSetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};l.prototype.isAmbient=
function(){return a.hasFlag(this.fncFlags,a.FncFlags.Ambient)};l.prototype.isExported=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Exported)};l.prototype.isPrivate=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Private)};l.prototype.isPublic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Public)};l.prototype.isStatic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Static)};l.prototype.treeViewLabel=function(){return null==this.name?"funcExpr":"func: "+this.name.text};l.prototype.ClearFlags=
function(){this.fncFlags=a.FncFlags.None};l.prototype.isSignature=function(){return(this.fncFlags&a.FncFlags.Signature)!=a.FncFlags.None};l.prototype.hasStaticDeclarations=function(){return!this.isConstructor&&(0<this.statics.members.length||0<this.innerStaticFuncs.length)};a.FuncDecl=l;i=function(a,c,d){this.filename=a;this.lineMap=c;this.unitIndex=d};a.LocationInfo=i;a.unknownLocationInfo=new i("unknown",null,-1);i=function(c,d){l.call(this,new j("script"),null,!1,null,c,d,null,a.NodeType.Script);
this.locationInfo=null;this.hasBeenTypeChecked=this.isDeclareFile=this.isResident=this.requiresInherits=this.requiresGlobal=!1;this.topLevelMod=null;this.rightCurlyCount=this.leftCurlyCount=0;this.vars=c;this.scopes=d};__extends(i,l);i.prototype.typeCheck=function(a){return a.typeCheckScript(this)};i.prototype.treeViewLabel=function(){return"Script"};i.prototype.emitRequired=function(){if(!this.isDeclareFile&&!this.isResident&&this.bod)for(var c=0,d=this.bod.members.length;c<d;c++){var h=this.bod.members[c];
if(h.nodeType==a.NodeType.Module){if(!a.hasFlag(h.modFlags,a.ModuleFlags.ShouldEmitModuleDecl|a.ModuleFlags.Ambient))return!0}else if(h.nodeType==a.NodeType.Class){if(!a.hasFlag(h.varFlags,a.VarFlags.Ambient))return!0}else if(h.nodeType==a.NodeType.VarDecl){if(!a.hasFlag(h.varFlags,a.VarFlags.Ambient))return!0}else if(h.nodeType==a.NodeType.FuncDecl){if(!h.isSignature())return!0}else if(h.nodeType!=a.NodeType.Interface&&h.nodeType!=a.NodeType.Empty)return!0}return!1};i.prototype.emit=function(c,d,
h,g){this.emitRequired()&&(c.emitParensAndCommentsInPlace(this,!0),c.recordSourceMappingStart(this),c.emitPrologue(this.requiresInherits),d=g?c.setDeclContainingAST(this):null,c.emitJavascriptList(this.bod,null,a.TokenID.SColon,!0,!1,!1,g),g&&c.setDeclContainingAST(d),c.recordSourceMappingEnd(this),c.emitParensAndCommentsInPlace(this,!1))};a.Script=i;var c=function(a,c,d){e.call(this,a);this.name=c;this.members=d;this.nty=a};__extends(c,e);a.Record=c;i=function(k,d,h,g){c.call(this,a.NodeType.Module,
k,d);this.modFlags=a.ModuleFlags.ShouldEmitModuleDecl;this.alias=null;this.rightCurlyCount=this.leftCurlyCount=0;this.amdDependencies=[];this.members=d;this.vars=h;this.name=k;this.scopes=g;this.prettyName=this.name.text};__extends(i,c);i.prototype.isExported=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Exported)};i.prototype.isAmbient=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Ambient)};i.prototype.isEnum=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.IsEnum)};i.prototype.recordNonInterface=
function(){this.modFlags&=~a.ModuleFlags.ShouldEmitModuleDecl};i.prototype.typeCheck=function(a){return a.typeCheckModule(this)};i.prototype.emit=function(c,d,h,g){a.hasFlag(this.modFlags,a.ModuleFlags.ShouldEmitModuleDecl)?g&&c.emitModuleSignature(this):(c.emitParensAndCommentsInPlace(this,!0),c.emitJavascriptModule(this,g),c.emitParensAndCommentsInPlace(this,!1))};a.ModuleDecl=i;var h=function(a,d,h,g,l){c.call(this,a,d,l);this.extendsList=h;this.implementsList=g;this.name=d;this.members=l};__extends(h,
c);a.NamedType=h;i=function(c,d,g,l){h.call(this,a.NodeType.Class,c,g,l,d);this.varFlags=a.VarFlags.None;this.rightCurlyCount=this.leftCurlyCount=0;this.knownMemberNames={};this.constructorDecl=null;this.constructorNestingLevel=0;this.allMemberDefinitions=new b;this.name=c;this.baseClass=g;this.implementsList=l;this.definitionMembers=d};__extends(i,h);i.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};i.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,
a.VarFlags.Ambient)};i.prototype.typeCheck=function(a){return a.typeCheckClass(this)};i.prototype.emit=function(a,c,d,h){a.emitJavascriptClass(this,h)};a.ClassDecl=i;i=function(c,d,g,l,b,j){h.call(this,c,d,b,j,g);this.args=l;this.varFlags=a.VarFlags.None;this.isOverload=!1;this.rightCurlyCount=this.leftCurlyCount=0;this.nty=c;this.name=d;this.extendsList=b;this.implementsList=j;this.members=g};__extends(i,h);i.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};i.prototype.isAmbient=
function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};i.prototype.typeCheck=function(c){if(this.nty==a.NodeType.Interface)return c.typeCheckInterface(this);throw Error("please implement type check for node type"+this.nty);};i.prototype.emit=function(c,d,h,g){if(this.nty==a.NodeType.Interface)g&&c.emitInterfaceDeclaration(this);else throw Error("please implement emit for node type"+this.nty);};a.TypeDecl=i;var g=function(c){e.call(this,c);this.flags|=a.ASTFlags.IsStatement};__extends(g,e);
g.prototype.isLoop=function(){return!1};g.prototype.isCompoundStatement=function(){return this.isLoop()};g.prototype.typeCheck=function(a){this.type=a.voidType;return this};a.Statement=g;i=function(c,d){g.call(this,a.NodeType.LabeledStatement);this.labels=c;this.stmt=d};__extends(i,g);i.prototype.emit=function(a,c,d,h){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);if(this.labels)for(var g=this.labels.members.length,l=0;l<g;l++)this.labels.members[l].emit(a,c,d,h);this.stmt.emit(a,
c,!0,h);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){a.typeCheck(this.labels);this.stmt=this.stmt.typeCheck(a);return this};i.prototype.addToControlFlow=function(c){var d=c.current,h=new a.BasicBlock;c.current=h;d.addSuccessor(h)};a.LabeledStatement=i;i=function(c,d){g.call(this,a.NodeType.Block);this.stmts=c;this.visible=d};__extends(i,g);i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
this.visible&&(c.writeLineToOutput(" {"),c.increaseIndent());var d=c.setInObjectLiteral(!1);this.stmts&&c.emitJavascriptList(this.stmts,null,a.TokenID.SColon,!0,!1,!1);this.visible&&(c.decreaseIndent(),c.emitIndent(),c.writeToOutput("}"));c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.addToControlFlow=function(c){var d=new a.BasicBlock;c.pushStatement(this,c.current,d);this.stmts&&c.walk(this.stmts,this);c.walker.options.goChildren=!1;c.popStatement();
0<d.predecessors.length&&(c.current.addSuccessor(d),c.current=d)};i.prototype.typeCheck=function(a){a.checker.styleSettings.emptyBlocks||(null===this.stmts||0==this.stmts.members.length)&&a.checker.errorReporter.styleError(this,"empty block");a.typeCheck(this.stmts);return this};a.Block=i;i=function(a){g.call(this,a);this.resolvedTarget=this.target=null;this.nty=a};__extends(i,g);i.prototype.hasExplicitTarget=function(){return this.target};i.prototype.setResolvedTarget=function(c,d){if(d.isLoop())return this.resolvedTarget=
d,!0;if(this.nty===a.NodeType.Continue)return c.reportParseError("continue statement applies only to loops"),!1;if(d.nodeType==a.NodeType.Switch||this.hasExplicitTarget())return this.resolvedTarget=d,!0;c.reportParseError("break statement with no label can apply only to a loop or switch statement");return!1};i.prototype.addToControlFlow=function(c){g.prototype.addToControlFlow.call(this,c);c.unconditionalBranch(this.resolvedTarget,this.nty==a.NodeType.Continue)};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.Break?c.writeToOutput("break"):c.writeToOutput("continue");this.hasExplicitTarget()&&c.writeToOutput(" "+this.target);c.writeToOutput(";");c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.Jump=i;i=function(c){g.call(this,a.NodeType.While);this.cond=c;this.body=null};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isLoop=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("while(");c.emitJavascript(this.cond,a.TokenID.WHILE,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!1,!1);c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){return a.typeCheckWhile(this)};i.prototype.addToControlFlow=function(c){var d=c.current,h=new a.BasicBlock,g=new a.BasicBlock;d.addSuccessor(h);c.current=h;c.addContent(this.cond);
d=c.current;this.body&&(c.current=new a.BasicBlock,d.addSuccessor(c.current),c.pushStatement(this,h,g),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(h);c.current=g;d.addSuccessor(g);c.noContinuation=!1;c.walker.options.goChildren=!1};a.WhileStatement=i;i=function(){g.call(this,a.NodeType.DoWhile);this.cond=this.whileAST=this.body=null};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isLoop=function(){return!0};i.prototype.emit=
function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("do");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingStart(this.whileAST);c.writeToOutput("while");c.recordSourceMappingEnd(this.whileAST);c.writeToOutput("(");c.emitJavascript(this.cond,a.TokenID.RParen,!1);c.writeToOutput(")");c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){return a.typeCheckDoWhile(this)};
i.prototype.addToControlFlow=function(c){var d=c.current,h=new a.BasicBlock,g=new a.BasicBlock;d.addSuccessor(h);c.current=h;this.body&&(c.pushStatement(this,h,g),c.walk(this.body,this),c.popStatement());c.noContinuation?c.addUnreachable(this.cond):(d=c.current,d.addSuccessor(h),c.addContent(this.cond),c.current=g,d.addSuccessor(g));c.walker.options.goChildren=!1};a.DoWhileStatement=i;i=function(c){g.call(this,a.NodeType.If);this.cond=c;this.elseBod=null};__extends(i,g);i.prototype.isStatementOrExpression=
function(){return!0};i.prototype.isCompoundStatement=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("if(");c.emitJavascript(this.cond,a.TokenID.IF,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.thenBod,!0,!1);this.elseBod&&(c.writeToOutput(" else"),c.emitJavascriptStatements(this.elseBod,!0,!0));c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};i.prototype.typeCheck=function(a){return a.typeCheckIf(this)};i.prototype.addToControlFlow=function(c){this.cond.addToControlFlow(c);var d=new a.BasicBlock,h=c.current;c.pushStatement(this,h,d);var g=!1;c.current=new a.BasicBlock;h.addSuccessor(c.current);c.walk(this.thenBod,this);c.noContinuation||(g=!0,c.current.addSuccessor(d));this.elseBod?(c.current=new a.BasicBlock,c.noContinuation=!1,h.addSuccessor(c.current),c.walk(this.elseBod,this),c.noContinuation?g&&(c.noContinuation=!1):(g=!0,c.current.addSuccessor(d))):
(h.addSuccessor(d),c.noContinuation=!1,g=!0);c.popStatement();0<d.predecessors.length&&(c.noContinuation=!1,g=!0);g&&(c.current=d);c.walker.options.goChildren=!1};a.IfStatement=i;i=function(){g.call(this,a.NodeType.Return);this.returnExpression=null};__extends(i,g);i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);this.returnExpression?(c.writeToOutput("return "),c.emitJavascript(this.returnExpression,a.TokenID.SColon,
!1)):c.writeToOutput("return;");c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.addToControlFlow=function(a){g.prototype.addToControlFlow.call(this,a);a.returnStmt()};i.prototype.typeCheck=function(a){return a.typeCheckReturn(this)};a.ReturnStatement=i;i=function(){e.call(this,a.NodeType.EndCode)};__extends(i,e);a.EndCode=i;i=function(c,d){g.call(this,a.NodeType.ForIn);this.lval=c;this.obj=d;this.lval&&this.lval.nodeType==a.NodeType.VarDecl&&
(this.lval.varFlags|=a.VarFlags.AutoInit)};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isLoop=function(){return!0};i.prototype.isFiltered=function(){if(this.body){var c=null;if(this.body.nodeType==a.NodeType.List){var d=this.body;1==d.members.length&&(c=d.members[0])}else c=this.body;if(null!==c&&(c.nodeType==a.NodeType.Block&&(d=c,null!==d.stmts&&1==d.stmts.members.length&&(c=d.stmts.members[0])),c.nodeType==a.NodeType.If&&(c=c.cond,c.nodeType==a.NodeType.Call&&
(d=c.target,d.nodeType==a.NodeType.Dot&&(d.operand1.nodeType==a.NodeType.Name&&(this.obj.nodeType==a.NodeType.Name&&d.operand1.text==this.obj.text)&&"hasOwnProperty"==d.operand2.text)&&(c=c.args,null!==c&&1==c.members.length&&(c=c.members[0],c.nodeType==a.NodeType.Name&&this.lval.nodeType==a.NodeType.Name&&this.lval.text==c.text))))))return!0}return!1};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("for(");
c.emitJavascript(this.lval,a.TokenID.FOR,!1);c.writeToOutput(" in ");c.emitJavascript(this.obj,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){a.checker.styleSettings.forin&&(this.isFiltered()||a.checker.errorReporter.styleError(this,"no hasOwnProperty filter"));return a.typeCheckForIn(this)};i.prototype.addToControlFlow=function(c){this.lval&&
c.addContent(this.lval);this.obj&&c.addContent(this.obj);var d=c.current,h=new a.BasicBlock,g=new a.BasicBlock;d.addSuccessor(h);c.current=h;this.body&&(c.pushStatement(this,h,g),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(h);c.current=g;c.noContinuation=!1;d.addSuccessor(g);c.walker.options.goChildren=!1};a.ForInStatement=i;i=function(c){g.call(this,a.NodeType.For);this.init=c};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isLoop=
function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("for(");this.init&&(this.init.nodeType!=a.NodeType.List?c.emitJavascript(this.init,a.TokenID.FOR,!1):c.emitForVarList(this.init));c.writeToOutput("; ");c.emitJavascript(this.cond,a.TokenID.FOR,!1);c.writeToOutput("; ");c.emitJavascript(this.incr,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(d);
c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){return a.typeCheckFor(this)};i.prototype.addToControlFlow=function(c){this.init&&c.addContent(this.init);var d=c.current,h=new a.BasicBlock,g=new a.BasicBlock;d.addSuccessor(h);c.current=h;var d=null,l=h,b=null;this.incr&&(l=b=new a.BasicBlock);this.cond&&(d=c.current,c.addContent(this.cond),c.current=new a.BasicBlock,d.addSuccessor(c.current));this.body&&(c.pushStatement(this,l,g),c.walk(this.body,
this),c.popStatement());this.incr&&(c.noContinuation?0==b.predecessors.length&&c.addUnreachable(this.incr):(c.current.addSuccessor(b),c.current=b,c.addContent(this.incr)));l=c.current;c.noContinuation||l.addSuccessor(h);d&&(d.addSuccessor(g),c.noContinuation=!1);0<g.predecessors.length&&(c.noContinuation=!1,c.current=g);c.walker.options.goChildren=!1};a.ForStatement=i;i=function(c){g.call(this,a.NodeType.With);this.expr=c;this.withSym=null};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};
i.prototype.isCompoundStatement=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("with (");this.expr&&c.emitJavascript(this.expr,a.TokenID.WITH,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){return a.typeCheckWith(this)};a.WithStatement=i;i=function(c){g.call(this,a.NodeType.Switch);
this.val=c;this.defaultCase=null};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isCompoundStatement=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var d=c.setInObjectLiteral(!1);c.writeToOutput("switch(");c.emitJavascript(this.val,a.TokenID.ID,!1);c.writeLineToOutput(") {");c.increaseIndent();for(var h=this.caseList.members.length,g=0;g<h;g++)c.emitJavascript(this.caseList.members[g],
a.TokenID.CASE,!0),c.writeLineToOutput("");c.decreaseIndent();c.emitIndent();c.writeToOutput("}");c.setInObjectLiteral(d);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){var c=this.caseList.members.length;this.val=a.typeCheck(this.val);for(var d=0;d<c;d++)this.caseList.members[d]=a.typeCheck(this.caseList.members[d]);this.defaultCase=a.typeCheck(this.defaultCase);this.type=a.voidType;return this};i.prototype.addToControlFlow=function(c){var d=
c.current;c.addContent(this.val);var h=new a.BasicBlock,g=new a.BasicBlock;d.addSuccessor(h);c.pushSwitch(h);c.current=h;c.pushStatement(this,h,g);c.walk(this.caseList,this);c.popSwitch();c.popStatement();null==this.defaultCase&&d.addSuccessor(g);0<g.predecessors.length?(c.noContinuation=!1,c.current=g):c.noContinuation=!0;c.walker.options.goChildren=!1};a.SwitchStatement=i;i=function(){g.call(this,a.NodeType.Case);this.expr=null};__extends(i,g);i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);this.expr?(c.writeToOutput("case "),c.emitJavascript(this.expr,a.TokenID.ID,!1)):c.writeToOutput("default");c.writeToOutput(":");c.emitJavascriptStatements(this.body,!1,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){this.expr=a.typeCheck(this.expr);a.typeCheck(this.body);this.type=a.voidType;return this};i.prototype.addToControlFlow=function(c){var d=new a.BasicBlock,h=c.currentSwitch[c.currentSwitch.length-
1];if(this.expr){var g=new a.BasicBlock;c.current=g;h.addSuccessor(g);c.addContent(this.expr);g.addSuccessor(d)}else h.addSuccessor(d);c.current=d;this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};a.CaseStatement=i;i=function(c,d){e.call(this,a.NodeType.TypeRef);this.term=c;this.arrayCount=d};__extends(i,e);i.prototype.emit=function(){throw Error("should not emit a type ref");};i.prototype.typeCheck=function(c){var d=c.inTypeRefTypeCheck;c.inTypeRefTypeCheck=!0;
var h=a.getTypeLink(this,c.checker,!0);c.checker.resolveTypeLink(c.scope,h,!1);c.checkForVoidConstructor(h.type,this);this.type=h.type;this.term&&(this.term.type=this.type);c.inTypeRefTypeCheck=d;return this};a.TypeReference=i;i=function(c,d){g.call(this,a.NodeType.TryFinally);this.tryNode=c;this.finallyNode=d};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isCompoundStatement=function(){return!0};i.prototype.emit=function(c){c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,
a.TokenID.TRY,!1);c.emitJavascript(this.finallyNode,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this)};i.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.finallyNode=a.typeCheck(this.finallyNode);this.type=a.voidType;return this};i.prototype.addToControlFlow=function(c){var d=new a.BasicBlock;c.walk(this.tryNode,this);var h=new a.BasicBlock;c.current&&c.current.addSuccessor(h);c.current=h;c.pushStatement(this,null,d);c.walk(this.finallyNode,this);!c.noContinuation&&c.current&&
c.current.addSuccessor(d);0<d.predecessors.length?c.current=d:c.noContinuation=!0;c.popStatement();c.walker.options.goChildren=!1};a.TryFinally=i;i=function(c,d){g.call(this,a.NodeType.TryCatch);this.tryNode=c;this.catchNode=d};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.isCompoundStatement=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,a.TokenID.TRY,!1);
c.emitJavascript(this.catchNode,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.addToControlFlow=function(c){var d=c.current,h=new a.BasicBlock;d.addSuccessor(h);c.current=h;h=new a.BasicBlock;c.pushStatement(this,null,h);c.walk(this.tryNode,this);c.noContinuation||c.current&&c.current.addSuccessor(h);c.current=new a.BasicBlock;d.addSuccessor(c.current);c.walk(this.catchNode,this);c.popStatement();c.noContinuation||c.current&&c.current.addSuccessor(h);
c.current=h;c.walker.options.goChildren=!1};i.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.catchNode=a.typeCheck(this.catchNode);this.type=a.voidType;return this};a.TryCatch=i;i=function(c){g.call(this,a.NodeType.Try);this.body=c};__extends(i,g);i.prototype.isStatementOrExpression=function(){return!0};i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("try ");c.emitJavascript(this.body,a.TokenID.TRY,
!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};i.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,this);a.walker.options.goChildren=!1;a.noContinuation=!1};a.Try=i;i=function(c,d){g.call(this,a.NodeType.Catch);this.param=c;this.body=d;this.containedScope=null;this.param&&(this.param.varFlags|=a.VarFlags.AutoInit)};__extends(i,g);i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);c.writeToOutput(" catch (");c.emitJavascript(this.param,a.TokenID.LParen,!1);c.writeToOutput(")");c.emitJavascript(this.body,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.addToControlFlow=function(c){if(this.param){c.addContent(this.param);var d=new a.BasicBlock;c.current.addSuccessor(d);c.current=d}this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};i.prototype.typeCheck=
function(c){var d=c.scope;c.scope=this.containedScope;this.param=c.typeCheck(this.param);var h=new a.ValueLocation,g=new a.VariableSymbol(this.param.id.text,this.param.minChar,c.checker.locationInfo.unitIndex,h);h.symbol=g;h.typeLink=new a.TypeLink;h.typeLink.type=c.anyType;g=c.thisFnc;h.symbol.container=g&&g.type?g.type.symbol:null;this.param.sym=h.symbol;c.scope.enter(h.symbol.container,this.param,h.symbol,c.checker.errorReporter,!1,!1,!1);this.body=c.typeCheck(this.body);c.checker.inProvisionalTypecheckMode()&&
(c.scope.getTable().secondaryTable.table[h.symbol.name]=void 0);this.type=c.voidType;c.scope=d;return this};a.Catch=i;i=function(c){g.call(this,a.NodeType.Finally);this.body=c};__extends(i,g);i.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("finally");c.emitJavascript(this.body,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};i.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,
this);a.walker.options.goChildren=!1;a.noContinuation=!1};i.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};a.Finally=i;i=function(c,d,h){e.call(this,a.NodeType.Comment);this.content=c;this.isBlockComment=d;this.endsLine=h;this.text=null};__extends(i,e);i.prototype.getText=function(){if(null==this.text)if(this.isBlockComment){this.text=this.content.split("\n");for(var a=0;a<this.text.length;a++)this.text[a]=this.text[a].replace(/^\s+|\s+$/g,"")}else this.text=[this.content.replace(/^\s+|\s+$/g,
"")];return this.text};a.Comment=i;i=function(){g.call(this,a.NodeType.Debugger)};__extends(i,g);i.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput("debugger;");a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.DebuggerStatement=i})(TypeScript||(TypeScript={}));
(function(a){var e=function(){this.goNextSibling=this.goChildren=!0;this.reverseSiblings=!1};e.prototype.stopWalk=function(a){"undefined"===typeof a&&(a=!0);this.goChildren=!a;this.goNextSibling=!a};a.AstWalkOptions=e;var i=function(a,d,g,l,b){this.childrenWalkers=a;this.pre=d;this.post=g;this.options=l;this.state=b};i.prototype.walk=function(a,d){var g=this.pre(a,d,this);void 0===g&&(g=a);if(this.options.goChildren){var l=this.options.goNextSibling;this.options.goNextSibling=!0;this.childrenWalkers[a.nodeType](a,
d,this);this.options.goNextSibling=l}else this.options.goChildren=!0;return this.post?(l=this.post(g,d,this),void 0===l&&(l=g),l):g};var b=function(){this.childrenWalkers=[];this.initChildrenWalkers()};b.prototype.walk=function(a,d,g,l,b){return this.getWalker(d,g,l,b).walk(a,null)};b.prototype.getWalker=function(a,d,g,l){return this.getSlowWalker(a,d,g,l)};b.prototype.getSlowWalker=function(a,d,g,l){g||(g=new e);return new i(this.childrenWalkers,a,d,g,l)};b.prototype.initChildrenWalkers=function(){this.childrenWalkers[a.NodeType.None]=
f.walkNone;this.childrenWalkers[a.NodeType.Empty]=f.walkNone;this.childrenWalkers[a.NodeType.EmptyExpr]=f.walkNone;this.childrenWalkers[a.NodeType.True]=f.walkNone;this.childrenWalkers[a.NodeType.False]=f.walkNone;this.childrenWalkers[a.NodeType.This]=f.walkNone;this.childrenWalkers[a.NodeType.Super]=f.walkNone;this.childrenWalkers[a.NodeType.QString]=f.walkNone;this.childrenWalkers[a.NodeType.Regex]=f.walkNone;this.childrenWalkers[a.NodeType.Null]=f.walkNone;this.childrenWalkers[a.NodeType.ArrayLit]=
f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.ObjectLit]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Void]=f.walkNone;this.childrenWalkers[a.NodeType.Comma]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Pos]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Neg]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Delete]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Await]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.In]=
f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Dot]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.From]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Is]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.InstOf]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Typeof]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.NumberLit]=f.walkNone;this.childrenWalkers[a.NodeType.Name]=f.walkNone;this.childrenWalkers[a.NodeType.TypeRef]=
f.walkTypeReferenceChildren;this.childrenWalkers[a.NodeType.Index]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Call]=f.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.New]=f.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.Asg]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAdd]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgSub]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgDiv]=f.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.AsgMul]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgMod]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAnd]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgXor]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgOr]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgLsh]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRsh]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRs2]=
f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.QMark]=f.walkTrinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogOr]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogAnd]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Or]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Xor]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.And]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eq]=f.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Ne]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eqv]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.NEqv]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lt]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Le]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Gt]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Ge]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Add]=
f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Sub]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mul]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Div]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mod]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lsh]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rsh]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rs2]=f.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Not]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.LogNot]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPre]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPre]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPost]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPost]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.TypeAssertion]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.FuncDecl]=
f.walkFuncDeclChildren;this.childrenWalkers[a.NodeType.Member]=f.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.VarDecl]=f.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.ArgDecl]=f.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.Return]=f.walkReturnStatementChildren;this.childrenWalkers[a.NodeType.Break]=f.walkNone;this.childrenWalkers[a.NodeType.Continue]=f.walkNone;this.childrenWalkers[a.NodeType.Throw]=f.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.For]=
f.walkForStatementChildren;this.childrenWalkers[a.NodeType.ForIn]=f.walkForInStatementChildren;this.childrenWalkers[a.NodeType.If]=f.walkIfStatementChildren;this.childrenWalkers[a.NodeType.While]=f.walkWhileStatementChildren;this.childrenWalkers[a.NodeType.DoWhile]=f.walkDoWhileStatementChildren;this.childrenWalkers[a.NodeType.Block]=f.walkBlockChildren;this.childrenWalkers[a.NodeType.Case]=f.walkCaseStatementChildren;this.childrenWalkers[a.NodeType.Switch]=f.walkSwitchStatementChildren;this.childrenWalkers[a.NodeType.Try]=
f.walkTryChildren;this.childrenWalkers[a.NodeType.TryCatch]=f.walkTryCatchChildren;this.childrenWalkers[a.NodeType.TryFinally]=f.walkTryFinallyChildren;this.childrenWalkers[a.NodeType.Finally]=f.walkFinallyChildren;this.childrenWalkers[a.NodeType.Catch]=f.walkCatchChildren;this.childrenWalkers[a.NodeType.List]=f.walkListChildren;this.childrenWalkers[a.NodeType.Script]=f.walkScriptChildren;this.childrenWalkers[a.NodeType.Class]=f.walkClassDeclChildren;this.childrenWalkers[a.NodeType.Interface]=f.walkTypeDeclChildren;
this.childrenWalkers[a.NodeType.Module]=f.walkModuleDeclChildren;this.childrenWalkers[a.NodeType.Import]=f.walkImportDeclChildren;this.childrenWalkers[a.NodeType.With]=f.walkWithStatementChildren;this.childrenWalkers[a.NodeType.Label]=f.walkLabelChildren;this.childrenWalkers[a.NodeType.LabeledStatement]=f.walkLabeledStatementChildren;this.childrenWalkers[a.NodeType.EBStart]=f.walkNone;this.childrenWalkers[a.NodeType.GotoEB]=f.walkNone;this.childrenWalkers[a.NodeType.EndCode]=f.walkNone;this.childrenWalkers[a.NodeType.Error]=
f.walkNone;this.childrenWalkers[a.NodeType.Comment]=f.walkNone;this.childrenWalkers[a.NodeType.Debugger]=f.walkNone;for(var c in a.NodeType._map)if(void 0===this.childrenWalkers[c])throw Error("initWalkers function is not up to date with enum content!");};a.AstWalkerFactory=b;var j;a.getAstWalkerFactory=function(){j||(j=new b);return j};var f,d=f||(f={}),l=function(a,d,g){a.name=g.walk(a.name,a);g.options.goNextSibling&&a.members&&(a.members=g.walk(a.members,a))};d.walkNone=function(){};d.walkListChildren=
function(a,d,g){d=a.members.length;if(g.options.reverseSiblings)for(var l=d-1;0<=l;l--)g.options.goNextSibling&&(a.members[l]=g.walk(a.members[l],a));else for(l=0;l<d;l++)g.options.goNextSibling&&(a.members[l]=g.walk(a.members[l],a))};d.walkUnaryExpressionChildren=function(a,d,g){a.castTerm&&(a.castTerm=g.walk(a.castTerm,a));a.operand&&(a.operand=g.walk(a.operand,a))};d.walkBinaryExpressionChildren=function(a,d,g){g.options.reverseSiblings?(a.operand2&&(a.operand2=g.walk(a.operand2,a)),a.operand1&&
g.options.goNextSibling&&(a.operand1=g.walk(a.operand1,a))):(a.operand1&&(a.operand1=g.walk(a.operand1,a)),a.operand2&&g.options.goNextSibling&&(a.operand2=g.walk(a.operand2,a)))};d.walkTypeReferenceChildren=function(a,d,g){a.term&&(a.term=g.walk(a.term,a))};d.walkCallExpressionChildren=function(a,d,g){g.options.reverseSiblings||(a.target=g.walk(a.target,a));a.args&&g.options.goNextSibling&&(a.args=g.walk(a.args,a));g.options.reverseSiblings&&g.options.goNextSibling&&(a.target=g.walk(a.target,a))};
d.walkTrinaryExpressionChildren=function(a,d,g){a.operand1&&(a.operand1=g.walk(a.operand1,a));a.operand2&&g.options.goNextSibling&&(a.operand2=g.walk(a.operand2,a));a.operand3&&g.options.goNextSibling&&(a.operand3=g.walk(a.operand3,a))};d.walkFuncDeclChildren=function(a,d,g){a.name&&(a.name=g.walk(a.name,a));a.args&&(0<a.args.members.length&&g.options.goNextSibling)&&(a.args=g.walk(a.args,a));a.returnTypeAnnotation&&g.options.goNextSibling&&(a.returnTypeAnnotation=g.walk(a.returnTypeAnnotation,a));
a.bod&&(0<a.bod.members.length&&g.options.goNextSibling)&&(a.bod=g.walk(a.bod,a))};d.walkBoundDeclChildren=function(a,d,g){a.id&&(a.id=g.walk(a.id,a));a.init&&(a.init=g.walk(a.init,a));a.typeExpr&&g.options.goNextSibling&&(a.typeExpr=g.walk(a.typeExpr,a))};d.walkReturnStatementChildren=function(a,d,g){a.returnExpression&&(a.returnExpression=g.walk(a.returnExpression,a))};d.walkForStatementChildren=function(a,d,g){a.init&&(a.init=g.walk(a.init,a));a.cond&&g.options.goNextSibling&&(a.cond=g.walk(a.cond,
a));a.incr&&g.options.goNextSibling&&(a.incr=g.walk(a.incr,a));a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkForInStatementChildren=function(a,d,g){a.lval=g.walk(a.lval,a);g.options.goNextSibling&&(a.obj=g.walk(a.obj,a));a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkIfStatementChildren=function(a,d,g){a.cond=g.walk(a.cond,a);a.thenBod&&g.options.goNextSibling&&(a.thenBod=g.walk(a.thenBod,a));a.elseBod&&g.options.goNextSibling&&(a.elseBod=g.walk(a.elseBod,a))};
d.walkWhileStatementChildren=function(a,d,g){a.cond=g.walk(a.cond,a);a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkDoWhileStatementChildren=function(a,d,g){a.cond=g.walk(a.cond,a);a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkBlockChildren=function(a,d,g){a.stmts&&(a.stmts=g.walk(a.stmts,a))};d.walkCaseStatementChildren=function(a,d,g){a.expr&&(a.expr=g.walk(a.expr,a));a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkSwitchStatementChildren=
function(a,d,g){a.val&&(a.val=g.walk(a.val,a));a.caseList&&g.options.goNextSibling&&(a.caseList=g.walk(a.caseList,a))};d.walkTryChildren=function(a,d,g){a.body&&(a.body=g.walk(a.body,a))};d.walkTryCatchChildren=function(a,d,g){a.tryNode&&(a.tryNode=g.walk(a.tryNode,a));a.catchNode&&g.options.goNextSibling&&(a.catchNode=g.walk(a.catchNode,a))};d.walkTryFinallyChildren=function(a,d,g){a.tryNode&&(a.tryNode=g.walk(a.tryNode,a));a.finallyNode&&g.options.goNextSibling&&(a.finallyNode=g.walk(a.finallyNode,
a))};d.walkFinallyChildren=function(a,d,g){a.body&&(a.body=g.walk(a.body,a))};d.walkCatchChildren=function(a,d,g){a.param&&(a.param=g.walk(a.param,a));a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkRecordChildren=l;d.walkNamedTypeChildren=function(a,d,g){l(a,d,g)};d.walkClassDeclChildren=function(a,d,g){l(a,d,g);g.options.goNextSibling&&a.baseClass&&(a.baseClass=g.walk(a.baseClass,a));g.options.goNextSibling&&a.implementsList&&(a.implementsList=g.walk(a.implementsList,a))};d.walkScriptChildren=
function(a,d,g){a.bod&&(a.bod=g.walk(a.bod,a))};d.walkTypeDeclChildren=function(a,d,g){l(a,d,g);g.options.goNextSibling&&a.extendsList&&(a.extendsList=g.walk(a.extendsList,a));g.options.goNextSibling&&a.implementsList&&(a.implementsList=g.walk(a.implementsList,a))};d.walkModuleDeclChildren=function(a,d,g){l(a,d,g);g.options.goNextSibling&&a.alias&&(a.alias=g.walk(a.alias,a))};d.walkImportDeclChildren=function(a,d,g){a.id&&(a.id=g.walk(a.id,a));a.alias&&(a.alias=g.walk(a.alias,a))};d.walkWithStatementChildren=
function(a,d,g){a.expr&&(a.expr=g.walk(a.expr,a));a.body&&g.options.goNextSibling&&(a.body=g.walk(a.body,a))};d.walkLabelChildren=function(){};d.walkLabeledStatementChildren=function(a,d,g){a.labels=g.walk(a.labels,a);g.options.goNextSibling&&(a.stmt=g.walk(a.stmt,a))}})(TypeScript||(TypeScript={}));
(function(a){function e(a){return null===a||0===a.length?null:a[a.length-1]}function i(a,d){return a>=d?a:d}function b(a){return null===a||-1===a.minChar||-1===a.limChar?!1:!0}a.lastOf=e;a.max=i;a.min=function(a,d){return a<=d?a:d};var j=function(){this.asts=[];this.top=-1};j.reverseIndexOf=function(a,d){return null===a||a.length<=d?null:a[a.length-d-1]};j.prototype.clone=function(){var a=new j;a.asts=this.asts.map(function(a){return a});a.top=this.top;return a};j.prototype.pop=function(){var a=this.ast();
for(this.up();this.asts.length>this.count();)this.asts.pop();return a};j.prototype.push=function(a){for(;this.asts.length>this.count();)this.asts.pop();this.top=this.asts.length;this.asts.push(a)};j.prototype.up=function(){if(-1>=this.top)throw Error("Invalid call to 'up'");this.top--};j.prototype.down=function(){if(this.top==this.ast.length-1)throw Error("Invalid call to 'down'");this.top++};j.prototype.nodeType=function(){return null==this.ast()?a.NodeType.None:this.ast().nodeType};j.prototype.ast=
function(){return j.reverseIndexOf(this.asts,this.asts.length-(this.top+1))};j.prototype.parent=function(){return j.reverseIndexOf(this.asts,this.asts.length-this.top)};j.prototype.count=function(){return this.top+1};j.prototype.get=function(a){return this.asts[a]};j.prototype.isNameOfClass=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Class&&this.parent().name===this.ast()};j.prototype.isNameOfInterface=function(){return null===
this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Interface&&this.parent().name===this.ast()};j.prototype.isNameOfArgument=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.ArgDecl&&this.parent().id===this.ast()};j.prototype.isNameOfVariable=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===
a.NodeType.VarDecl&&this.parent().id===this.ast()};j.prototype.isNameOfModule=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Module&&this.parent().name===this.ast()};j.prototype.isNameOfFunction=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.FuncDecl&&this.parent().name===this.ast()};j.prototype.isChildOfScript=function(){var c=
e(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Script};j.prototype.isChildOfModule=function(){var c=e(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Module};j.prototype.isChildOfClass=function(){var c=e(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Class};j.prototype.isArgumentOfClassConstructor=function(){var c=e(this.asts);return 5<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-3].nodeType===a.NodeType.List&&this.asts[this.top-4].nodeType===a.NodeType.Class&&this.asts[this.top-2].isConstructor&&this.asts[this.top-2].args===this.asts[this.top-1]&&this.asts[this.top-
4].constructorDecl===this.asts[this.top-2]};j.prototype.isChildOfInterface=function(){var c=e(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Interface};j.prototype.isTopLevelImplicitModule=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.Module&&a.hasFlag(this.asts[this.top].modFlags,a.ModuleFlags.IsWholeFile)};j.prototype.isBodyOfTopLevelImplicitModule=function(){return 2<=
this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]&&a.hasFlag(this.asts[this.top-1].modFlags,a.ModuleFlags.IsWholeFile)};j.prototype.isBodyOfScript=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Script&&this.asts[this.top-1].bod==this.asts[this.top-0]};j.prototype.isBodyOfSwitch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Switch&&
this.asts[this.top-1].caseList==this.asts[this.top-0]};j.prototype.isBodyOfModule=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]};j.prototype.isBodyOfClass=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Class&&this.asts[this.top-1].members==this.asts[this.top-0]};j.prototype.isBodyOfFunction=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&
this.asts[this.top-1].bod==this.asts[this.top-0]};j.prototype.isBodyOfInterface=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Interface&&this.asts[this.top-1].members==this.asts[this.top-0]};j.prototype.isBodyOfBlock=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Block&&this.asts[this.top-1].stmts==this.asts[this.top-0]};j.prototype.isBodyOfFor=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.For&&this.asts[this.top-
1].body==this.asts[this.top-0]};j.prototype.isBodyOfCase=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Case&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfTry=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Try&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfCatch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Catch&&this.asts[this.top-1].body==this.asts[this.top-
0]};j.prototype.isBodyOfDoWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.DoWhile&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.While&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfForIn=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ForIn&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfWith=
function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.With&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isBodyOfFinally=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Finally&&this.asts[this.top-1].body==this.asts[this.top-0]};j.prototype.isCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-
1]};j.prototype.isDefaultCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-1]&&this.asts[this.top-2].defaultCase==this.asts[this.top-0]};j.prototype.isListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-
0]};j.prototype.isBodyOfObjectLit=function(){return this.isListOfObjectLit()};j.prototype.isEmptyListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]&&0==this.asts[this.top-0].members.length};j.prototype.isMemberOfObjectLit=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-0].nodeType===a.NodeType.Member&&this.asts[this.top-2].operand==this.asts[this.top-1]};j.prototype.isNameOfMemberOfObjectLit=function(){return 4<=this.count()&&this.asts[this.top-3].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-2].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-0].nodeType===a.NodeType.Name&&this.asts[this.top-3].operand==this.asts[this.top-2]};j.prototype.isListOfArrayLit=function(){return 2<=
this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ArrayLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]};j.prototype.isTargetOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand1===this.asts[this.top-0]};j.prototype.isMemberOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand2===this.asts[this.top-
0]};j.prototype.isItemOfList=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List};j.prototype.isThenOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].thenBod==this.asts[this.top-0]};j.prototype.isElseOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].elseBod==this.asts[this.top-0]};j.prototype.isBodyOfDefaultCase=function(){return this.isBodyOfCase()};
j.prototype.isSingleStatementList=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.List&&1===this.asts[this.top].members.length};j.prototype.isArgumentListOfFunction=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-1].args===this.asts[this.top-0]};j.prototype.isArgumentOfFunction=function(){return 3<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List&&
this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-2].args===this.asts[this.top-1]};j.prototype.isArgumentListOfCall=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Call&&this.asts[this.top-1].args===this.asts[this.top-0]};j.prototype.isArgumentListOfNew=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.New&&this.asts[this.top-
1].args===this.asts[this.top-0]};j.prototype.isSynthesizedBlock=function(){return 1<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.Block&&!1===this.asts[this.top-0].visible};a.AstPath=j;a.isValidAstNode=b;var f;f=function(){this.path=new a.AstPath};a.AstPathContext=f;var d=a.GetAstPathOptions||(a.GetAstPathOptions={});d._map=[];d.Default=0;d.EdgeInclusive=1;d.DontPruneSearchBasedOnPosition=2;var l=a.GetAstPathOptions;a.getAstPathToPosition=function(c,d,g){"undefined"===typeof g&&(g=l.Default);
var j=function(a){if(a&&0<a.length)for(var c=0;c<a.length;c++){var g=a[c].minChar,l=a[c].limChar;a[c].isBlockComment||l++;d>=g&&d<l&&e.path.push(a[c])}},e=new f;a.getAstWalkerFactory().walk(c,function(f,m,i){if(b(f)){var n=a.hasFlag(g,l.EdgeInclusive)||f.nodeType===a.NodeType.Name||d===c.limChar,m=f.minChar,n=f.limChar+(n?1:0);if(d>=m&&d<n){var p=e.path.ast();(null==p||f.minChar>=p.minChar&&f.limChar<=p.limChar)&&e.path.push(f)}d<n&&j(f.preComments);d>=m&&j(f.postComments);a.hasFlag(g,l.DontPruneSearchBasedOnPosition)||
(i.options.goChildren=m<=d&&d<=n)}return f},null,null,e);return e.path};a.getTokenizationOffset=function(c,d){var g=0;a.getAstWalkerFactory().walk(c,function(c,l,b){if(a.isValidAstNode(c)&&(c.minChar<=d&&(g=i(g,c.minChar)),c.minChar>d||c.limChar<g))b.options.goChildren=!1;return c});return g};a.walkAST=function(c,d){var g=new j;a.getAstWalkerFactory().walk(c,function(a,c,g){c=g.state;c.push(a);d(c,g);return a},function(a,c,d){d.state.pop();return a},null,g)}})(TypeScript||(TypeScript={}));
(function(a){var e=function(a){this.logger=a};e.prototype.logScript=function(e){var b=this;this.logLinemap(e.locationInfo.lineMap);var j=[];a.getAstWalkerFactory().walk(e,function(a){j.push(a);var d=2*(j.length-1);b.logComments(e,a.preComments,d);b.logNode(e,a,d);b.logComments(e,a.postComments,d);return a},function(a){j.pop();return a})};e.prototype.logNode=function(a,b,j){j=this.addPadding("",j,"| ",!0);j=j.concat("+ "+b.treeViewLabel());j=this.addPadding(j,70," ",!1);j+=this.addLineColumn(a,b.minChar);
j=this.addPadding(j,80," ",!1);j=j+"=> "+this.addLineColumn(a,b.limChar);j=this.addPadding(j,102," ",!1);j=j.concat("["+this.addPadding(b.minChar.toString(),1," ",!0)+", "+this.addPadding(b.limChar.toString(),1," ",!0)+"]");j=this.addPadding(j,115," ",!1);j=j.concat("sym="+b.sym);j=this.addPadding(j,135," ",!1);j=j.concat("type="+(null===b.type?"null":b.type.getTypeName()));this.logger.log(j)};e.prototype.logComments=function(a,b,j){if(null!=b)for(var f=0;f<b.length;f++)this.logNode(a,b[f],j)};e.prototype.logLinemap=
function(a){for(var b="[",j=0;j<a.length;j++)0<j&&(b+=","),b+=a[j];this.logger.log("linemap: "+(b+"]"))};e.prototype.addPadding=function(a,b,j,f){for(var d=f?"":a,l=a.length;l<b;l++)d+=j;return d+(f?a:"")};e.prototype.addLineColumn=function(e,b){var j={line:-1,col:-1};a.getSourceLineColFromMap(j,b,e.locationInfo.lineMap);-1!==j.col&&j.col++;return"("+j.line+", "+j.col+")"};a.AstLogger=e})(TypeScript||(TypeScript={}));
(function(a){var e=function(a){this.checker=a};e.prototype.resolveBaseTypeLinks=function(a,b){var j=null;if(a)for(var j=[],f=0,d=a.length;f<d;f++){var l=a[f];this.checker.resolvingBases=!0;this.checker.resolveTypeLink(b,l,!0);this.checker.resolvingBases=!1;j[f]=l.type.isClass()?l.type.instanceType:l.type}return j};e.prototype.resolveBases=function(a,b){b.extendsList=this.resolveBaseTypeLinks(b.extendsTypeLinks,a);for(var j=0,f=b.extendsList.length,d=b.isClassInstance();j<f;j++){var l=b.extendsList[j].isClassInstance();
b.extendsList[j]!=this.checker.anyType&&(d?l||this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A export class may only extend other classes, "+b.extendsList[j].symbol.fullName()+" is an interface."):l&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"An interface may only extend other interfaces, "+b.extendsList[j].symbol.fullName()+" is a class."))}b.implementsList=this.resolveBaseTypeLinks(b.implementsTypeLinks,a);if(b.implementsList){j=0;for(f=b.implementsList.length;j<f;j++)l=b.implementsList[j],
l.isClassInstance()&&d&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A class may only implement an interface; "+l.symbol.fullName()+" is a class.")}};e.prototype.resolveSignatureGroup=function(a,b,j){for(var f=!a.hasImplementation,d=0,l=a.signatures.length;d<l;d++){var c=a.signatures[d];j?c.returnType.type=j:this.checker.resolveTypeLink(b,c.returnType,f);for(var h=c.parameters.length,g=0;g<h;g++)this.bindSymbol(b,c.parameters[g]);c.hasVariableArgList&&(c=c.parameters[h-1],c.argsOffset=
h-1,c.getType().isArray()||(this.checker.errorReporter.simpleErrorFromSym(c,"... parameter must have array type"),c.parameter.typeLink.type=this.checker.makeArrayType(c.parameter.typeLink.type)))}};e.prototype.bindType=function(e,b,j){j&&this.bindType(e,j,null);if(b.hasMembers()){var f=b.members,d=b.ambientMembers,l=b.getAllEnclosedTypes(),c=b.getAllAmbientEnclosedTypes(),h=new a.SymbolTableScope(f,d,l,c,b.symbol),g=new a.SymbolAggregateScope(b.symbol),k=this.checker.currentModDecl,v=this.checker.inBind;
g.addParentScope(h);g.addParentScope(e);b.isModuleType()&&(this.checker.currentModDecl=b.symbol.declAST,this.checker.inBind=!0);f&&this.bind(g,b.members.allMembers);l&&this.bind(g,l.allMembers);d&&this.bind(g,d.allMembers);c&&this.bind(g,c.allMembers);this.checker.currentModDecl=k;this.checker.inBind=v}b.extendsTypeLinks&&this.resolveBases(e,b);b.construct&&this.resolveSignatureGroup(b.construct,e,j);b.call&&this.resolveSignatureGroup(b.call,e,null);b.index&&this.resolveSignatureGroup(b.index,e,null);
b.elementType&&this.bindType(e,b.elementType,null)};e.prototype.bindSymbol=function(e,b){if(!b.bound){var j=this.checker.locationInfo;this.checker.units&&(0<=b.unitIndex&&b.unitIndex<this.checker.units.length)&&(this.checker.locationInfo=this.checker.units[b.unitIndex]);switch(b.kind()){case a.SymbolKind.Type:if(b.flags&a.SymbolFlags.Bound)break;b.flags|=a.SymbolFlags.Bound;if(b.aliasLink&&!b.type&&b.aliasLink.alias.nodeType==a.NodeType.Name){var f=this.checker.findSymbolForDynamicModule(b.aliasLink.alias.text,
this.checker.locationInfo.filename,function(a){return e.find(a,!1,!0)});f&&(b.type=f.getType())}if(b.type&&b.type!=this.checker.gloModType&&(this.bindType(e,b.type,b.instanceType),b.type.isModuleType()))for(f=0;f<b.expansions.length;f++)this.bindType(e,b.expansions[f],b.instanceType);break;case a.SymbolKind.Field:this.checker.resolveTypeLink(e,b.field.typeLink,!1);break;case a.SymbolKind.Parameter:this.checker.resolveTypeLink(e,b.parameter.typeLink,!0)}this.checker.locationInfo=j}b.bound=!0};e.prototype.bind=
function(a,b){b.map(function(b,f,d){d.bindSymbol(a,f)},this)};a.Binder=e})(TypeScript||(TypeScript={}));
(function(a){var e=function(){};e.encodedValues="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";e.encode=function(a){if(64>a)return e.encodedValues.charAt(a);throw TypeError(a+": not a 64 based value");};e.decodeChar=function(a){if(1===a.length)return e.encodedValues.indexOf(a);throw TypeError('"'+a+'" must have length 1');};var i=function(){};i.encode=function(a){var a=0>a?(-a<<1)+1:a<<1,j="";do{var f=a&31,a=a>>5;0<a&&(f|=32);j+=e.encode(f)}while(0<a);return j};i.decode=function(a){for(var j=
0,f=!1,d=0,l=0;l<a.length;l++){var c=e.decodeChar(a[l]);0===l?(1===(c&1)&&(f=!0),j=c>>1&15):j|=(c&31)<<d;d+=0==l?4:5;if(32!==(c&32))return{value:f?-j:j,rest:a.substr(l+1)}}throw Error('Base64 value "'+a+'" finished with a continuation bit');};a.Base64VLQFormat=i})(TypeScript||(TypeScript={}));
(function(a){a.SourceMapping=function(){this.firstChild=this.parent=-1};var e=function(e,b,j,f){this.jsFile=j;this.sourceMapOut=f;this.sourceMappings=[];this.currentMapping=-1;this.jsFileName=a.getPrettyName(b,!1,!0);this.tsFileName=a.getPrettyName(e,!1,!0)};e.MapFileExtension=".map";e.CanEmitMapping=function(a,b){if(-1!==b.firstChild){var j=a[b.firstChild];if(j.emittedStartLine===b.emittedStartLine&&j.emittedStartColumn===b.emittedStartColumn)return!1}return!0};e.EmitSourceMapping=function(i){var b=
i[0];b.jsFile.WriteLine("//@ sourceMappingURL="+b.jsFileName+e.MapFileExtension);for(var j=b.sourceMapOut,f="",d=[],l=0,c=0,h=0,g=0,k=0,v=!1,q=0;q<i.length;q++)if(b=i[q],b.sourceMappings){var m=d.length;d.push(b.tsFileName);for(var s=b.sourceMappings,n=0,p=s.length;n<p;n++){var r=s[n];if(e.CanEmitMapping(s,r)){if(c!==r.emittedStartLine)for(;c<r.emittedStartLine;)l=0,f+=";",c++;else v&&(f+=",");f+=a.Base64VLQFormat.encode(r.emittedStartColumn-l);l=r.emittedStartColumn;f+=a.Base64VLQFormat.encode(m-
k);k=m;f+=a.Base64VLQFormat.encode(r.sourceStartLine-1-g);g=r.sourceStartLine-1;f+=a.Base64VLQFormat.encode(r.sourceStartColumn-h);h=r.sourceStartColumn;v=!0}}}""!=f&&(j.Write("{"),j.Write('"version":3,'),j.Write('"file":"'+b.jsFileName+'",'),j.Write('"sources":["'+d.join('","')+'"],'),j.Write('"names":[],'),j.Write('"mappings":"'+f),j.Write('"'),j.Write("}"));j.Close()};a.SourceMapper=e})(TypeScript||(TypeScript={}));
(function(a){var e=a.EmitContainer||(a.EmitContainer={});e._map=[];e._map[0]="Prog";e.Prog=0;e._map[1]="Module";e.Module=1;e._map[2]="DynamicModule";e.DynamicModule=2;e._map[3]="Class";e.Class=3;e._map[4]="Constructor";e.Constructor=4;e._map[5]="Function";e.Function=5;e._map[6]="Args";e.Args=6;e._map[7]="Interface";e.Interface=7;var i=a.EmitContainer,b;b=function(){this.line=this.column=this.indentAmt=0;this.inObjectLiteral=this.pretty=!1;this.container=i.Prog};a.EmitState=b;e=function(a,f,d){this.checker=
a;this.outfile=f;this.emitOptions=d;this.prologueEmitted=!1;this.indentStep=4;this.thisFnc=this.thisClassNode=null;this.moduleDeclList=[];this.moduleName="";this.emitState=new b;this.indentStrings=[];this.ambientModule=!1;this.firstModAlias=this.modAliasId=null;this.allSourceMappers=[];this.sourceMapper=null;this.declDottedModuleName=!1;this.declIndentDelta=0;this.declContainingAST=this.declFile=null};e.prototype.canWriteDeclFile=function(){return null!=this.declFile};e.prototype.setSourceMappings=
function(a){this.allSourceMappers.push(a);this.sourceMapper=a};e.prototype.setDeclarationFile=function(a){this.declFile=a};e.prototype.increaseIndent=function(){this.emitState.indentAmt+=this.indentStep;this.declDottedModuleName&&this.addDeclIndentDelta()};e.prototype.decreaseIndent=function(){this.emitState.indentAmt-=this.indentStep};e.prototype.addDeclIndentDelta=function(){this.declIndentDelta+=this.indentStep};e.prototype.reduceDeclIndentDelta=function(){this.declIndentDelta-=this.indentStep};
e.prototype.writeToOutput=function(a){this.outfile.Write(a);this.emitState.column+=a.length};e.prototype.writeToOutputTrimmable=function(a){this.emitOptions.minWhitespace&&(a=a.replace(/[\s]*/g,""));this.writeToOutput(a)};e.prototype.writeLineToOutput=function(b){this.emitOptions.minWhitespace?(this.writeToOutput(b),b=b.charCodeAt(b.length-1),b==a.LexCodeSpace||(b==a.LexCodeSMC||b==a.LexCodeLBR)||this.writeToOutput(" ")):(this.outfile.WriteLine(b),this.emitState.column=0,this.emitState.line++)};e.prototype.setInObjectLiteral=
function(a){var b=this.emitState.inObjectLiteral;this.emitState.inObjectLiteral=a;return b};e.prototype.setContainer=function(a){var b=this.emitState.container;this.emitState.container=a;return b};e.prototype.setDeclContainingAST=function(a){var b=this.declContainingAST;this.declContainingAST=a;return b};e.prototype.getIndentString=function(a){"undefined"===typeof a&&(a=!1);if(this.emitOptions.minWhitespace)return"";var a=this.emitState.indentAmt-(a?this.declIndentDelta:0),b=this.indentStrings[a];
if(void 0===b){for(var b="",d=0;d<a;d++)b+=" ";this.indentStrings[a]=b}return b};e.prototype.emitIndent=function(){this.writeToOutput(this.getIndentString())};e.prototype.emitIndentToDeclFile=function(){this.declFile.Write(this.getIndentString(!0))};e.prototype.emitCommentInPlace=function(a){this.recordSourceMappingStart(a);var b=a.getText(),d=!1;if(a.isBlockComment){if(0==this.emitState.column&&this.emitIndent(),this.writeToOutput(b[0]),1<b.length||a.endsLine){this.writeLineToOutput("");for(d=1;d<
b.length;d++)this.emitIndent(),this.writeLineToOutput(b[d]);d=!0}}else 0==this.emitState.column&&this.emitIndent(),this.writeLineToOutput(b[0]),d=!0;d?this.emitIndent():this.writeToOutput(" ");this.recordSourceMappingEnd(a)};e.prototype.emitParensAndCommentsInPlace=function(a,b){var d=b?a.preComments:a.postComments;a.isParenthesized&&!b&&this.writeToOutput(")");if(this.emitOptions.emitComments&&d&&0!=d.length)for(var l=0;l<d.length;l++)this.emitCommentInPlace(d[l]);a.isParenthesized&&b&&this.writeToOutput("(")};
e.prototype.emitObjectLiteral=function(b){this.writeLineToOutput("{");this.increaseIndent();var f=this.setInObjectLiteral(!0);this.emitJavascriptList(b,",",a.TokenID.Comma,!0,!1,!1);this.setInObjectLiteral(f);this.decreaseIndent();this.emitIndent();this.writeToOutput("}")};e.prototype.emitArrayLiteral=function(b){this.writeToOutput("[");b&&(this.writeLineToOutput(""),this.increaseIndent(),this.emitJavascriptList(b,", ",a.TokenID.Comma,!0,!1,!1),this.decreaseIndent(),this.emitIndent());this.writeToOutput("]")};
e.prototype.emitNew=function(b,f){this.recordSourceMappingStart(b);this.writeToOutput("new ");b.nodeType==a.NodeType.TypeRef?this.writeToOutput("Array()"):(this.emitJavascript(b,a.TokenID.Tilde,!1),this.writeToOutput("("),this.emitJavascriptList(f,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")"));this.recordSourceMappingEnd(b)};e.prototype.tryEmitConstant=function(b){if(!this.emitOptions.propagateConstants)return!1;if((b=b.operand2)&&b.sym&&b.sym.isVariable()&&a.hasFlag(b.sym.flags,a.SymbolFlags.Constant)&&
b.sym.declAST){var f=b.sym.declAST;if(f.init&&f.init.nodeType==a.NodeType.NumberLit)return this.writeToOutput(f.init.value.toString()),b=" /* "+b.text,this.writeToOutput(b+" */ "),!0}return!1};e.prototype.emitCall=function(b,f,d){this.emitSuperCall(b)||(a.hasFlag(b.flags,a.ASTFlags.ClassBaseConstructorCall)?(this.decreaseIndent(),this.decreaseIndent(),f=new a.ASTList,f.members[0]=b,this.emitConstructorCalls(f,this.thisClassNode),this.increaseIndent(),this.increaseIndent()):(f.nodeType==a.NodeType.FuncDecl&&
!f.isParenthesized&&this.writeToOutput("("),this.emitJavascript(f,a.TokenID.LParen,!1),f.nodeType==a.NodeType.FuncDecl&&!f.isParenthesized&&this.writeToOutput(")"),this.writeToOutput("("),this.emitJavascriptList(d,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")")))};e.prototype.defaultValue=function(a){return a==this.checker.anyType?"undefined":a==this.checker.numberType?"0":a==this.checker.stringType?'""':a==this.checker.booleanType?"false":"null"};e.prototype.emitConstructorCalls=function(b,
f){if(null!=b){var d=b.members.length;this.recordSourceMappingStart(f);for(var l=0;l<d;l++){var c=b.members[l],h=null,h=c.nodeType==a.NodeType.Call?c.target.type.symbol:c.type.symbol;h.declModule!=f.type.symbol.declModule&&h.fullName();if(c.nodeType==a.NodeType.Call){this.emitIndent();this.writeToOutput("_super.call(this");if((c=c.args)&&0<c.members.length)this.writeToOutput(", "),this.emitJavascriptList(c,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput(")")}else c.type&&c.type.isClassInstance()&&
(this.emitIndent(),this.writeToOutput(f.name.text+"._super.constructor"),this.writeToOutput(".call(this)"))}this.recordSourceMappingEnd(f)}};e.prototype.emitInnerFunction=function(b,f,d,l,c,h,g,k){"undefined"===typeof g&&(g=!1);"undefined"===typeof k&&(k=this.emitState.container);var e=b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&(a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseType)&&!a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseTypeOfObject))&&
a.hasFlag(this.thisClassNode.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor);this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);(!b.isAccessor()||!b.accessorSymbol.isObjectLitField)&&this.writeToOutput("function ");f&&(f=b.getNameText())&&!b.isAccessor()&&this.writeToOutput(f);this.writeToOutput("(");g&&(g=this.emitFuncSignatureIdentifier(b,!1,k));var q=0,k=0,m,s=[];if(b.args){f=this.setContainer(i.Args);q=b.args.members.length;b.variableArgList&&q--;for(k=0;k<q;k++)m=
b.args.members[k],m.init&&s.push(m),this.emitJavascript(m,a.TokenID.LParen,!1,g),k<q-1&&(this.writeToOutput(", "),g&&this.declFile.Write(", "));this.setContainer(f)}this.writeLineToOutput(") {");f=null;g&&(this.emitFuncSignatureVariableArg(b),b.hasStaticDeclarations()&&(f=this.setDeclContainingAST(b)));this.increaseIndent();for(k=0;k<s.length;k++)m=s[k],this.emitIndent(),this.recordSourceMappingStart(m),this.writeToOutput("if (typeof "+m.id.text+' === "undefined") { '),this.recordSourceMappingStart(m.id),
this.writeToOutput(m.id.text),this.recordSourceMappingEnd(m.id),this.writeToOutput(" = "),this.emitJavascript(m.init,a.TokenID.LParen,!1),this.writeLineToOutput("; }"),this.recordSourceMappingEnd(m);if(b.isConstructor&&!e){if(b.args){q=b.args.members.length;for(k=0;k<q;k++)m=b.args.members[k],(m.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(m),this.recordSourceMappingStart(m.id),this.writeToOutput("this."+m.id.text),this.recordSourceMappingEnd(m.id),
this.writeToOutput(" = "),this.recordSourceMappingStart(m.id),this.writeToOutput(m.id.text),this.recordSourceMappingEnd(m.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(m))}a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)||this.emitConstructorCalls(l,h)}c&&(this.emitIndent(),this.writeLineToOutput("var _this = this;"));b.variableArgList&&(q=b.args.members.length,k=b.args.members[q-1],this.emitIndent(),this.recordSourceMappingStart(k),this.writeToOutput("var "),this.recordSourceMappingStart(k.id),
this.writeToOutput(k.id.text),this.recordSourceMappingEnd(k.id),this.writeLineToOutput(" = [];"),this.recordSourceMappingEnd(k),this.emitIndent(),this.writeLineToOutput("for (var _i = 0; _i < (arguments.length - "+(q-1)+"); _i++) {"),this.increaseIndent(),this.emitIndent(),this.writeLineToOutput(k.id.text+"[_i] = arguments[_i + "+(q-1)+"];"),this.decreaseIndent(),this.emitIndent(),this.writeLineToOutput("}"));if(b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&!e){l=this.thisClassNode.members.members.length;
for(k=0;k<l;k++)this.thisClassNode.members.members[k].nodeType==a.NodeType.VarDecl&&(c=this.thisClassNode.members.members[k],!a.hasFlag(c.varFlags,a.VarFlags.Static)&&c.init&&(this.emitIndent(),this.emitJavascriptVarDecl(c,a.TokenID.Tilde),this.writeLineToOutput("")))}this.emitBareJavascriptStatements(b.bod,e);this.decreaseIndent();this.emitIndent();this.writeToOutput("}");!d&&(!a.hasFlag(b.fncFlags,a.FncFlags.IsFunctionExpression)&&(a.hasFlag(b.fncFlags,a.FncFlags.Definition)||b.isConstructor))&&
this.writeLineToOutput("");if(b.hasStaticDeclarations()){this.writeLineToOutput("");this.emitIndent();e=b.getNameText();this.writeLineToOutput("(function ("+e+") {");this.increaseIndent();l=0;l=b.innerStaticFuncs.length;for(k=0;k<l;k++)c=b.innerStaticFuncs[k],c.isOverload?g&&this.emitFuncSignature(c):(this.emitIndent(),c.isAccessor()?this.emitPropertyAccessor(c,b.name.text,!1,g):(this.writeToOutput(e+"."+c.name.text+" = "),this.emitInnerFunction(c,c.name&&!c.name.isMissing(),!1,null,c.hasSelfReference(),
null,g)));if(b.statics){this.recordSourceMappingStart(b.statics);l=b.statics.members.length;for(k=0;k<l;k++)this.emitIndent(),this.writeToOutput(e),this.emitJavascript(b.statics.members[k],a.TokenID.Tilde,!1,g),this.writeLineToOutput("");this.recordSourceMappingEnd(b.statics)}this.decreaseIndent();this.emitIndent();this.writeLineToOutput("})("+(d&&this.thisClassNode?this.thisClassNode.name.text+".prototype.":"")+e+");");g&&(this.setDeclContainingAST(f),this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))}this.recordSourceMappingEnd(b);
this.emitParensAndCommentsInPlace(b,!1)};e.prototype.emitArgDecl=function(a){this.declFile.Write(a.id.text);a.isOptionalArg()&&this.declFile.Write("?");(a.typeExpr||a.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.type)&&this.declFile.Write(": "+this.getTypeSignature(a.type))};e.prototype.emitFuncSignatureIdentifier=function(b,f,d){"undefined"===typeof f&&(f=!1);"undefined"===typeof d&&(d=this.emitState.container);if(!f&&!b.isOverload)if(b.isConstructor){if(1<b.type.construct.signatures.length)return!1}else if(1<
b.type.call.signatures.length)return!1;if(!this.canEmitSignature(a.ToDeclFlags(b.fncFlags),d))return!1;b.isConstructor?(this.emitIndentToDeclFile(),this.declFile.Write("constructor ")):(d=b.getNameText(),f?(this.emitIndentToDeclFile(),b.isConstructMember()?this.declFile.Write("new"):!b.isCallMember()&&!b.isIndexerMember()&&(this.declFile.Write(d),a.hasFlag(b.name.flags,a.ASTFlags.OptionalName)&&this.declFile.Write("? "))):(this.emitDeclFlags(a.ToDeclFlags(b.fncFlags),"function"),this.declFile.Write(d)));
b.isIndexerMember()?this.declFile.Write("["):this.declFile.Write("(");return!0};e.prototype.emitFuncSignatureVariableArg=function(a){if(a.variableArgList){var b=a.args.members[a.args.members.length-1];1<a.args.members.length?this.declFile.Write(", ..."):this.declFile.Write("...");this.emitArgDecl(b)}a.isIndexerMember()?this.declFile.Write("]"):this.declFile.Write(")");!a.isConstructor&&((a.returnTypeAnnotation||a.signature.returnType.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.signature.returnType.type))&&
this.declFile.Write(": "+this.getTypeSignature(a.signature.returnType.type));a.hasStaticDeclarations()?this.declFile.WriteLine(" {"):this.declFile.WriteLine(";")};e.prototype.emitFuncSignature=function(a,b){"undefined"===typeof b&&(b=!1);if(this.emitFuncSignatureIdentifier(a,b)){if(a.args){var d=a.args.members.length;a.variableArgList&&d--;for(var l=0;l<d;l++)this.emitArgDecl(a.args.members[l]),l<d-1&&this.declFile.Write(", ")}this.emitFuncSignatureVariableArg(a)}};e.prototype.emitPropertyAccessorSignature=
function(b){var f=b.accessorSymbol;this.emitDeclFlags(a.ToDeclFlags(f.flags),"var");this.declFile.WriteLine(b.name.text+" : "+this.getTypeSignature(f.getType())+";")};e.prototype.emitDeclFlags=function(b,f){this.emitIndentToDeclFile();var d="";a.hasFlag(b,a.DeclFlags.GetAccessor)?d="get ":a.hasFlag(b,a.DeclFlags.SetAccessor)&&(d="set ");a.hasFlag(b,a.DeclFlags.Exported)&&this.declFile.Write("export ");a.hasFlag(b,a.DeclFlags.LocalStatic)||a.hasFlag(b,a.DeclFlags.Static)?this.declFile.Write("static "+
d):a.hasFlag(b,a.DeclFlags.Private)?this.declFile.Write("private "+d):a.hasFlag(b,a.DeclFlags.Public)?this.declFile.Write("public "+d):""==d?this.declFile.Write(f+" "):this.declFile.Write(d)};e.prototype.canEmitTypeAnnotationSignature=function(b,f){"undefined"===typeof f&&(f=a.DeclFlags.None);if(null==b)return!1;if(b.primitiveTypeClass==a.Primitive.None&&b.symbol&&void 0!=b.symbol.container&&b.symbol.container!=this.checker.gloMod){if(a.hasFlag(f,a.DeclFlags.Private))return!1;if(a.hasFlag(b.symbol.container.flags,
a.SymbolFlags.Exported))return!0;if(b.symbol.declAST)switch(b.symbol.declAST.nodeType){case a.NodeType.Module:if(!a.hasFlag(b.symbol.declAST.modFlags,a.ModuleFlags.Exported))return!1;break;case a.NodeType.Class:if(!a.hasFlag(b.symbol.declAST.varFlags,a.VarFlags.Exported))return!1;break;case a.NodeType.Interface:if(!a.hasFlag(b.symbol.declAST.varFlags,a.VarFlags.Exported))return!1;break;case a.NodeType.FuncDecl:if(!a.hasFlag(b.symbol.declAST.fncFlags,a.FncFlags.Exported))return!1;break;default:throw Error("Catch this unhandled type container");
}}return!0};e.prototype.getTypeSignature=function(b){var f=null;if(this.declContainingAST)switch(this.declContainingAST.nodeType){case a.NodeType.Module:case a.NodeType.Interface:case a.NodeType.FuncDecl:this.declContainingAST.type&&(f=this.declContainingAST.type.containedScope);break;case a.NodeType.Script:var d=this.declContainingAST;d.bod&&(f=d.bod.enclosingScope);break;case a.NodeType.Class:this.declContainingAST.type&&(f=this.declContainingAST.type.instanceType.containedScope);break;default:throw Error("Unknown containing scope");
}return b.getScopedTypeName(f)};e.prototype.canEmitSignature=function(b,f){"undefined"===typeof f&&(f=this.emitState.container);return f==i.Module&&!a.hasFlag(b,a.DeclFlags.Exported)?!1:!0};e.prototype.emitVarSignature=function(b,f){"undefined"===typeof f&&(f=!1);if(this.canEmitSignature(a.ToDeclFlags(b.varFlags))){f?(this.emitIndentToDeclFile(),this.declFile.Write(b.id.text),a.hasFlag(b.id.flags,a.ASTFlags.OptionalName)&&this.declFile.Write("?")):(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"var"),
this.declFile.Write(b.id.text));var d=null;b.typeExpr&&b.typeExpr.type?d=b.typeExpr.type:b.sym&&(d=b.sym.getType(),d==this.checker.anyType&&(d=null));this.canEmitTypeAnnotationSignature(d,a.ToDeclFlags(b.varFlags))?(d=this.getTypeSignature(d),this.declFile.WriteLine(": "+d+";")):this.declFile.WriteLine(";")}};e.prototype.emitBaseList=function(a,b){if(a&&0<a.members.length){this.declFile.Write(" "+b+" ");for(var d=a.members.length,l=0;l<d;l++){var c=this.getTypeSignature(a.members[l].type);0<l&&this.declFile.Write(", ");
this.declFile.Write(c)}}};e.prototype.emitClassSignatureIdentifierAndHeritage=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.varFlags)))return!1;var f=b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"class");this.declFile.Write(f);this.emitBaseList(b.baseClass,"extends");this.emitBaseList(b.implementsList,"implements");this.declFile.WriteLine(" {");return!0};e.prototype.emitClassSignatureClassBodyOfAmbientClass=function(b){for(var f=b.definitionMembers.members.length,d=0;d<f;d++){var l=
b.definitionMembers.members[d];if(l.nodeType==a.NodeType.FuncDecl)l.isAccessor()||this.emitFuncSignature(l);else if(l.nodeType==a.NodeType.VarDecl)this.emitVarSignature(l);else throw Error("We want to catch this");}};e.prototype.emitMembersFromConstructorDefinition=function(b){if(b.args){var f=b.args.members.length;b.variableArgList&&f--;for(var d=0;d<f;d++){var l=b.args.members[d];a.hasFlag(l.varFlags,a.VarFlags.Property)&&(this.emitDeclFlags(a.ToDeclFlags(l.varFlags),"var"),this.declFile.Write(l.id.text),
l.typeExpr&&this.declFile.Write(": "+this.getTypeSignature(l.type)),this.declFile.WriteLine(";"))}}};e.prototype.emitClassSignature=function(a){if(this.emitClassSignatureIdentifierAndHeritage(a)){var b=this.setDeclContainingAST(a);this.increaseIndent();this.emitClassSignatureClassBodyOfAmbientClass(a);this.decreaseIndent();this.setDeclContainingAST(b);this.emitIndentToDeclFile();this.declFile.WriteLine("}")}};e.prototype.emitImportDecl=function(b){this.canEmitSignature(a.ToDeclFlags(b.varFlags))&&
(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"import"),this.declFile.Write(b.id.text+" = "),b.isDynamicImport?this.declFile.WriteLine("module ("+b.getAliasName()+");"):this.declFile.WriteLine(b.getAliasName()+";"))};e.prototype.emitModuleIdentification=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.modFlags)))return!1;this.declDottedModuleName?this.declFile.Write("."):this.emitDeclFlags(a.ToDeclFlags(b.modFlags),"module");this.declFile.Write(b.name.text);1==b.members.members.length&&b.members.members[0].nodeType==
a.NodeType.Module&&!b.members.members[0].isEnum()&&a.hasFlag(b.members.members[0].modFlags,a.ModuleFlags.Exported)?this.declDottedModuleName=!0:(this.declDottedModuleName=!1,this.declFile.WriteLine(" {"));return!0};e.prototype.emitModuleBodyOfAmbientModule=function(b){for(var f=b.members.members.length,d=0;d<f;d++){var l=b.members.members[d];switch(l.nodeType){case a.NodeType.VarDecl:this.emitVarSignature(l);break;case a.NodeType.FuncDecl:this.emitFuncSignature(l);break;case a.NodeType.Class:this.emitClassSignature(l);
break;case a.NodeType.Interface:this.emitInterfaceDeclaration(l);break;case a.NodeType.Module:this.emitModuleSignature(l);break;case a.NodeType.Import:this.emitImportDecl(l);break;case a.NodeType.Empty:break;default:throw Error("We want to catch this");}}};e.prototype.emitModuleSignature=function(a){if(a.isEnum())this.emitEnumSignature(a);else{var b=this.declIndentDelta,d=this.declDottedModuleName;if(this.emitModuleIdentification(a)){var l=this.setDeclContainingAST(a);this.increaseIndent();var c=
this.setContainer(i.Module);this.emitModuleBodyOfAmbientModule(a);this.setContainer(c);this.decreaseIndent();this.setDeclContainingAST(l);d||(this.declIndentDelta=b,this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))}}};e.prototype.emitEnumBodyOfAmbientEnum=function(b){for(var f=b.members.members.length,d=1;d<f;d++){var l=b.members.members[d];if(l.nodeType==a.NodeType.VarDecl)this.emitIndentToDeclFile(),this.declFile.WriteLine(l.id.text+",");else if(l.nodeType!=a.NodeType.Asg)throw Error("We want to catch this");
}};e.prototype.emitEnumSignature=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.modFlags)))return!1;this.emitDeclFlags(a.ToDeclFlags(b.modFlags),"enum");this.declFile.WriteLine(b.name.text+" {");this.increaseIndent();this.emitEnumBodyOfAmbientEnum(b);this.decreaseIndent();this.emitIndentToDeclFile();this.declFile.WriteLine("}");return!0};e.prototype.emitInterfaceBody=function(b){for(var f=0;f<b.members.length;f++){var d=b.members[f];switch(d.nodeType){case a.NodeType.FuncDecl:this.emitFuncSignature(d,
!0);break;case a.NodeType.VarDecl:this.emitVarSignature(d,!0);break;default:throw Error("Not allowed");}}};e.prototype.emitInterfaceDeclaration=function(b){if(this.canEmitSignature(a.ToDeclFlags(b.varFlags))){var f=this.setContainer(i.Interface),d=b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"interface");this.declFile.Write(d);this.emitBaseList(b.extendsList,"extends");this.declFile.WriteLine(" {");this.increaseIndent();d=this.setDeclContainingAST(b);this.emitInterfaceBody(b.members);
this.setDeclContainingAST(d);this.decreaseIndent();this.emitIndentToDeclFile();this.declFile.WriteLine("}");this.setContainer(f)}};e.prototype.emitJavascriptModule=function(b,f){var d=b.name.text;a.isTSFile(d)?b.name.text=d.substring(0,d.length-3):a.isSTRFile(d)&&(b.name.text=d.substring(0,d.length-4));if(a.hasFlag(b.modFlags,a.ModuleFlags.Ambient))f&&this.emitModuleSignature(b);else{var l=a.hasFlag(b.modFlags,a.ModuleFlags.IsDynamic),c=this.declIndentDelta,h=this.declDottedModuleName,g=null,k=this.outfile;
f&&(l||(f=b.isEnum()?this.emitEnumSignature(b):this.emitModuleIdentification(b)),f&&(g=this.setDeclContainingAST(b)));var d=this.setContainer(i.Module),e=this.moduleName,q=a.hasFlag(b.modFlags,a.ModuleFlags.Exported);this.moduleDeclList[this.moduleDeclList.length]=b;this.moduleName=b.name.text;this.recordSourceMappingStart(b);if(l){var m=a.stripQuotes(a.trimModName(b.name.text))+".js";this.emitOptions.createFile&&(m!=this.emitOptions.path?this.outfile=this.emitOptions.createFile(m):this.emitOptions.outputMany||
this.checker.errorReporter.emitterError(b,"Module emit collides with emitted script: "+m));this.setContainer(i.DynamicModule);if(a.moduleGenTarget==a.ModuleGenTarget.Asynchronous){for(var m='["require", "exports"',s="require, exports",n=null,p=0;p<b.mod.importedModules.length;p++)n=b.mod.importedModules[p],n.id.sym&&!n.id.sym.onlyReferencedAsTypeRef&&(p<=b.mod.importedModules.length-1&&(m+=", ",s+=", "),s+="__"+n.id.text+"__",m+=n.firstAliasedModToString());for(p=0;p<b.amdDependencies.length;p++)m+=
', "'+b.amdDependencies[p]+'"';this.writeLineToOutput("define("+(m+"]")+", function("+s+") {")}}else q||(this.writeLineToOutput("var "+this.moduleName+";"),this.emitIndent()),this.writeLineToOutput("(function ("+this.moduleName+") {");if(!l||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)this.increaseIndent(),l&&this.addDeclIndentDelta();this.emitJavascriptList(b.members,null,a.TokenID.SColon,!0,!1,!1,f&&!b.isEnum());if(!l||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)this.decreaseIndent(),
l&&this.reduceDeclIndentDelta();this.emitIndent();l?(f&&this.setDeclContainingAST(g),a.moduleGenTarget==a.ModuleGenTarget.Asynchronous&&this.writeLineToOutput("})"),this.outfile!=k&&(this.outfile.Close(),this.outfile=k)):(f&&(this.setDeclContainingAST(g),!b.isEnum()&&!h&&(this.declIndentDelta=c,this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))),l=null,b.type&&(b.type.symbol.container&&b.type.symbol.container.declAST)&&(l=b.type.symbol.container.declAST),l=l&&a.hasFlag(l.modFlags,a.ModuleFlags.IsDynamic),
d==i.Prog&&q?this.writeLineToOutput("})(this."+this.moduleName+" || (this."+this.moduleName+" = {}));"):q||d==i.Prog?(c=""!=e?(l?"exports":e)+".":e,this.writeLineToOutput("})("+c+this.moduleName+" || ("+c+this.moduleName+" = {}));")):!q&&d!=i.Prog?this.writeLineToOutput("})("+this.moduleName+" || ("+this.moduleName+" = {}));"):this.writeLineToOutput("})();"),d!=i.Prog&&(!l&&q)&&(this.emitIndent(),this.writeLineToOutput("var "+this.moduleName+" = "+e+"."+this.moduleName+";")));this.recordSourceMappingEnd(b);
this.setContainer(d);this.moduleName=e;this.moduleDeclList.length--}};e.prototype.emitIndex=function(b,f){var d=this.setInObjectLiteral(!1);this.emitJavascript(b,a.TokenID.Tilde,!1);this.writeToOutput("[");this.emitJavascriptList(f,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput("]");this.setInObjectLiteral(d)};e.prototype.emitStringLiteral=function(a){this.writeToOutput(a)};e.prototype.emitJavascriptFunction=function(b,f){if(a.hasFlag(b.fncFlags,a.FncFlags.Signature)||b.isOverload)f&&this.emitFuncSignature(b);
else{var d,l=this.thisFnc;this.thisFnc=b;d=b.isConstructor?this.setContainer(i.Constructor):this.setContainer(i.Function);var c=null,h=!1,g=b.getNameText();if((this.emitState.inObjectLiteral||!b.isAccessor())&&(d!=i.Constructor||(b.fncFlags&a.FncFlags.Method)==a.FncFlags.None)){var k=this.setInObjectLiteral(!1);this.thisClassNode&&(c=this.thisClassNode.extendsList);h=b.hasSelfReference();this.recordSourceMappingStart(b);a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)&&
b.type.symbol.container==this.checker.gloMod&&!b.isConstructor?(this.writeToOutput("this."+g+" = "),this.emitInnerFunction(b,!1,!1,c,h,this.thisClassNode,f,d)):this.emitInnerFunction(b,b.name&&!b.name.isMissing(),!1,c,h,this.thisClassNode,f,d);this.recordSourceMappingEnd(b);this.setInObjectLiteral(k)}this.setContainer(d);this.thisFnc=l;if(a.hasFlag(b.fncFlags,a.FncFlags.Definition))if(a.hasFlag(b.fncFlags,a.FncFlags.Static))this.thisClassNode&&(b.isAccessor()?this.emitPropertyAccessor(b,this.thisClassNode.name.text,
!1,!1):(this.emitIndent(),this.recordSourceMappingStart(b),this.writeLineToOutput(this.thisClassNode.name.text+"."+g+" = "+g+";"),this.recordSourceMappingEnd(b)));else if((this.emitState.container==i.Module||this.emitState.container==i.DynamicModule)&&a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported))this.emitIndent(),d=this.emitState.container==i.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeLineToOutput(d+"."+g+" = "+g+";"),this.recordSourceMappingEnd(b)}};
e.prototype.emitAmbientVarDecl=function(b){b.init&&(this.emitParensAndCommentsInPlace(b,!0),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(b.id.text),this.recordSourceMappingEnd(b.id),this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1),this.recordSourceMappingEnd(b),this.writeToOutput(";"),this.emitParensAndCommentsInPlace(b,!1))};e.prototype.emitForVarList=function(b){if(b){this.recordSourceMappingStart(b);for(var f=b.members.length,d=
0;d<f;d++)this.emitJavascriptVarDecl(b.members[d],0==d?a.TokenID.FOR:a.TokenID.LParen),d<f-1&&this.writeToOutput(", ");this.recordSourceMappingEnd(b)}};e.prototype.emitJavascriptVarDecl=function(b,f,d){"undefined"===typeof d&&(d=!1);if((b.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient)this.emitAmbientVarDecl(b);else{var l=b.sym,c=null!=b.init;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);if(l&&l.isMember()&&l.container&&l.container.kind()==a.SymbolKind.Type){var h=l.container.type;
h.isClass()&&!a.hasFlag(l.flags,a.SymbolFlags.ModuleMember)?this.emitState.container!=i.Args&&(a.hasFlag(l.flags,a.SymbolFlags.Static)?this.writeToOutput(l.container.name+"."):this.writeToOutput("this.")):h.hasImplementation()?!a.hasFlag(l.flags,a.SymbolFlags.Exported)&&(l.container==this.checker.gloMod||!a.hasFlag(l.flags,a.SymbolFlags.Property))?this.writeToOutput("var "):a.hasFlag(b.varFlags,a.VarFlags.LocalStatic)?this.writeToOutput("."):this.emitState.container==i.DynamicModule?this.writeToOutput("exports."):
this.writeToOutput(this.moduleName+"."):f!=a.TokenID.LParen&&(a.hasFlag(l.flags,a.SymbolFlags.Exported)&&l.container==this.checker.gloMod?this.writeToOutput("this."):this.writeToOutput("var "))}else f!=a.TokenID.LParen&&this.writeToOutput("var ");this.recordSourceMappingStart(b.id);this.writeToOutput(b.id.text);this.recordSourceMappingEnd(b.id);c?(this.writeToOutputTrimmable(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1)):l&&(l.isMember()&&this.emitState.container==i.Constructor)&&(this.writeToOutputTrimmable(" = "),
this.writeToOutput(this.defaultValue(b.type)));f!=a.TokenID.FOR&&f!=a.TokenID.LParen&&this.writeToOutputTrimmable(";");this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1)}d&&this.emitVarSignature(b)};e.prototype.declEnclosed=function(a){if(null==a)return!0;for(var b=0,d=this.moduleDeclList.length;b<d;b++)if(this.moduleDeclList[b]==a)return!0;return!1};e.prototype.emitJavascriptName=function(b,f){var d=b.sym;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);
if(!b.isMissing()){if(f&&this.emitState.container!=i.Args&&d)if(d.container&&d.container.name!=a.globalId)if(a.hasFlag(d.flags,a.SymbolFlags.Static)&&a.hasFlag(d.flags,a.SymbolFlags.Property))d.declModule&&a.hasFlag(d.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):this.writeToOutput(d.container.name+".");else if(d.kind()==a.SymbolKind.Field)if(a.hasFlag(d.flags,a.SymbolFlags.ModuleMember)){if(d.container!=this.checker.gloMod&&(a.hasFlag(d.flags,a.SymbolFlags.Property)||
a.hasFlag(d.flags,a.SymbolFlags.Exported)))a.hasFlag(d.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):this.writeToOutput(d.container.name+".")}else d.isInstanceProperty()&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?this.writeToOutput("_this."):this.writeToOutput("this."));else d.kind()==a.SymbolKind.Type&&(d.isInstanceProperty()?d.type.call&&!a.hasFlag(d.flags,a.SymbolFlags.ModuleMember)&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?
this.writeToOutput("_this."):this.writeToOutput("this.")):(d.unitIndex!=this.checker.locationInfo.unitIndex||!this.declEnclosed(d.declModule))&&this.writeToOutput(d.container.name+"."));else d.container==this.checker.gloMod&&(a.hasFlag(d.flags,a.SymbolFlags.Exported)&&!a.hasFlag(d.flags,a.SymbolFlags.Ambient)&&(!d.isType()&&!d.isMember()||!d.declModule||!a.hasFlag(d.declModule.modFlags,a.ModuleFlags.Ambient))&&this.emitState.container==i.Prog&&d.declAST.nodeType!=a.NodeType.FuncDecl)&&this.writeToOutput("this.");
if(d&&d.declAST&&d.declAST.nodeType==a.NodeType.Module&&a.hasFlag(d.declAST.modFlags,a.ModuleFlags.IsDynamic)){var l=d.declAST;a.moduleGenTarget==a.ModuleGenTarget.Asynchronous?this.writeLineToOutput("__"+this.modAliasId+"__;"):(d=b.text,d=(l=l.mod.symbol.declAST&&a.hasFlag(l.mod.symbol.declAST.modFlags,a.ModuleFlags.Ambient))?d:this.firstModAlias?this.firstModAlias:a.quoteBaseName(d),d=l?d:!a.isRelative(a.stripQuotes(d))?a.quoteStr("./"+a.stripQuotes(d)):d,this.writeToOutput("require("+d+")"))}else this.writeToOutput(b.text)}this.recordSourceMappingEnd(b);
this.emitParensAndCommentsInPlace(b,!1)};e.prototype.emitJavascriptStatements=function(b,f){if(b)if(b.nodeType!=a.NodeType.Block){var d=b&&(b.nodeType!=a.NodeType.List||0<b.members.length);if(f||d)d=b.nodeType==a.NodeType.Block||b.nodeType==a.NodeType.List&&1==b.members.length&&b.members[0].nodeType==a.NodeType.Block,this.recordSourceMappingStart(b),d||(this.writeLineToOutput(" {"),this.increaseIndent()),this.emitJavascriptList(b,null,a.TokenID.SColon,!0,!1,!1),d||(this.writeLineToOutput(""),this.decreaseIndent(),
this.emitIndent(),this.writeToOutput("}")),this.recordSourceMappingEnd(b)}else this.emitJavascript(b,a.TokenID.SColon,!0);else f&&this.writeToOutput("{ }")};e.prototype.emitBareJavascriptStatements=function(b,f){b.nodeType!=a.NodeType.Block?b.nodeType==a.NodeType.List?2==b.members.length&&b.members[0].nodeType==a.NodeType.Block&&b.members[1].nodeType==a.NodeType.EndCode?(this.emitJavascript(b.members[0],a.TokenID.SColon,!0),this.writeLineToOutput("")):this.emitJavascriptList(b,null,a.TokenID.SColon,
!0,!1,f):this.emitJavascript(b,a.TokenID.SColon,!0):this.emitJavascript(b,a.TokenID.SColon,!0)};e.prototype.recordSourceMappingStart=function(b){if(this.sourceMapper&&b){var f={line:-1,col:-1},d=new a.SourceMapping(b);d.emittedStartColumn=this.emitState.column;d.emittedStartLine=this.emitState.line;a.getSourceLineColFromMap(f,b.minChar,this.checker.locationInfo.lineMap);d.sourceStartColumn=f.col;d.sourceStartLine=f.line;a.getSourceLineColFromMap(f,b.limChar,this.checker.locationInfo.lineMap);d.sourceEndColumn=
f.col;d.sourceEndLine=f.line;d.parent=this.sourceMapper.currentMapping;this.sourceMapper.currentMapping=this.sourceMapper.sourceMappings.length;this.sourceMapper.sourceMappings.push(d);0<=d.parent&&(b=this.sourceMapper.sourceMappings[d.parent],-1==b.firstChild&&(b.firstChild=this.sourceMapper.currentMapping))}};e.prototype.recordSourceMappingEnd=function(a){this.sourceMapper&&a&&(a=this.sourceMapper.sourceMappings[this.sourceMapper.currentMapping],a.emittedEndColumn=this.emitState.column,a.emittedEndLine=
this.emitState.line,this.sourceMapper.currentMapping=a.parent)};e.prototype.emitSourceMappings=function(){a.SourceMapper.EmitSourceMapping(this.allSourceMappers)};e.prototype.emitJavascriptList=function(b,f,d,l,c,h,g){if(null!=b)if(b.nodeType!=a.NodeType.List)this.emitJavascript(b,d,l,g);else if(0!=b.members.length){this.emitParensAndCommentsInPlace(b,!0);for(var k=b.members.length,e=0;e<k;e++){if(1==e&&h){var q=this.thisClassNode.constructorDecl;if(q&&q.args)for(var m=q.args.members.length,i=0;i<
m;i++){var n=q.args.members[i];(n.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(n),this.recordSourceMappingStart(n.id),this.writeToOutput("this."+n.id.text),this.recordSourceMappingEnd(n.id),this.writeToOutput(" = "),this.recordSourceMappingStart(n.id),this.writeToOutput(n.id.text),this.recordSourceMappingEnd(n.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(n))}q=this.thisClassNode.members.members.length;for(m=0;m<q;m++)this.thisClassNode.members.members[m].nodeType==
a.NodeType.VarDecl&&(i=this.thisClassNode.members.members[m],!a.hasFlag(i.varFlags,a.VarFlags.Static)&&i.init&&(this.emitIndent(),this.emitJavascriptVarDecl(i,a.TokenID.Tilde),this.writeLineToOutput("")))}q=b.members[e];m=q.nodeType==a.NodeType.FuncDecl&&a.hasFlag(q.fncFlags,a.FncFlags.Static)||q.nodeType==a.NodeType.VarDecl&&a.hasFlag(q.varFlags,a.VarFlags.Static);if(!(c?!m:m))this.emitJavascript(q,d,l,g),f&&e<k-1?l?this.writeLineToOutput(f):this.writeToOutput(f):l&&(q.nodeType!=a.NodeType.Interface&&
!(q.nodeType==a.NodeType.VarDecl&&(q.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient&&null==q.init)&&q.nodeType!=a.NodeType.EndCode&&q.nodeType!=a.NodeType.FuncDecl)&&this.writeLineToOutput("")}this.emitParensAndCommentsInPlace(b,!1)}};e.prototype.emitJavascript=function(b,f,d,l){"undefined"===typeof l&&(l=!1);null!=b&&(d&&0<this.emitState.indentAmt&&b.nodeType!=a.NodeType.List&&b.nodeType!=a.NodeType.Block&&b.nodeType!=a.NodeType.Interface&&(!(b.nodeType==a.NodeType.VarDecl&&(b.varFlags&a.VarFlags.Ambient)==
a.VarFlags.Ambient&&null==b.init)&&b.nodeType!=a.NodeType.EndCode&&(b.nodeType!=a.NodeType.FuncDecl||this.emitState.container!=i.Constructor))&&this.emitIndent(),b.emit(this,f,d,l),f==a.TokenID.SColon&&b.nodeType<a.NodeType.GeneralNode&&this.writeToOutput(";"))};e.prototype.emitPropertyAccessor=function(a,b,d,l){if(!a.accessorSymbol.hasBeenEmitted){var c=a.accessorSymbol;this.emitIndent();this.recordSourceMappingStart(a);this.writeLineToOutput("Object.defineProperty("+b+(d?'.prototype, "':', "')+
a.name.text+'", {');this.increaseIndent();c.getter&&(b=c.getter.declAST,this.emitIndent(),this.writeToOutput("get: "),this.emitInnerFunction(b,!1,d,null,a.hasSelfReference(),null),this.writeLineToOutput(","));c.setter&&(b=c.setter.declAST,this.emitIndent(),this.writeToOutput("set: "),this.emitInnerFunction(b,!1,d,null,a.hasSelfReference(),null),this.writeLineToOutput(","));this.emitIndent();this.writeLineToOutput("enumerable: true,");this.emitIndent();this.writeLineToOutput("configurable: true");
this.decreaseIndent();this.emitIndent();this.writeLineToOutput("});");this.recordSourceMappingEnd(a);l&&this.emitPropertyAccessorSignature(a);c.hasBeenEmitted=!0}};e.prototype.emitPrototypeMember=function(b,f,d){b.nodeType==a.NodeType.FuncDecl?b.isAccessor()?this.emitPropertyAccessor(b,f,!0,d):(this.emitIndent(),this.recordSourceMappingStart(b),this.writeToOutput(f+".prototype."+b.getNameText()+" = "),this.emitInnerFunction(b,!1,!0,null,b.hasSelfReference(),null,d),this.recordSourceMappingEnd(b),
this.writeLineToOutput(";")):b.nodeType==a.NodeType.VarDecl&&(b.init&&(this.emitIndent(),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(f+".prototype."+b.id.text),this.recordSourceMappingEnd(b.id),this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Asg,!1),this.recordSourceMappingEnd(b),this.writeLineToOutput(";")),d&&this.emitVarSignature(b))};e.prototype.emitAddBaseMethods=function(b,f,d){if(f.members){var l=f.symbol,c=l.name;l.declModule!=d.type.symbol.declModule&&
(c=l.fullName());f.members.allMembers.map(function(d,h){h.kind()==a.SymbolKind.Type&&h.type.call&&(this.recordSourceMappingStart(h.declAST),this.writeLineToOutput(b+".prototype."+h.name+" = "+c+".prototype."+h.name+";"),this.recordSourceMappingEnd(h.declAST))},null)}if(f.extendsList)for(var l=0,h=f.extendsList.length;l<h;l++)this.emitAddBaseMethods(b,f.extendsList[l],d)};e.prototype.emitJavascriptClass=function(b,f){if(a.hasFlag(b.varFlags,a.VarFlags.Ambient))f&&this.emitClassSignature(b);else{var d=
this.thisClassNode,l=0;this.thisClassNode=b;var c=b.name.text;this.emitParensAndCommentsInPlace(b,!0);var h=null;f&&(f=this.emitClassSignatureIdentifierAndHeritage(b))&&(h=this.setDeclContainingAST(b));var g=this.setContainer(i.Class);this.recordSourceMappingStart(b);a.hasFlag(b.varFlags,a.VarFlags.Exported)&&b.type.symbol.container==this.checker.gloMod?this.writeToOutput("this."+c):this.writeToOutput("var "+c);var k=b.type.instanceType,e=k?k.baseClass():null,q=null,q=null;e?this.writeLineToOutput(" = (function (_super) {"):
this.writeLineToOutput(" = (function () {");this.increaseIndent();if(e){q=b.extendsList.members[0];q=q.nodeType==a.NodeType.Call?q.target:q;this.emitIndent();this.writeLineToOutput("__extends("+c+", _super);");var m=k.extendsList.length;if(1<m)for(l=1;l<m;l++)this.emitAddBaseMethods(c,k.extendsList[l],b)}this.emitIndent();if(b.constructorDecl)this.emitJavascript(b.constructorDecl,a.TokenID.LParen,!1,!1),f&&this.emitMembersFromConstructorDefinition(b.constructorDecl);else{m=0;this.recordSourceMappingStart(b);
this.increaseIndent();this.writeToOutput("function "+b.name.text+"() {");e&&(this.writeLineToOutput(""),this.emitIndent(),this.writeLineToOutput("_super.apply(this, arguments);"),m++);for(var s=this.thisClassNode.members.members,l=0;l<s.length;l++)s[l].nodeType==a.NodeType.VarDecl&&(k=s[l],!a.hasFlag(k.varFlags,a.VarFlags.Static)&&k.init&&(this.writeLineToOutput(""),this.emitIndent(),this.emitJavascriptVarDecl(k,a.TokenID.Tilde),m++));m?(this.writeLineToOutput(""),this.decreaseIndent(),this.emitIndent(),
this.writeLineToOutput("}")):(this.writeLineToOutput(" }"),this.decreaseIndent());this.recordSourceMappingEnd(b)}l=b.definitionMembers.members.length;for(m=0;m<l;m++)if(k=b.definitionMembers.members[m],k.nodeType==a.NodeType.FuncDecl)a.hasFlag(k.fncFlags,a.FncFlags.Method)&&!k.isSignature()?a.hasFlag(k.fncFlags,a.FncFlags.Static)?k.isAccessor()?this.emitPropertyAccessor(k,this.thisClassNode.name.text,!1,f):(this.emitIndent(),this.recordSourceMappingStart(k),this.writeToOutput(b.name.text+"."+k.name.text+
" = "),this.emitInnerFunction(k,k.name&&!k.name.isMissing(),!1,null,k.hasSelfReference(),null,f),this.recordSourceMappingEnd(k)):this.emitPrototypeMember(k,c,f):f&&this.emitFuncSignature(k);else if(k.nodeType==a.NodeType.VarDecl)a.hasFlag(k.varFlags,a.VarFlags.Static)?(this.emitIndent(),this.recordSourceMappingStart(k),this.writeToOutput(b.name.text+"."+k.id.text+" = "),k.init?(this.emitJavascript(k.init,a.TokenID.Asg,!1),this.writeLineToOutput(";")):this.writeLineToOutput(this.defaultValue(k.type)+
";"),f&&this.emitVarSignature(k),this.recordSourceMappingEnd(k)):f&&this.emitVarSignature(k);else throw Error("We want to catch this");this.emitIndent();this.recordSourceMappingStart(b);this.writeLineToOutput("return "+c+";");this.recordSourceMappingEnd(b);this.decreaseIndent();this.emitIndent();this.writeToOutput("})(");e&&this.emitJavascript(q,a.TokenID.Tilde,!1);this.writeToOutput(");");f&&(this.setDeclContainingAST(h),this.emitIndentToDeclFile(),this.declFile.WriteLine("}"));if((g==i.Module||
g==i.DynamicModule)&&a.hasFlag(b.varFlags,a.VarFlags.Exported))this.writeLineToOutput(""),this.emitIndent(),h=g==i.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeToOutput(h+"."+c+" = "+c+";"),this.recordSourceMappingEnd(b);this.emitIndent();this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1);this.setContainer(g);this.thisClassNode=d}};e.prototype.emitPrologue=function(a){!this.prologueEmitted&&a&&(this.prologueEmitted=!0,this.writeLineToOutput("var __extends = this.__extends || function (d, b) {"),
this.writeLineToOutput("    function __() { this.constructor = d; }"),this.writeLineToOutput("    __.prototype = b.prototype;"),this.writeLineToOutput("    d.prototype = new __();"),this.writeLineToOutput("}"))};e.prototype.emitSuperReference=function(){this.writeToOutput("_super.prototype")};e.prototype.emitSuperCall=function(b){if(b.target.nodeType==a.NodeType.Dot){var f=b.target;if(f.operand1.nodeType==a.NodeType.Super)return this.emitJavascript(f,a.TokenID.LParen,!1),this.writeToOutput(".call(this"),
b.args&&0<b.args.members.length&&(this.writeToOutput(", "),this.emitJavascriptList(b.args,", ",a.TokenID.Comma,!1,!1,!1)),this.writeToOutput(")"),!0}return!1};a.Emitter=e})(TypeScript||(TypeScript={}));
(function(a){var e=function(a){this.outfile=a;this.checker=this.parser=null;this.lineCol={line:0,col:0};this.emitAsComments=!0;this.pushToErrorSink=this.hasErrors=!1;this.errorSink=[]};e.prototype.getCapturedErrors=function(){return this.errorSink};e.prototype.freeCapturedErrors=function(){this.errorSink=[]};e.prototype.captureError=function(a){this.errorSink[this.errorSink.length]=a};e.prototype.setErrOut=function(a){this.outfile=a;this.emitAsComments=!1};e.prototype.emitPrefix=function(){this.emitAsComments&&
this.outfile.Write("// ");this.outfile.Write(this.checker.locationInfo.filename+"("+this.lineCol.line+","+this.lineCol.col+"): ")};e.prototype.writePrefix=function(a){a?this.setError(a):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};e.prototype.writePrefixFromSym=function(e){e&&this.checker.locationInfo.lineMap?a.getSourceLineColFromMap(this.lineCol,e.location,this.checker.locationInfo.lineMap):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};e.prototype.setError=function(e){e&&
(e.flags|=a.ASTFlags.Error,this.checker.locationInfo.lineMap&&a.getSourceLineColFromMap(this.lineCol,e.minChar,this.checker.locationInfo.lineMap))};e.prototype.reportError=function(a,b){if(this.pushToErrorSink)this.captureError(b);else{this.hasErrors=!0;var e=a.limChar-a.minChar;this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.minChar,e,b,this.checker.locationInfo.unitIndex):(this.writePrefix(a),this.outfile.WriteLine(b))}};e.prototype.reportErrorFromSym=function(a,
b){this.pushToErrorSink?this.captureError(b):(this.hasErrors=!0,this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.location,1,b,this.checker.locationInfo.unitIndex):(this.writePrefixFromSym(a),this.outfile.WriteLine(b)))};e.prototype.emitterError=function(a,b){this.reportError(a,b);throw Error("EmitError");};e.prototype.duplicateIdentifier=function(a,b){this.reportError(a,"Duplicate identifier '"+b+"'")};e.prototype.showRef=function(a,b,e){var f={line:-1,col:-1};this.parser.getSourceLineCol(f,
e.location);this.reportError(a,"symbol "+b+" defined at ("+f.line+","+f.col+")")};e.prototype.unresolvedSymbol=function(a,b){this.reportError(a,"The name '"+b+"' does not exist in the current scope")};e.prototype.symbolDoesNotReferToAValue=function(a,b){this.reportError(a,"The name '"+b+"' does not refer to a value")};e.prototype.styleError=function(a,b){var e=this.pushToErrorSink;this.pushToErrorSink=!1;this.reportError(a,"STYLE: "+b);this.pushToErrorSink=e};e.prototype.simpleError=function(a,b){this.reportError(a,
b)};e.prototype.simpleErrorFromSym=function(a,b){this.reportErrorFromSym(a,b)};e.prototype.invalidSuperReference=function(a){this.simpleError(a,"Keyword 'super' can only be used inside a class instance method")};e.prototype.valueCannotBeModified=function(a){this.simpleError(a,"The left-hand side of an assignment expression must be a variable, property or indexer")};e.prototype.invalidCall=function(e,b,j){var f=e.target.type,j=f.getScopedTypeName(j);f.construct&&b==a.NodeType.Call?this.reportError(e,
"Value of type '"+j+"' is not callable.  Did you mean to include 'new'?"):this.reportError(e,"Value of type '"+j+"' is not "+(b==a.NodeType.Call?"callable":"newable"))};e.prototype.indexLHS=function(a,b){var e=a.operand1.type.getScopedTypeName(b),f=a.operand2.type.getScopedTypeName(b);this.simpleError(a,"Value of type '"+e+"' is not indexable by type '"+f+"'")};e.prototype.incompatibleTypes=function(a,b,e,f,d,l){b||(b=this.checker.anyType);e||(e=this.checker.anyType);l=l?l.message:"";f?this.reportError(a,
"Operator '"+f+"' cannot be applied to types '"+b.getScopedTypeName(d)+"' and '"+e.getScopedTypeName(d)+"'"+(l?": "+l:"")):this.reportError(a,"Cannot convert '"+b.getScopedTypeName(d)+"' to '"+e.getScopedTypeName(d)+"'"+(l?": "+l:""))};e.prototype.expectedClassOrInterface=function(a){this.simpleError(a,"Expected var, class, interface, or module")};e.prototype.unaryOperatorTypeError=function(a,b,e){this.reportError(a,"Operator '"+b+"' cannot be applied to type '"+e.getTypeName()+"'")};a.ErrorReporter=
e})(TypeScript||(TypeScript={}));
(function(a){var e=a.TypeContext||(a.TypeContext={});e._map=[];e.NoTypes=0;e.ArraySuffix=1;e.Primitive=2;e.Named=4;e.AllSimpleTypes=e.Primitive|e.Named;e.AllTypes=e.Primitive|e.Named|e.ArraySuffix;var i=a.TypeContext,e=a.ParseState||(a.ParseState={});e._map=[];e._map[0]="None";e.None=0;e._map[1]="StartScript";e.StartScript=1;e._map[2]="StartStmtList";e.StartStmtList=2;e._map[3]="StartStatement";e.StartStatement=3;e._map[4]="StartFncDecl";e.StartFncDecl=4;e._map[5]="FncDeclName";e.FncDeclName=5;e._map[6]=
"FncDeclArgs";e.FncDeclArgs=6;e._map[7]="FncDeclReturnType";e.FncDeclReturnType=7;e._map[8]="ForInit";e.ForInit=8;e._map[9]="ForInitAfterVar";e.ForInitAfterVar=9;e._map[10]="ForCondStart";e.ForCondStart=10;e._map[11]="EndStmtList";e.EndStmtList=11;e._map[12]="EndScript";e.EndScript=12;var b=a.ParseState,j;j=function(a,b){this.Script=a;this.endLexState=b};a.QuickParseResult=j;var f=function(){this.varLists=[];this.scopeLists=[];this.staticsLists=[];this.scanner=new a.Scanner;this.tok=null;this.inInterfaceDecl=
this.inStaticFnc=this.inFnc=this.needTerminator=!1;this.currentClassDecl=null;this.inFncDecl=!1;this.anonId=new a.Identifier("_anonymous");this.style_requireSemi=!1;this.style_funcInLoop=!0;this.errorRecovery=this.incremental=!1;this.outfile=void 0;this.errorCallback=null;this.state=b.StartStmtList;this.cursorColumn=this.cursorLine=-1;this.cursorState=b.None;this.errorMessage="";this.ambientClass=this.ambientModule=!1;this.topLevel=!0;this.currentUnitIndex=-1;this.prevIDTok=null;this.stmtStack=[];
this.strictMode=this.hasTopLevelImportOrExport=!1;this.nestingLevel=0;this.currentClassDefinition=this.prevExpr=null;this.parsingDeclareFile=this.parsingClassConstructorDefinition=!1;this.amdDependencies=[];this.inferPropertiesFromThisAssignment=!1;this.fname="";this.parseError=!1};f.prototype.resetStmtStack=function(){this.stmtStack=[]};f.prototype.inLoop=function(){for(var a=this.stmtStack.length-1;0<=a;a--)if(this.stmtStack[a].stmt.isLoop())return!0;return!1};f.prototype.pushStmt=function(a,b){this.stmtStack.push({stmt:a,
labels:b})};f.prototype.popStmt=function(){return this.stmtStack.pop()};f.prototype.resolveJumpTarget=function(d){for(var b=this.stmtStack.length-1;0<=b;b--){var c=this.stmtStack[b];if(d.target){if(c.labels&&0<c.labels.members.length)for(var h=0,g=c.labels.members.length;h<g;h++)if(c.labels.members[h].id.text==d.target){d.setResolvedTarget(this,c.stmt);return}}else{if(c.stmt.isLoop()){d.setResolvedTarget(this,c.stmt);return}if(c.stmt.nodeType==a.NodeType.Switch&&d.nodeType==a.NodeType.Break){d.setResolvedTarget(this,
c.stmt);return}}}d.target?this.reportParseError("could not find enclosing statement with label "+d.target):d.nodeType==a.NodeType.Break?this.reportParseError("break statement requires enclosing loop or switch"):this.reportParseError("continue statement requires enclosing loop")};f.prototype.setNonInteractive=function(){this.errorRecovery=!1};f.prototype.setErrorRecovery=function(a,l,c){this.outfile=a;this.cursorLine=l;this.cursorColumn=c;this.cursorState=b.None;this.errorRecovery=!0};f.prototype.posMatchesCursor=
function(a){var b={line:-1,col:-1};this.getSourceLineCol(b,a);return b.line==this.cursorLine&&b.col==this.cursorColumn};f.prototype.getSourceLineCol=function(d,b){a.getSourceLineColFromMap(d,b,this.scanner.lineMap)};f.prototype.createRef=function(d,b){var c=new a.Identifier(d);c.minChar=b;return c};f.prototype.reportParseStyleError=function(a){this.reportParseError("STYLE: "+a)};f.prototype.reportParseError=function(a,b,c){"undefined"===typeof b&&(b=this.scanner.startPos);"undefined"===typeof c&&
(c=this.scanner.pos);c=Math.max(1,c-b);if(this.errorCallback)this.errorCallback(b,c,a,this.currentUnitIndex);else if(this.errorRecovery)c={line:-1,col:-1},this.getSourceLineCol(c,b),this.outfile&&this.outfile.WriteLine("// "+this.fname+" ("+c.line+","+c.col+"): "+a);else throw new SyntaxError(this.fname+" ("+this.scanner.line+","+this.scanner.col+"): "+a);};f.prototype.chkNxtTok=function(a,b,c){this.tok=this.scanner.scan();this.chkCurTok(a,b,c)};f.prototype.skip=function(d){var d=d|a.ErrorRecoverySet.EOF,
b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId);void 0!=c&&(b=c.ers);for(var h=0;(b&d)==a.ErrorRecoverySet.None||this.tok.tokenId==a.TokenID.RCurly&&0<h;)this.tok.tokenId==a.TokenID.LCurly?h++:this.tok.tokenId==a.TokenID.RCurly&&h--,this.tok=this.scanner.scan(),b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId),void 0!=c&&(b=c.ers)};f.prototype.chkCurTok=function(a,b,c){this.tok.tokenId!=a?(this.reportParseError(b),this.errorRecovery&&this.skip(c)):this.tok=this.scanner.scan()};
f.prototype.pushDeclLists=function(){this.staticsLists.push(new a.ASTList);this.varLists.push(new a.ASTList);this.scopeLists.push(new a.ASTList)};f.prototype.popDeclLists=function(){this.staticsLists.pop();this.varLists.pop();this.scopeLists.pop()};f.prototype.topVarList=function(){return this.varLists[this.varLists.length-1]};f.prototype.topScopeList=function(){return this.scopeLists[this.scopeLists.length-1]};f.prototype.topStaticsList=function(){return this.staticsLists[this.staticsLists.length-
1]};f.prototype.parseComment=function(d){if(d){var b=new a.Comment(d.value,d.isBlock,d.endsLine);b.minChar=d.startPos;b.limChar=d.startPos+d.value.length;!d.isBlock&&3<d.value.length&&"///"==d.value.substring(0,3)&&(d=a.getAdditionalDependencyPath(d.value))&&this.amdDependencies.push(d);return b}return null};f.prototype.parseCommentsInner=function(a){if(a){for(var b=[],c=0;c<a.length;c++)b.push(this.parseComment(a[c]));return b}return null};f.prototype.parseComments=function(){var a=this.scanner.getComments();
return this.parseCommentsInner(a)};f.prototype.parseCommentsForLine=function(a){a=this.scanner.getCommentsForLine(a);return this.parseCommentsInner(a)};f.prototype.combineComments=function(a,b){return null==a?b:null==b?a:a.concat(b)};f.prototype.parseEnumDecl=function(d){var b=this.scanner.leftCurlyCount,c=this.scanner.rightCurlyCount,h=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(h=new a.Identifier(this.tok.getText()),h.minChar=this.scanner.startPos,h.limChar=
this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("Enum declaration requires identifier"),this.errorRecovery&&(h=new a.MissingIdentifier,h.minChar=this.scanner.startPos,h.limChar=this.scanner.startPos,h.flags|=a.ASTFlags.Error));var g=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",d|a.ErrorRecoverySet.ID);this.pushDeclLists();var k=new a.ASTList;k.minChar=g;g=new a.VarDecl(new a.Identifier("_map"),0);g.varFlags|=a.VarFlags.Exported;g.varFlags|=a.VarFlags.Private;
g.varFlags|=a.VarFlags.Property|a.VarFlags.Public;g.init=new a.UnaryExpression(a.NodeType.ArrayLit,null);k.append(g);for(g=null;;){var f=this.scanner.startPos,e,m=null,j=null,n=null,p=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok))m=new a.Identifier(this.tok.getText()),m.minChar=this.scanner.startPos,m.limChar=this.scanner.pos;else if(this.tok.tokenId==a.TokenID.RCurly)break;else this.reportParseError("Expected identifer of enum member"),this.errorRecovery&&(m=new a.MissingIdentifier,
m.minChar=this.scanner.startPos,m.limChar=this.scanner.startPos,m.flags|=a.ASTFlags.Error);e=this.scanner.pos;n=this.parseComments();this.tok=this.scanner.scan();p=this.parseComments();if(this.tok.tokenId==a.TokenID.Asg)this.tok=this.scanner.scan(),g=j=this.parseExpr(d,a.OperatorPrecedence.Cma,!0,i.NoTypes),e=j.limChar;else{var g=j=null==g?new a.NumberLiteral(0):new a.NumberLiteral(g.value+1),r=new a.BinaryExpression(a.NodeType.Asg,new a.BinaryExpression(a.NodeType.Index,new a.Identifier("_map"),
j),new a.StringLiteral('"'+m.text+'"'));k.append(r)}m=new a.VarDecl(m,this.nestingLevel);m.minChar=f;m.limChar=e;m.init=j;m.typeExpr=new a.TypeReference(this.createRef(h.text,-1),0);m.varFlags|=a.VarFlags.Readonly|a.VarFlags.Property;j.nodeType==a.NodeType.NumberLit&&(m.varFlags|=a.VarFlags.Constant);m.preComments=n;k.append(m);m.postComments=p;m.varFlags|=a.VarFlags.Exported;if(this.tok.tokenId==a.TokenID.Comma&&(this.tok=this.scanner.scan(),m.postComments=this.combineComments(m.postComments,this.parseCommentsForLine(this.scanner.prevLine)),
this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)))continue;break}this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);k.limChar=this.scanner.lastTokenLimChar();d=new a.ModuleDecl(h,k,this.topVarList(),this.topScopeList());d.modFlags|=a.ModuleFlags.IsEnum;this.popDeclLists();d.leftCurlyCount=this.scanner.leftCurlyCount-b;d.rightCurlyCount=this.scanner.rightCurlyCount-c;return d};f.prototype.parseDottedName=function(d){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)){var b=new a.Identifier(this.tok.getText());b.preComments=this.parseComments();d[d.length]=b;b.minChar=this.scanner.startPos;b.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Dot&&this.parseDottedName(d)}else this.reportParseError("need identifier after '.'")};f.prototype.isValidImportPath=function(d){d=a.stripQuotes(d);return!d||-1!=d.indexOf(":")||-1!=d.indexOf("\\")||"/"==d.charAt(0)?!1:!0};f.prototype.parseImportDecl=function(d,b){var c=null,
h=null,c=null,g=this.scanner.startPos,k=!1;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?c=new a.Identifier(this.tok.getText()):(this.reportParseError("Expected identifer after 'import'"),c=new a.MissingIdentifier);c.minChar=this.scanner.startPos;c.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.Asg,"Expected =",d|a.ErrorRecoverySet.ID);var e=this.parseComments(),f;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode))if(this.tok.tokenId==a.TokenID.MODULE){if(f=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.QString||this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))this.tok.tokenId==a.TokenID.QString?(this.topLevel&&(this.hasTopLevelImportOrExport=!0),h=this.tok.getText(),this.isValidImportPath(h)||this.reportParseError("Invalid import path"),h=new a.Identifier(h),h.minChar=this.scanner.startPos,
h.limChar=this.scanner.pos,k=!0,this.tok=this.scanner.scan()):h=this.parseExpr(d|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,i.NoTypes),h.preComments=e;f=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.ID);h&&(h.postComments=this.parseComments());this.tok.tokenId==a.TokenID.SColon&&(f=this.scanner.pos,this.tok=this.scanner.scan())}}else h=this.parseExpr(d|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,i.NoTypes),f=this.scanner.pos;else this.reportParseError("Expected module name"),
h=new a.MissingIdentifier,h.minChar=this.scanner.startPos,h.limChar=this.scanner.startPos,h.flags|=a.ASTFlags.Error,f=h.limChar;c=new a.ImportDecl(c,h);c.isDynamicImport=k;a.hasFlag(b,a.Modifiers.Exported)&&(c.varFlags|=a.VarFlags.Exported);c.minChar=g;c.limChar=f;return c};f.prototype.parseModuleDecl=function(d,b){var c=this.scanner.leftCurlyCount,h=this.scanner.rightCurlyCount,g=this.ambientModule,k=this.topLevel;this.topLevel=!1;if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))this.ambientModule=
!0;this.tok=this.scanner.scan();var f=null,e=null;this.pushDeclLists();var m=this.parseComments(),i=this.scanner.startPos,j=!1;this.tok.tokenId==a.TokenID.ID||this.tok.tokenId==a.TokenID.QString||a.convertTokToID(this.tok,this.strictMode)?(f=this.tok.getText(),this.tok.tokenId==a.TokenID.QString&&(j=!0,this.ambientModule||this.reportParseError("Only ambient dynamic modules may have string literal names")),f=new a.Identifier(f),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,this.tok=this.scanner.scan()):
this.tok.tokenId==a.TokenID.LCurly&&(this.reportParseError("Module name missing"),f=new a.Identifier(""),f.minChar=i,f.limChar=i);this.tok.tokenId==a.TokenID.Dot&&(e=[],this.parseDottedName(e));null==f&&(f=new a.MissingIdentifier);var p=new a.ASTList,r=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",d|a.ErrorRecoverySet.ID);this.parseStmtList(d|a.ErrorRecoverySet.RCurly,p,!0,!0,a.AllowedElements.ModuleMembers,b);p.minChar=r;p.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RCurly,
"Expected '}'",d);r=this.scanner.pos;if(e&&0<e.length){var t=e.length,u=e[t-1],u=new a.ModuleDecl(u,p,this.topVarList(),this.topScopeList());if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))u.modFlags|=a.ModuleFlags.Ambient;u.modFlags|=a.ModuleFlags.Exported;u.minChar=i;u.limChar=r;this.popDeclLists();for(t-=2;0<=t;t--){p=new a.ASTList;p.append(u);u=e[t];u=new a.ModuleDecl(u,p,new a.ASTList,new a.ASTList);p.minChar=u.minChar=i;p.limChar=u.limChar=r;if(this.parsingDeclareFile||a.hasFlag(b,
a.Modifiers.Ambient))u.modFlags|=a.ModuleFlags.Ambient;u.modFlags|=a.ModuleFlags.Exported}p=new a.ASTList;p.append(u);p.minChar=i;p.limChar=r;e=new a.ModuleDecl(f,p,new a.ASTList,new a.ASTList)}else e=new a.ModuleDecl(f,p,this.topVarList(),this.topScopeList()),this.popDeclLists();if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))e.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(b,a.Modifiers.Exported)&&(e.modFlags|=a.ModuleFlags.Exported);j&&(e.modFlags|=a.ModuleFlags.IsDynamic);e.preComments=
m;e.postComments=this.parseComments();this.ambientModule=g;this.topLevel=k;e.leftCurlyCount=this.scanner.leftCurlyCount-c;e.rightCurlyCount=this.scanner.rightCurlyCount-h;return e};f.prototype.parseTypeReferenceTail=function(d,b,c){c=new a.TypeReference(c,0);for(c.minChar=b;this.tok.tokenId==a.TokenID.LBrack;)this.tok=this.scanner.scan(),c.arrayCount++,this.chkCurTok(a.TokenID.RBrack,"Expected ']'",d|a.ErrorRecoverySet.LBrack);c.limChar=this.scanner.lastTokenLimChar();return c};f.prototype.parseNamedType=
function(d,b,c,h){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.Dot){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)){var g=new a.Identifier(this.tok.getText());g.minChar=this.scanner.startPos;g.limChar=this.scanner.pos;var k=new a.BinaryExpression(a.NodeType.Dot,c,g);k.minChar=c.minChar;k.limChar=g.limChar;return this.parseNamedType(d,b,k,h)}this.reportParseError("need identifier after '.'");if(this.errorRecovery)return c.flags|=
a.ASTFlags.DotLHS,c.limChar=this.scanner.lastTokenLimChar(),c;g=new a.MissingIdentifier;g.minChar=this.scanner.pos;g.limChar=this.scanner.pos;k=new a.BinaryExpression(a.NodeType.Dot,c,g);k.flags|=a.ASTFlags.Error;k.minChar=c.minChar;k.limChar=g.limChar;return this.parseNamedType(d,b,k,h)}return h?this.parseTypeReferenceTail(d,b,c):c};f.prototype.parseTypeReference=function(d,b){var c=this.scanner.startPos,h=!1;switch(this.tok.tokenId){case a.TokenID.VOID:b||this.reportParseError("void not a valid type in this context");
case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:return h=new a.Identifier(a.tokenTable[this.tok.tokenId].text),h.minChar=c,h.limChar=this.scanner.pos,this.tok=this.scanner.scan(),this.parseTypeReferenceTail(d,c,h);case a.TokenID.ID:return h=this.createRef(this.tok.getText(),c),h.limChar=this.scanner.pos,this.parseNamedType(d,c,h,!0);case a.TokenID.LCurly:this.tok=this.scanner.scan();h=new a.ASTList;h.minChar=c;var g=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(d|
a.ErrorRecoverySet.RCurly,h);this.inInterfaceDecl=g;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);g=new a.TypeDecl(a.NodeType.Interface,this.anonId,h,null,null,null);g.minChar=c;g.limChar=h.limChar;return this.parseTypeReferenceTail(d,c,g);case a.TokenID.NEW:this.tok=this.scanner.scan(),this.tok.tokenId!=a.TokenID.LParen?this.reportParseError("Expected '('"):h=!0;case a.TokenID.LParen:var k=new a.ASTList,g=this.parseFormalParameterList(d|a.ErrorRecoverySet.RParen,k,!1,!0,!1,!1,!1,null);this.chkCurTok(a.TokenID.Arrow,
"Expected '=>'",d);var e=this.parseTypeReference(d,!0),k=new a.FuncDecl(null,null,!1,k,null,null,null,a.NodeType.FuncDecl);k.returnTypeAnnotation=e;k.variableArgList=g;k.fncFlags|=a.FncFlags.Signature;h&&(k.fncFlags|=a.FncFlags.ConstructMember,k.hint="_construct",k.classDecl=null);k.minChar=c;return this.parseTypeReferenceTail(d,c,k);default:return this.reportParseError("Expected type name"),c=new a.TypeReference(null,0),c.flags|=a.ASTFlags.Error,c.minChar=this.scanner.pos,c.limChar=this.scanner.pos,
c}};f.prototype.parseFunctionStatements=function(d,l,c,h,g,k,e,f,m){this.pushDeclLists();var j=this.stmtStack;this.resetStmtStack();var n=null,p=!1,r=!1;if(!f){var n=new a.ASTList,t=this.scanner.startPos;this.tok.tokenId==a.TokenID.Arrow&&(h&&this.reportParseError("'=>' may not be used for class methods"),p=!0,this.tok=this.scanner.scan());p&&this.tok.tokenId!=a.TokenID.LCurly?(k=this.parseExpr(d|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,i.NoTypes),m=new a.ReturnStatement,m.returnExpression=
k,n.minChar=t,n.append(m)):(this.state=b.StartStmtList,this.chkCurTok(a.TokenID.LCurly,"Expected '{'",d|a.ErrorRecoverySet.StmtStart),h=this.inFnc,r=p,this.inFnc=!0,this.parseStmtList(d|a.ErrorRecoverySet.RCurly|a.ErrorRecoverySet.StmtStart,n,!0,!1,k,m),n.minChar=t,n.limChar=this.scanner.pos,this.inFnc=h,t=new a.EndCode,t.minChar=n.limChar,t.limChar=t.minChar,n.append(t))}l=new a.FuncDecl(l,n,c,g,this.topVarList(),this.topScopeList(),this.topStaticsList(),a.NodeType.FuncDecl);this.popDeclLists();
this.topScopeList().append(l);c=this.scanner.pos;f?this.chkCurTok(a.TokenID.SColon,"Expected ';'",d):!p||r?(this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d),r&&(l.fncFlags|=a.FncFlags.IsFatArrowFunction)):(l.fncFlags|=a.FncFlags.IsFatArrowFunction,this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan()));l.minChar=e;l.limChar=c;f||(l.fncFlags|=a.FncFlags.Definition);this.stmtStack=j;return l};f.prototype.transformAnonymousArgsIntoFormals=function(d,b){var c=this,h=function(b){if(b.nodeType==
a.NodeType.Comma)c.transformAnonymousArgsIntoFormals(d,b);else if(b.nodeType==a.NodeType.Name||b.nodeType==a.NodeType.Asg){var h=b.nodeType==a.NodeType.Asg?b.operand1:b,l=new a.ArgDecl(h);l.preComments=h.preComments;l.postComments=h.postComments;l.minChar=h.minChar;l.limChar=h.limChar;a.hasFlag(h.flags,a.ASTFlags.PossibleOptionalParameter)&&(l.isOptional=!0);b.nodeType==a.NodeType.Asg&&(l.init=b.operand2);d.append(l)}else c.reportParseError("Invalid lambda argument")};b&&(b.nodeType==a.NodeType.Comma?
(h(b.operand1),h(b.operand2)):h(b))};f.prototype.parseFormalParameterList=function(d,b,c,h,g,k,e,f){b.minChar=this.scanner.startPos;g?this.tok=this.scanner.scan():f||this.chkCurTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.RParen);var m=!1,j=!0,n=!1,p=!1,r=!1;f&&(this.transformAnonymousArgsIntoFormals(b,f),p=!0);for(;;){var t=!1,u=a.VarFlags.None,w=this.scanner.startPos;this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),
this.tok=this.scanner.scan(),u|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor));this.tok.tokenId==a.TokenID.PUBLIC?(u|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor)):this.tok.tokenId==a.TokenID.PRIVATE&&(u|=a.VarFlags.Private|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=
a.VarFlags.ClassSuperMustBeFirstCallInConstructor));u!=a.VarFlags.None?(c||this.reportParseError("only constructor parameters can be properties"),this.tok=this.scanner.scan(),this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),this.tok=this.scanner.scan(),this.tok=this.scanner.scan())):this.tok.tokenId==a.TokenID.Ellipsis&&(m=!0,this.tok=this.scanner.scan());var A=
null;if(!p&&this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))A=new a.Identifier(this.tok.getText()),A.minChar=this.scanner.startPos,A.limChar=this.scanner.pos;if(p||A){var t=!0,C=null,x=null;p&&b.members.length?(x=b.members[b.members.length-1],x.isOptional&&(r=n=!0)):(x=new a.ArgDecl(A),k&&this.reportParseError("Property getters may not take any arguments"),e&&!j&&this.reportParseError("Property setters may only take one argument"),x.minChar=w,x.preComments=this.parseComments(),
this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(n=x.isOptional=!0,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),C=this.parseTypeReference(d,!1),f&&(r=!0));this.tok.tokenId==a.TokenID.Asg&&(h&&this.reportParseError("Arguments in signatures may not have default values"),n=!0,this.tok=this.scanner.scan(),x.init=this.parseExpr(a.ErrorRecoverySet.Comma|d,a.OperatorPrecedence.Cma,!1,i.NoTypes));n&&(!x.isOptionalArg()&&!m)&&this.reportParseError("Optional parameters may only be followed by other optional parameters");
m&&x.isOptionalArg()&&this.reportParseError("Varargs may not be optional or have default parameters");x.postComments=this.parseComments();x.typeExpr=C;x.limChar=this.scanner.lastTokenLimChar();x.varFlags|=u;p?p=!1:b.append(x)}j=!1;if(this.tok.tokenId==a.TokenID.Comma)t&&!m?this.tok=this.scanner.scan():(this.reportParseError("Unexpected ',' in argument list"),this.errorRecovery&&(this.tok=this.scanner.scan()));else break}g?this.chkCurTok(a.TokenID.RBrack,"Expected ']'",d|a.ErrorRecoverySet.LCurly|
a.ErrorRecoverySet.SColon):(!f||r)&&this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.LCurly|a.ErrorRecoverySet.SColon);b.limChar=this.scanner.lastTokenLimChar();return m};f.prototype.parseFncDecl=function(d,l,c,h,g,k,f,e,m,i){var j=this.scanner.leftCurlyCount,p=this.scanner.rightCurlyCount,r=this.parsingClassConstructorDefinition;this.parsingClassConstructorDefinition=!1;var t=null,u=this.scanner.startPos,w=this.scanner.pos,A=this.nestingLevel;this.nestingLevel=0;!this.style_funcInLoop&&
this.inLoop()&&this.reportParseStyleError("function declaration in loop");if(!h&&!f&&!k&&!i)if(this.tok=this.scanner.scan(),this.state=b.StartFncDecl,this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)){if(l)return this.reportParseError("Function declaration must include identifier"),this.nestingLevel=A,new a.IncompleteAST(u,this.scanner.pos)}else t=new a.Identifier(this.tok.getText()),t.minChar=this.scanner.startPos,t.limChar=this.scanner.pos,this.tok=this.scanner.scan();
else g&&(t=g);this.state=b.FncDeclName;var C=new a.ASTList,u=g=!1,x=a.hasFlag(m,a.Modifiers.Getter),D=a.hasFlag(m,a.Modifiers.Setter);if(this.tok.tokenId==a.TokenID.LParen||k&&this.tok.tokenId==a.TokenID.LBrack||i&&i.preProcessedLambdaArgs)g=this.parseFormalParameterList(d,C,!1,c,k,x,D,i?i.preProcessedLambdaArgs:null);this.state=b.FncDeclArgs;i=null;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),a.hasFlag(m,a.Modifiers.Setter)&&this.reportParseError("Property setters may not declare a return type"),
i=this.parseTypeReference(d,!0));k&&0==C.members.length&&this.reportParseError("Index signatures require a parameter type to be specified");this.state=b.FncDeclReturnType;if(l&&!this.parsingDeclareFile&&!e&&(!h||!this.ambientModule&&!this.ambientClass&&!this.inInterfaceDecl)&&this.tok.tokenId==a.TokenID.SColon)c=u=!0;l=this.inFncDecl;this.inFncDecl=!0;d=this.parseFunctionStatements(d|a.ErrorRecoverySet.RCurly,t,!1,h,C,a.AllowedElements.FunctionBody,w,c,a.Modifiers.None);this.inFncDecl=l;d.variableArgList=
g;d.isOverload=u;c||(d.fncFlags|=a.FncFlags.Definition);f&&(d.fncFlags|=a.FncFlags.Static);c&&(d.fncFlags|=a.FncFlags.Signature);k&&(d.fncFlags|=a.FncFlags.IndexerMember);d.returnTypeAnnotation=i;h&&(d.fncFlags|=a.FncFlags.Method,d.fncFlags|=a.FncFlags.ClassPropertyMethodExported);d.leftCurlyCount=this.scanner.leftCurlyCount-j;d.rightCurlyCount=this.scanner.rightCurlyCount-p;this.nestingLevel=A;this.parsingClassConstructorDefinition=r;return d};f.prototype.convertToTypeReference=function(d){var b;
switch(d.nodeType){case a.NodeType.TypeRef:return d;case a.NodeType.Name:return b=new a.TypeReference(d,0),b.minChar=d.minChar,b.limChar=d.limChar,b;case a.NodeType.Index:return(b=this.convertToTypeReference(d.operand1))?(b.arrayCount++,b.minChar=d.minChar,b.limChar=d.limChar,b):new a.AST(a.NodeType.Error)}return null};f.prototype.parseArgList=function(d){var b=new a.ASTList;b.minChar=this.scanner.startPos;this.tok=this.scanner.scan();if(this.tok.tokenId!==a.TokenID.RParen)for(;;){if(65535<b.members.length){this.reportParseError("max number of args exceeded");
break}var c=this.parseExpr(a.ErrorRecoverySet.Comma|d,a.OperatorPrecedence.Cma,!1,i.NoTypes);b.append(c);if(this.tok.tokenId!=a.TokenID.Comma)break;this.tok=this.scanner.scan()}b.limChar=this.scanner.pos;return b};f.prototype.parseBaseList=function(d,b,c,h,g){for(var k=!0,f=d;;){k&&(this.tok.tokenId==a.TokenID.IMPLEMENTS&&(h&&this.reportParseError("interfaces can not implement other types"),f=b),this.tok=this.scanner.scan(),k=!1);var e=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)){var m=this.scanner.startPos,e=new a.Identifier(this.tok.getText());e.minChar=m;e.limChar=this.scanner.pos;e=this.parseNamedType(c|a.ErrorRecoverySet.LCurly,m,e,!1)}else this.reportParseError("Expected base name"),this.errorRecovery&&(e=new a.MissingIdentifier,e.minChar=this.scanner.pos,e.limChar=this.scanner.pos,e.flags|=a.ASTFlags.Error);this.tok.tokenId==a.TokenID.LParen&&(g&&this.reportParseError("Base classes may only be initialized via a 'super' call within the constructor body"),
m=this.parseArgList(c|a.ErrorRecoverySet.RParen),e=new a.CallExpression(a.NodeType.Call,e,m),this.tok=this.scanner.scan(),e.limChar=this.scanner.pos);f.append(e);!h&&(f==d&&1<d.members.length)&&this.reportParseError("A class may only extend one other class");if(this.tok.tokenId==a.TokenID.Comma)this.tok=this.scanner.scan();else if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)f=d,k=!0;else break}};f.prototype.parseClassDecl=function(d,b,c){var b=this.scanner.leftCurlyCount,
h=this.scanner.rightCurlyCount;(c&a.Modifiers.Readonly)!=a.Modifiers.None&&this.reportParseError("const modifier is implicit for class");if(this.parsingDeclareFile||this.ambientModule)c|=a.Modifiers.Ambient,c|=a.Modifiers.Exported;var g=this.ambientClass;this.ambientClass=this.parsingDeclareFile||(c&a.Modifiers.Ambient)!=a.Modifiers.None;this.tok=this.scanner.scan();var k=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(k=new a.Identifier(this.tok.getText()),k.minChar=
this.scanner.startPos,k.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("class missing name"),this.errorRecovery&&(k=new a.MissingIdentifier,k.minChar=this.scanner.pos,k.limChar=this.scanner.pos,k.flags|=a.ASTFlags.Error));var e=null,f=null;if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)e=new a.ASTList,f=new a.ASTList,this.parseBaseList(e,f,d,!1,!0);this.currentClassDefinition=k=new a.ClassDecl(k,new a.ASTList,e,f);this.parseClassElements(k,
d,c);if(this.ambientModule||this.parsingDeclareFile||a.hasFlag(c,a.Modifiers.Exported))k.varFlags|=a.VarFlags.Exported;if(this.ambientModule||a.hasFlag(c,a.Modifiers.Ambient))k.varFlags|=a.VarFlags.Ambient;k.varFlags|=a.VarFlags.Class;this.ambientClass=g;k.leftCurlyCount=this.scanner.leftCurlyCount-b;k.rightCurlyCount=this.scanner.rightCurlyCount-h;return k};f.prototype.parseClassElements=function(d,b,c){var h=c,g=!1,d=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",b);this.nestingLevel++;
for(var k=this.scanner.startPos,e=!1;!(this.tok.tokenId==a.TokenID.RCurly||this.tok.tokenId==a.TokenID.EOF);){var f=!0,m=a.Modifiers.Public|a.Modifiers.Private;this.tok.tokenId==a.TokenID.GET?(h&a.Modifiers.Getter&&this.reportParseError("Duplicate 'get' declaration in class body"),h&a.Modifiers.Setter&&this.reportParseError("Getter already marked as a setter"),h|=a.Modifiers.Getter):this.tok.tokenId==a.TokenID.SET?(h&a.Modifiers.Setter&&this.reportParseError("Duplicate 'set' declaration in class body"),
h&a.Modifiers.Getter&&this.reportParseError("Setter already marked as a getter"),h|=a.Modifiers.Setter):this.tok.tokenId==a.TokenID.PRIVATE?(h&m&&this.reportParseError("Multiple modifiers may not be applied to class members"),h|=a.Modifiers.Private):this.tok.tokenId==a.TokenID.PUBLIC?(h&m&&this.reportParseError("Multiple modifiers may not be applied to class members"),h|=a.Modifiers.Public):this.tok.tokenId==a.TokenID.STATIC?(h&a.Modifiers.Static&&this.reportParseError("Multiple modifiers may not be applied to class members"),
h|=a.Modifiers.Static):this.tok.tokenId==a.TokenID.CONSTRUCTOR?(h!=c&&this.reportParseError("Constructors may not have modifiers"),this.parseClassConstructorDeclaration(k,b,h),f=!1,g=!0):e||this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(g=e?h&a.Modifiers.Getter?"get":"set":this.tok.getText(),g=new a.Identifier(g),g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos,e?(h^=h&a.Modifiers.Getter?a.Modifiers.Getter:a.Modifiers.Setter,e=!1):this.tok=this.scanner.scan(),this.tok.tokenId==
a.TokenID.LParen?(this.parseClassMemberFunctionDeclaration(g,k,b,h),f=!1):((h&a.Modifiers.Getter||h&a.Modifiers.Setter)&&this.reportParseError("Property accessors must be functions"),g=this.parseClassMemberVariableDeclaration(g,k,!1,b,h),g.init&&g.init.nodeType==a.NodeType.FuncDecl?this.tok.tokenId==a.TokenID.RCurly&&(f=!1):g.init&&g.init.nodeType==a.NodeType.ObjectLit&&this.tok.tokenId!=a.TokenID.SColon?(f=!1,g.init.flags|=a.ASTFlags.AutomaticSemicolon):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Expected ';'"),
f=!1)),g=!0):this.tok.tokenId==a.TokenID.SUPER?this.reportParseError("Base class initializers must be the first statement in a class definition"):!e&&(h&a.Modifiers.Getter||h&a.Modifiers.Setter)&&this.tok.tokenId==a.TokenID.LParen||this.tok.tokenId==a.TokenID.Asg?(e=!0,f=!1):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Unexpected '"+this.tok.getText()+"' in class definition"),g=!0);f&&(this.tok=this.scanner.scan());g&&(h=c,k=this.scanner.startPos,g=!1)}b=this.scanner.pos;this.tok.tokenId==
a.TokenID.RCurly&&(this.currentClassDefinition.definitionMembers.members.length||(this.currentClassDefinition.preComments=this.parseComments()),this.tok=this.scanner.scan());this.nestingLevel--;this.currentClassDefinition.members.minChar=d;this.currentClassDefinition.members.limChar=b;this.currentClassDefinition.limChar=b;this.currentClassDefinition=null};f.prototype.parseClassConstructorDeclaration=function(d,b,c){this.parsingClassConstructorDefinition=!0;var h=this.parsingDeclareFile||a.hasFlag(c,
a.Modifiers.Ambient),g=new a.ASTList,k=!1,e=this.parseComments();this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.LParen&&(k=this.parseFormalParameterList(b,g,!0,h,!1,!1,!1,null));var f=h||this.tok.tokenId==a.TokenID.SColon;if(f)for(var m=0;m<g.members.length;m++)a.hasFlag(g.members[m].varFlags,a.VarFlags.Property)&&this.reportParseError("Overload or ambient signatures may not specify parameter properties");f||(this.currentClassDefinition.constructorNestingLevel=this.nestingLevel+1);d=this.parseFunctionStatements(b|
a.ErrorRecoverySet.RCurly,this.currentClassDefinition.name,!0,!1,g,a.AllowedElements.ClassMembers,d,f,c);d.preComments=e;f&&!h&&(d.isOverload=!0);d.variableArgList=k;this.currentClassDecl=null;d.returnTypeAnnotation=this.convertToTypeReference(this.currentClassDefinition.name);d.classDecl=this.currentClassDefinition;h&&(d.fncFlags|=a.FncFlags.Ambient);f&&(d.fncFlags|=a.FncFlags.Signature);if(this.ambientModule||a.hasFlag(c,a.Modifiers.Exported))d.fncFlags|=a.FncFlags.Exported;this.currentClassDefinition.constructorDecl&&
!h&&(!this.currentClassDefinition.constructorDecl.isSignature()&&!d.isSignature())&&this.reportParseError("Duplicate constructor definition");if(h||!d.isSignature())this.currentClassDefinition.constructorDecl=d;d.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=d;this.parsingClassConstructorDefinition=!1;d.postComments=this.parseComments();return d};f.prototype.parseClassMemberVariableDeclaration=function(d,
b,c,h,g){var k=new a.VarDecl(d,this.nestingLevel);k.minChar=b;b=!1;k.preComments=this.parseComments();this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),k.typeExpr=this.parseTypeReference(h|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(this.parsingDeclareFile||a.hasFlag(g,a.Modifiers.Ambient))if(this.reportParseError("context does not permit variable initializer"),this.errorRecovery)return this.skip(h),k.flags|=a.ASTFlags.Error,k.limChar=
this.scanner.lastTokenLimChar(),k;this.tok=this.scanner.scan();k.init=this.parseExpr(a.ErrorRecoverySet.Comma|h,a.OperatorPrecedence.Cma,!0,i.NoTypes);k.limChar=k.init.limChar;this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor}else k.limChar=this.scanner.pos;g&a.Modifiers.Static&&(k.varFlags|=a.VarFlags.Static,b=!0);k.varFlags=(g&a.Modifiers.Private)!=a.Modifiers.None?k.varFlags|a.VarFlags.Private:k.varFlags|a.VarFlags.Public;k.varFlags|=a.VarFlags.Property;c&&
(k.varFlags|=a.VarFlags.ClassConstructorProperty);!c&&!b&&(k.varFlags|=a.VarFlags.ClassBodyProperty);this.currentClassDefinition.knownMemberNames[d.text]=!0;c||(this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=k);this.currentClassDefinition.allMemberDefinitions.members[this.currentClassDefinition.allMemberDefinitions.members.length]=k;k.postComments=this.parseComments();return k};f.prototype.parseClassMemberFunctionDeclaration=function(d,
b,c,h){var g=a.hasFlag(h,a.Modifiers.Getter)||a.hasFlag(h,a.Modifiers.Setter),k=a.hasFlag(h,a.Modifiers.Static),e=this.ambientModule||a.hasFlag(h,a.Modifiers.Ambient),c=c|a.ErrorRecoverySet.RParen,f=this.parseComments();g&&h&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient classes");c=this.parseFncDecl(c,!0,e,!0,d,!1,k,e,h,null);if(c.nodeType==a.NodeType.Error)return c;c.preComments=f;c.minChar=b;null!==c.bod&&(c.limChar=c.bod.limChar);c.fncFlags=h&a.Modifiers.Private?
c.fncFlags|a.FncFlags.Private:c.fncFlags|a.FncFlags.Public;k&&(c.fncFlags|=a.FncFlags.Static);g&&(a.hasFlag(h,a.Modifiers.Getter)?(c.fncFlags|=a.FncFlags.GetAccessor,c.hint="get"+c.name.text):(c.fncFlags|=a.FncFlags.SetAccessor,c.hint="set"+c.name.text),c.fncFlags|=a.FncFlags.IsFunctionExpression,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"));c.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.knownMemberNames[d.text]=
!0;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=c;c.postComments=this.parseComments();return c};f.prototype.parseInterfaceMember=function(d){var b=this.scanner.startPos,c=this.parsePropertyDecl(d,a.Modifiers.Public,!0,!1);c.nodeType==a.NodeType.VarDecl&&this.chkCurTok(a.TokenID.SColon,"Expected ';'",d);c&&(c.minChar=b);return c};f.prototype.parseInterfaceMembers=function(d,b){for(;;){switch(this.tok.tokenId){case a.TokenID.RCurly:case a.TokenID.EOF:b.limChar=
this.scanner.pos;return}var c=this.parseInterfaceMember(d|a.ErrorRecoverySet.TypeScriptS);c&&b.append(c)}};f.prototype.parseInterfaceDecl=function(d,b){var c=this.scanner.leftCurlyCount,h=this.scanner.rightCurlyCount;this.tok=this.scanner.scan();var g=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(g=new a.Identifier(this.tok.getText()),g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("interface missing name"),
this.errorRecovery&&(g=new a.MissingIdentifier,g.minChar=this.scanner.pos,g.limChar=this.scanner.pos,g.flags|=a.ASTFlags.Error));var k=null;this.tok.tokenId==a.TokenID.EXTENDS&&(k=new a.ASTList,k.minChar=this.scanner.startPos,this.parseBaseList(k,null,d,!0,!1));var e=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",d|a.ErrorRecoverySet.TypeScriptS);var f=new a.ASTList;f.minChar=e;e=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(d|a.ErrorRecoverySet.RCurly,
f);this.inInterfaceDecl=e;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);g=new a.TypeDecl(a.NodeType.Interface,g,f,null,k,null);a.hasFlag(b,a.Modifiers.Private)&&(g.varFlags|=a.VarFlags.Private);a.hasFlag(b,a.Modifiers.Public)&&(g.varFlags|=a.VarFlags.Public);if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Exported))g.varFlags|=a.VarFlags.Exported;g.leftCurlyCount=this.scanner.leftCurlyCount-c;g.rightCurlyCount=this.scanner.rightCurlyCount-h;return g};f.prototype.makeVarDecl=function(d,b){var c=
new a.VarDecl(d,b),h=this.topVarList();h&&h.append(c);return c};f.prototype.parsePropertyDecl=function(d,b,c,h){var g=null,k=this.scanner.startPos,e=k,f=!1,m=!1,j=null!=this.prevIDTok,n=a.hasFlag(b,a.Modifiers.Getter)||a.hasFlag(b,a.Modifiers.Setter);if(this.parsingDeclareFile||this.ambientModule||a.hasFlag(b,a.Modifiers.Ambient))c=!0;if(this.tok.tokenId==a.TokenID.LParen&&!j)!c&&!h&&(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery&&(this.skip(d),g=new a.MissingIdentifier));
else if(this.tok.tokenId==a.TokenID.NEW)c&&(this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen&&(f=!0)),f||(c||(this.tok=this.scanner.scan()),g=new a.Identifier("new"),g.minChar=this.scanner.pos-3,e=g.limChar=this.scanner.pos);else if(this.tok.tokenId==a.TokenID.LBrack&&c)m=!0,g=new a.Identifier("__item");else if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToIDName(this.tok)&&!j){if(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery)return b=this.scanner.startPos,
h=this.scanner.pos,this.skip(d&~a.ErrorRecoverySet.Comma),this.scanner.pos==h&&(this.tok=this.scanner.scan()),d=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),d.flags|=a.ASTFlags.Error,d.minChar=b,d.limChar=this.scanner.lastTokenLimChar(),d}else j?(g=new a.Identifier(this.prevIDTok.getText()),g.minChar=this.scanner.lastTokenLimChar()-3,g.limChar=this.scanner.lastTokenLimChar(),e=g.limChar,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.getText()==g.text&&this.tok!=this.prevIDTok&&(this.tok=this.scanner.scan()),this.prevIDTok=null):(g=new a.Identifier(this.tok.getText()),g.minChar=this.scanner.startPos,e=g.limChar=this.scanner.pos,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(this.inInterfaceDecl&&g?g.flags|=a.ASTFlags.OptionalName:this.reportParseError("Optional properties may only be declared on interface or object types"),this.tok=this.scanner.scan());if(this.tok.tokenId==a.TokenID.LParen||m&&this.tok.tokenId==
a.TokenID.LBrack){j=d|a.ErrorRecoverySet.RParen;m&&(j=d|a.ErrorRecoverySet.RBrack);d=this.parseFncDecl(j,!0,c,!this.inFncDecl,g,m,h,this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient),b,null);if(d.nodeType==a.NodeType.Error)return d;d.name&&(d.name.minChar=k,d.name.limChar=e);(b&a.Modifiers.Public)!=a.Modifiers.None&&(d.fncFlags|=a.FncFlags.Public);(b&a.Modifiers.Private)!=a.Modifiers.None&&(d.fncFlags|=a.FncFlags.Private);h&&(d.fncFlags|=a.FncFlags.Static);if(this.parsingDeclareFile||a.hasFlag(b,
a.Modifiers.Ambient))d.fncFlags|=a.FncFlags.Ambient;n&&(a.hasFlag(b,a.Modifiers.Getter)?(d.fncFlags|=a.FncFlags.GetAccessor,d.hint="get"+d.name.text):(d.fncFlags|=a.FncFlags.SetAccessor,d.hint="set"+d.name.text),d.fncFlags|=a.FncFlags.IsFunctionExpression,b&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient types"));null==g&&(f?(d.fncFlags|=a.FncFlags.ConstructMember,d.hint="_construct",d.classDecl=this.currentClassDecl):(d.hint="_call",d.fncFlags|=a.FncFlags.CallMember));
return d}g=new a.VarDecl(g,this.nestingLevel);g.minChar=k;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),g.typeExpr=this.parseTypeReference(d|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(c&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(d),g.flags|=a.ASTFlags.Error,g.limChar=this.scanner.lastTokenLimChar(),g;this.tok=this.scanner.scan();g.init=this.parseExpr(a.ErrorRecoverySet.Comma|
d,a.OperatorPrecedence.Cma,!0,i.NoTypes);g.limChar=g.init.limChar;g.init.nodeType==a.NodeType.FuncDecl?(d=g.init,d.hint=g.id.text,d.boundToProperty=g):n&&this.reportParseError("Accessors may only be functions")}else g.limChar=this.scanner.pos;(b&a.Modifiers.Readonly)!=a.Modifiers.None&&(g.varFlags|=a.VarFlags.Readonly);h&&(g.varFlags|=a.VarFlags.Static);(b&a.Modifiers.Public)!=a.Modifiers.None&&(g.varFlags|=a.VarFlags.Public);(b&a.Modifiers.Private)!=a.Modifiers.None&&(g.varFlags|=a.VarFlags.Private);
g.varFlags|=a.VarFlags.Property;return g};f.prototype.parseVarDecl=function(d,b,c,h,g){var k=a.hasFlag(b,a.Modifiers.Readonly),e=this.scanner.startPos;this.tok=this.scanner.scan();for(var f=null,m=null,j=!1,n=this.parseComments();;){if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)&&(this.reportParseError("Expected identifier in variable declaration"),this.errorRecovery))return f=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),f.minChar=e,this.skip(d),f.flags|=
a.ASTFlags.Error,f.limChar=this.scanner.lastTokenLimChar(),f;f=this.tok.getText();this.strictMode&&"eval"==f&&this.reportParseError("can not name a variable eval in strict mode");f=this.makeVarDecl(new a.Identifier(f),this.nestingLevel);f.id.minChar=this.scanner.startPos;f.id.limChar=this.scanner.pos;f.preComments=n;g&&(f.varFlags|=a.VarFlags.Static);a.hasFlag(b,a.Modifiers.Readonly)&&(f.varFlags|=a.VarFlags.Readonly);if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))f.varFlags|=a.VarFlags.Ambient;
if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Exported))f.varFlags|=a.VarFlags.Exported;f.minChar=e;m&&m.append(f);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),e=this.inFncDecl,this.inFncDecl=!1,f.typeExpr=this.parseTypeReference(d|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1),this.inFncDecl=e);if(this.tok.tokenId==a.TokenID.Asg){if(h&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(d),
f.flags|=a.ASTFlags.Error,f;this.tok=this.scanner.scan();f.init=this.parseExpr(a.ErrorRecoverySet.Comma|d,a.OperatorPrecedence.Cma,c,i.NoTypes);f.limChar=f.init.limChar;f.init.nodeType==a.NodeType.FuncDecl&&(f.init.hint=f.id.text)}else k&&this.reportParseError("const declaration requires initializer"),f.limChar=this.scanner.pos;f.postComments=this.parseCommentsForLine(this.scanner.line);if(this.tok.tokenId!=a.TokenID.Comma)return m?(m.limChar=f.limChar,m):f;j||(m=new a.ASTList,m.minChar=f.minChar,
m.append(f),j=!0);this.tok=this.scanner.scan();e=this.scanner.startPos}};f.prototype.parseMemberList=function(d){var b=new a.ASTList;if(this.tok.tokenId==a.TokenID.RCurly)return b;for(var c=null,h=null,g=null,k=null,f=this.scanner.startPos,e=!1,m=!1,g=null,j=0,n=0;;){var p=!1;this.tok.tokenId==a.TokenID.GET||this.tok.tokenId==a.TokenID.SET?(e=this.tok.tokenId==a.TokenID.SET,g=this.tok,j=this.scanner.startPos,n=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?
(c=e?"set":"get",c+=this.tok.getText(),h=new a.Identifier(this.tok.getText()),h.minChar=this.scanner.startPos,p=!0,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater")):this.tok.tokenId!=a.TokenID.Colon?this.reportParseError("Expected identifier, string or number as accessor name"):(m=!0,h=new a.Identifier(g.getText()),h.minChar=j,h.limChar=n)):this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(c=this.tok.getText(),
h=new a.Identifier(c),h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.QString?(c=this.tok.getText(),h=new a.StringLiteral(c),h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.NumberLit?(c=this.tok.value.toString(),h=new a.StringLiteral(c),h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos):(this.reportParseError("Expected identifier, string or number as member name"),this.errorRecovery&&(h=new a.MissingIdentifier,
h.minChar=this.scanner.startPos,h.flags|=a.ASTFlags.Error,this.skip(d|a.ErrorRecoverySet.Comma),h.limChar=this.scanner.lastTokenLimChar()));m?m=!1:this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.QMark&&(h.flags|=a.ASTFlags.OptionalName,this.tok=this.scanner.scan());if(p)k=new a.ASTList,this.parseFormalParameterList(d|a.ErrorRecoverySet.RParen,k,!1,!0,!1,!e,e,null),g=this.parseFunctionStatements(d|a.ErrorRecoverySet.RCurly,h,!1,!0,k,a.AllowedElements.FunctionDecls,this.scanner.startPos,!1,
a.Modifiers.None),e&&g.returnTypeAnnotation&&this.reportParseError("Property setters may not declare a return type"),g.fncFlags|=e?a.FncFlags.SetAccessor:a.FncFlags.GetAccessor,g.fncFlags|=a.FncFlags.IsFunctionExpression,g.hint=c,k=new a.BinaryExpression(a.NodeType.Member,h,g),k.minChar=h.minChar,g.nodeType==a.NodeType.FuncDecl&&(g.hint=c);else if(this.tok.tokenId==a.TokenID.Colon)this.tok=this.scanner.scan(),g=this.parseExpr(a.ErrorRecoverySet.Comma|d,a.OperatorPrecedence.Cma,!0,i.NoTypes),g.nodeType==
a.NodeType.TypeRef&&this.reportParseError("Expected 'new' on array declaration in member definition"),k=new a.BinaryExpression(a.NodeType.Member,h,g),k.minChar=h.minChar,g.nodeType==a.NodeType.FuncDecl&&(g.hint=c);else if(this.reportParseError("Expected ':' in member definition"),this.errorRecovery)return this.skip(d),b.flags|=a.ASTFlags.Error,b.minChar=f,b.limChar=this.scanner.lastTokenLimChar(),b;c=null;b.append(k);k.limChar=this.scanner.lastTokenLimChar();if(this.tok.tokenId!=a.TokenID.Comma)break;
else this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RCurly)break}k&&(b.limChar=k.limChar);b.minChar=f;return b};f.prototype.parseArrayList=function(d){var b=null;if(this.tok.tokenId==a.TokenID.RBrack)return b;b=new a.ASTList;b.minChar=this.scanner.startPos;for(var c;;){c=this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RBrack?new a.AST(a.NodeType.EmptyExpr):this.parseExpr(a.ErrorRecoverySet.Comma|d,a.OperatorPrecedence.Cma,!0,i.NoTypes);b.append(c);if(this.tok.tokenId!=
a.TokenID.Comma)break;this.tok=this.scanner.scan()}b.limChar=this.scanner.lastTokenLimChar();return b};f.prototype.parseArrayLiteral=function(d){var b=null;return b=new a.UnaryExpression(a.NodeType.ArrayLit,this.parseArrayList(d))};f.prototype.parseTerm=function(d,b,c,h){var g=null,k=!1,f=!1,e=this.scanner.startPos,m=this.scanner.pos,j=!1;switch(this.tok.tokenId){case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:k=new a.Identifier(a.tokenTable[this.tok.tokenId].text);
g=a.hasFlag(c,i.Primitive)?new a.TypeReference(k,0):k;k=!0;g.minChar=e;this.tok=this.scanner.scan();m=this.scanner.lastTokenLimChar();break;case a.TokenID.THIS:g=new a.AST(a.NodeType.This);g.minChar=e;this.tok=this.scanner.scan();m=this.scanner.lastTokenLimChar();break;case a.TokenID.SUPER:g=new a.AST(a.NodeType.Super);g.minChar=e;this.tok=this.scanner.scan();m=this.scanner.lastTokenLimChar();break;case a.TokenID.TRUE:g=new a.AST(a.NodeType.True);this.tok=this.scanner.scan();g.minChar=e;break;case a.TokenID.FALSE:g=
new a.AST(a.NodeType.False);this.tok=this.scanner.scan();g.minChar=e;break;case a.TokenID.NULL:g=new a.AST(a.NodeType.Null);this.tok=this.scanner.scan();g.minChar=e;break;case a.TokenID.NEW:e=this.scanner.pos;this.tok=this.scanner.scan();g=new a.CallExpression(a.NodeType.New,this.parseTerm(d,!1,i.AllSimpleTypes,h),null);g.minChar=e;m=this.scanner.lastTokenLimChar();f=!0;break;case a.TokenID.FUNCTION:e=this.scanner.pos,g=this.parseFncDecl(d,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,null),g.fncFlags|=
a.FncFlags.IsFunctionExpression,g.minChar=e,m=this.scanner.lastTokenLimChar(),g.limChar=m}if(null==g&&(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))k=this.tok.getText(),g=this.createRef(k,e),k=!0,g.minChar=e,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.QMark?g.flags|=a.ASTFlags.PossibleOptionalParameter:this.tok.tokenId==a.TokenID.Arrow&&(j=!0),m=this.scanner.lastTokenLimChar();h&&this.chkCurTok(a.TokenID.GT,"Expected '>'",d);if(null==g)switch(this.tok.tokenId){case a.TokenID.LParen:e=
this.scanner.pos;j=this.scanner.previousToken().tokenId;this.tok=this.scanner.scan();(j=j==a.TokenID.LParen||j==a.TokenID.Comma||j==a.TokenID.EQ||j==a.TokenID.Colon)&&this.tok.tokenId==a.TokenID.RParen?(j=!0,this.tok=this.scanner.scan()):(g=this.parseExpr(d|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes),m=this.scanner.lastTokenLimChar(),j=j&&(g.nodeType==a.NodeType.Name||g.nodeType==a.NodeType.Comma)&&(this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.QMark));g&&!j&&
(this.chkCurTok(a.TokenID.RParen,"Expected ')'",d),g.isParenthesized=!0);break;case a.TokenID.NumberLit:m=this.tok;this.tok=this.scanner.scan();g=new a.NumberLiteral(m.value);g.minChar=e;m=this.scanner.lastTokenLimChar();break;case a.TokenID.QString:g=new a.StringLiteral(this.tok.getText());this.tok=this.scanner.scan();g.minChar=e;m=this.scanner.lastTokenLimChar();break;case a.TokenID.Regex:g=new a.RegexLiteral(this.tok.regex);this.tok=this.scanner.scan();g.minChar=e;m=this.scanner.lastTokenLimChar();
break;case a.TokenID.LBrack:e=this.scanner.startPos;this.tok=this.scanner.scan();g=this.parseArrayLiteral(a.ErrorRecoverySet.RBrack|d);g.minChar=e;m=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,"Expected ']'",d);break;case a.TokenID.LCurly:e=this.scanner.startPos;this.tok=this.scanner.scan();h=this.parseMemberList(a.ErrorRecoverySet.RCurly|d);this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);g=new a.UnaryExpression(a.NodeType.ObjectLit,h);g.minChar=e;m=this.scanner.lastTokenLimChar();h.minChar=
e;h.limChar=m;break;case a.TokenID.LT:e=this.scanner.startPos;this.tok=this.scanner.scan();h=this.parseTypeReference(a.ErrorRecoverySet.BinOp,!1);this.chkCurTok(a.TokenID.GT,"Expected '>'",d);g=new a.UnaryExpression(a.NodeType.TypeAssertion,this.parseExpr(d,a.OperatorPrecedence.Uni,!1,i.NoTypes));g.castTerm=h;break;default:if(this.prevExpr&&a.hasFlag(this.prevExpr.flags,a.ASTFlags.PossibleOptionalParameter))j=!0,g=this.prevExpr;else if(this.reportParseError("Check format of expression term"),this.errorRecovery){g=
new a.MissingIdentifier;g.minChar=e;g.flags|=a.ASTFlags.Error;this.skip(d|a.ErrorRecoverySet.Postfix);if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))g.text=this.tok.getText(),this.tok=this.scanner.scan();m=this.scanner.lastTokenLimChar()}}j&&(this.tok.tokenId==a.TokenID.Arrow||this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RParen?(g=this.parseFncDecl(d,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:g}),
g.fncFlags|=a.FncFlags.IsFunctionExpression,g.fncFlags|=a.FncFlags.IsFatArrowFunction,g.minChar=e,m=this.scanner.lastTokenLimChar(),g.limChar=m):g&&(g.isParenthesized=!0));k&&c!=i.NoTypes&&(c|=i.ArraySuffix);return(d=this.parsePostfixOperators(d,g,b,f,c,e,m))?(k&&d.nodeType==a.NodeType.Index&&null==d.operand2&&(d=this.convertToTypeReference(d)),d.minChar=e,d.limChar=a.max(d.limChar,this.scanner.lastTokenLimChar()),d):new a.AST(a.NodeType.Error)};f.prototype.parseExpr=function(d,b,c,h){var g=null,
k=a.lookupToken(this.tok.tokenId),f=!0,e=null,m=this.scanner.startPos,j=this.parseComments(),n=!1;if(void 0!=k&&k.unopNodeType!=a.NodeType.None)f=!1,this.tok=this.scanner.scan(),h=this.parseExpr(a.ErrorRecoverySet.BinOp|d,k.unopPrecedence,c,i.NoTypes),k.unopNodeType==a.NodeType.Pos&&h.nodeType==a.NodeType.NumberLit?g=h:k.unopNodeType==a.NodeType.Neg&&h.nodeType==a.NodeType.NumberLit?(h.value=-h.value,0==h.value&&(h.isNegativeZero=!0),g=h):(g=new a.UnaryExpression(k.unopNodeType,h),g.limChar=h.limChar),
g.minChar=m;else{g=this.parseTerm(a.ErrorRecoverySet.BinOp|a.ErrorRecoverySet.AddOp|d,!0,h,!1);if(g.nodeType==a.NodeType.Name)e=g.text;else if(g.nodeType==a.NodeType.Dot){k=!1;if(this.inferPropertiesFromThisAssignment&&((this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Asg)&&this.parsingClassConstructorDefinition&&this.nestingLevel==this.currentClassDefinition.constructorNestingLevel&&g.operand1.nodeType==a.NodeType.This)&&g.operand2.nodeType==a.NodeType.Name)h=g.operand2,this.currentClassDefinition.knownMemberNames[h.text]||
(g=this.parseClassMemberVariableDeclaration(h,g.minChar,!0,d,a.Modifiers.Public),k=!0);if(!k){for(k=g;k.nodeType==a.NodeType.Dot;)k=k.operand2;k.nodeType==a.NodeType.Name&&(e=k.text)}}if(!this.scanner.lastTokenHadNewline()&&(this.tok.tokenId==a.TokenID.Inc||this.tok.tokenId==a.TokenID.Dec))f=!1,k=g,g=new a.UnaryExpression(this.tok.tokenId==a.TokenID.Inc?a.NodeType.IncPost:a.NodeType.DecPost,k),g.limChar=this.scanner.pos,g.minChar=k.minChar,this.tok=this.scanner.scan()}for(;;){k=a.lookupToken(this.tok.tokenId);
if(void 0==k||k.binopNodeType==a.NodeType.None)break;if(!c&&k.binopNodeType==a.NodeType.In)break;if(k.binopPrecedence==a.OperatorPrecedence.Asg){if(k.binopPrecedence<b)break;f||this.reportParseError("illegal assignment")}else if(k.binopPrecedence<=b)break;this.tok=this.scanner.scan();f=!1;k.binopNodeType==a.NodeType.QMark?(this.prevExpr=g,k=this.parseExpr(d|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.Asg,c,i.NoTypes),this.prevExpr=null,k.nodeType==a.NodeType.FuncDecl&&a.hasFlag(k.fncFlags,a.FncFlags.IsFatArrowFunction)?
(g=k,n=!0):(this.chkCurTok(a.TokenID.Colon,"Expected :",d|a.ErrorRecoverySet.ExprStart),g=new a.TrinaryExpression(a.NodeType.QMark,g,k,this.parseExpr(d|a.ErrorRecoverySet.BinOp,a.OperatorPrecedence.Asg,c,i.NoTypes)))):(k=new a.BinaryExpression(k.binopNodeType,g,this.parseExpr(d|a.ErrorRecoverySet.BinOp,k.binopPrecedence,c,i.NoTypes)),k.operand2.nodeType==a.NodeType.FuncDecl&&(k.operand2.hint=e),k.minChar=g.minChar,k.limChar=this.scanner.lastTokenLimChar(),e=null,g=k)}f&&(g.flags|=a.ASTFlags.Writeable);
n||(g.minChar=m,g.limChar=a.max(g.limChar,this.scanner.lastTokenLimChar()),g.preComments=j,g.postComments=this.parseCommentsForLine(this.scanner.line));return g};f.prototype.parsePostfixOperators=function(d,b,c,h,g,k,f){b||(b=new a.AST(a.NodeType.EmptyExpr),b.isParenthesized=!0);b.minChar=k;for(b.limChar=f;;)switch(this.tok.tokenId){case a.TokenID.LParen:if(h)b.args=this.parseArgList(d),h=!1;else{if(!c)return b;b=new a.CallExpression(a.NodeType.Call,b,this.parseArgList(d));b.minChar=k}b.limChar=this.scanner.pos;
this.chkCurTok(a.TokenID.RParen,"Expected ')'",d);break;case a.TokenID.LBrack:this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RBrack&&a.hasFlag(g,i.ArraySuffix)){this.tok=this.scanner.scan();b.nodeType==a.NodeType.TypeRef?b.arrayCount++:b=new a.BinaryExpression(a.NodeType.Index,b,null);b.limChar=this.scanner.pos;break}b=new a.BinaryExpression(a.NodeType.Index,b,this.parseExpr(d|a.ErrorRecoverySet.RBrack,a.OperatorPrecedence.No,!0,i.NoTypes));b.minChar=k;b.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,
"Expected ']'",d);break;case a.TokenID.Dot:f=null;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||!this.scanner.lastTokenHadNewline()&&a.convertTokToIDName(this.tok))b.flags|=a.ASTFlags.DotLHS,f=this.createRef(this.tok.getText(),this.scanner.startPos),f.limChar=this.scanner.pos,this.tok=this.scanner.scan();else{this.reportParseError("Expected identifier following dot");if(this.errorRecovery)return this.skip(d),b.flags|=a.ASTFlags.Error|a.ASTFlags.DotLHS,b;f=new a.MissingIdentifier}b=
new a.BinaryExpression(a.NodeType.Dot,b,f);b.minChar=k;b.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.Arrow:b=this.parseFncDecl(d,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:b});b.fncFlags|=a.FncFlags.IsFunctionExpression;b.minChar=k;b.limChar=this.scanner.lastTokenLimChar();break;default:return b}};f.prototype.parseTry=function(d,b,c,h){var g=this.scanner.startPos,k=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{'"),
this.errorRecovery))return d.minChar=g,d.limChar=this.scanner.lastTokenLimChar(),d.flags|=a.ASTFlags.Error,d;d.body=this.parseStatement(b,c,h);d.minChar=g;d.limChar=d.body.limChar;d.preComments=k;d.postComments=this.parseComments();return d};f.prototype.parseCatch=function(d,b,c){var h=this.scanner.startPos,g=this.parseComments();this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart);if(this.tok.tokenId!=a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode))if(this.reportParseError("Expected identifier in catch header"),this.errorRecovery)return this.skip(d),h=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos,h.flags|=a.ASTFlags.Error,h;var k=new a.VarDecl(new a.Identifier(this.tok.getText()),this.nestingLevel);k.id.minChar=this.scanner.startPos;k.id.limChar=this.scanner.pos;k.minChar=k.id.minChar;k.limChar=k.id.limChar;this.tok=
this.scanner.scan();this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.StmtStart);if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start catch body"),this.errorRecovery))return this.skip(d),h=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos,h.flags|=a.ASTFlags.Error,h;d=this.parseStatement(d,b,c);k=new a.Catch(k,d);k.minChar=h;k.limChar=d.limChar;
k.preComments=g;k.postComments=this.parseComments();return k};f.prototype.parseFinally=function(d,b,c){var h=this.scanner.startPos,g=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start body of finally statement"),this.errorRecovery))return this.skip(d),h=new a.Finally(new a.Statement(a.NodeType.Empty)),h.flags|=a.ASTFlags.Error,h.minChar=this.scanner.startPos,h.limChar=this.scanner.pos,h;d=this.parseStatement(d,b,c);
d=new a.Finally(d);d.minChar=h;d.limChar=d.body.limChar;d.preComments=g;d.postComments=this.parseComments();return d};f.prototype.parseTryCatchFinally=function(d,b,c,h){var g=new a.Try(null),k=this.scanner.startPos;this.pushStmt(g,h);this.parseTry(g,d|a.ErrorRecoverySet.Catch,b,c);this.popStmt();var f=h=null;this.tok.tokenId==a.TokenID.CATCH&&(f=this.parseCatch(d|a.ErrorRecoverySet.Catch,b,c),h=new a.TryCatch(g,f),h.minChar=g.minChar,h.limChar=f.limChar);if(this.tok.tokenId!=a.TokenID.FINALLY)return null==
h?(this.reportParseError("try with neither catch nor finally"),this.errorRecovery?(g=new a.TryFinally(g,new a.Finally(new a.AST(a.NodeType.Empty))),g.flags|=a.ASTFlags.Error,g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos,g):new a.TryFinally(g,new a.Finally(new a.AST(a.NodeType.Empty)))):h;h&&(g=h);d=this.parseFinally(d,b,c);f=new a.TryFinally(g,d);f.minChar=k;f.limChar=d.limChar;return f};f.prototype.parseStatement=function(d,f,c){function h(){return a.hasFlag(m,a.Modifiers.Ambient)||
a.hasFlag(c,a.Modifiers.Ambient)}function g(){a.hasFlag(m,a.Modifiers.Exported)&&this.reportError("Statement may not be exported")}var k=null,e=null,q,m=a.Modifiers.None,j=this.scanner.startPos,n=!1,p=!1;q=null;var r=this.parseComments();for(this.state=b.StartStatement;;){switch(this.tok.tokenId){case a.TokenID.EOF:k=new a.AST(a.NodeType.Error);k.minChar=j;k.limChar=this.scanner.pos;break;case a.TokenID.FUNCTION:this.inStaticFnc&&this.reportParseError("Ambient static function delarations may only contain other ambient static function declarations");
if(this.parsingDeclareFile||h()||this.ambientModule){this.tok=this.scanner.scan();q=this.parsePropertyDecl(d|a.ErrorRecoverySet.SColon,m,!0,!1);if(q.nodeType==a.NodeType.VarDecl)this.reportParseError("function keyword can only introduce function declaration");else if(q.nodeType==a.NodeType.FuncDecl&&(q.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;k=q}else k=this.parseFncDecl(d,!0,!1,!1,null,!1,!1,h(),m,null),a.hasFlag(k.fncFlags,a.FncFlags.IsFatArrowFunction)&&(p=!0),this.ambientModule&&this.reportParseError("function declaration not permitted within ambient module"),
a.hasFlag(m,a.Modifiers.Exported)&&(k.fncFlags|=a.FncFlags.Exported);break;case a.TokenID.MODULE:(f&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):k=this.parseModuleDecl(d,m);break;case a.TokenID.IMPORT:(f&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),
this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):k=this.parseImportDecl(d,m);break;case a.TokenID.EXPORT:(f&a.AllowedElements.ModuleDecls)==a.AllowedElements.None&&(this.reportParseError("'export' statements are only allowed at the global and module levels"),this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar());this.topLevel&&(this.hasTopLevelImportOrExport=!0);m|=a.Modifiers.Exported;
this.tok=this.scanner.scan();break;case a.TokenID.PRIVATE:m|=a.Modifiers.Private;this.tok=this.scanner.scan();if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),j=this.scanner.pos,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=
this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),k=new a.Identifier(this.tok.getText()),k.minChar=this.scanner.startPos,k.limChar=this.scanner.pos,this.tok=this.scanner.scan(),k=this.parseClassMemberVariableDeclaration(k,j,this.parsingClassConstructorDefinition,d,m));else if(this.tok.tokenId!=a.TokenID.INTERFACE){if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<
a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))m|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)))m|=a.Modifiers.Setter,this.prevIDTok=null;q=this.parsePropertyDecl(d|a.ErrorRecoverySet.SColon,m,h(),!1);if(q.nodeType==a.NodeType.VarDecl||q.nodeType==a.NodeType.FuncDecl&&a.hasFlag(q.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;k=q}break;case a.TokenID.PUBLIC:if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),this.tok=this.scanner.scan(),j=this.scanner.pos,
m|=a.Modifiers.Public,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),k=new a.Identifier(this.tok.getText()),k.minChar=this.scanner.startPos,k.limChar=this.scanner.pos,this.tok=this.scanner.scan(),k=this.parseClassMemberVariableDeclaration(k,
j,this.parsingClassConstructorDefinition,d,m));else if((f&a.AllowedElements.Properties)==a.AllowedElements.None)this.reportParseError("'property' statements are only allowed within classes"),this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar();else{m|=a.Modifiers.Public;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))m|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))m|=a.Modifiers.Setter,this.prevIDTok=null;q=this.parsePropertyDecl(d|a.ErrorRecoverySet.SColon,
m,h(),!1);if(q.nodeType==a.NodeType.VarDecl||q.nodeType==a.NodeType.FuncDecl&&a.hasFlag(q.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;k=q}break;case a.TokenID.DECLARE:f&a.AllowedElements.AmbientDecls||this.reportParseError("Ambient declarations are only allowed at the top-level or module scopes");!this.parsingDeclareFile&&a.hasFlag(c,a.Modifiers.Ambient)&&this.reportParseError("Duplicate ambient declaration in this context. (Is the enclosing module or class already ambient?)");m|=a.Modifiers.Ambient;
this.tok=this.scanner.scan();break;case a.TokenID.CLASS:(f&a.AllowedElements.ClassDecls)==a.AllowedElements.None?(this.reportParseError("class not allowed in this context"),this.tok=this.scanner.scan(),k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):k=this.parseClassDecl(d,j,m);break;case a.TokenID.INTERFACE:(f&a.AllowedElements.InterfaceDecls)==a.AllowedElements.None?(this.reportParseError("interface not allowed in this context"),this.tok=this.scanner.scan(),
k=new a.AST(a.NodeType.Error),k.minChar=j,k.limChar=this.scanner.lastTokenLimChar()):k=this.parseInterfaceDecl(d,m);break;case a.TokenID.VAR:p=this.parseVarDecl(d|a.ErrorRecoverySet.StmtStart,m,!0,!1,!1);k=p.nodeType==a.NodeType.VarDecl?p:new a.Block(p,!1);p=!0;if(this.parsingDeclareFile||this.ambientModule&&k.nodeType==a.NodeType.VarDecl)k.varFlags|=a.VarFlags.Exported;break;case a.TokenID.STATIC:null==this.currentClassDecl&&this.reportParseError("Statics may only be class members");g();m|=a.Modifiers.Public;
this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))m|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))m|=a.Modifiers.Setter;h()&&(m|=a.Modifiers.Ambient);q=this.parsePropertyDecl(d|a.ErrorRecoverySet.SColon,m,this.parsingDeclareFile||(m&a.Modifiers.Ambient)!=a.Modifiers.None,!0);(k=this.topStaticsList())&&q.nodeType==a.NodeType.VarDecl&&k.append(q);if(q.nodeType==a.NodeType.VarDecl||q.nodeType==a.NodeType.FuncDecl&&a.hasFlag(q.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;k=q;break;case a.TokenID.FOR:g();m!=a.Modifiers.None&&
this.reportParseError("syntax error: for statement does not take modifiers");j=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);this.state=b.ForInit;n=!0;switch(this.tok.tokenId){case a.TokenID.VAR:q=this.parseVarDecl(d|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,a.Modifiers.None,!1,!1,!1);break;case a.TokenID.SColon:q=null;this.state=b.ForCondStart;break;default:q=this.parseExpr(d|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,
a.OperatorPrecedence.No,!1,i.NoTypes)}this.state=b.ForInitAfterVar;this.tok.tokenId==a.TokenID.IN?null==q||!n?(this.reportParseError("malformed for statement"),this.errorRecovery&&(this.skip(d|a.ErrorRecoverySet.StmtStart),k=new a.AST(a.NodeType.Empty),k.flags|=a.ASTFlags.Error)):(this.tok=this.scanner.scan(),k=new a.ForInStatement(q,this.parseExpr(a.ErrorRecoverySet.RParen|d,a.OperatorPrecedence.Cma,!1,i.NoTypes)),k.limChar=this.scanner.pos,this.chkCurTok(a.TokenID.RParen,"Expected ')'",a.ErrorRecoverySet.StmtStart|
d),this.pushStmt(k,e),k.body=this.parseStatement(d,f,c),this.popStmt(),k.minChar=j):(q=new a.ForStatement(q),q.minChar=j,this.chkCurTok(a.TokenID.SColon,"Expected ';'",d),this.tok.tokenId==a.TokenID.SColon?q.cond=null:(q.cond=this.parseExpr(d|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes),this.tok.tokenId!=a.TokenID.SColon&&(this.skip(d|a.ErrorRecoverySet.StmtStart),k=q,k.flags|=a.ASTFlags.Error)),this.tok=this.scanner.scan(),q.incr=this.tok.tokenId==a.TokenID.RParen?
null:this.parseExpr(d|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes),this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.LCurly),this.pushStmt(q,e),q.body=this.parseStatement(d,f,c),this.popStmt(),q.limChar=q.body.limChar,k=q);break;case a.TokenID.WITH:a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("'with' statements are only available in ES5 codegen mode or better");this.strictMode&&this.reportParseError("'with' statements are not available in strict mode");
g();m!=a.Modifiers.None&&this.reportParseError("'with' statement does not take modifiers");j=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);k=this.parseExpr(d|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,i.NoTypes);this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.LCurly);k=new a.WithStatement(k);k.body=this.parseStatement(d,f,c);k.minChar=j;k.limChar=k.body.limChar;break;case a.TokenID.SWITCH:g();
m!=a.Modifiers.None&&this.reportParseError("'switch' statement does not take modifiers");this.chkNxtTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart);k=new a.SwitchStatement(this.parseExpr(d|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes));this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.LCurly);q=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",d|a.ErrorRecoverySet.SCase);k.defaultCase=null;k.caseList=new a.ASTList;n=null;for(this.pushStmt(k,
e);;)if(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT){var t=this.tok.tokenId==a.TokenID.DEFAULT,n=new a.CaseStatement;n.minChar=this.scanner.startPos;this.tok=this.scanner.scan();t?k.defaultCase=n:n.expr=this.parseExpr(d|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,i.NoTypes);this.chkCurTok(a.TokenID.Colon,"Expected ':'",d|a.ErrorRecoverySet.StmtStart);n.body=new a.ASTList;this.parseStmtList(d|a.ErrorRecoverySet.RCurly,n.body,!1,!0,f,m);n.limChar=n.body.limChar;k.caseList.append(n)}else break;
k.caseList.minChar=q;k.caseList.limChar=this.scanner.pos;k.limChar=k.caseList.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);this.popStmt();break;case a.TokenID.WHILE:g();m!=a.Modifiers.None&&this.reportParseError("'while' statement does not take modifiers");j=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",a.ErrorRecoverySet.ExprStart|d);k=new a.WhileStatement(this.parseExpr(d|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes));k.minChar=j;this.chkCurTok(a.TokenID.RParen,
"Expected ')'",d|a.ErrorRecoverySet.StmtStart);this.pushStmt(k,e);k.body=this.parseStatement(d,f,c);k.limChar=k.body.limChar;this.popStmt();break;case a.TokenID.DO:g();m!=a.Modifiers.None&&this.reportParseError("'do' statement does not take modifiers");j=this.scanner.startPos;this.tok=this.scanner.scan();k=new a.DoWhileStatement;k.minChar=j;this.pushStmt(k,e);k.body=this.parseStatement(d|a.ErrorRecoverySet.While,f,c);this.popStmt();k.whileAST=new a.Identifier("while");k.whileAST.minChar=this.scanner.startPos;
this.chkCurTok(a.TokenID.WHILE,"Expected 'while'",d|a.ErrorRecoverySet.LParen);k.whileAST.limChar=k.whileAST.minChar+5;this.chkCurTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart);k.cond=this.parseExpr(d|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,i.NoTypes);k.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",d);this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan());break;case a.TokenID.IF:g();m!=a.Modifiers.None&&this.reportParseError("if statement does not take modifiers");
j=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",d|a.ErrorRecoverySet.ExprStart);k=new a.IfStatement(this.parseExpr(d|a.ErrorRecoverySet.LParen,a.OperatorPrecedence.No,!0,i.NoTypes));k.minChar=j;this.chkCurTok(a.TokenID.RParen,"Expected ')'",d|a.ErrorRecoverySet.StmtStart);this.pushStmt(k,e);k.thenBod=this.parseStatement(a.ErrorRecoverySet.Else|d,f,c);k.limChar=k.thenBod.limChar;this.tok.tokenId==a.TokenID.ELSE&&(this.tok=this.scanner.scan(),k.elseBod=this.parseStatement(d,f,
c),k.limChar=k.elseBod.limChar);this.popStmt();break;case a.TokenID.TRY:g();m!=a.Modifiers.None&&this.reportParseError("try statement does not take modifiers");j=this.scanner.startPos;k=this.parseTryCatchFinally(d,a.AllowedElements.FunctionBody,c,e);break;case a.TokenID.LCurly:g();m!=a.Modifiers.None&&this.reportParseError("block does not take modifiers");j=this.scanner.startPos;this.tok=this.scanner.scan();k=new a.Block(new a.ASTList,!0);this.pushStmt(k,e);this.parseStmtList(d|a.ErrorRecoverySet.RCurly,
k.stmts,!1,!1,a.AllowedElements.Block,m);this.popStmt();k.stmts.minChar=j;k.stmts.limChar=this.scanner.pos;k.minChar=k.stmts.minChar;k.limChar=k.stmts.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",d);break;case a.TokenID.SColon:g();m!=a.Modifiers.None&&this.reportParseError("modifier can not appear here");k=new a.AST(a.NodeType.Empty);this.tok=this.scanner.scan();break;case a.TokenID.BREAK:case a.TokenID.CONTINUE:g();m!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before jump statement");
p=new a.Jump(this.tok.tokenId==a.TokenID.BREAK?a.NodeType.Break:a.NodeType.Continue);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID&&!this.scanner.lastTokenHadNewline()&&(p.target=this.tok.getText(),this.tok=this.scanner.scan());this.resolveJumpTarget(p);k=p;p=!0;break;case a.TokenID.RETURN:g();m!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before return statement");this.inFnc||this.reportParseError("return statement outside of function body");j=this.scanner.startPos;
this.tok=this.scanner.scan();k=new a.ReturnStatement;k.minChar=j;this.tok.tokenId!=a.TokenID.SColon&&(this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline())&&(k.returnExpression=this.parseExpr(d|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,i.NoTypes));p=!0;k.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.THROW:g();m!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before a throw statement");j=this.scanner.startPos;this.tok=this.scanner.scan();
this.tok.tokenId!=a.TokenID.SColon&&this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline()?q=this.parseExpr(d|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,i.NoTypes):(this.reportParseError("throw with no target"),q=null);k=new a.UnaryExpression(a.NodeType.Throw,q);k.limChar=this.scanner.lastTokenLimChar();p=!0;break;case a.TokenID.ENUM:this.tok=this.scanner.scan();k=this.parseEnumDecl(d,m);k.minChar=j;k.limChar=this.scanner.lastTokenLimChar();if(this.parsingDeclareFile||a.hasFlag(m,
a.Modifiers.Ambient))k.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(m,a.Modifiers.Exported)&&(k.modFlags|=a.ModuleFlags.Exported);break;case a.TokenID.DEBUGGER:g();m!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before debugger statement");j=this.scanner.startPos;this.tok=this.scanner.scan();k=new a.DebuggerStatement;k.minChar=j;p=!0;k.limChar=this.scanner.lastTokenLimChar();break;default:m!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before an expression statement or label"),
j=this.scanner.startPos,n=this.scanner.pos,q=this.parseExpr(a.ErrorRecoverySet.Colon|a.ErrorRecoverySet.StmtStart|d,a.OperatorPrecedence.No,!0,i.NoTypes),this.scanner.pos==n?(this.tok=this.scanner.scan(),k=q):this.tok.tokenId==a.TokenID.Colon&&!this.scanner.lastTokenHadNewline()&&q&&q.nodeType==a.NodeType.Name?(null==e&&(e=new a.ASTList),e.append(new a.Label(q)),this.tok=this.scanner.scan()):(k=q,p=!0)}if(k)break}if(p)switch(this.tok.tokenId){case a.TokenID.SColon:this.tok=this.scanner.scan();k.flags|=
a.ASTFlags.ExplicitSemicolon;break;case a.TokenID.EOF:case a.TokenID.RCurly:k.flags|=a.ASTFlags.AutomaticSemicolon;this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon");break;default:this.scanner.lastTokenHadNewline()?(k.flags|=a.ASTFlags.AutomaticSemicolon,this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon")):this.reportParseError("Expected ';'")}e&&(k=new a.LabeledStatement(e,k));k.minChar=j;k.limChar=a.max(k.limChar,this.scanner.lastTokenLimChar());
k.preComments=r;this.ambientModule&&!this.okAmbientModuleMember(k)&&this.reportParseError("statement not permitted within ambient module");k.flags|=a.ASTFlags.IsStatement;return k};f.prototype.okAmbientModuleMember=function(d){var b=d.nodeType;return b==a.NodeType.Class||b==a.NodeType.Import||b==a.NodeType.Interface||b==a.NodeType.Module||b==a.NodeType.Empty||b==a.NodeType.VarDecl&&(a.hasFlag(d.varFlags,a.VarFlags.Property)||a.hasFlag(d.varFlags,a.VarFlags.Exported))||b==a.NodeType.FuncDecl&&d.isMethod()};
f.prototype.parseStmtList=function(d,f,c,h,g,k){f.minChar=this.scanner.startPos;var e=this.scanner.pos,q=(g&a.AllowedElements.ModuleDecls)==a.AllowedElements.None,m=(g&a.AllowedElements.ClassDecls)==a.AllowedElements.None,d=d|a.ErrorRecoverySet.TypeScriptS|a.ErrorRecoverySet.RCurly;this.state=b.StartStmtList;var j=this.strictMode;for(this.nestingLevel++;;){if(this.tok.tokenId==a.TokenID.RCurly||h&&(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT)||q&&this.tok.tokenId==a.TokenID.EXPORT||
m&&this.tok.tokenId==a.TokenID.CLASS||this.tok.tokenId==a.TokenID.EOF){this.state=b.EndStmtList;f.limChar=e;0==f.members.length?f.preComments=this.parseComments():f.postComments=this.parseComments();this.strictMode=j;this.nestingLevel--;break}var i=this.parseStatement(d&~(a.ErrorRecoverySet.Else|a.ErrorRecoverySet.RParen|a.ErrorRecoverySet.Catch|a.ErrorRecoverySet.Colon),g,k);i&&(i.postComments=this.combineComments(i.postComments,this.parseCommentsForLine(this.scanner.prevLine)),f.append(i),e=i.limChar,
c&&(i.nodeType==a.NodeType.QString?"use strict"==i.text?(f.flags|=a.ASTFlags.StrictMode,this.strictMode=!0):c=!1:c=!1))}};f.prototype.quickParse=function(d,b,c){var h=a.moduleGenTarget;try{a.moduleGenTarget=a.ModuleGenTarget.Local;var g=this.parse(d,b,c,a.AllowedElements.QuickParse);return new j(g,this.scanner.lexState)}finally{a.moduleGenTarget=h}};f.prototype.parse=function(d,f,c,h){"undefined"===typeof h&&(h=a.AllowedElements.Global);this.ambientModule=!1;this.topLevel=!0;this.hasTopLevelImportOrExport=
this.parseError=!1;this.fname=f;this.currentUnitIndex=c;this.amdDependencies=[];this.scanner.resetComments();this.scanner.setSourceText(d,a.LexMode.File);var d=this.scanner.leftCurlyCount,g=this.scanner.rightCurlyCount,k=this.scanner.pos;this.tok=this.scanner.scan();this.pushDeclLists();var e=new a.ASTList;e.minChar=k;this.state=b.StartScript;this.parsingDeclareFile=a.isDSTRFile(f)||a.isDTSFile(f);this.parseStmtList(a.ErrorRecoverySet.EOF|a.ErrorRecoverySet.Func,e,!0,!1,h,a.Modifiers.None);this.tok.tokenId!=
a.TokenID.EOF&&this.reportParseError("Unexpected statement block terminator '"+a.tokenTable[this.tok.tokenId].text+"'");this.state=b.EndScript;e.limChar=this.scanner.pos;h=null;if(a.moduleGenTarget!=a.ModuleGenTarget.Local&&this.hasTopLevelImportOrExport){var q=a.switchToForwardSlashes(f),h=new a.Identifier(q),h=new a.ModuleDecl(h,e,this.topVarList(),this.topScopeList());h.modFlags|=a.ModuleFlags.IsDynamic;h.modFlags|=a.ModuleFlags.IsWholeFile;h.modFlags|=a.ModuleFlags.Exported;this.parsingDeclareFile&&
(h.modFlags|=a.ModuleFlags.Ambient);h.minChar=k;h.limChar=this.scanner.pos;h.prettyName=a.getPrettyName(q);h.amdDependencies=this.amdDependencies;e=new a.ASTList;e.minChar=h.minChar;e.limChar=h.limChar;e.append(h)}q=new a.Script(this.topVarList(),this.topScopeList());q.bod=e;this.popDeclLists();q.minChar=k;q.limChar=this.scanner.pos;q.locationInfo=new a.LocationInfo(f,this.scanner.lineMap,c);q.leftCurlyCount=this.scanner.leftCurlyCount-d;q.rightCurlyCount=this.scanner.rightCurlyCount-g;q.isDeclareFile=
this.parsingDeclareFile;q.topLevelMod=h;return q};a.Parser=f;a.quickParse=function(b,e,c,h,g,k){e=c.getText(h,g);b.log("Quick parse range ("+h+","+g+'): "'+a.stringToLiteral(e,100)+'"');b=new f;b.setErrorRecovery(null,-1,-1);b.errorCallback=k;k=new a.TypeDecl(a.NodeType.Class,null,null,null,null,null);b.currentClassDecl=k;return b.quickParse(new a.StringSourceText(e),"",0)}})(TypeScript||(TypeScript={}));
(function(a){var e=function(a,b){this.outfile=a;this.parser=b;this.builder="";this.indent1="  ";this.indentStrings=[];this.indentAmt=0};e.prototype.increaseIndent=function(){this.indentAmt++};e.prototype.decreaseIndent=function(){this.indentAmt--};e.prototype.startLine=function(){0<this.builder.length&&a.CompilerDiagnostics.Alert(this.builder);var e=this.indentStrings[this.indentAmt];if(void 0===e){for(var e="",b=0;b<this.indentAmt;b++)e+=this.indent1;this.indentStrings[this.indentAmt]=e}this.builder+=
e};e.prototype.write=function(a){this.builder+=a};e.prototype.writeLine=function(a){this.builder+=a;this.outfile.WriteLine(this.builder);this.builder=""};a.PrintContext=e;a.prePrintAST=function(a,b,e){b=e.state;a.print(b);b.increaseIndent();return a};a.postPrintAST=function(a,b,e){e.state.decreaseIndent();return a}})(TypeScript||(TypeScript={}));
(function(a){function e(){a.initializeStaticTokens();l[a.LexCodeLPR]=a.staticTokens[a.TokenID.LParen];l[a.LexCodeRPR]=a.staticTokens[a.TokenID.RParen];l[a.LexCodeCMA]=a.staticTokens[a.TokenID.Comma];l[a.LexCodeSMC]=a.staticTokens[a.TokenID.SColon];l[a.LexCodeLBR]=a.staticTokens[a.TokenID.LBrack];l[a.LexCodeRBR]=a.staticTokens[a.TokenID.RBrack];l[a.LexCodeTIL]=a.staticTokens[a.TokenID.Tilde];l[a.LexCodeQUE]=a.staticTokens[a.TokenID.QMark];l[a.LexCodeLC]=a.staticTokens[a.TokenID.LCurly];l[a.LexCodeRC]=
a.staticTokens[a.TokenID.RCurly];l[a.LexCodeCOL]=a.staticTokens[a.TokenID.Colon];a.LexKeywordTable=new a.StringHashTable;for(var b in a.TokenID._map)b<=a.TokenID.LimKeyword&&a.LexKeywordTable.add(a.TokenID._map[b].toLowerCase(),b);for(b=0;128>b;b++)c[b]=i(b)?!0:!1}function i(c){return 97<=c&&122>=c||65<=c&&90>=c||c==a.LexCodeDollar||c==a.LexCodeUnderscore}function b(a){return 48<=a&&57>=a}function j(c,b,d){if(c.tokenId<=a.TokenID.LimKeyword)if(c=a.lookupToken(c.tokenId),void 0!=c){var h=a.Reservation.Javascript|
a.Reservation.JavascriptFuture;d&&(h|=a.Reservation.JavascriptFutureStrict);if(b||!a.hasFlag(c.reservation,h))return!0}else return!1;else return!1}function f(a,c){if(-1===c)return 0;for(var b=0,d=a.length-1;b<d;){var h=b+d>>1;c<a[h]?d=h-1:b=c<a[h+1]?d=h:h+1}return b}function d(a,c,b){var d=f(b,c);0<d&&(a.line=d,a.col=c-b[d])}a.LexEOF=-1;a.LexCodeNWL=10;a.LexCodeRET=13;a.LexCodeTAB=9;a.LexCodeVTAB=11;a.LexCode_e=101;a.LexCode_E=69;a.LexCode_x=120;a.LexCode_X=88;a.LexCode_a=97;a.LexCode_A=65;a.LexCode_f=
102;a.LexCode_F=70;a.LexCode_g=103;a.LexCode_m=109;a.LexCode_i=105;a.LexCode_0=48;a.LexCode_9=57;a.LexCode_8=56;a.LexCode_7=55;a.LexCodeBSL=92;a.LexCodeSHP=35;a.LexCodeBNG=33;a.LexCodeQUO=34;a.LexCodeAPO=39;a.LexCodePCT=37;a.LexCodeAMP=38;a.LexCodeLPR=40;a.LexCodeRPR=41;a.LexCodePLS=43;a.LexCodeMIN=45;a.LexCodeMUL=42;a.LexCodeSLH=47;a.LexCodeXOR=94;a.LexCodeCMA=44;a.LexCodeDOT=46;a.LexCodeLT=60;a.LexCodeEQ=61;a.LexCodeGT=62;a.LexCodeQUE=63;a.LexCodeLBR=91;a.LexCodeRBR=93;a.LexCodeUSC=95;a.LexCodeLC=
123;a.LexCodeRC=125;a.LexCodeBAR=124;a.LexCodeTIL=126;a.LexCodeCOL=58;a.LexCodeSMC=59;a.LexCodeUnderscore=95;a.LexCodeDollar=36;a.LexCodeSpace=32;a.LexKeywordTable=void 0;var l=Array(128),c=Array(128);a.LexInitialize=e;a.LexAdjustIndent=function(c,b){return c==a.LexCodeLBR||c==a.LexCodeLC||c==a.LexCodeLPR?b+1:c==a.LexCodeRBR||c==a.LexCodeRC||c==a.LexCodeRPR?b-1:b};a.LexIsIdentifierStartChar=i;a.LexIsDigit=b;a.LexIsIdentifierChar=function(a){return c[a]||b(a)};a.LexMatchingOpen=function(c){return c==
a.LexCodeRBR?a.LexCodeLBR:c==a.LexCodeRC?a.LexCodeLC:c==a.LexCodeRPR?a.LexCodeLPR:0};var h=a.NumberScanState||(a.NumberScanState={});h._map=[];h._map[0]="Start";h.Start=0;h._map[1]="InFraction";h.InFraction=1;h._map[2]="InExponent";h.InExponent=2;var g=a.NumberScanState,h=a.LexState||(a.LexState={});h._map=[];h._map[0]="Start";h.Start=0;h._map[1]="InMultilineComment";h.InMultilineComment=1;var k=a.LexState,h=a.LexMode||(a.LexMode={});h._map=[];h._map[0]="Line";h.Line=0;h._map[1]="File";h.File=1;var v=
a.LexMode,h=a.CommentStyle||(a.CommentStyle={});h._map=[];h._map[0]="Line";h.Line=0;h._map[1]="Block";h.Block=1;var q=function(a){this.text=a};q.prototype.getText=function(a,c){return this.text.substring(a,c)};q.prototype.getLength=function(){return this.text.length};a.StringSourceText=q;var m=function(a,c,b){this.segmentStart=a;this.segmentEnd=c;this.segment=b};m.prototype.charCodeAt=function(a){return this.segment.charCodeAt(a-this.segmentStart)};m.prototype.substring=function(a,c){return this.segment.substring(a-
this.segmentStart,c-this.segmentStart)};a.SourceTextSegment=m;var s=function(a,c){this.seg1=a;this.seg2=c};s.prototype.charCodeAt=function(a){return this.seg1.segmentStart<=a&&a<this.seg1.segmentEnd?this.seg1.segment.charCodeAt(a-this.seg1.segmentStart):this.seg2.segment.charCodeAt(a-this.seg2.segmentStart)};s.prototype.substring=function(a,c){return this.seg1.segmentStart<=a&&c<=this.seg1.segmentEnd?this.seg1.segment.substring(a-this.seg1.segmentStart,c-this.seg1.segmentStart):this.seg2.segment.substring(a-
this.seg2.segmentStart)+this.seg1.segment.substring(0,c-this.seg1.segmentStart)};a.AggerateSourceTextSegment=s;var n=function(a){this.sourceText=a;this.agg=new s(n.emptySegment,n.emptySegment);this.len=this.sourceText.getLength()};n.emptySegment=new m(0,0,"");n.prototype.max=function(a,c){return a>=c?a:c};n.prototype.min=function(a,c){return a<=c?a:c};n.prototype.fetchSegment=function(c,b){if(this.agg.seg1.segmentStart<=c&&b<=this.agg.seg1.segmentEnd)return this.agg.seg1;if(this.agg.seg2.segmentStart<=
c&&b<=this.agg.seg1.segmentEnd)return this.agg;var d=this.agg.seg1,h=d.segmentEnd,g=a.max(h+512,b),g=a.min(g,this.len),f=this.sourceText.getText(h,g),h=new m(h,g,f);this.agg.seg2=d;this.agg.seg1=h;return this.agg};n.prototype.charCodeAt=function(a){return this.fetchSegment(a,a+1).charCodeAt(a)};n.prototype.substring=function(a,c){return this.fetchSegment(a,c).substring(a,c)};a.ScannerTextStream=n;h=function(){this.prevToken=this.prevSavedToken=this.curSavedToken=this.prevToken=null;this.currentToken=
0;this.tokens=[];this.line=this.prevLine=1;this.col=0;this.lexState=k.Start;this.commentStack=[]};h.prototype.previousToken=function(){return this.prevToken};h.prototype.close=function(){this.currentToken=0};h.prototype.addToken=function(c,b){this.tokens[this.currentToken++]=new a.SavedToken(c,b.startPos,b.pos)};h.prototype.scan=function(){this.startLine=this.line;this.startPos=this.col;if(this.currentTokenIndex==this.currentTokens.length)if(this.line<this.lineMap.length)this.line++,this.currentTokenIndex=
this.col=0,this.currentTokens=this.tokensByLine[this.line];else return a.staticTokens[a.TokenID.EOF];if(this.currentTokenIndex<this.currentTokens.length){this.prevToken=this.curSavedToken.tok;this.prevSavedToken=this.curSavedToken;this.curSavedToken=this.currentTokens[this.currentTokenIndex++];var c=this.curSavedToken.tok;this.pos=this.curSavedToken.limChar;this.col+=this.curSavedToken.limChar-this.curSavedToken.minChar;this.startPos=this.curSavedToken.minChar;this.prevLine=this.line;return c}return a.staticTokens[a.TokenID.EOF]};
h.prototype.syncToTok=function(a){this.line=f(this.lineMap,a);this.currentTokenIndex=0;for(a-=this.lineMap[this.line];this.lexStateByLine[this.line]==k.InMultilineComment&&0<this.line;)this.line--,a=0;var c=this.lineMap.length-1;for(this.currentTokens=this.tokensByLine[this.line];0==this.currentTokens.length&&this.line<c;)this.line++,this.currentTokens=this.tokensByLine[this.line],a=0;if(this.line<=c){for(;this.currentTokenIndex<this.currentTokens.length&&a>this.currentTokens[this.currentTokenIndex].limChar;)this.currentTokenIndex++;
if(this.currentTokenIndex<this.currentTokens.length)return this.col=this.currentTokens[this.currentTokenIndex].minChar,this.col+this.lineMap[this.line]}return-1};h.prototype.lastTokenLimChar=function(){return null!==this.prevSavedToken?this.prevSavedToken.limChar:0};h.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};h.prototype.pushComment=function(a){this.commentStack.push(a)};h.prototype.getComments=function(){var a=this.commentStack;this.commentStack=[];return a};
h.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};h.prototype.resetComments=function(){this.commentStack=[]};h.prototype.setSourceText=function(){};a.SavedTokens=h;h=function(){this.line=this.prevLine=1;this.len=this.startPos=this.pos=this.col=0;this.lineMap=[];this.ch=a.LexEOF;this.lexState=k.Start;this.mode=v.File;this.scanComments=!0;this.interveningWhitespace=
!1;this.rightCurlyCount=this.leftCurlyCount=this.interveningWhitespacePos=0;this.commentStack=[];this.saveScan=null;this.prevTok=a.staticTokens[a.TokenID.EOF];this.startCol=this.col;this.startLine=this.line;this.lineMap[1]=0;a.LexKeywordTable||e()};h.prototype.previousToken=function(){return this.prevTok};h.prototype.setSourceText=function(a,c){this.mode=c;this.scanComments=this.mode===v.Line;this.startPos=this.interveningWhitespacePos=this.pos=0;this.line=1;this.startCol=this.col=0;this.startLine=
this.line;this.len=0;this.src=a.getText(0,a.getLength());this.len=this.src.length;this.lineMap=[];this.lineMap[1]=0;this.commentStack=[];this.rightCurlyCount=this.leftCurlyCount=0};h.prototype.setSaveScan=function(a){this.saveScan=a};h.prototype.setText=function(a,c){this.setSourceText(new q(a),c)};h.prototype.setScanComments=function(a){this.scanComments=a};h.prototype.getLexState=function(){return this.lexState};h.prototype.scanLine=function(c,b){this.lexState=b;var d=[];this.setText(c,v.Line);
for(var h=this.scan();h.tokenId!=a.TokenID.EOF;)d[d.length]=h,h=this.scan();return d};h.prototype.tokenStart=function(){this.startPos=this.pos;this.startLine=this.line;this.startCol=this.col;this.interveningWhitespace=!1};h.prototype.peekChar=function(){return this.pos<this.len?this.src.charCodeAt(this.pos):a.LexEOF};h.prototype.peekCharAt=function(c){return c<this.len?this.src.charCodeAt(c):a.LexEOF};h.prototype.IsHexDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_9||c>=a.LexCode_A&&c<=a.LexCode_F||
c>=a.LexCode_a&&c<=a.LexCode_f};h.prototype.IsOctalDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_7||c>=a.LexCode_a&&c<=a.LexCode_f};h.prototype.scanHexDigits=function(){for(var c=!1;;)if(this.IsHexDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,this.pos))):null};h.prototype.scanOctalDigits=function(){for(var c=!1;;)if(this.IsOctalDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,
this.pos))):null};h.prototype.scanDecimalNumber=function(c){for(var d=!1,h=this.pos,f=this.col;;)if(b(this.ch))d=!0,this.nextChar();else if(this.ch==a.LexCodeDOT)if(c==g.Start)this.nextChar(),c=g.InFraction;else{if(d)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=h;this.col=f;return null}else if(this.ch==a.LexCode_e||this.ch==a.LexCode_E)if(c==g.Start)if(d)d=!1,this.nextChar(),c=g.InExponent;else return this.pos=h,this.col=f,null;else if(c==g.InFraction)this.nextChar(),
c=g.InExponent,d=!1;else{if(d)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=h;this.col=f;return null}else if(this.ch==a.LexCodePLS||this.ch==a.LexCodeMIN)if(c==g.InExponent){if(d)return this.pos=h,this.col=f,null;this.nextChar()}else{if(c==g.InFraction||d)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=h;this.col=f;return null}else{if(d)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));
this.pos=h;this.col=f;return null}};h.prototype.scanNumber=function(){if(this.peekChar()==a.LexCode_0)switch(this.peekCharAt(this.pos+1)){case a.LexCode_x:case a.LexCode_X:return this.advanceChar(2),this.scanHexDigits();case a.LexCode_8:case a.LexCode_9:case a.LexCodeDOT:return this.scanDecimalNumber(g.Start);default:return this.scanOctalDigits()}else return this.scanDecimalNumber(g.Start)};h.prototype.scanFraction=function(){return this.scanDecimalNumber(g.InFraction)};h.prototype.newLine=function(){this.col=
0;this.mode==v.File&&(this.line++,this.lineMap[this.line]=this.pos+1)};h.prototype.finishMultilineComment=function(){var c;for(this.lexState=k.InMultilineComment;this.pos<this.len;){if(this.ch==a.LexCodeMUL){if(c=this.peekCharAt(this.pos+1),c==a.LexCodeSLH)return this.advanceChar(2),this.mode==v.File&&this.tokenStart(),this.lexState=k.Start,!0}else if(this.ch==a.LexCodeNWL&&(this.newLine(),this.mode==v.Line)){this.nextChar();break}this.nextChar()}return!1};h.prototype.pushComment=function(a){this.commentStack.push(a)};
h.prototype.getComments=function(){var a=this.commentStack;this.commentStack=[];return a};h.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};h.prototype.resetComments=function(){this.commentStack=[]};h.prototype.endsLine=function(c){return c==a.LexCodeNWL||c==a.LexCodeRET||8232==c||8233==c};h.prototype.finishSinglelineComment=function(){for(;this.pos<
this.len&&!this.endsLine(this.ch);)this.nextChar();this.mode==v.File&&this.tokenStart()};h.prototype.tokenText=function(){return this.src.substring(this.startPos,this.pos)};h.prototype.findClosingSLH=function(){for(var c=this.pos,b=this.src.charCodeAt(c),d=0,h=!1;!this.endsLine(b)&&c<this.len;){if(b==a.LexCodeSLH&&!h)return c;d=b;c++;h=h?!1:d==a.LexCodeBSL;b=this.src.charCodeAt(c)}return-1};h.prototype.speculateRegex=function(){if(void 0!=a.noRegexTable[this.prevTok.tokenId])return null;var c=this.pos,
b=this.col,d=this.findClosingSLH();if(0<d){var h=this.src.substring(c,d),g="";this.pos=d+1;this.ch=this.peekChar();for(g=this.pos;this.ch==a.LexCode_i||this.ch==a.LexCode_g||this.ch==a.LexCode_m;)this.nextChar();if(3<this.pos-g)return null;g=this.src.substring(g,this.pos);d=void 0;try{d=RegExp(h,g)}catch(f){}if(d)return this.col=b+(this.pos-this.startPos),new a.RegexToken(d)}this.pos=c;this.col=b;return null};h.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};h.prototype.lastTokenLimChar=
function(){return this.interveningWhitespace?this.interveningWhitespacePos:this.startPos};h.prototype.advanceChar=function(a){this.pos+=a;this.col+=a;this.ch=this.peekChar()};h.prototype.nextChar=function(){this.pos++;this.col++;this.ch=this.peekChar()};h.prototype.scan=function(){if(this.lexState==k.InMultilineComment&&this.scanComments){this.ch=this.peekChar();var c=this.line;this.finishMultilineComment();if(this.startPos<this.pos){var b=this.src.substring(this.startPos,this.pos);this.tokenStart();
return new a.CommentToken(a.TokenID.Comment,b,!0,this.startPos,c,!0)}return a.staticTokens[a.TokenID.EOF]}this.prevLine=this.line;this.prevTok=this.innerScan();this.saveScan&&this.saveScan.addToken(this.prevTok,this);return this.prevTok};h.prototype.innerScan=function(){var d;this.tokenStart();for(this.ch=this.peekChar();this.pos<this.len;){if(c[this.ch]){do this.nextChar();while(c[this.ch]||b(this.ch));var h=this.src.substring(this.startPos,this.pos);return null!=(d=a.LexKeywordTable.lookup(h))?
a.staticTokens[d]:new a.StringToken(a.TokenID.ID,h)}if(this.ch==a.LexCodeSpace){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos);do this.nextChar();while(this.ch==a.LexCodeSpace);if(this.mode==v.Line)return d=this.src.substring(this.startPos,this.pos),new a.WhitespaceToken(a.TokenID.Whitespace,d);this.tokenStart();this.interveningWhitespace=!0}else if(this.ch==a.LexCodeSLH){this.nextChar();var g;if(this.ch==a.LexCodeSLH){this.interveningWhitespace||(this.interveningWhitespacePos=
this.pos-1);var h=this.pos-1,f=this.line;this.finishSinglelineComment();g=this.src.substring(h,this.pos);g=new a.CommentToken(a.TokenID.Comment,g,!1,h,f,!1);if(this.scanComments)return this.startPos=h,g;this.pushComment(g);this.interveningWhitespace=!0}else if(this.ch==a.LexCodeMUL){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos-1);h=this.pos-1;f=this.line;this.nextChar();this.finishMultilineComment();g=this.src.substring(h,this.pos);var e=this.peekChar()==a.LexCodeNWL||this.peekChar()==
a.LexCodeRET;g=new a.CommentToken(a.TokenID.Comment,g,!0,h,f,e);if(this.scanComments)return this.startPos=h,g;this.pushComment(g);this.interveningWhitespace=!0}else return(d=this.speculateRegex())?d:this.peekCharAt(this.pos)==a.LexCodeEQ?(this.nextChar(),a.staticTokens[a.TokenID.AsgDiv]):a.staticTokens[a.TokenID.Div]}else{if(this.ch==a.LexCodeSMC)return this.nextChar(),a.staticTokens[a.TokenID.SColon];if(this.ch==a.LexCodeAPO||this.ch==a.LexCodeQUO){d=this.ch;h=0;g=!1;do h=this.ch,g=g?!1:h==a.LexCodeBSL,
this.nextChar();while(this.ch!=a.LexEOF&&(g||this.ch!=d));this.ch!=a.LexEOF&&this.nextChar();return new a.StringToken(a.TokenID.QString,this.src.substring(this.startPos,this.pos))}if(l[this.ch])return d=l[this.ch],d.tokenId==a.TokenID.LCurly?this.leftCurlyCount++:d.tokenId==a.TokenID.RCurly&&this.rightCurlyCount++,this.nextChar(),d;if(this.ch>=a.LexCode_0&&this.ch<=a.LexCode_9){if(d=this.scanNumber())return d;this.nextChar();return a.staticTokens[a.TokenID.Error]}switch(this.ch){case a.LexCodeTAB:case a.LexCodeVTAB:this.interveningWhitespace||
(this.interveningWhitespacePos=this.pos);if(this.mode==v.Line){do this.nextChar();while(this.ch==a.LexCodeSpace||9==this.ch);d=this.src.substring(this.startPos,this.pos);return new a.WhitespaceToken(a.TokenID.Whitespace,d)}this.interveningWhitespace=!0;case 255:case 254:case 239:case 187:case 191:case 8232:case 8233:case a.LexCodeNWL:case a.LexCodeRET:if(this.ch==a.LexCodeNWL&&(this.newLine(),this.mode==v.Line))return a.staticTokens[a.TokenID.EOF];this.interveningWhitespace||(this.interveningWhitespacePos=
this.pos);this.nextChar();this.tokenStart();this.interveningWhitespace=!0;break;case a.LexCodeDOT:if(this.peekCharAt(this.pos+1)==a.LexCodeDOT){if(this.peekCharAt(this.pos+2)==a.LexCodeDOT)return this.advanceChar(3),a.staticTokens[a.TokenID.Ellipsis];this.nextChar();return a.staticTokens[a.TokenID.Dot]}this.nextChar();return(d=this.scanFraction())?d:a.staticTokens[a.TokenID.Dot];case a.LexCodeEQ:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),
a.staticTokens[a.TokenID.Eqv];this.advanceChar(2);return a.staticTokens[a.TokenID.EQ]}if(this.peekCharAt(this.pos+1)==a.LexCodeGT)return this.advanceChar(2),a.staticTokens[a.TokenID.Arrow];this.nextChar();return a.staticTokens[a.TokenID.Asg];case a.LexCodeBNG:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.NEqv];this.advanceChar(2);return a.staticTokens[a.TokenID.NE]}this.nextChar();return a.staticTokens[a.TokenID.Bang];
case a.LexCodePLS:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAdd];if(this.peekCharAt(this.pos+1)==a.LexCodePLS)return this.advanceChar(2),a.staticTokens[a.TokenID.Inc];this.nextChar();return a.staticTokens[a.TokenID.Add];case a.LexCodeMIN:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgSub];if(this.peekCharAt(this.pos+1)==a.LexCodeMIN)return this.advanceChar(2),a.staticTokens[a.TokenID.Dec];
this.nextChar();return a.staticTokens[a.TokenID.Sub];case a.LexCodeMUL:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMul];this.nextChar();return a.staticTokens[a.TokenID.Mult];case a.LexCodePCT:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMod];this.nextChar();return a.staticTokens[a.TokenID.Pct];case a.LexCodeLT:if(this.peekCharAt(this.pos+1)==a.LexCodeLT){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),
a.staticTokens[a.TokenID.AsgLsh];this.advanceChar(2);return a.staticTokens[a.TokenID.Lsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.LE];this.nextChar();return a.staticTokens[a.TokenID.LT];case a.LexCodeGT:if(this.peekCharAt(this.pos+1)==a.LexCodeGT){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.AsgRsh];if(this.peekCharAt(this.pos+2)==a.LexCodeGT){if(this.peekCharAt(this.pos+3)==a.LexCodeEQ)return this.advanceChar(4),
a.staticTokens[a.TokenID.AsgRs2];this.advanceChar(3);return a.staticTokens[a.TokenID.Rs2]}this.advanceChar(2);return a.staticTokens[a.TokenID.Rsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.GE];this.nextChar();return a.staticTokens[a.TokenID.GT];case a.LexCodeXOR:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgXor];this.nextChar();return a.staticTokens[a.TokenID.Xor];case a.LexCodeBAR:if(this.peekCharAt(this.pos+
1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgOr];if(this.peekCharAt(this.pos+1)==a.LexCodeBAR)return this.advanceChar(2),a.staticTokens[a.TokenID.LogOr];this.nextChar();return a.staticTokens[a.TokenID.Or];case a.LexCodeAMP:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAnd];if(this.peekCharAt(this.pos+1)==a.LexCodeAMP)return this.advanceChar(2),a.staticTokens[a.TokenID.LogAnd];this.nextChar();return a.staticTokens[a.TokenID.And];
default:return a.staticTokens[a.TokenID.EOF]}}}return a.staticTokens[a.TokenID.EOF]};a.Scanner=h;a.convertTokToIDName=function(a){return j(a,!0,!1)};a.convertTokToID=function(a,c){return j(a,!1,c)};a.getLineNumberFromPosition=f;a.getSourceLineColFromMap=d;a.getLineColumnFromPosition=function(a,c){var b={line:-1,col:-1};d(b,c,a.locationInfo.lineMap);0<=b.col&&b.col++;return b};a.getPositionFromLineColumn=function(a,c,b){return a.locationInfo.lineMap[c]+(b-1)}})(TypeScript||(TypeScript={}));
(function(a){function e(c,b,d,h,g){c=new a.ScopeChain(null,b.scopeChain,c);c.thisType=d;c.classType=h;c.fnc=g;b.scopeChain=c}function i(a){a.scopeChain=a.scopeChain.previous}function b(a,c){return null==a||!a.isInstanceProperty()?c:a}function j(a){return a.isInstanceProperty()}function f(c,b){var d=null,h=null;c.name&&c.mod&&(c.name.sym=c.mod.symbol);var g=c.mod;g&&(d=new a.SymbolTableScope(g.members,g.ambientMembers,g.enclosedTypes,g.ambientEnclosedTypes,g.symbol),g.memberScope=d,b.modDeclChain.push(c),
b.typeFlow.checker.currentModDecl=c,h=new a.SymbolAggregateScope(g.symbol),h.addParentScope(d),h.addParentScope(b.scopeChain.scope),e(h,b,null,null,null),g.containedScope=h,g.symbol&&b.typeFlow.addLocalsFromScope(g.containedScope,g.symbol,c.vars,g.members.privateMembers,!0))}function d(c,b){var d=null,h=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var g=c.type;if(g){d=b.typeFlow.checker.scopeOf(g);h=new a.SymbolAggregateScope(g.symbol);h.addParentScope(d);h.addParentScope(b.scopeChain.scope);g.containedScope=
h;g.memberScope=d;var f=g.instanceType,d=b.typeFlow.checker.scopeOf(f);f.memberScope=d;h=new a.SymbolAggregateScope(f.symbol);h.addParentScope(b.scopeChain.scope);e(h,b,f,g,null);f.containedScope=h}else c.type=b.typeFlow.anyType}function l(c,b){var d=null,h=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var g=c.type,d=b.typeFlow.checker.scopeOf(g);g.memberScope=d;h=new a.SymbolAggregateScope(g.symbol);h.addParentScope(d);h.addParentScope(b.scopeChain.scope);e(h,b,null,null,null);g.containedScope=
h}function c(c,b){var d=c.type,h=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),g=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d=new a.Type,f=new a.WithSymbol(c.minChar,b.typeFlow.checker.locationInfo.unitIndex,d);d.members=h;d.ambientMembers=g;d.symbol=f;d.setHasImplementation();c.type=d;h=new a.SymbolScopeBuilder(d.members,d.ambientMembers,null,null,b.scopeChain.scope,d.symbol);e(h,b,null,null,null);d.containedScope=
h}function h(c,b){var d=null,h=null;c.type&&(h=c.type.symbol);var g=a.hasFlag(c.fncFlags,a.FncFlags.Static),f=g&&null!=b.scopeChain.fnc?b.scopeChain.fnc.type.memberScope:b.scopeChain.scope;b.scopeChain.thisType&&(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))?(d=b.scopeChain.thisType,f=!(d.typeFlags&a.TypeFlags.IsClass)&&!a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?!c.isMethod()||g?d.constructorScope:d.containedScope:b.scopeChain.previous.scope.container&&b.scopeChain.previous.scope.container.declAST&&
b.scopeChain.previous.scope.container.declAST.nodeType==a.NodeType.FuncDecl&&b.scopeChain.previous.scope.container.declAST.isConstructor?d.constructorScope:g&&b.scopeChain.classType?b.scopeChain.classType.containedScope:d.containedScope,d=d.symbol):c.isConstructor&&b.scopeChain.thisType&&(d=b.scopeChain.thisType.symbol);if(null==c.type||a.hasFlag(c.type.symbol.flags,a.SymbolFlags.TypeSetDuringScopeAssignment)){b.scopeChain.fnc&&b.scopeChain.fnc.type&&(d=b.scopeChain.fnc.type.symbol);var k=null,l=
b.scopeChain.fnc,j=c.name?c.name.text:null,i=null;g?(null==l.type.members&&d.getType().memberScope&&(l.type.members=d.type.memberScope.valueMembers),k=b.scopeChain.fnc.type.memberScope,l.innerStaticFuncs[l.innerStaticFuncs.length]=c):k=!c.isConstructor&&d&&d.declAST&&d.declAST.nodeType==a.NodeType.FuncDecl&&d.declAST.isConstructor&&!c.isMethod()?b.scopeChain.thisType.constructorScope:b.scopeChain.scope;j&&("__missing"!=j&&!c.isAccessor())&&(i=k.findLocal(j,!1,!1));b.typeFlow.checker.createFunctionSignature(c,
d,k,i,null==i);if(!c.accessorSymbol&&c.fncFlags&a.FncFlags.ClassMethod&&d&&(!i||i.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||i&&i.isAccessor())c.accessorSymbol=b.typeFlow.checker.createAccessorSymbol(c,i,d.getType(),c.isMethod()&&g,!0,k,d);c.type.symbol.flags|=a.SymbolFlags.TypeSetDuringScopeAssignment}c.name&&c.type&&(c.name.sym=c.type.symbol);c.scopeType=c.type;if(!c.isOverload){var d=new a.StringHashTable,i=new a.ScopedMembers(new a.DualStringHashTable(d,new a.StringHashTable)),k=
new a.StringHashTable,j=new a.ScopedMembers(new a.DualStringHashTable(k,new a.StringHashTable)),k=new a.StringHashTable,l=new a.ScopedMembers(new a.DualStringHashTable(k,new a.StringHashTable)),A=new a.StringHashTable,A=new a.ScopedMembers(new a.DualStringHashTable(A,new a.StringHashTable));c.unitIndex=b.typeFlow.checker.locationInfo.unitIndex;h=new a.SymbolScopeBuilder(i,j,null,null,f,h);l=new a.SymbolScopeBuilder(l,A,null,null,f,null);c.isConstructor&&b.scopeChain.thisType&&(b.scopeChain.thisType.constructorScope=
h);c.symbols=d;if(!c.isSpecialFn()){i=c.type;f=c.signature;c.isConstructor||(i.containedScope=h,h.container=i.symbol,i.memberScope=l,l.container=i.symbol);c.enclosingFnc=b.scopeChain.fnc;i.enclosingType=g?b.scopeChain.classType:b.scopeChain.thisType;i=c.type.symbol;(c.fncFlags&a.FncFlags.Signature)==a.FncFlags.None&&c.vars&&(b.typeFlow.addLocalsFromScope(h,i,c.vars,d,!1),b.typeFlow.addLocalsFromScope(l,i,c.statics,k,!1));if(f.parameters){g=f.parameters.length;for(d=0;d<g;d++)b.typeFlow.checker.resolveTypeLink(h,
f.parameters[d].parameter.typeLink,!0)}b.typeFlow.checker.resolveTypeLink(h,f.returnType,c.isSignature())}if(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))g=c.isConstructor&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?b.scopeChain.thisType:null,e(h,b,g,null,c)}}function g(c,b){if(c.param){var d=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d=new a.SymbolScopeBuilder(d,null,null,null,b.scopeChain.scope,b.scopeChain.scope.container);c.containedScope=
d;e(d,b,b.scopeChain.thisType,b.scopeChain.classType,b.scopeChain.fnc)}}a.AssignScopeContext=function(a,c,b){this.scopeChain=a;this.typeFlow=c;this.modDeclChain=b};a.pushAssignScope=e;a.popAssignScope=i;a.instanceCompare=b;a.instanceFilterStop=j;var k=function(a,c){this.select=a;this.stop=c;this.result=null};k.prototype.reset=function(){this.result=null};k.prototype.update=function(a){return(this.result=this.select(this.result,a))?this.stop(this.result):!1};a.ScopeSearchFilter=k;a.instanceFilter=
new k(b,j);a.preAssignModuleScopes=f;a.preAssignClassScopes=d;a.preAssignInterfaceScopes=l;a.preAssignWithScopes=c;a.preAssignFuncDeclScopes=h;a.preAssignCatchScopes=g;a.preAssignScopes=function(b,e,k){var e=k.state,j=!0;b&&(b.nodeType==a.NodeType.List?b.enclosingScope=e.scopeChain.scope:b.nodeType==a.NodeType.Module?f(b,e):b.nodeType==a.NodeType.Class?d(b,e):b.nodeType==a.NodeType.Interface?l(b,e):b.nodeType==a.NodeType.With?c(b,e):b.nodeType==a.NodeType.FuncDecl?h(b,e):b.nodeType==a.NodeType.Catch?
g(b,e):b.nodeType==a.NodeType.TypeRef&&(j=!1));k.options.goChildren=j;return b};a.postAssignScopes=function(c,b,d){var b=d.state,h=!0;c&&(c.nodeType==a.NodeType.Module?(i(b),b.modDeclChain.pop(),1<=b.modDeclChain.length&&(b.typeFlow.checker.currentModDecl=b.modDeclChain[b.modDeclChain.length-1])):c.nodeType==a.NodeType.Class?i(b):c.nodeType==a.NodeType.Interface?i(b):c.nodeType==a.NodeType.With?i(b):c.nodeType==a.NodeType.FuncDecl?(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))&&
!c.isOverload&&i(b):c.nodeType==a.NodeType.Catch?c.param&&i(b):h=!1);d.options.goChildren=h;return c}})(TypeScript||(TypeScript={}));
(function(a){function e(b,e,f){var e=f.state,d=b.minChar,l=b.limChar;b.nodeType==a.NodeType.Script&&e.pos>l&&(l=e.pos);if(d<=e.pos&&l>=e.pos){switch(b.nodeType){case a.NodeType.Script:e.scopeGetter=function(){return null===b.bod?null:b.bod.enclosingScope};e.scopeStartAST=b;break;case a.NodeType.Class:e.scopeGetter=function(){return null===b.type||null===b.type.instanceType.containedScope?null:b.type.instanceType.containedScope};e.scopeStartAST=b;e.enclosingClassDecl=b;break;case a.NodeType.ObjectLit:b.targetType&&
(e.scopeGetter=function(){return b.targetType.containedScope},e.objectLiteralScopeGetter=function(){return b.targetType.memberScope},e.enclosingObjectLit=b);break;case a.NodeType.Module:e.deepestModuleDecl=b;e.scopeGetter=function(){return null===b.type?null:b.type.containedScope};e.scopeStartAST=b;break;case a.NodeType.Interface:e.scopeGetter=function(){return null===b.type?null:b.type.containedScope};e.scopeStartAST=b;break;case a.NodeType.FuncDecl:e.skipNextFuncDeclForClass?e.skipNextFuncDeclForClass=
!1:(e.scopeGetter=function(){return b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&b.type&&b.type.enclosingType?b.type.enclosingType.constructorScope:b.scopeType?b.scopeType.containedScope:b.type?b.type.containedScope:null},e.scopeStartAST=b)}f.options.goChildren=!0}else f.options.goChildren=!1;return b}a.TypeCollectionContext=function(a,e){this.scopeChain=a;this.checker=e;this.script=null};a.MemberScopeContext=function(b,e,f){this.flow=b;this.pos=e;this.matchFlag=f;this.ast=this.type=
null;this.options=new a.AstWalkOptions};var i=function(a,e,f,d,l){this.logger=a;this.script=e;this.text=f;this.pos=d;this.isMemberCompletion=l;this.scopeStartAST=this.objectLiteralScopeGetter=this.scopeGetter=null;this.skipNextFuncDeclForClass=!1;this.enclosingObjectLit=this.enclosingClassDecl=this.deepestModuleDecl=null;this.publicsOnly=!0;this.useFullAst=!1};i.prototype.getScope=function(){return this.scopeGetter()};i.prototype.getObjectLiteralScope=function(){return this.objectLiteralScopeGetter()};
i.prototype.getScopeAST=function(){return this.scopeStartAST};i.prototype.getScopePosition=function(){return this.scopeStartAST.minChar};i.prototype.getScriptFragmentStartAST=function(){return this.scopeStartAST};i.prototype.getScriptFragmentPosition=function(){return this.getScriptFragmentStartAST().minChar};i.prototype.getScriptFragment=function(){if(null==this.scriptFragment){var b=this.getScriptFragmentStartAST();this.scriptFragment=a.quickParse(this.logger,b,this.text,b.minChar,this.isMemberCompletion?
this.pos:this.pos+1,null).Script}return this.scriptFragment};a.EnclosingScopeContext=i;a.preFindMemberScope=function(b,e,f){e=f.state;if(a.hasFlag(b.flags,e.matchFlag)&&(0>e.pos||e.pos==b.limChar))e.ast=b,null==b.type&&0<=e.pos&&e.flow.inScopeTypeCheck(b,e.scope),e.type=b.type,e.options.stopWalk();return b};a.pushTypeCollectionScope=function(b,e,f,d,l,c,h,g,k){e=new a.SymbolScopeBuilder(e,f,d,l,null,b);b=new a.ScopeChain(b,c.scopeChain,e);b.thisType=h;b.classType=g;b.moduleDecl=k;c.scopeChain=b};
a.popTypeCollectionScope=function(a){a.scopeChain=a.scopeChain.previous};a.preFindEnclosingScope=e;a.findEnclosingScopeAt=function(b,j,f,d,l){b=new i(b,j,f,d,l);a.getAstWalkerFactory().walk(j,e,null,null,b);return null===b.scopeStartAST?null:b}})(TypeScript||(TypeScript={}));
(function(a){var e=function(){this.hasVariableArgList=!1;this.declAST=this.parameters=null;this.typeCheckStatus=a.TypeCheckStatus.NotStarted;this.nonOptionalParameterCount=0};e.prototype.specializeType=function(b,j,f){var d=new e;this.hasVariableArgList&&(d.hasVariableArgList=!0);d.returnType=new a.TypeLink;d.returnType.type=this.returnType.type?this.returnType.type.specializeType(b,j,f,!1):f.anyType;if(this.parameters){d.parameters=[];for(var l=0,c=this.parameters.length;l<c;l++){var h=this.parameters[l],
g=new a.ValueLocation,k=new a.ParameterSymbol(h.name,h.location,f.locationInfo.unitIndex,g);k.declAST=this.declAST;g.symbol=k;g.typeLink=new a.TypeLink;d.parameters[l]=k;(h=h.getType())?(g.typeLink.type=h.specializeType(b,j,f,!1),k.declAST.type=g.typeLink.type):g.typeLink.type=f.anyType}}d.nonOptionalParameterCount=this.nonOptionalParameterCount;d.declAST=this.declAST;return d};e.prototype.toString=function(){return this.toStringHelper(!1,!1,null)};e.prototype.toStringHelper=function(a,e,f){var d;
d=e?"[":"(";for(var l=this.parameters.length,c=0;c<l;c++)d+=this.parameters[c].name+(this.parameters[c].isOptional()?"?":"")+": ",d+=this.parameters[c].getType().getScopedTypeName(f),c<l-1&&(d+=",");d=a?e?d+"] => ":d+") => ":e?d+"]: ":d+"): ";return d=this.returnType.type?d+this.returnType.type.getScopedTypeName(f):d+"any"};a.Signature=e;var i=function(){this.signatures=[];this.hasImplementation=!0;this.definitionSignature=null;this.hasBeenTypechecked=!1;this.flags=a.SignatureFlags.None};i.prototype.addSignature=
function(b){null==this.signatures&&(this.signatures=[]);this.signatures[this.signatures.length]=b;b.declAST&&(!b.declAST.isOverload&&!b.declAST.isSignature()&&!a.hasFlag(b.declAST.fncFlags,a.FncFlags.Ambient)&&a.hasFlag(b.declAST.fncFlags,a.FncFlags.Definition))&&(this.definitionSignature=b)};i.prototype.toString=function(){return this.signatures.toString()};i.prototype.toStrings=function(b,e,f){var d=[],l=this.signatures.length;1<l&&(e=!1);for(var c=0;c<l;c++)1<l&&this.signatures[c]==this.definitionSignature||
(d[c]=this.flags&a.SignatureFlags.IsIndexer?this.signatures[c].toStringHelper(e,!0,f):b+this.signatures[c].toStringHelper(e,!1,f));return d};i.prototype.specializeType=function(a,e,f){var d=new i;if(this.signatures)for(var l=0,c=this.signatures.length;l<c;l++)d.addSignature(this.signatures[l].specializeType(a,e,f));return d};i.prototype.verifySignatures=function(b){var e=0;if(this.signatures&&0<(e=this.signatures.length))for(var f=0;f<e;f++){for(var d=f+1;d<e;d++)this.signatures[f].declAST&&(this.signatures[d].declAST&&
!a.hasFlag(this.signatures[f].declAST.fncFlags,a.FncFlags.Definition)&&!a.hasFlag(this.signatures[d].declAST.fncFlags,a.FncFlags.Definition)&&b.signaturesAreIdentical(this.signatures[f],this.signatures[d]))&&b.errorReporter.simpleError(this.signatures[f].declAST,this.signatures[f].declAST&&this.signatures[f].declAST.name?"Signature for '"+this.signatures[f].declAST.name.text+"' is duplicated":"Signature is duplicated");this.definitionSignature&&(b.signatureIsAssignableToTarget(this.definitionSignature,
this.signatures[f])||b.errorReporter.simpleError(this.signatures[f].declAST,"Overload signature is not compatible with function definition"))}};i.prototype.typeCheck=function(b,e,f){if(!this.hasBeenTypechecked&&(this.hasBeenTypechecked=!0,e=0,this.signatures&&0<(e=this.signatures.length))){for(var d=0;d<e;d++)!f&&(!this.definitionSignature&&this.signatures[d].declAST&&this.signatures[d].declAST.isOverload&&!a.hasFlag(this.signatures[d].declAST.fncFlags,a.FncFlags.Ambient))&&b.errorReporter.simpleError(this.signatures[d].declAST,
"Overload declaration lacks definition"),this.signatures[d].declAST&&(this.signatures[d].declAST.isConstructor&&this.signatures[d].declAST.classDecl&&this.signatures[d].declAST.classDecl.type.symbol.typeCheckStatus==a.TypeCheckStatus.NotStarted)&&b.typeFlow.typeCheck(this.signatures[d].declAST.classDecl),b.typeFlow.typeCheck(this.signatures[d].declAST);this.verifySignatures(b)}};a.SignatureGroup=i})(TypeScript||(TypeScript={}));
(function(a){function e(c,b){return c.declAST&&b&&b.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl?c.declAST.minChar<=b.declAST.minChar&&c.declAST.limChar>=b.declAST.limChar:!1}function i(a,c){for(;a.container;){if(a==c||e(a.container,c))return!0;a=a.container}return!1}var b=a.TypeCheckStatus||(a.TypeCheckStatus={});b._map=[];b._map[0]="NotStarted";b.NotStarted=0;b._map[1]="Started";b.Started=1;b._map[2]="Finished";b.Finished=2;var j=a.TypeCheckStatus;a.aLexicallyEnclosesB=e;a.aEnclosesB=i;var f=
function(c,b,d){this.name=c;this.location=b;this.unitIndex=d;this.bound=!1;this.flags=a.SymbolFlags.None;this.isObjectLitField=!1;this.declModule=this.declAST=null;this.passSymbolCreated=a.CompilerDiagnostics.analysisPass};f.prototype.instanceScope=function(){return null};f.prototype.isVariable=function(){return!1};f.prototype.isMember=function(){return!1};f.prototype.isInferenceSymbol=function(){return!1};f.prototype.isWith=function(){return!1};f.prototype.writeable=function(){return!1};f.prototype.isType=
function(){return!1};f.prototype.getType=function(){return null};f.prototype.isAccessor=function(){return!1};f.prototype.isInstanceProperty=function(){return a.hasFlag(this.flags,a.SymbolFlags.Property)&&!a.hasFlag(this.flags,a.SymbolFlags.ModuleMember)};f.prototype.getTypeName=function(){return this.toString()};f.prototype.getOptionalNameString=function(){return a.hasFlag(this.flags,a.SymbolFlags.Optional)?"?":""};f.prototype.pathToRoot=function(){for(var c=[],b=this;b&&b.name!=a.globalId;)c[c.length]=
b,b=b.container;return c};f.prototype.findCommonAncestorPath=function(a){if(null==this.container)return[];for(var c=this.container.pathToRoot(),a=a?a.pathToRoot():[],b=-1,d=0,h=c.length;d<h;d++){for(var g=c[d],e=0,f=a.length;e<f;e++)if(g==a[e]){b=d;break}if(0<=b)break}return 0<=b?c.slice(0,b):c};f.prototype.scopeRelativeName=function(a){if(null==a)return this.name;for(var a=this.findCommonAncestorPath(a.container),c="",b=0,d=a.length;b<d;b++)c=a[b].name+"."+c;return c+=this.name};f.prototype.fullName=
function(){for(var c=this.name,b=this.container;b&&b.name!=a.globalId;)c=b.name+"."+c,b=b.container;return c};f.prototype.visible=function(c,b){if(null==b||this.container==b.gloMod)return!0;if(a.hasFlag(this.flags,a.SymbolFlags.ModuleMember))return a.hasFlag(this.flags,a.SymbolFlags.Exported)?a.hasFlag(this.flags,a.SymbolFlags.Private)?i(this,c.container):!0:b&&b.currentModDecl==this.declModule||b.currentModDecl&&b.currentModDecl.mod&&b.currentModDecl.mod.symbol&&this.declModule&&this.declModule.mod&&
this.declModule.mod.symbol&&i(b.currentModDecl.mod.symbol,this.declModule.mod.symbol);var d=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl,h=d&&this.declAST.isMethod(),d=d&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Static),g=h&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Private),e=this.isType()&&this.aliasLink;return this.isMember()||h||d||e?a.hasFlag(this.flags,a.SymbolFlags.Private)||g?null==c.container&&this.container!=c.container?!1:null==this.container?!0:i(c.container,this.container):
!0:this.container?i(this,c.container):!0};f.prototype.addRef=function(a){this.refs||(this.refs=[]);this.refs[this.refs.length]=a};f.prototype.toString=function(){return this.name?this.name:"_anonymous"};f.prototype.print=function(a){a.Write(this.toString())};f.prototype.specializeType=function(){throw Error("please implement in derived class");};f.prototype.setType=function(){throw Error("please implement in derived class");};f.prototype.kind=function(){throw Error("please implement in derived class");
};a.Symbol=f;var d;d=function(){};a.ValueLocation=d;var l=function(a,c,b){f.call(this,a,c,b);this.typeCheckStatus=j.NotStarted};__extends(l,f);l.prototype.isInferenceSymbol=function(){return!0};l.prototype.transferVarFlags=function(c){a.hasFlag(c,a.VarFlags.Ambient)&&(this.flags|=a.SymbolFlags.Ambient);a.hasFlag(c,a.VarFlags.Constant)&&(this.flags|=a.SymbolFlags.Constant);a.hasFlag(c,a.VarFlags.Static)&&(this.flags|=a.SymbolFlags.Static);a.hasFlag(c,a.VarFlags.Property)&&(this.flags|=a.SymbolFlags.Property);
a.hasFlag(c,a.VarFlags.Private)&&(this.flags|=a.SymbolFlags.Private);a.hasFlag(c,a.VarFlags.Public)&&(this.flags|=a.SymbolFlags.Public);a.hasFlag(c,a.VarFlags.Readonly)&&(this.flags|=a.SymbolFlags.Readonly);a.hasFlag(c,a.VarFlags.Exported)&&(this.flags|=a.SymbolFlags.Exported)};a.InferenceSymbol=l;var c=function(c,b,d,h){l.call(this,c,b,d);this.type=h;this.expansions=[];this.isMethod=!1;this.aliasLink=null;this.onlyReferencedAsTypeRef=a.optimizeModuleCodeGen;this.prettyName=this.name};__extends(c,
l);c.prototype.addLocation=function(a){null==this.additionalLocations&&(this.additionalLocations=[]);this.additionalLocations[this.additionalLocations.length]=a};c.prototype.kind=function(){return a.SymbolKind.Type};c.prototype.isType=function(){return!0};c.prototype.getType=function(){return this.type};c.prototype.getTypeName=function(a){return this.type.getMemberTypeName(this.name?this.name+this.getOptionalNameString():"",!1,!1,a)};c.prototype.instanceScope=function(){return!(this.type.typeFlags&
a.TypeFlags.IsClass)&&this.type.isClass()?this.type.instanceType.constructorScope:this.type.containedScope};c.prototype.toString=function(){var a=this.type.getTypeName();this.name&&(a=this.name+":"+a);return a};c.prototype.isClass=function(){return null!=this.instanceType};c.prototype.isFunction=function(){return null!=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl};c.prototype.specializeType=function(a,b,d){if(this.type==a)return b.symbol;a=this.type.specializeType(a,b,d,!1);return a!=
this.type?new c(this.name,0,-1,a):this};c.prototype.scopeRelativeName=function(c){if(null==c)return this.prettyName+this.getOptionalNameString();for(var c=this.findCommonAncestorPath(c.container),b="",d=0,h=c.length;d<h;d++)b=(c[d].kind()==a.SymbolKind.Type?c[d].prettyName:c[d].name)+"."+b;return b+=this.prettyName+this.getOptionalNameString()};a.TypeSymbol=c;b=function(a,b,d){c.call(this,"with",a,b,d)};__extends(b,c);b.prototype.isWith=function(){return!0};a.WithSymbol=b;var h=function(a,c,b,d,h){l.call(this,
a,c,b);this.canWrite=d;this.field=h;this.setter=this.getter=null;this.hasBeenEmitted=!1;this.name=a;this.location=c};__extends(h,l);h.prototype.kind=function(){return a.SymbolKind.Field};h.prototype.writeable=function(){return this.isAccessor()?null!=this.setter:this.canWrite};h.prototype.getType=function(){return this.field.typeLink.type};h.prototype.getTypeName=function(a){return this.name+this.getOptionalNameString()+": "+this.field.typeLink.type.getMemberTypeName("",!0,!1,a)};h.prototype.isMember=
function(){return!0};h.prototype.setType=function(a){this.field.typeLink.type=a};h.prototype.isAccessor=function(){return null!=this.getter||null!=this.setter};h.prototype.isVariable=function(){return!0};h.prototype.toString=function(){return this.name+this.getOptionalNameString()+":"+this.field.typeLink.type.getTypeName()};h.prototype.specializeType=function(c,b,g){c=this.field.typeLink.type.specializeType(c,b,g,!1);return c!=this.field.typeLink.type?(b=new d,g=new h(this.name,0,g.locationInfo.unitIndex,
this.canWrite,b),g.flags=this.flags,b.symbol=g,b.typeLink=new a.TypeLink,g.setType(c),g.typeCheckStatus=j.Finished,g):this};a.FieldSymbol=h;var g=function(a,c,b,d){l.call(this,a,c,b);this.parameter=d;this.argsOffset=-1;this.name=a;this.location=c};__extends(g,l);g.prototype.kind=function(){return a.SymbolKind.Parameter};g.prototype.writeable=function(){return!0};g.prototype.getType=function(){return this.parameter.typeLink.type};g.prototype.setType=function(a){this.parameter.typeLink.type=a};g.prototype.isVariable=
function(){return!0};g.prototype.isOptional=function(){return this.parameter&&this.parameter.symbol&&this.parameter.symbol.declAST?this.parameter.symbol.declAST.isOptional:!1};g.prototype.getTypeName=function(a){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getMemberTypeName("",!1,!1,a)};g.prototype.toString=function(){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getTypeName()};g.prototype.specializeType=function(a,c,b){a=this.parameter.typeLink.type.specializeType(a,
c,b,!1);return this.parameter.typeLink.type!=a?(c=new d,b=new g(this.name,0,b.locationInfo.unitIndex,c),c.symbol=b,b.setType(a),b):this};a.ParameterSymbol=g;b=function(a,c,b,d){l.call(this,a,c,b);this.variable=d};__extends(b,l);b.prototype.kind=function(){return a.SymbolKind.Variable};b.prototype.writeable=function(){return!0};b.prototype.getType=function(){return this.variable.typeLink.type};b.prototype.getTypeName=function(a){return this.name+":"+this.getType().getMemberTypeName("",!1,!1,a)};b.prototype.setType=
function(a){this.variable.typeLink.type=a};b.prototype.isVariable=function(){return!0};a.VariableSymbol=b})(TypeScript||(TypeScript={}));
(function(a){var e=function(a){this.allMembers=this.dualMembers=a;this.publicMembers=this.dualMembers.primaryTable;this.privateMembers=this.dualMembers.secondaryTable};e.prototype.addPublicMember=function(a,b){return this.dualMembers.primaryTable.add(a,b)};e.prototype.addPrivateMember=function(a,b){return this.dualMembers.secondaryTable.add(a,b)};a.ScopedMembers=e;e=a.SymbolKind||(a.SymbolKind={});e._map=[];e._map[0]="None";e.None=0;e._map[1]="Type";e.Type=1;e._map[2]="Field";e.Field=2;e._map[3]=
"Parameter";e.Parameter=3;e._map[4]="Variable";e.Variable=4;var i=a.SymbolKind,b=function(a){this.container=a};b.prototype.printLabel=function(){return"base"};b.prototype.getAllSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllTypeSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllValueSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.search=function(){return null};b.prototype.findLocal=
function(){return null};b.prototype.find=function(){return null};b.prototype.findImplementation=function(){return null};b.prototype.findAmbient=function(){return null};b.prototype.print=function(a){this.container?a.WriteLine(this.printLabel()+" scope with container: "+this.container.name+"..."):a.WriteLine(this.printLabel()+" scope...")};b.prototype.enter=function(){throw Error("please implement in derived class");};b.prototype.getTable=function(){throw Error("please implement in derived class");
};a.SymbolScope=b;e=function(a){this.container=a;this.parents=this.typeAmbientCache=this.typeImplCache=this.typeCache=this.valueAmbientCache=this.valueImplCache=this.valueCache=null;this.container=a};__extends(e,b);e.prototype.printLabel=function(){return"agg"};e.prototype.search=function(a,b,e,c){if(this.parents)for(var h=0;h<this.parents.length;h++){var g=this.parents[h].search(a,b,e,c);if(g&&a.update(g))return g}return a.result};e.prototype.getAllSymbolNames=function(a){var b=[];if(this.parents)for(var e=
0;e<this.parents.length;e++){var c=this.parents[e].getAllSymbolNames(a);c&&(b=b.concat(c))}return b};e.prototype.getAllTypeSymbolNames=function(a){var b=[];if(this.parents)for(var e=0;e<this.parents.length;e++){var c=this.parents[e].getAllTypeSymbolNames(a);c&&(b=b.concat(c))}return b};e.prototype.getAllValueSymbolNames=function(a){var b=[];if(this.parents)for(var e=0;e<this.parents.length;e++){var c=this.parents[e].getAllValueSymbolNames(a);c&&(b=b.concat(c))}return b};e.prototype.print=function(a){b.prototype.print.call(this,
a);if(this.parents)for(var d=0;d<this.parents.length;d++)this.parents[d].print(a)};e.prototype.findImplementation=function(b,d,e){var c=null,h=0,g=this.valueImplCache;e&&(g=this.typeImplCache);if(g&&null!=(c=g.lookup(b))&&(d?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(h=0;h<this.parents.length&&!(c=this.parents[h].findImplementation(b,d,e));h++);g&&(g=e?this.typeImplCache=
new a.StringHashTable:this.valueImplCache=new a.StringHashTable);g.add(b,c);return c};e.prototype.find=function(b,d,e){var c=null,h=0,g=this.valueCache;e&&(g=this.typeCache);if(g&&null!=(c=g.lookup(b))&&(d?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(h=0;h<this.parents.length&&!(c=this.parents[h].find(b,d,e));h++);null==g&&(g=e?this.typeCache=new a.StringHashTable:this.valueCache=
new a.StringHashTable);g.add(b,c);return c};e.prototype.findAmbient=function(b,d,e){var c=null,h=0,g=this.valueAmbientCache;e&&(g=this.typeAmbientCache);if(g&&null!=(c=g.lookup(b)))return c;if(this.parents)for(h=0;h<this.parents.length&&!(c=this.parents[h].findAmbient(b,d,e));h++);null==g&&(g=e?this.typeAmbientCache=new a.StringHashTable:this.valueAmbientCache=new a.StringHashTable);g.add(b,c);return c};e.prototype.addParentScope=function(a){null==this.parents&&(this.parents=[]);this.parents[this.parents.length]=
a};a.SymbolAggregateScope=e;e=function(a,b,e,c,h){this.container=h;this.valueMembers=a;this.ambientValueMembers=b;this.enclosedTypes=e;this.ambientEnclosedTypes=c;this.container=h};__extends(e,b);e.prototype.printLabel=function(){return"table"};e.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};e.prototype.getAllTypeSymbolNames=function(){var a=[];this.ambientEnclosedTypes&&(a=a.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));
this.enclosedTypes&&(a=a.concat(this.enclosedTypes.allMembers.getAllKeys()));return a};e.prototype.getAllValueSymbolNames=function(){var a=[];this.ambientValueMembers&&(a=a.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(a=a.concat(this.valueMembers.allMembers.getAllKeys()));return a};e.prototype.search=function(a,b,e,c){b=this.find(b,e,c);a.update(b);return a.result};e.prototype.find=function(a,b,e){var c=null,h=null;e?(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:
this.enclosedTypes.allMembers,h=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers):(c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,h=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers);return h&&(b=h.lookup(a))||c&&(b=c.lookup(a))?b:null};e.prototype.findAmbient=function(a,b,e){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:
this.ambientValueMembers.allMembers;e&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&(a=c.lookup(a))?a:null};e.prototype.print=function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+
b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null)};e.prototype.findImplementation=function(a,b,e){(a=this.find(a,b,e))&&(a.kind()==i.Type?a.type.hasImplementation()||(a=null):a.container&&a.container.kind()==i.Type&&(a.container.type.hasImplementation()||(a=null)));return a};e.prototype.getTable=function(){return this.valueMembers.publicMembers};a.SymbolTableScope=e;var j=function(a,b,e,c,h,g){this.container=g;this.valueMembers=a;this.ambientValueMembers=
b;this.enclosedTypes=e;this.ambientEnclosedTypes=c;this.parent=h;this.container=g};__extends(j,b);j.prototype.printLabel=function(){return"builder"};j.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};j.prototype.getAllTypeSymbolNames=function(a){var b=[];this.ambientEnclosedTypes&&(b=b.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));this.enclosedTypes&&(b=b.concat(this.enclosedTypes.allMembers.getAllKeys()));!a&&this.parent&&
(a=this.parent.getAllTypeSymbolNames(a))&&(b=b.concat(a));return b};j.prototype.getAllValueSymbolNames=function(a){var b=[];this.ambientValueMembers&&(b=b.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(b=b.concat(this.valueMembers.allMembers.getAllKeys()));!a&&this.parent&&(a=this.parent.getAllValueSymbolNames(a))&&(b=b.concat(a));return b};j.prototype.search=function(a,b,e,c){var h=null,g=null==this.valueMembers?null:e?this.valueMembers.publicMembers:this.valueMembers.allMembers,
k=null==this.ambientValueMembers?null:e?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;c&&(g=null==this.enclosedTypes?null:e?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,k=null==this.ambientEnclosedTypes?null:e?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return k&&null!=(h=k.lookup(b))&&a.update(h)||g&&null!=(h=g.lookup(b))&&a.update(h)||this.parent&&(h=this.parent.search(a,b,e,c))&&a.update(h)?h:a.result};j.prototype.print=
function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.parent&&this.parent.print(a)};j.prototype.find=function(a,
b,e){var c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,h=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;e&&(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,h=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return h&&null!=h.lookup(a)||c&&null!=c.lookup(a)?null:this.parent?
this.parent.find(a,b,e):null};j.prototype.findAmbient=function(a,b,e){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;e&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&null!=c.lookup(a)?null:this.parent?this.parent.findAmbient(a,b,e):null};j.prototype.findLocal=function(a,b,e){var c=null,h=null==this.valueMembers?null:b?this.valueMembers.publicMembers:
this.valueMembers.allMembers,g=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;e&&(h=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,g=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return h&&null!=(c=h.lookup(a))&&c||g&&null!=(c=g.lookup(a))&&c?c:null};j.prototype.enter=function(b,d,e,c,h,g,k){var i=null;(i=k?g?null==
this.ambientEnclosedTypes?null:h?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.privateMembers:null==this.ambientValueMembers?null:h?this.ambientValueMembers.publicMembers:this.ambientValueMembers.privateMembers:g?null==this.enclosedTypes?null:h?this.enclosedTypes.publicMembers:this.enclosedTypes.privateMembers:null==this.valueMembers?null:h?this.valueMembers.publicMembers:this.valueMembers.privateMembers)?i.add(e.name,e)||c.duplicateIdentifier(d,e.name):a.CompilerDiagnostics.Alert("YYYYY");
e.container=b};j.prototype.getTable=function(){return this.valueMembers.allMembers};a.SymbolScopeBuilder=j;e=function(a,b,e){this.container=b;this.scope=a;this.filter=e};__extends(e,b);e.prototype.print=function(a){this.scope.print(a)};e.prototype.find=function(a,b,e){this.filter.reset();return this.scope.search(this.filter,a,b,e)};e.prototype.findLocal=function(a,b,e){return this.scope.findLocal(a,b,e)};a.FilteredSymbolScope=e;e=function(a,b,e,c){j.call(this,a,null,null,null,b,e);this.filter=c};
__extends(e,j);e.prototype.findLocal=function(a,b,e){return(a=j.prototype.findLocal.call(this,a,b,e))&&!this.filter(a)?null:a};e.prototype.search=function(){throw Error("please implement");};e.prototype.find=function(a,b,e){var c=j.prototype.findLocal.call(this,a,b,e);return c&&!this.filter(c)?null:j.prototype.find.call(this,a,b,e)};a.FilteredSymbolScopeBuilder=e})(TypeScript||(TypeScript={}));
(function(a){function e(c,b,e,f,l,m,i,j){void 0!==c&&(a.tokenTable[c]=new d(c,b,e,f,l,m,i,j),f!=a.NodeType.None&&(a.nodeTypeTable[f]=i,a.nodeTypeToTokTable[f]=c),m!=a.NodeType.None&&(a.nodeTypeTable[m]=i))}function i(c){return a.tokenTable[c]}var b=a.TokenID||(a.TokenID={});b._map=[];b._map[0]="ANY";b.ANY=0;b._map[1]="BOOL";b.BOOL=1;b._map[2]="BREAK";b.BREAK=2;b._map[3]="CASE";b.CASE=3;b._map[4]="CATCH";b.CATCH=4;b._map[5]="CLASS";b.CLASS=5;b._map[6]="CONST";b.CONST=6;b._map[7]="CONTINUE";b.CONTINUE=
7;b._map[8]="DEBUGGER";b.DEBUGGER=8;b._map[9]="DEFAULT";b.DEFAULT=9;b._map[10]="DELETE";b.DELETE=10;b._map[11]="DO";b.DO=11;b._map[12]="ELSE";b.ELSE=12;b._map[13]="ENUM";b.ENUM=13;b._map[14]="EXPORT";b.EXPORT=14;b._map[15]="EXTENDS";b.EXTENDS=15;b._map[16]="DECLARE";b.DECLARE=16;b._map[17]="FALSE";b.FALSE=17;b._map[18]="FINALLY";b.FINALLY=18;b._map[19]="FOR";b.FOR=19;b._map[20]="FUNCTION";b.FUNCTION=20;b._map[21]="CONSTRUCTOR";b.CONSTRUCTOR=21;b._map[22]="GET";b.GET=22;b._map[23]="IF";b.IF=23;b._map[24]=
"IMPLEMENTS";b.IMPLEMENTS=24;b._map[25]="IMPORT";b.IMPORT=25;b._map[26]="IN";b.IN=26;b._map[27]="INSTANCEOF";b.INSTANCEOF=27;b._map[28]="INTERFACE";b.INTERFACE=28;b._map[29]="LET";b.LET=29;b._map[30]="MODULE";b.MODULE=30;b._map[31]="NEW";b.NEW=31;b._map[32]="NUMBER";b.NUMBER=32;b._map[33]="NULL";b.NULL=33;b._map[34]="PACKAGE";b.PACKAGE=34;b._map[35]="PRIVATE";b.PRIVATE=35;b._map[36]="PROTECTED";b.PROTECTED=36;b._map[37]="PUBLIC";b.PUBLIC=37;b._map[38]="RETURN";b.RETURN=38;b._map[39]="SET";b.SET=39;
b._map[40]="STATIC";b.STATIC=40;b._map[41]="STRING";b.STRING=41;b._map[42]="SUPER";b.SUPER=42;b._map[43]="SWITCH";b.SWITCH=43;b._map[44]="THIS";b.THIS=44;b._map[45]="THROW";b.THROW=45;b._map[46]="TRUE";b.TRUE=46;b._map[47]="TRY";b.TRY=47;b._map[48]="TYPEOF";b.TYPEOF=48;b._map[49]="VAR";b.VAR=49;b._map[50]="VOID";b.VOID=50;b._map[51]="WITH";b.WITH=51;b._map[52]="WHILE";b.WHILE=52;b._map[53]="YIELD";b.YIELD=53;b._map[54]="SColon";b.SColon=54;b._map[55]="LParen";b.LParen=55;b._map[56]="RParen";b.RParen=
56;b._map[57]="LBrack";b.LBrack=57;b._map[58]="RBrack";b.RBrack=58;b._map[59]="LCurly";b.LCurly=59;b._map[60]="RCurly";b.RCurly=60;b._map[61]="Comma";b.Comma=61;b._map[62]="Asg";b.Asg=62;b._map[63]="AsgAdd";b.AsgAdd=63;b._map[64]="AsgSub";b.AsgSub=64;b._map[65]="AsgMul";b.AsgMul=65;b._map[66]="AsgDiv";b.AsgDiv=66;b._map[67]="AsgMod";b.AsgMod=67;b._map[68]="AsgAnd";b.AsgAnd=68;b._map[69]="AsgXor";b.AsgXor=69;b._map[70]="AsgOr";b.AsgOr=70;b._map[71]="AsgLsh";b.AsgLsh=71;b._map[72]="AsgRsh";b.AsgRsh=
72;b._map[73]="AsgRs2";b.AsgRs2=73;b._map[74]="QMark";b.QMark=74;b._map[75]="Colon";b.Colon=75;b._map[76]="LogOr";b.LogOr=76;b._map[77]="LogAnd";b.LogAnd=77;b._map[78]="Or";b.Or=78;b._map[79]="Xor";b.Xor=79;b._map[80]="And";b.And=80;b._map[81]="EQ";b.EQ=81;b._map[82]="NE";b.NE=82;b._map[83]="Eqv";b.Eqv=83;b._map[84]="NEqv";b.NEqv=84;b._map[85]="LT";b.LT=85;b._map[86]="LE";b.LE=86;b._map[87]="GT";b.GT=87;b._map[88]="GE";b.GE=88;b._map[89]="Lsh";b.Lsh=89;b._map[90]="Rsh";b.Rsh=90;b._map[91]="Rs2";b.Rs2=
91;b._map[92]="Add";b.Add=92;b._map[93]="Sub";b.Sub=93;b._map[94]="Mult";b.Mult=94;b._map[95]="Div";b.Div=95;b._map[96]="Pct";b.Pct=96;b._map[97]="Tilde";b.Tilde=97;b._map[98]="Bang";b.Bang=98;b._map[99]="Inc";b.Inc=99;b._map[100]="Dec";b.Dec=100;b._map[101]="Dot";b.Dot=101;b._map[102]="Ellipsis";b.Ellipsis=102;b._map[103]="Error";b.Error=103;b._map[104]="EOF";b.EOF=104;b._map[105]="Arrow";b.Arrow=105;b._map[106]="ID";b.ID=106;b._map[107]="QString";b.QString=107;b._map[108]="Regex";b.Regex=108;b._map[109]=
"NumberLit";b.NumberLit=109;b._map[110]="Whitespace";b.Whitespace=110;b._map[111]="Comment";b.Comment=111;b._map[112]="Lim";b.Lim=112;b.LimFixed=b.Arrow;b.LimKeyword=b.YIELD;var j=a.TokenID;a.tokenTable=[];a.nodeTypeTable=[];a.nodeTypeToTokTable=[];a.noRegexTable=[];a.noRegexTable[j.ID]=!0;a.noRegexTable[j.QString]=!0;a.noRegexTable[j.NumberLit]=!0;a.noRegexTable[j.Regex]=!0;a.noRegexTable[j.THIS]=!0;a.noRegexTable[j.Inc]=!0;a.noRegexTable[j.Dec]=!0;a.noRegexTable[j.RParen]=!0;a.noRegexTable[j.RBrack]=
!0;a.noRegexTable[j.RCurly]=!0;a.noRegexTable[j.TRUE]=!0;a.noRegexTable[j.FALSE]=!0;b=a.OperatorPrecedence||(a.OperatorPrecedence={});b._map=[];b._map[0]="No";b.No=0;b._map[1]="Cma";b.Cma=1;b._map[2]="Asg";b.Asg=2;b._map[3]="Que";b.Que=3;b._map[4]="Lor";b.Lor=4;b._map[5]="Lan";b.Lan=5;b._map[6]="Bor";b.Bor=6;b._map[7]="Xor";b.Xor=7;b._map[8]="Ban";b.Ban=8;b._map[9]="Equ";b.Equ=9;b._map[10]="Cmp";b.Cmp=10;b._map[11]="Shf";b.Shf=11;b._map[12]="Add";b.Add=12;b._map[13]="Mul";b.Mul=13;b._map[14]="Uni";
b.Uni=14;b._map[15]="Lim";b.Lim=15;var b=a.OperatorPrecedence,f=a.Reservation||(a.Reservation={});f._map=[];f.None=0;f.Javascript=1;f.JavascriptFuture=2;f.TypeScript=4;f.JavascriptFutureStrict=8;f.TypeScriptAndJS=f.Javascript|f.TypeScript;f.TypeScriptAndJSFuture=f.JavascriptFuture|f.TypeScript;f.TypeScriptAndJSFutureStrict=f.JavascriptFutureStrict|f.TypeScript;var f=a.Reservation,d;d=function(a,c,b,d,e,f,l,i){this.tokenId=a;this.reservation=c;this.binopPrecedence=b;this.binopNodeType=d;this.unopPrecedence=
e;this.unopNodeType=f;this.text=l;this.ers=i};a.TokenInfo=d;e(j.ANY,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"any",a.ErrorRecoverySet.PrimType);e(j.BOOL,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"bool",a.ErrorRecoverySet.PrimType);e(j.BREAK,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"break",a.ErrorRecoverySet.Stmt);e(j.CASE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"case",a.ErrorRecoverySet.SCase);e(j.CATCH,f.TypeScriptAndJS,b.No,a.NodeType.None,
b.No,a.NodeType.None,"catch",a.ErrorRecoverySet.Catch);e(j.CLASS,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"class",a.ErrorRecoverySet.TypeScriptS);e(j.CONST,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"const",a.ErrorRecoverySet.Var);e(j.CONTINUE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"continue",a.ErrorRecoverySet.Stmt);e(j.DEBUGGER,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.Debugger,"debugger",a.ErrorRecoverySet.Stmt);
e(j.DEFAULT,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"default",a.ErrorRecoverySet.SCase);e(j.DELETE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Delete,"delete",a.ErrorRecoverySet.Prefix);e(j.DO,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"do",a.ErrorRecoverySet.Stmt);e(j.ELSE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"else",a.ErrorRecoverySet.Else);e(j.ENUM,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"enum",a.ErrorRecoverySet.TypeScriptS);
e(j.EXPORT,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"export",a.ErrorRecoverySet.TypeScriptS);e(j.EXTENDS,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"extends",a.ErrorRecoverySet.None);e(j.DECLARE,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"declare",a.ErrorRecoverySet.Stmt);e(j.FALSE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"false",a.ErrorRecoverySet.RLit);e(j.FINALLY,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"finally",a.ErrorRecoverySet.Catch);e(j.FOR,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"for",a.ErrorRecoverySet.Stmt);e(j.FUNCTION,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"function",a.ErrorRecoverySet.Func);e(j.CONSTRUCTOR,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"constructor",a.ErrorRecoverySet.Func);e(j.GET,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"get",a.ErrorRecoverySet.Func);e(j.SET,f.TypeScript,b.No,a.NodeType.None,
b.No,a.NodeType.None,"set",a.ErrorRecoverySet.Func);e(j.IF,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"if",a.ErrorRecoverySet.Stmt);e(j.IMPLEMENTS,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"implements",a.ErrorRecoverySet.None);e(j.IMPORT,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"import",a.ErrorRecoverySet.TypeScriptS);e(j.IN,f.TypeScriptAndJS,b.Cmp,a.NodeType.In,b.No,a.NodeType.None,"in",a.ErrorRecoverySet.None);e(j.INSTANCEOF,
f.TypeScriptAndJS,b.Cmp,a.NodeType.InstOf,b.No,a.NodeType.None,"instanceof",a.ErrorRecoverySet.BinOp);e(j.INTERFACE,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"interface",a.ErrorRecoverySet.TypeScriptS);e(j.LET,f.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"let",a.ErrorRecoverySet.None);e(j.MODULE,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"module",a.ErrorRecoverySet.TypeScriptS);e(j.NEW,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"new",a.ErrorRecoverySet.PreOp);e(j.NUMBER,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"number",a.ErrorRecoverySet.PrimType);e(j.NULL,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"null",a.ErrorRecoverySet.RLit);e(j.PACKAGE,f.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"package",a.ErrorRecoverySet.None);e(j.PRIVATE,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"private",a.ErrorRecoverySet.TypeScriptS);e(j.PROTECTED,f.JavascriptFutureStrict,
b.No,a.NodeType.None,b.No,a.NodeType.None,"protected",a.ErrorRecoverySet.None);e(j.PUBLIC,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"public",a.ErrorRecoverySet.TypeScriptS);e(j.RETURN,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"return",a.ErrorRecoverySet.Stmt);e(j.STATIC,f.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"static",a.ErrorRecoverySet.None);e(j.STRING,f.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"string",a.ErrorRecoverySet.PrimType);
e(j.SUPER,f.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"super",a.ErrorRecoverySet.RLit);e(j.SWITCH,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"switch",a.ErrorRecoverySet.Stmt);e(j.THIS,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"this",a.ErrorRecoverySet.RLit);e(j.THROW,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"throw",a.ErrorRecoverySet.Stmt);e(j.TRUE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"true",a.ErrorRecoverySet.RLit);
e(j.TRY,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"try",a.ErrorRecoverySet.Stmt);e(j.TYPEOF,f.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Typeof,"typeof",a.ErrorRecoverySet.Prefix);e(j.VAR,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"var",a.ErrorRecoverySet.Var);e(j.VOID,f.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Void,"void",a.ErrorRecoverySet.Prefix);e(j.WITH,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.With,"with",a.ErrorRecoverySet.Stmt);
e(j.WHILE,f.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"while",a.ErrorRecoverySet.While);e(j.YIELD,f.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"yield",a.ErrorRecoverySet.None);e(j.ID,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"identifier",a.ErrorRecoverySet.ID);e(j.NumberLit,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"numberLiteral",a.ErrorRecoverySet.Literal);e(j.Regex,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"regex",a.ErrorRecoverySet.RegExp);
e(j.QString,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"qstring",a.ErrorRecoverySet.Literal);e(j.SColon,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,";",a.ErrorRecoverySet.SColon);e(j.RParen,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,")",a.ErrorRecoverySet.RParen);e(j.RBrack,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"]",a.ErrorRecoverySet.RBrack);e(j.LCurly,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"{",a.ErrorRecoverySet.LCurly);e(j.RCurly,f.None,b.No,a.NodeType.None,
b.No,a.NodeType.None,"}",a.ErrorRecoverySet.RCurly);e(j.Ellipsis,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"...",a.ErrorRecoverySet.None);e(j.Comma,f.None,b.Cma,a.NodeType.Comma,b.No,a.NodeType.None,",",a.ErrorRecoverySet.Comma);e(j.Asg,f.None,b.Asg,a.NodeType.Asg,b.No,a.NodeType.None,"=",a.ErrorRecoverySet.Asg);e(j.AsgAdd,f.None,b.Asg,a.NodeType.AsgAdd,b.No,a.NodeType.None,"+=",a.ErrorRecoverySet.BinOp);e(j.AsgSub,f.None,b.Asg,a.NodeType.AsgSub,b.No,a.NodeType.None,"-=",a.ErrorRecoverySet.BinOp);
e(j.AsgMul,f.None,b.Asg,a.NodeType.AsgMul,b.No,a.NodeType.None,"*=",a.ErrorRecoverySet.BinOp);e(j.AsgDiv,f.None,b.Asg,a.NodeType.AsgDiv,b.No,a.NodeType.None,"/=",a.ErrorRecoverySet.BinOp);e(j.AsgMod,f.None,b.Asg,a.NodeType.AsgMod,b.No,a.NodeType.None,"%=",a.ErrorRecoverySet.BinOp);e(j.AsgAnd,f.None,b.Asg,a.NodeType.AsgAnd,b.No,a.NodeType.None,"&=",a.ErrorRecoverySet.BinOp);e(j.AsgXor,f.None,b.Asg,a.NodeType.AsgXor,b.No,a.NodeType.None,"^=",a.ErrorRecoverySet.BinOp);e(j.AsgOr,f.None,b.Asg,a.NodeType.AsgOr,
b.No,a.NodeType.None,"|=",a.ErrorRecoverySet.BinOp);e(j.AsgLsh,f.None,b.Asg,a.NodeType.AsgLsh,b.No,a.NodeType.None,"<<=",a.ErrorRecoverySet.BinOp);e(j.AsgRsh,f.None,b.Asg,a.NodeType.AsgRsh,b.No,a.NodeType.None,">>=",a.ErrorRecoverySet.BinOp);e(j.AsgRs2,f.None,b.Asg,a.NodeType.AsgRs2,b.No,a.NodeType.None,">>>=",a.ErrorRecoverySet.BinOp);e(j.QMark,f.None,b.Que,a.NodeType.QMark,b.No,a.NodeType.None,"?",a.ErrorRecoverySet.BinOp);e(j.Colon,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,":",a.ErrorRecoverySet.Colon);
e(j.LogOr,f.None,b.Lor,a.NodeType.LogOr,b.No,a.NodeType.None,"||",a.ErrorRecoverySet.BinOp);e(j.LogAnd,f.None,b.Lan,a.NodeType.LogAnd,b.No,a.NodeType.None,"&&",a.ErrorRecoverySet.BinOp);e(j.Or,f.None,b.Bor,a.NodeType.Or,b.No,a.NodeType.None,"|",a.ErrorRecoverySet.BinOp);e(j.Xor,f.None,b.Xor,a.NodeType.Xor,b.No,a.NodeType.None,"^",a.ErrorRecoverySet.BinOp);e(j.And,f.None,b.Ban,a.NodeType.And,b.No,a.NodeType.None,"&",a.ErrorRecoverySet.BinOp);e(j.EQ,f.None,b.Equ,a.NodeType.Eq,b.No,a.NodeType.None,"==",
a.ErrorRecoverySet.BinOp);e(j.NE,f.None,b.Equ,a.NodeType.Ne,b.No,a.NodeType.None,"!=",a.ErrorRecoverySet.BinOp);e(j.Eqv,f.None,b.Equ,a.NodeType.Eqv,b.No,a.NodeType.None,"===",a.ErrorRecoverySet.BinOp);e(j.NEqv,f.None,b.Equ,a.NodeType.NEqv,b.No,a.NodeType.None,"!==",a.ErrorRecoverySet.BinOp);e(j.LT,f.None,b.Cmp,a.NodeType.Lt,b.No,a.NodeType.None,"<",a.ErrorRecoverySet.BinOp);e(j.LE,f.None,b.Cmp,a.NodeType.Le,b.No,a.NodeType.None,"<=",a.ErrorRecoverySet.BinOp);e(j.GT,f.None,b.Cmp,a.NodeType.Gt,b.No,
a.NodeType.None,">",a.ErrorRecoverySet.BinOp);e(j.GE,f.None,b.Cmp,a.NodeType.Ge,b.No,a.NodeType.None,">=",a.ErrorRecoverySet.BinOp);e(j.Lsh,f.None,b.Shf,a.NodeType.Lsh,b.No,a.NodeType.None,"<<",a.ErrorRecoverySet.BinOp);e(j.Rsh,f.None,b.Shf,a.NodeType.Rsh,b.No,a.NodeType.None,">>",a.ErrorRecoverySet.BinOp);e(j.Rs2,f.None,b.Shf,a.NodeType.Rs2,b.No,a.NodeType.None,">>>",a.ErrorRecoverySet.BinOp);e(j.Add,f.None,b.Add,a.NodeType.Add,b.Uni,a.NodeType.Pos,"+",a.ErrorRecoverySet.AddOp);e(j.Sub,f.None,b.Add,
a.NodeType.Sub,b.Uni,a.NodeType.Neg,"-",a.ErrorRecoverySet.AddOp);e(j.Mult,f.None,b.Mul,a.NodeType.Mul,b.No,a.NodeType.None,"*",a.ErrorRecoverySet.BinOp);e(j.Div,f.None,b.Mul,a.NodeType.Div,b.No,a.NodeType.None,"/",a.ErrorRecoverySet.BinOp);e(j.Pct,f.None,b.Mul,a.NodeType.Mod,b.No,a.NodeType.None,"%",a.ErrorRecoverySet.BinOp);e(j.Tilde,f.None,b.No,a.NodeType.None,b.Uni,a.NodeType.Not,"~",a.ErrorRecoverySet.PreOp);e(j.Bang,f.None,b.No,a.NodeType.None,b.Uni,a.NodeType.LogNot,"!",a.ErrorRecoverySet.PreOp);
e(j.Inc,f.None,b.No,a.NodeType.None,b.Uni,a.NodeType.IncPre,"++",a.ErrorRecoverySet.PreOp);e(j.Dec,f.None,b.No,a.NodeType.None,b.Uni,a.NodeType.DecPre,"--",a.ErrorRecoverySet.PreOp);e(j.LParen,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"(",a.ErrorRecoverySet.LParen);e(j.LBrack,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"[",a.ErrorRecoverySet.LBrack);e(j.Dot,f.None,b.Uni,a.NodeType.None,b.No,a.NodeType.None,".",a.ErrorRecoverySet.Dot);e(j.EOF,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,
"<EOF>",a.ErrorRecoverySet.EOF);e(j.Arrow,f.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"=>",a.ErrorRecoverySet.None);a.lookupToken=i;b=a.TokenClass||(a.TokenClass={});b._map=[];b._map[0]="Punctuation";b.Punctuation=0;b._map[1]="Keyword";b.Keyword=1;b._map[2]="Operator";b.Operator=2;b._map[3]="Comment";b.Comment=3;b._map[4]="Whitespace";b.Whitespace=4;b._map[5]="Identifier";b.Identifier=5;b._map[6]="Literal";b.Literal=6;var l=a.TokenClass;a.SavedToken=function(a,c,b){this.tok=a;this.minChar=c;
this.limChar=b};var c=function(a){this.tokenId=a};c.prototype.toString=function(){return"token: "+this.tokenId+" "+this.getText()+" ("+j._map[this.tokenId]+")"};c.prototype.print=function(a,c){c.WriteLine(this.toString()+",on line"+a)};c.prototype.getText=function(){return a.tokenTable[this.tokenId].text};c.prototype.classification=function(){if(this.tokenId<=j.LimKeyword)return l.Keyword;var c=i(this.tokenId);return void 0!=c&&(c.unopNodeType!=a.NodeType.None||c.binopNodeType!=a.NodeType.None)?l.Operator:
l.Punctuation};a.Token=c;b=function(a){this.tokenId=j.NumberLit;this.value=a};__extends(b,c);b.prototype.getText=function(){return this.value.toString()};b.prototype.classification=function(){return l.Literal};a.NumberToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return this.tokenId==j.ID?l.Identifier:l.Literal};a.StringToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=
a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return l.Whitespace};a.WhitespaceToken=b;b=function(a,c,b,d,e,f){this.tokenId=a;this.value=c;this.isBlock=b;this.startPos=d;this.line=e;this.endsLine=f;this.tokenID=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return l.Comment};a.CommentToken=b;b=function(a){this.tokenId=j.Regex;this.regex=a};__extends(b,c);b.prototype.getText=function(){return this.regex.toString()};
b.prototype.classification=function(){return l.Literal};a.RegexToken=b;a.staticTokens=[];a.initializeStaticTokens=function(){for(var b=0;b<=j.LimFixed;b++)a.staticTokens[b]=new c(b)}})(TypeScript||(TypeScript={}));
(function(a){var e=function(){this.arrayBase=null};e.prototype.specialize=function(a,b){null==this.arrayBase&&(this.arrayBase=a.specializeType(b.wildElm.type,this.arrayType.elementType,b,!0));return this.arrayBase};a.ArrayCache=e;var i=function(){this.onlyCaptureFirstError=!1;this.flags=a.TypeRelationshipFlags.SuccessfulComparison;this.message=""};i.prototype.addMessageToFront=function(a){this.onlyCaptureFirstError?this.setMessage(a):this.message=this.message?a+":\n\t"+this.message:a};i.prototype.setMessage=
function(a){this.message=a};a.TypeComparisonInfo=i;i=a.TypeCheckCollectionMode||(a.TypeCheckCollectionMode={});i._map=[];i._map[0]="Resident";i.Resident=0;i._map[1]="Transient";i.Transient=1;var b=a.TypeCheckCollectionMode,i=function(d){this.errorReporter=d;this.importedGlobalsTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.importedGlobalsTypeTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.ambientGlobalTypes=
this.ambientGlobals=this.globalTypes=this.globals=null;this.residentGlobalValues=new a.StringHashTable;this.residentGlobalTypes=new a.StringHashTable;this.residentGlobalAmbientValues=new a.StringHashTable;this.residentGlobalAmbientTypes=new a.StringHashTable;this.residentTypeCheck=!0;this.wildElm=this.gloMod=this.mod=null;this.importedGlobals=new a.SymbolScopeBuilder(null,this.importedGlobalsTable,null,this.importedGlobalsTypeTable,null,null);this.dualGlobalValues=new a.DualStringHashTable(this.residentGlobalValues,
new a.StringHashTable);this.dualGlobalTypes=new a.DualStringHashTable(this.residentGlobalTypes,new a.StringHashTable);this.dualAmbientGlobalValues=new a.DualStringHashTable(this.residentGlobalAmbientValues,new a.StringHashTable);this.dualAmbientGlobalTypes=new a.DualStringHashTable(this.residentGlobalAmbientTypes,new a.StringHashTable);var d=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalValues,new a.StringHashTable)),e=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalValues,
new a.StringHashTable)),c=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalTypes,new a.StringHashTable)),h=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalTypes,new a.StringHashTable));this.globalScope=new a.SymbolScopeBuilder(d,e,c,h,this.importedGlobals,null);this.voidType=this.enterPrimitive(a.Primitive.Void,"void");this.booleanType=this.enterPrimitive(a.Primitive.Boolean,"bool");this.doubleType=this.enterPrimitive(a.Primitive.Double,"number");this.importedGlobals.ambientEnclosedTypes.addPublicMember("number",
this.doubleType.symbol);this.stringType=this.enterPrimitive(a.Primitive.String,"string");this.anyType=this.enterPrimitive(a.Primitive.Any,"any");this.nullType=this.enterPrimitive(a.Primitive.Null,"null");this.undefinedType=this.enterPrimitive(a.Primitive.Undefined,"undefined");this.setCollectionMode(b.Resident);this.wildElm=new a.TypeSymbol("_element",0,-1,new a.Type);this.importedGlobalsTypeTable.addPublicMember(this.wildElm.name,this.wildElm);this.mod=new a.ModuleType(c,h);this.mod.members=d;this.mod.ambientMembers=
e;this.mod.containedScope=this.globalScope;this.gloMod=new a.TypeSymbol(a.globalId,0,-1,this.mod);this.mod.members.addPublicMember(this.gloMod.name,this.gloMod);this.defineGlobalValue("undefined",this.undefinedType)};i.prototype.enterPrimitive=function(b,e){var c=new a.Type;c.primitiveTypeClass=b;var h=new a.TypeSymbol(e,0,-1,c);h.typeCheckStatus=a.TypeCheckStatus.Finished;c.symbol=h;this.importedGlobals.enter(null,null,h,this.errorReporter,!0,!0,!0);return c};i.prototype.setCollectionMode=function(a){this.residentTypeCheck=
this.dualGlobalValues.insertPrimary=this.dualGlobalTypes.insertPrimary=this.dualAmbientGlobalValues.insertPrimary=this.dualAmbientGlobalTypes.insertPrimary=a==b.Resident};i.prototype.refreshPersistentState=function(){this.globals=new a.StringHashTable;this.globalTypes=new a.StringHashTable;this.ambientGlobals=new a.StringHashTable;this.ambientGlobalTypes=new a.StringHashTable;this.dualGlobalValues.secondaryTable=this.globals;this.dualGlobalTypes.secondaryTable=this.globalTypes;this.dualAmbientGlobalValues.secondaryTable=
this.ambientGlobals;this.dualAmbientGlobalTypes.secondaryTable=this.ambientGlobalTypes};i.prototype.defineGlobalValue=function(b,e){var c=new a.ValueLocation;c.typeLink=new a.TypeLink;c=new a.VariableSymbol(b,0,-1,c);c.setType(e);c.typeCheckStatus=a.TypeCheckStatus.Finished;c.container=this.gloMod;this.importedGlobalsTable.addPublicMember(b,c)};a.PersistentGlobalTypeState=i;var j;j=function(a,b,c){this.contextualType=a;this.provisional=b;this.contextID=c;this.targetAccessorType=this.targetThis=this.targetSig=
null};a.ContextualTypeContext=j;var f=function(a){this.checker=a;this.contextStack=[];this.hadProvisionalErrors=!1};f.contextID=a.TypeCheckStatus.Finished+1;f.prototype.pushContextualType=function(a,b){this.contextStack.push(new j(a,b,f.contextID++));this.checker.errorReporter.pushToErrorSink=b};f.prototype.popContextualType=function(){var a=this.contextStack.pop();this.checker.errorReporter.pushToErrorSink=this.isProvisional();this.hadProvisionalErrors=this.hadProvisionalErrors||a.provisional&&this.checker.errorReporter.getCapturedErrors().length;
this.checker.errorReporter.freeCapturedErrors();return a};f.prototype.getContextualType=function(){return!this.contextStack.length?null:this.contextStack[this.contextStack.length-1]};f.prototype.getContextID=function(){return!this.contextStack.length?a.TypeCheckStatus.Finished:this.contextStack[this.contextStack.length-1].contextID};f.prototype.isProvisional=function(){return!this.contextStack.length?!1:this.contextStack[this.contextStack.length-1].provisional};a.ContextualTypingContextStack=f;i=
function(a){this.persistentState=a;this.errorReporter=null;this.checkControlFlowUseDef=this.printControlFlowGraph=this.checkControlFlow=!1;this.units=this.styleSettings=null;this.anon="_anonymous";this.currentModDecl=this.currentCompareB=this.currentCompareA=this.typeFlow=this.locationInfo=null;this.inWith=this.inBind=!1;this.errorsOnWith=!0;this.currentContextualTypeContext=null;this.canCallDefinitionSignature=this.resolvingBases=!1;this.assignableCache={};this.subtypeCache={};this.identicalCache=
{};this.provisionalStartedTypecheckObjects=[];this.voidType=this.persistentState.voidType;this.booleanType=this.persistentState.booleanType;this.numberType=this.persistentState.doubleType;this.stringType=this.persistentState.stringType;this.anyType=this.persistentState.anyType;this.nullType=this.persistentState.nullType;this.undefinedType=this.persistentState.undefinedType;this.globals=this.persistentState.dualGlobalValues;this.globalTypes=this.persistentState.dualGlobalTypes;this.ambientGlobals=
this.persistentState.dualAmbientGlobalValues;this.ambientGlobalTypes=this.persistentState.dualAmbientGlobalTypes;this.gloModType=this.persistentState.mod;this.gloMod=this.persistentState.gloMod;this.wildElm=this.persistentState.wildElm;this.globalScope=this.persistentState.globalScope;this.typingContextStack=new f(this)};i.prototype.setStyleOptions=function(a){this.styleSettings=a};i.prototype.setContextualType=function(a,b){this.typingContextStack.pushContextualType(a,b);this.currentContextualTypeContext=
this.typingContextStack.getContextualType()};i.prototype.unsetContextualType=function(){var a=this.typingContextStack.popContextualType();this.currentContextualTypeContext=this.typingContextStack.getContextualType();return a};i.prototype.hadProvisionalErrors=function(){return this.typingContextStack.hadProvisionalErrors};i.prototype.resetProvisionalErrors=function(){this.typingContextStack.getContextualType()||(this.typingContextStack.hadProvisionalErrors=!1)};i.prototype.typeCheckWithContextualType=
function(a,b,c,h){c&&this.setContextualType(a,this.typingContextStack.isProvisional()||b);this.typeFlow.typeCheck(h);c&&this.unsetContextualType()};i.prototype.resetTargetType=function(){this.currentContextualTypeContext=this.typingContextStack.getContextualType()};i.prototype.killTargetType=function(){this.currentContextualTypeContext=null;this.errorReporter.pushToErrorSink=!1};i.prototype.hasTargetType=function(){return this.currentContextualTypeContext&&this.currentContextualTypeContext.contextualType};
i.prototype.getTargetTypeContext=function(){return this.currentContextualTypeContext};i.prototype.inProvisionalTypecheckMode=function(){return this.typingContextStack.isProvisional()};i.prototype.getTypeCheckFinishedStatus=function(){return this.inProvisionalTypecheckMode()?this.typingContextStack.getContextID():a.TypeCheckStatus.Finished};i.prototype.typeStatusIsFinished=function(b){return b==a.TypeCheckStatus.Finished||this.inProvisionalTypecheckMode()&&b==this.typingContextStack.getContextID()};
i.prototype.addStartedPTO=function(a){this.inProvisionalTypecheckMode()&&(this.provisionalStartedTypecheckObjects[this.provisionalStartedTypecheckObjects.length]=a)};i.prototype.cleanStartedPTO=function(){for(var b=0;b<this.provisionalStartedTypecheckObjects.length;b++)this.provisionalStartedTypecheckObjects[b].typeCheckStatus=a.TypeCheckStatus.NotStarted;this.provisionalStartedTypecheckObjects=[]};i.prototype.collectTypes=function(b){b.nodeType==a.NodeType.Script&&(this.locationInfo=b.locationInfo);
var e=new a.ScopeChain(this.gloMod,null,this.globalScope),e=new a.TypeCollectionContext(e,this);a.getAstWalkerFactory().walk(b,a.preCollectTypes,a.postCollectTypes,null,e)};i.prototype.makeArrayType=function(b){null==b.arrayCache&&(b.arrayCache=new e,b.arrayCache.arrayType=new a.Type,b.arrayCache.arrayType.elementType=b,b.arrayCache.arrayType.symbol=b.symbol);return b.arrayCache.arrayType};i.prototype.getParameterList=function(b,e){var c=null,c=null,h=b.members.length,g=0,f=[];if(0<h)for(var c=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),c=new a.SymbolScopeBuilder(c,null,null,null,null,e),i=0;i<h;i++){var j=b.members[i],m=new a.ValueLocation,s=new a.ParameterSymbol(j.id.text,j.minChar,this.locationInfo.unitIndex,m);s.declAST=j;j.id.sym=s;j.sym=s;m.symbol=s;m.typeLink=a.getTypeLink(j.typeExpr,this,!1);c.enter(null,j,s,this.errorReporter,!0,!1,!1);f[f.length]=s;j.isOptionalArg()||g++}return{parameters:f,nonOptionalParameterCount:g}};i.prototype.createFunctionSignature=function(b,e,c,h,g){var f=a.hasFlag(b.fncFlags,
a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)||e==this.gloMod,i=a.hasFlag(b.fncFlags,a.FncFlags.Static),j=a.hasFlag(b.fncFlags,a.FncFlags.Private),m=a.hasFlag(b.fncFlags,a.FncFlags.Definition),s=a.hasFlag(b.fncFlags,a.FncFlags.Ambient),n=b.isConstructMember()||b.isConstructor,p=e==this.gloMod,r=new a.Signature,t=b.fncFlags&a.FncFlags.IsFunctionExpression;b.returnTypeAnnotation||m?r.returnType=a.getTypeLink(b.returnTypeAnnotation,this,!1):(r.returnType=new a.TypeLink,r.returnType.type=
this.anyType);r.hasVariableArgList=b.variableArgList;m=this.getParameterList(b.args,e);r.parameters=m.parameters;r.nonOptionalParameterCount=m.nonOptionalParameterCount;b.signature=r;r.declAST=b;var u=h&&h.getType()&&!h.isAccessor()&&(b.isSignature()||s==a.hasFlag(h.flags,a.SymbolFlags.Ambient));u&&j!=a.hasFlag(h.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Public/Private visibility of overloads does not agree");m=u?h.getType():new a.Type;n?(null==m.construct&&(m.construct=new a.SignatureGroup),
m.construct.addSignature(r),m.construct.hasImplementation=!b.isSignature(),m.construct.hasImplementation&&m.setHasImplementation()):b.isIndexerMember()?(null==m.index&&(m.index=new a.SignatureGroup,m.index.flags|=a.SignatureFlags.IsIndexer),m.index.addSignature(r),m.index.hasImplementation=!b.isSignature(),m.index.hasImplementation&&m.setHasImplementation()):(null==m.call&&(m.call=new a.SignatureGroup),m.call.addSignature(r),m.call.hasImplementation=!b.isSignature(),m.call.hasImplementation&&m.setHasImplementation());
var w=m.instanceType;w&&!i&&(null==w.call?w.call=m.call:m.call&&w.call.signatures.concat(m.call.signatures));var w=null,A=!1;b.name&&!b.name.isMissing()?w=b.name.text:b.hint&&(w=b.hint,A=!0);null==m.symbol&&(m.symbol=new a.TypeSymbol(w?w:this.anon,b.minChar,this.locationInfo.unitIndex,m),u||(m.symbol.declAST=b));i&&(m.symbol.flags|=a.SymbolFlags.Static);s&&(m.symbol.flags|=a.SymbolFlags.Ambient);j&&(m.symbol.flags|=a.SymbolFlags.Private);m.symbol.isMethod=b.isMethod();m.symbol.isMethod&&(m.symbol.flags|=
a.SymbolFlags.Property);b.type=m;if(!n)if(w&&!t&&!b.isAccessor()&&!A)if(g)if(b.isMethod()&&i)e.type.members.publicMembers.add(w,m.symbol)||this.errorReporter.duplicateIdentifier(b,w),m.symbol.container=e;else{if(null==h||h.declAST&&!h.declAST.isOverload&&e.isType())c.enter(e,b,m.symbol,this.errorReporter,!j&&(f||i||p),!1,s)}else b.isSpecialFn()||(m.symbol.container=e);else b.isSpecialFn()||(m.symbol.container=e);if(u&&(b=h?h.getType():null,m!=b&&(null==m.construct?m.construct=b&&b.construct?b.construct:
new a.SignatureGroup:b&&b.construct&&m.construct.signatures.concat(b.construct.signatures),b))){null==m.call?m.call=b.call:b.call&&m.call.signatures.concat(b.call.signatures);if(!i&&(null==m.instanceType&&(m.instanceType=b.instanceType),w=m.instanceType))null==w.call?w.call=b.call:b.call&&w.call.signatures.concat(b.call.signatures);null==m.index?m.index=b.index:b.index&&m.index.signatures.concat(b.index.signatures)}return r};i.prototype.createAccessorSymbol=function(b,e,c,h,g,f,i){var j=null,m=b.signature,
s=b.name.text,n=a.hasFlag(b.fncFlags,a.FncFlags.Static),p=a.hasFlag(b.fncFlags,a.FncFlags.Private);null==e?(e=new a.ValueLocation,j=new a.FieldSymbol(s,b.minChar,this.locationInfo.unitIndex,!1,e),e.symbol=j,j.declAST=b,a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(j.getter&&this.errorReporter.simpleError(b,"Redeclaration of property getter"),j.getter=m.declAST.type.symbol):(j.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),j.setter=m.declAST.type.symbol),e.typeLink=a.getTypeLink(null,
this,!1),h?c?(c.members.publicMembers.add(s,j)||this.errorReporter.duplicateIdentifier(b,j.name),j.container=c.symbol):this.errorReporter.simpleError(b,"Accessor property may not be added in this context"):f.enter(i,b,j,this.errorReporter,!p||n,!1,!1),g&&(j.flags|=a.SymbolFlags.Property),n&&(j.flags|=a.SymbolFlags.Static),j.flags=p?j.flags|a.SymbolFlags.Private:j.flags|a.SymbolFlags.Public):(j=e,p!=a.hasFlag(j.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Getter and setter accessors do not agree in visibility"),
a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(j.getter&&this.errorReporter.simpleError(b,"Redeclaration of property getter"),j.getter=b.type.symbol):(j.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),j.setter=b.type.symbol));return j};i.prototype.addBases=function(b,e,c){b.addParentScope(new a.SymbolTableScope(e.members,e.ambientMembers,e.getAllEnclosedTypes(),e.getAllAmbientEnclosedTypes(),e.symbol));var h=0,g;if(e.extendsList)for(var f=e.extendsList.length;h<f;h++){g=
e.extendsList[h];if(c.baseId==g.typeID){this.errorReporter.reportErrorFromSym(g.symbol,"Type '"+c.base+"' is recursively referenced as a base class of itself");g.symbol.flags|=a.SymbolFlags.RecursivelyReferenced;break}this.addBases(b,g,c)}};i.prototype.scopeOf=function(b){var e=new a.SymbolAggregateScope(b.symbol);this.addBases(e,b,{base:b.symbol&&b.symbol.name?b.symbol.name:"{}",baseId:b.typeID});return e};i.prototype.lookupMemberType=function(a,b){var c=null;a.containedScope?c=a.containedScope.find(b,
!1,!0):a.members&&(c=a.members.allMembers.lookup(b),null==c&&a.ambientMembers&&(c=a.ambientMembers.allMembers.lookup(b)));if(null==c){var h=a.getAllEnclosedTypes(),g=a.getAllAmbientEnclosedTypes();h&&(c=h.allMembers.lookup(b),null==c&&g&&(c=g.allMembers.lookup(b)))}return c&&c.isType()?c.getType():null};i.prototype.findSymbolForDynamicModule=function(b,e,c){var h=b,g=c(b);if(null==g&&(g||(b=a.swapQuotes(h),g=c(b)),g||(b=a.stripQuotes(h)+".ts",g=c(b)),g||(b=a.stripQuotes(h)+".str",g=c(b)),g||(b=a.stripQuotes(h)+
".d.ts",g=c(b)),g||(b=a.stripQuotes(h)+".d.str",g=c(b)),!g&&!a.isRelative(h))){h=a.stripQuotes(h);for(e=a.getRootFilePath(a.switchToForwardSlashes(e));null==g&&""!=e&&"/"!=e;)b=a.normalizePath(e+h+".ts"),g=c(b),null==g&&(b=a.changePathToSTR(b),g=c(b)),null==g&&(b=a.changePathToDTS(b),g=c(b)),null==g&&(b=a.changePathToDSTR(b),g=c(b)),null==g&&(e=(e=a.normalizePath(e+".."))&&"/"!=e?e+"/":e)}return g};i.prototype.resolveTypeMember=function(b,e){var c=e.operand1,h=e.operand2,g=this.anyType,f=this.anyType;
if(c&&h&&h.nodeType==a.NodeType.Name){if(c.nodeType==a.NodeType.Dot)f=this.resolveTypeMember(b,c);else if(c.nodeType==a.NodeType.Name){var j=b.find(c.text,!1,!0);if(null==j)this.errorReporter.unresolvedSymbol(c,c.text);else if(j.isType()){if(j.aliasLink&&(!j.type&&j.aliasLink.alias.nodeType==a.NodeType.Name)&&(f=this.findSymbolForDynamicModule(j.aliasLink.alias.text,this.locationInfo.filename,function(a){return b.find(a,!1,!0)})))j.type=f.getType();if(a.optimizeModuleCodeGen&&j&&(f=j.getType())&&
j.aliasLink&&j.onlyReferencedAsTypeRef)if((f=f.symbol.declAST)&&a.hasFlag(f.modFlags,a.ModuleFlags.IsDynamic))j.onlyReferencedAsTypeRef=!this.resolvingBases;j.visible(b,this)||this.errorReporter.simpleError(c,"The symbol '"+c.text+"' is not visible at this point");f=j.getType();c.sym=j}else this.errorReporter.simpleError(c,"Expected type")}f||(f=this.anyType);f!=this.anyType&&(g=this.lookupMemberType(f,h.text),null==g?(g=this.anyType,this.errorReporter.simpleError(e,"Expected type")):g.symbol.visible(b,
this)||this.errorReporter.simpleError(c,"The symbol '"+h.text+"' is not visible at this point"),h.sym=g.symbol)}g.isClass()&&(g=g.instanceType);return g};i.prototype.resolveFuncDecl=function(a,b,c){var c=this.createFunctionSignature(a,b.container,b,c,!1).declAST.type.symbol,h;h=a.isConstructMember()?c.type.construct.signatures:a.isIndexerMember()?c.type.getInstanceType().index.signatures:c.type.call.signatures;h=h[h.length-1];for(var g=h.parameters.length,e=0;e<g;e++)this.resolveTypeLink(b,h.parameters[e].parameter.typeLink,
!0);g&&a.variableArgList&&!h.parameters[g-1].parameter.typeLink.type.elementType&&(this.errorReporter.simpleErrorFromSym(h.parameters[g-1].parameter.symbol,"... parameter must have array type"),h.parameters[g-1].parameter.typeLink.type.elementType=this.makeArrayType(h.parameters[g-1].parameter.typeLink.type));this.resolveTypeLink(b,h.returnType,a.isSignature());return c};i.prototype.resolveVarDecl=function(b,e){var c=new a.ValueLocation,h=new a.FieldSymbol(b.id.text,b.minChar,this.locationInfo.unitIndex,
(b.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,c);h.transferVarFlags(b.varFlags);c.symbol=h;h.declAST=b;c.typeLink=a.getTypeLink(b.typeExpr,this,null==b.init);this.resolveTypeLink(e,c.typeLink,!0);b.sym=h;b.type=c.typeLink.type;return h};i.prototype.resolveTypeLink=function(b,e,c){var h=0;if(null==e.type){var g=e.ast;if(g)for(;null==e.type;)switch(g.nodeType){case a.NodeType.Name:var f=g,j=b.find(f.text,!1,!0);null==j?(e.type=this.anyType,this.errorReporter.unresolvedSymbol(f,f.text)):j.isType()?
(j.visible(b,this)||this.errorReporter.simpleError(g,"The symbol '"+f.text+"' is not visible at this point"),f.sym=j,e.type=j.getType(),e.type?e.type.isClass()&&(e.type=e.type.instanceType):e.type=this.anyType):(e.type=this.anyType,this.errorReporter.simpleError(g,"Expected type"));break;case a.NodeType.Dot:e.type=this.resolveTypeMember(b,g);break;case a.NodeType.TypeRef:h=g.arrayCount;g=g.term;null==g&&(e.type=this.anyType);break;case a.NodeType.Interface:var i=g,f=new a.Type,j=new a.TypeSymbol(i.name.text,
g.minChar,this.locationInfo.unitIndex,f);f.symbol=j;f.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));f.containedScope=new a.SymbolTableScope(f.members,null,null,null,j);f.containedScope.container=j;f.memberScope=f.containedScope;for(var i=i.members.members,m=i.length,s=0;s<m;s++){var n=i[s],p=null,r=!0,t=null;n.nodeType==a.NodeType.FuncDecl?(t=n.name,p=f.members.allMembers.lookup(n.getNameText()),r=null==p,n.isSpecialFn()?(r=!1,p=this.resolveFuncDecl(n,
b,j)):p=this.resolveFuncDecl(n,b,p),n.type=p.type):(t=n.id,p=this.resolveVarDecl(n,b));r&&(t&&a.hasFlag(t.flags,a.ASTFlags.OptionalName)&&(p.flags|=a.SymbolFlags.Optional),f.members.allMembers.add(p.name,p)||this.errorReporter.duplicateIdentifier(g,p.name))}g.type=f;e.type=f;break;case a.NodeType.FuncDecl:f=this.resolveFuncDecl(g,b,null);e.type=f.type;break;default:e.type=this.anyType,this.errorReporter.simpleError(g,"Expected type")}for(b=h;0<b;b--)e.type=this.makeArrayType(e.type);c&&null==e.type&&
(e.type=this.anyType);e.ast&&(e.ast.type=e.type)}};i.prototype.findMostApplicableSignature=function(a,b){if(1==a.length)return{sig:a[0].signature,ambiguous:!1};for(var c=a[0],h=null,g=null,e=null,f=null,g=!1,j=1;j<a.length;j++){for(var h=a[j],i=0,i=0;b&&i<b.members.length;i++)if(g=b.members[i].type,e=i<c.signature.parameters.length?c.signature.parameters[i].getType():c.signature.parameters[c.signature.parameters.length-1].getType().elementType,f=i<h.signature.parameters.length?h.signature.parameters[i].getType():
h.signature.parameters[h.signature.parameters.length-1].getType().elementType,!this.typesAreIdentical(e,f))if(this.typesAreIdentical(g,e))break;else if(this.typesAreIdentical(g,f)){c=h;break}else if(this.sourceIsSubtypeOfTarget(e,f))break;else if(this.sourceIsSubtypeOfTarget(f,e)){c=h;break}else if(h.hadProvisionalErrors)break;else if(c.hadProvisionalErrors){c=h;break}g=!b||i==b.members.length?!this.findBestCommonType(c.signature.returnType.type,null,{getLength:function(){return 2},setTypeAtIndex:function(){},
getTypeAtIndex:function(a){return a?h.signature.returnType.type:c.signature.returnType.type}}):!1}return{sig:c.signature,ambiguous:g}};i.prototype.getApplicableSignatures=function(b,e,c){for(var h=[],g=null,f=!1,j=!1,i=0;i<b.length;i++){for(var f=!1,m=0;m<e.members.length;m++)if(!(m>=b[i].parameters.length)&&(g=b[i].parameters[m].getType(),b[i].declAST.variableArgList&&(m>=b[i].nonOptionalParameterCount-1&&g.isArray())&&(g=g.elementType),g!=this.anyType))if(e.members[m].nodeType==a.NodeType.FuncDecl){if(!(this.typeFlow.functionInterfaceType&&
g==this.typeFlow.functionInterfaceType))if(this.canContextuallyTypeFunction(g,e.members[m],!0)){if(this.typeCheckWithContextualType(g,!0,!0,e.members[m]),this.cleanStartedPTO(),j=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(e.members[m].type,g,c)||(c&&c.setMessage("Could not apply type '"+g.getTypeName()+"' to argument "+(m+1)+", which is of type '"+e.members[m].type.getTypeName()+"'"),f=!0),j&&(this.typeCheckWithContextualType(null,!0,!0,e.members[m]),this.sourceIsAssignableToTarget(e.members[m].type,
g)||(f=!0),this.cleanStartedPTO()),this.resetProvisionalErrors(),f)break}else if(this.canContextuallyTypeFunction(g,e.members[m],!1)){if(this.typeFlow.typeCheck(e.members[m]),!this.sourceIsAssignableToTarget(e.members[m].type,g,c))break}else break}else if(e.members[m].nodeType==a.NodeType.ObjectLit){if(!(this.typeFlow.objectInterfaceType&&g==this.typeFlow.objectInterfaceType)&&(this.typeCheckWithContextualType(g,!0,!0,e.members[m]),this.cleanStartedPTO(),j=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(e.members[m].type,
g,c)||(c&&c.setMessage("Could not apply type '"+g.getTypeName()+"' to argument "+(m+1)+", which is of type '"+e.members[m].type.getTypeName()+"'"),f=!0),j&&(this.typeCheckWithContextualType(null,!0,!0,e.members[m]),this.sourceIsAssignableToTarget(e.members[m].type,g)||(f=!0),this.cleanStartedPTO()),this.resetProvisionalErrors(),f))break}else if(e.members[m].nodeType==a.NodeType.ArrayLit&&!(this.typeFlow.arrayInterfaceType&&g==this.typeFlow.arrayInterfaceType)){this.typeCheckWithContextualType(g,!0,
!0,e.members[m]);this.cleanStartedPTO();j=this.hadProvisionalErrors();if(!this.sourceIsAssignableToTarget(e.members[m].type,g,c)){c&&c.setMessage("Could not apply type '"+g.getTypeName()+"' to argument "+(m+1)+", which is of type '"+e.members[m].type.getTypeName()+"'");break}j&&(this.typeCheckWithContextualType(null,!0,!0,e.members[m]),this.sourceIsAssignableToTarget(e.members[m].type,g)||(f=!0),this.cleanStartedPTO());this.resetProvisionalErrors();if(f)break}m==e.members.length&&(h[h.length]={signature:b[i],
hadProvisionalErrors:j});j=!1}return h};i.prototype.canContextuallyTypeFunction=function(a,b,c){if(b.isParenthesized||b.isMethod()||c&&b.returnTypeAnnotation||b.isInlineCallLiteral)return!1;c=c||this.typeFlow.functionInterfaceType==a;if(!c)return!0;b.signature||(this.createFunctionSignature(b,this.typeFlow.scope.container,this.typeFlow.scope,null,null),this.typeFlow.typeCheck(b));for(var b=b.signature,h=b.parameters.length,g=0;g<h;g++){var e=b.parameters[g].declAST;if(c&&e.typeExpr)return!1}if(a.construct&&
a.call)return!1;a=a.construct?a.construct:a.call;return!a||1<a.signatures.length?!1:!0};i.prototype.canContextuallyTypeObjectLiteral=function(b,e){if(b==this.typeFlow.objectInterfaceType)return!0;var c=e.operand;if(!c||!b.memberScope)return!1;for(var h=null,h=null,g="",f={},j=0;j<c.members.length;j++){h=c.members[j].operand1;if(h.nodeType==a.NodeType.Name)g=h.text;else if(h.nodeType==a.NodeType.QString)h=h.text,g=h.substring(1,h.length-1);else return!1;h=b.memberScope.find(g,!0,!1);if(!h)return!1;
f[g]=!0}c=b.memberScope.getAllValueSymbolNames(!0);for(j=0;j<c.length;j++)if(h=b.memberScope.find(c[j],!0,!1),!f[c[j]]&&!a.hasFlag(h.flags,a.SymbolFlags.Optional))return!1;return!0};i.prototype.widenType=function(a){return a==this.undefinedType||a==this.nullType?this.anyType:a};i.prototype.isNullOrUndefinedType=function(a){return a==this.undefinedType||a==this.nullType};i.prototype.findBestCommonType=function(a,b,c,h){var g=0,e=c.getLength(),f=0;b&&(a=a?a.mergeOrdered(b,this):b);for(var j=a;f<e;){for(g=
0;g<e;g++)if(g!=f){if(j&&(a=j.mergeOrdered(c.getTypeAtIndex(g),this,h)))j=a;if(a==this.anyType||null==a)break;else b&&c.setTypeAtIndex(g,b)}if(j&&a)break;f++;f<e&&(j=c.getTypeAtIndex(f))}return a};i.prototype.typesAreIdentical=function(b,e){if(b==e)return!0;if(!b||!e)return!1;var c=e.typeID<<16|b.typeID;if(this.identicalCache[c])return!0;if(b.typeFlags&a.TypeFlags.IsEnum||e.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||e.isArray()){if(!b.isArray()||!e.isArray())return!1;this.identicalCache[c]=
!1;var h=this.typesAreIdentical(b.elementType,e.elementType);this.subtypeCache[c]=h?!0:void 0;return h}if(b.primitiveTypeClass!=e.primitiveTypeClass)return!1;this.identicalCache[c]=!1;if(b.memberScope&&e.memberScope){var h=b.memberScope.getAllValueSymbolNames(!0).sort(),g=e.memberScope.getAllValueSymbolNames(!0).sort();if(h.length!=g.length)return this.identicalCache[c]=void 0,!1;for(var f=null,j=null,j=f=null,i=0;i<h.length;i++){if(h[i]!=g[i])return this.identicalCache[c]=void 0,!1;f=b.memberScope.find(h[i],
!1,!1);j=e.memberScope.find(g[i],!1,!1);if((f.flags&a.SymbolFlags.Optional)!=(j.flags&a.SymbolFlags.Optional))return this.identicalCache[c]=void 0,!1;f=f.getType();j=j.getType();if((!f||!(j&&void 0!=this.identicalCache[j.typeID<<16|f.typeID]))&&!this.typesAreIdentical(f,j))return this.identicalCache[c]=void 0,!1}}else if(b.memberScope||e.memberScope)return this.identicalCache[c]=void 0,!1;return!this.signatureGroupsAreIdentical(b.call,e.call)||!this.signatureGroupsAreIdentical(b.construct,e.construct)||
!this.signatureGroupsAreIdentical(b.index,e.index)?(this.identicalCache[c]=void 0,!1):this.identicalCache[c]=!0};i.prototype.signatureGroupsAreIdentical=function(a,b){if(a==b)return!0;if(!a||!b||a.signatures.length!=b.signatures.length)return!1;for(var c=null,h=null,g=!1,e=0;e<a.signatures.length;e++){for(var c=a.signatures[e],f=0;f<b.signatures.length;f++)if(h=b.signatures[f],this.signaturesAreIdentical(c,h)){g=!0;break}if(g)g=!1;else return!1}return!0};i.prototype.signaturesAreIdentical=function(a,
b){if(a.hasVariableArgList!=b.hasVariableArgList||a.nonOptionalParameterCount!=b.nonOptionalParameterCount||a.parameters.length!=b.parameters.length||!this.typesAreIdentical(a.returnType.type,b.returnType.type))return!1;for(var c=0;c<a.parameters.length;c++)if(!this.typesAreIdentical(a.parameters[c].parameter.typeLink.type,b.parameters[c].parameter.typeLink.type))return!1;return!0};i.prototype.sourceIsSubtypeOfTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};
i.prototype.signatureGroupIsSubtypeOfTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};i.prototype.signatureIsSubtypeOfTarget=function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};i.prototype.sourceIsAssignableToTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!0,this.assignableCache,c)};i.prototype.signatureGroupIsAssignableToTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!0,
this.assignableCache,c)};i.prototype.signatureIsAssignableToTarget=function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!0,this.assignableCache,c)};i.prototype.sourceIsRelatableToTarget=function(b,e,c,h,g){if(b==e||!b||!e)return!0;var f=b.typeID<<16|e.typeID;if(h[f])return!0;if(c){if(b==this.anyType||e==this.anyType)return!0}else if(e==this.anyType)return!0;if(b==this.undefinedType||b==this.nullType&&e!=this.undefinedType&&e!=this.voidType||e==this.numberType&&b.typeFlags&a.TypeFlags.IsEnum||
b==this.numberType&&e.typeFlags&a.TypeFlags.IsEnum)return!0;if(b.typeFlags&a.TypeFlags.IsEnum||e.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||e.isArray()){if(!b.isArray()||!e.isArray())return!1;h[f]=!1;g=this.sourceIsRelatableToTarget(b.elementType,e.elementType,c,h,g);h[f]=g?!0:void 0;return g}if(b.primitiveTypeClass!=e.primitiveTypeClass)if(e.primitiveTypeClass==a.Primitive.None)if(b==this.numberType&&this.typeFlow.numberInterfaceType)b=this.typeFlow.numberInterfaceType;else if(b==this.stringType&&
this.typeFlow.stringInterfaceType)b=this.typeFlow.stringInterfaceType;else if(b==this.booleanType&&this.typeFlow.booleanInterfaceType)b=this.typeFlow.booleanInterfaceType;else return!1;else return!1;h[f]=!1;if(b.hasBase(e))return h[f]=!0;if(this.typeFlow.objectInterfaceType&&e==this.typeFlow.objectInterfaceType||this.typeFlow.functionInterfaceType&&(b.call||b.construct)&&e==this.typeFlow.functionInterfaceType)return!0;if(e.isClass()||e.isClassInstance())return h[f]=void 0,!1;if(e.memberScope&&b.memberScope)for(var j=
e.memberScope.getAllValueSymbolNames(!0),i=null,m=null,s=null,n=m=null,p=0;p<j.length;p++)if(i=e.memberScope.find(j[p],!1,!1),m=b.memberScope.find(j[p],!1,!1),!(i.kind()==a.SymbolKind.Variable&&i.variable.typeLink.ast&&i.variable.typeLink.ast.nodeType==a.NodeType.Name&&"IArguments"==i.variable.typeLink.ast.text)){i.isInferenceSymbol()&&(n=i,n.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(i.declAST));s=i.getType();if(!m&&(this.typeFlow.objectInterfaceType&&(m=this.typeFlow.objectInterfaceType.memberScope.find(j[p],
!1,!1)),!m)){if(this.typeFlow.functionInterfaceType&&(s.call||s.construct))m=this.typeFlow.functionInterfaceType.memberScope.find(j[p],!1,!1);if(!m)if(i.flags&a.SymbolFlags.Optional)continue;else return h[f]=void 0,g&&(g.flags|=a.TypeRelationshipFlags.RequiredPropertyIsMissing,g.addMessageToFront("Type '"+b.getTypeName()+"' is missing property '"+j[p]+"' from type '"+e.getTypeName()+"'")),!1}m.isInferenceSymbol()&&(n=m,n.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(m.declAST));
m=m.getType();if((!s||!(m&&void 0!=h[m.typeID<<16|s.typeID]))&&!this.sourceIsRelatableToTarget(m,s,c,h,g))return h[f]=void 0,g&&(g.flags|=a.TypeRelationshipFlags.IncompatiblePropertyTypes,g.addMessageToFront("Types of property '"+i.name+"' of types '"+b.getTypeName()+"' and '"+e.getTypeName()+"' are incompatible")),!1}return(b.call||e.call)&&!this.signatureGroupIsRelatableToTarget(b.call,e.call,c,h,g)?(g&&(b.call&&e.call?g.addMessageToFront("Call signatures of types '"+b.getTypeName()+"' and '"+e.getTypeName()+
"' are incompatible"):(c=e.call?e.getTypeName():b.getTypeName(),b=!e.call?e.getTypeName():b.getTypeName(),g.setMessage("Type '"+c+"' requires a call signature, but Type '"+b+"' lacks one")),g.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),h[f]=void 0,!1):(b.construct||e.construct)&&!this.signatureGroupIsRelatableToTarget(b.construct,e.construct,c,h,g)?(g&&(b.construct&&e.construct?g.addMessageToFront("Construct signatures of types '"+b.getTypeName()+"' and '"+e.getTypeName()+"' are incompatible"):
(c=e.construct?e.getTypeName():b.getTypeName(),b=!e.construct?e.getTypeName():b.getTypeName(),g.setMessage("Type '"+c+"' requires a construct signature, but Type '"+b+"' lacks one")),g.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),h[f]=void 0,!1):e.index&&!this.signatureGroupIsRelatableToTarget(!b.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:b.index,!e.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:e.index,c,h,g)?(g&&(g.addMessageToFront("Index signatures of types '"+
b.getTypeName()+"' and '"+e.getTypeName()+"' are incompatible"),g.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),h[f]=void 0,!1):h[f]=!0};i.prototype.signatureGroupIsRelatableToTarget=function(a,b,c,h,g){if(a==b)return!0;if(!a||!b)return!1;for(var e=null,f=null,j=!1,i=0;i<b.signatures.length;i++){for(var e=b.signatures[i],s=0;s<a.signatures.length;s++)if(f=a.signatures[s],this.signatureIsRelatableToTarget(f,e,c,h,g)){j=!0;break}if(j)j=!1;else return!1}return!0};i.prototype.signatureIsRelatableToTarget=
function(b,e,c,h,g){if(!b.parameters||!e.parameters)return!1;var f=e.hasVariableArgList?e.nonOptionalParameterCount-1:e.nonOptionalParameterCount,j=b.hasVariableArgList?b.nonOptionalParameterCount-1:b.nonOptionalParameterCount;if(j>f&&!e.hasVariableArgList)return g&&(g.flags|=a.TypeRelationshipFlags.SourceSignatureHasTooManyParameters,g.addMessageToFront("Call signature expects "+f+" or fewer parameters")),!1;var i=b.returnType.type,m=e.returnType.type;if(m!=this.voidType&&!this.sourceIsRelatableToTarget(i,
m,c,h,g))return g&&(g.flags|=a.TypeRelationshipFlags.IncompatibleReturnTypes),!1;for(var i=j<f&&b.hasVariableArgList?f:j,s=m=null,n=0,p=0;n<i;n++,p++)if(!b.hasVariableArgList||n<j?m=b.parameters[n].parameter.typeLink.type:n==j&&(m=b.parameters[n].parameter.typeLink.type,m.elementType&&(m=m.elementType)),p<e.parameters.length&&p<f?s=e.parameters[p].parameter.typeLink.type:e.hasVariableArgList&&p==f&&(s=e.parameters[p].parameter.typeLink.type,s.elementType&&(s=s.elementType)),!this.sourceIsRelatableToTarget(m,
s,c,h,g)&&!this.sourceIsRelatableToTarget(s,m,c,h,g))return g&&(g.flags|=a.TypeRelationshipFlags.IncompatibleParameterTypes),!1;return!0};a.TypeChecker=i})(TypeScript||(TypeScript={}));
(function(a){function e(c,b){if(c){var h=c.members.length;null==b&&(b=[]);for(var g=0;g<h;g++){var d=c.members[g];d.nodeType==a.NodeType.Call&&(d=d.target);var e=new a.TypeLink;e.ast=d;b[b.length]=e}}return b}function i(a,c){a.extendsTypeLinks=e(c.extendsList,a.extendsTypeLinks);a.implementsTypeLinks=e(c.implementsList,a.implementsTypeLinks)}function b(c){var b=new a.Signature;b.returnType=new a.TypeLink;b.returnType.type=c.instanceType;b.parameters=[];c.construct=new a.SignatureGroup;c.construct.addSignature(b)}
function j(a,c){var b=c.scope.find(a,!1,!0);null==b&&c.previous&&(b=j(a,c.previous));return b}function f(c,b){var g=null;switch(c.nodeType){case a.NodeType.Name:var h=c.text,g=function(){return b.members?b.members.lookup(h):j(h,b.topLevelScope)},g=a.isQuoted(h)?b.tcContext.checker.findSymbolForDynamicModule(h,b.tcContext.script.locationInfo.filename,g):g(h);break;case a.NodeType.Dot:var d=f(c.operand1,b);d&&d.getType()&&(g=f(c.operand2,b))}if(g)if(d=g.getType()){if(d=d.members)b.members=d.publicMembers}else b.tcContext.checker.errorReporter.simpleError(c,
"Potentially circular alias reference - could not obtain type of alias");return g}function d(c,b,g){var b=g.scopeChain,h=null,h=null,d=a.hasFlag(c.varFlags,a.VarFlags.Exported),e=f(c.alias,{topLevelScope:b,members:null,tcContext:g}),k=g.scopeChain.container==g.checker.gloMod;e&&(e=e.getType())&&(h=e);h=new a.TypeSymbol(c.id.text,c.minChar,g.checker.locationInfo.unitIndex,h);h.aliasLink=c;g.scopeChain.moduleDecl&&(h.declModule=g.scopeChain.moduleDecl);h.declAST=c;c.id.sym=h;b.scope.enter(b.container,
c,h,g.checker.errorReporter,d||k,!0,!1);b.scope.enter(b.container,c,h,g.checker.errorReporter,d||k,!1,!1);return!0}function l(c,b,g){var h=g.scopeChain,d=a.hasFlag(c.modFlags,a.ModuleFlags.Ambient),b=a.hasFlag(c.modFlags,a.ModuleFlags.IsEnum),e=g.scopeChain.container==g.checker.gloMod,f=a.hasFlag(c.modFlags,a.ModuleFlags.Exported),k=c.name.text;a.isQuoted(k);var j=h.scope.findLocal(k,!1,!1),i=null,l=null;null==j||j.kind()!=a.SymbolKind.Type?(null==l&&(l=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),j=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),l=new a.ModuleType(l,j),b&&(l.typeFlags|=a.TypeFlags.IsEnum),l.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),l.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),l.setHasImplementation()),i=new a.TypeSymbol(k,c.minChar,g.checker.locationInfo.unitIndex,l),g.scopeChain.moduleDecl&&
(i.declModule=g.scopeChain.moduleDecl),i.declAST=c,i.prettyName=c.prettyName,h.scope.enter(h.container,c,i,g.checker.errorReporter,f||e,!0,d),h.scope.enter(h.container,c,i,g.checker.errorReporter,f||e,!1,d),l.symbol=i):(j&&(j.declAST&&j.declAST.nodeType!=a.NodeType.Module)&&g.checker.errorReporter.simpleError(c,"Conflicting symbol name for module '"+k+"'"),i=j,l=i.type.getAllEnclosedTypes().publicMembers,l=null==l?new a.StringHashTable:l,l=new a.ScopedMembers(new a.DualStringHashTable(l,new a.StringHashTable)),
j=i.type.getAllAmbientEnclosedTypes().publicMembers,j=null==j?new a.StringHashTable:j,j=new a.ScopedMembers(new a.DualStringHashTable(j,new a.StringHashTable)),h=i.type.members.publicMembers,h=null==h?new a.StringHashTable:h,h=new a.ScopedMembers(new a.DualStringHashTable(h,new a.StringHashTable)),d=i.type.ambientMembers.publicMembers,d=null==d?new a.StringHashTable:d,d=new a.ScopedMembers(new a.DualStringHashTable(d,new a.StringHashTable)),l=new a.ModuleType(l,j),b&&(l.typeFlags|=a.TypeFlags.IsEnum),
l.members=h,l.ambientMembers=d,l.setHasImplementation(),l.symbol=i,i.addLocation(c.minChar),i.expansions.push(l));g.scopeChain.moduleDecl&&g.scopeChain.moduleDecl.recordNonInterface();f&&(i.flags|=a.SymbolFlags.Exported);if(g.scopeChain.moduleDecl||g.scopeChain.container==g.checker.gloMod)i.flags|=a.SymbolFlags.ModuleMember;c.mod=l;a.pushTypeCollectionScope(i,l.members,l.ambientMembers,l.enclosedTypes,l.ambientEnclosedTypes,g,null,null,c);return!0}function c(c,g,h){var d=h.scopeChain,e,f=null,g=c.name.text,
k=a.hasFlag(c.varFlags,a.VarFlags.Ambient),j=a.hasFlag(c.varFlags,a.VarFlags.Exported),l=h.scopeChain.container==h.checker.gloMod;e=!1;f=d.scope.findLocal(g,!1,!0);if(!f){var v=d.scope.findLocal(g,!1,!1);v&&(v.isType()&&v.declAST&&v.declAST.nodeType==a.NodeType.FuncDecl&&v.declAST.isSignature())&&(f=v,e=!0,j&&(f.flags|=a.SymbolFlags.Exported),k&&(f.flags|=a.SymbolFlags.Ambient),h.scopeChain.scope.enter(h.scopeChain.container,c,f,h.checker.errorReporter,j||l,!0,k))}f&&(!e&&f.declAST!=c&&!f.declAST.isOverload)&&
(f=null);if(null==f){v=d.scope.findLocal(g,!1,!1);d=new a.Type;d.setHasImplementation();e=new a.Type;e.setHasImplementation();d.instanceType=e;d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));var f=d,C=new a.ValueLocation;C.typeLink=new a.TypeLink;C.typeLink.ast=c;C.typeLink.type=f.instanceType;var x=new a.FieldSymbol("prototype",c.minChar,
h.checker.locationInfo.unitIndex,!0,C);x.flags|=a.SymbolFlags.Property|a.SymbolFlags.BuiltIn;C.symbol=x;x.declAST=c;f.members.addPublicMember("prototype",x);e.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));e.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));f=new a.TypeSymbol(g,c.minChar,h.checker.locationInfo.unitIndex,d);f.declAST=c;f.instanceType=e;d.symbol=f;e.symbol=f;h.scopeChain.moduleDecl&&
(h.scopeChain.moduleDecl.recordNonInterface(),f.declModule=h.scopeChain.moduleDecl,f.flags|=a.SymbolFlags.ModuleMember);j&&(f.flags|=a.SymbolFlags.Exported);k&&(f.flags|=a.SymbolFlags.Ambient);c.type=d;h.scopeChain.scope.enter(h.scopeChain.container,c,f,h.checker.errorReporter,j||l,!0,k);null==v&&h.scopeChain.scope.enter(h.scopeChain.container,c,f,h.checker.errorReporter,j||l,!1,k)}else d=f.type,null==d.instanceType&&(d.instanceType=new a.Type,d.instanceType.setHasImplementation(),d.instanceType.members=
new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.instanceType.symbol=d.symbol,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable))),e=d.instanceType,c.type=d;c.constructorDecl||(f&&(f.declAST&&f.declAST.type&&f.declAST.type.call&&!f.declAST.isOverload)&&h.checker.errorReporter.duplicateIdentifier(f.declAST,
f.name),b(c.type));d.typeFlags|=a.TypeFlags.IsClass;e.typeFlags|=a.TypeFlags.IsClass;i(e,c);a.pushTypeCollectionScope(f,e.members,e.ambientMembers,null,null,h,e,d,null);return!0}function h(c,b,h){var b=h.scopeChain,g=null,d=null,e=a.hasFlag(c.varFlags,a.VarFlags.Exported),f=h.scopeChain.container==h.checker.gloMod,k=!0,k=!1,j=c.name.text,g=b.scope.findLocal(j,!1,!0);null==g?(d=new a.Type,g=new a.TypeSymbol(j,c.minChar,h.checker.locationInfo.unitIndex,d),d.symbol=g,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),g.declAST=c,g.declModule=h.scopeChain.moduleDecl):(k=!0,d=g.type);d||(d=h.checker.anyType);c.type=d;i(d,c);e&&(g.flags|=a.SymbolFlags.Exported);h.scopeChain.moduleDecl&&(g.flags|=a.SymbolFlags.ModuleMember);k||h.scopeChain.scope.enter(h.scopeChain.container,c,g,h.checker.errorReporter,f||e,!0,!1);a.pushTypeCollectionScope(g,d.members,d.ambientMembers,null,null,h,d,null,
null);return!0}function g(c,b,h){if(a.hasFlag(c.varFlags,a.VarFlags.Public|a.VarFlags.Private)){var b=new a.ValueLocation,g=a.hasFlag(c.varFlags,a.VarFlags.Private),d=new a.FieldSymbol(c.id.text,c.minChar,h.checker.locationInfo.unitIndex,!a.hasFlag(c.varFlags,a.VarFlags.Readonly),b);d.transferVarFlags(c.varFlags);b.symbol=d;d.declAST=c;c.parameterPropertySym=d;h.scopeChain.scope.enter(h.scopeChain.container,c,d,h.checker.errorReporter,!g,!1,!1);b.typeLink=a.getTypeLink(c.typeExpr,h.checker,null==
c.init);c.sym=d}return!1}function k(c,b,h){var g=h.scopeChain,b=a.hasFlag(c.varFlags,a.VarFlags.Ambient),d=a.hasFlag(c.varFlags,a.VarFlags.Exported),e=h.scopeChain.container==h.checker.gloMod,f=a.hasFlag(c.varFlags,a.VarFlags.Property),k=a.hasFlag(c.varFlags,a.VarFlags.Static),j=a.hasFlag(c.varFlags,a.VarFlags.Private),l=a.hasFlag(c.id.flags,a.ASTFlags.OptionalName);h.scopeChain.moduleDecl&&h.scopeChain.moduleDecl.recordNonInterface();if(f||d||h.scopeChain.container==h.checker.gloMod||h.scopeChain.moduleDecl){if(b&&
(g=g.scope.findLocal(c.id.text,!1,!1)))return c.sym=g,!1;if(null==c.id)return h.checker.errorReporter.simpleError(c,"Expected variable identifier at this location"),!1;var g=new a.ValueLocation,i=new a.FieldSymbol(c.id.text,c.minChar,h.checker.locationInfo.unitIndex,(c.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,g);i.transferVarFlags(c.varFlags);l&&(i.flags|=a.SymbolFlags.Optional);g.symbol=i;i.declAST=c;if(h.scopeChain.moduleDecl||h.scopeChain.container==h.checker.gloMod)i.flags|=a.SymbolFlags.ModuleMember,
i.declModule=h.scopeChain.moduleDecl;a.hasFlag(c.varFlags,a.VarFlags.Property)&&k&&h.scopeChain.classType?(h.scopeChain.classType.members.publicMembers.add(c.id.text,i)||h.checker.errorReporter.duplicateIdentifier(c,i.name),i.container=h.scopeChain.classType.symbol):h.scopeChain.scope.enter(h.scopeChain.container,c,i,h.checker.errorReporter,!j&&(f||d||e||k),!1,b);a.hasFlag(c.varFlags,a.VarFlags.Exported)&&(i.flags|=a.SymbolFlags.Exported);g.typeLink=a.getTypeLink(c.typeExpr,h.checker,null==c.init);
c.sym=i}return!1}function v(c,b,h){var g=h.scopeChain;h.scopeChain.moduleDecl&&h.scopeChain.moduleDecl.recordNonInterface();var b=null,d=c.getNameText(),e=a.hasFlag(c.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported),f=a.hasFlag(c.fncFlags,a.FncFlags.Static);a.hasFlag(c.fncFlags,a.FncFlags.Private);var k=c.isConstructMember()||c.isConstructor,j=(c.isMethod()&&f||c.isAccessor())&&h.scopeChain.classType?h.scopeChain.classType.symbol:h.scopeChain.container,i=h.scopeChain.scope,l=c.name&&
a.hasFlag(c.name.flags,a.ASTFlags.OptionalName),v=!1,D=!1;k&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)&&(j=j.container,i=g.previous.scope);c.unitIndex=h.checker.locationInfo.unitIndex;if(!c.isConstructor&&j&&j.declAST&&j.declAST.nodeType==a.NodeType.FuncDecl&&j.declAST.isConstructor&&!c.isMethod())return v;if(a.hasFlag(c.fncFlags,a.FncFlags.Signature)){g=h.scopeChain.thisType;d&&"__missing"!=d&&(f?b=j.type.members.allMembers.lookup(d):(b=i.findLocal(d,!1,!1),null==b&&(b=i.findLocal(d,!1,!0))),
b&&(D=!0,!c.isSignature()&&a.hasFlag(c.fncFlags,a.FncFlags.Ambient)!=a.hasFlag(b.flags,a.SymbolFlags.Ambient)&&(b=null)));if(null==b){if(b=c.isSpecialFn()?h.checker.createFunctionSignature(c,j,i,j,!1).declAST.type.symbol:h.checker.createFunctionSignature(c,j,i,null,!D).declAST.type.symbol,null==b.declAST||!c.isSpecialFn())b.declAST=c}else b.kind()==a.SymbolKind.Type?b=h.checker.createFunctionSignature(c,j,i,b,!1).declAST.type.symbol:h.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+
"' already declared as a property");c.type=c.isSpecialFn()&&!f?g?g:b.type:b.type}else{d&&(f?b=j.type.members.allMembers.lookup(d):(c.isConstructor&&h.scopeChain.previous&&(b=h.scopeChain.previous.scope.findLocal(d,!1,!1)),null==b&&(b=i.findLocal(d,!1,!1))),b&&(D=!0,!k&&(b.declAST.nodeType==a.NodeType.FuncDecl&&!b.declAST.isAccessor()&&!b.declAST.isSignature())&&(b=null,D=!1)));b&&(!b.isAccessor()&&b.type&&b.type.construct&&b.type.construct.signatures!=[]&&(null==b.type.construct.signatures[0].declAST||
!a.hasFlag(b.type.construct.signatures[0].declAST.fncFlags,a.FncFlags.Ambient))&&!c.isConstructor)&&h.checker.errorReporter.simpleError(c,"Functions may not have class overloads");b&&(b.kind()!=a.SymbolKind.Type&&c.isMethod()&&!c.isAccessor()&&!c.isConstructor)&&(h.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+"' already declared as a property"),b.type=h.checker.anyType);h.checker.createFunctionSignature(c,j,i,b,!D);if((!b||b.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||
b&&b.isAccessor())c.accessorSymbol=h.checker.createAccessorSymbol(c,b,j.type,c.isMethod()&&f,!0,i,j);c.type.symbol.declAST=c;c.isConstructor&&(v=!0)}e&&(c.type.call&&(c.type.symbol.flags|=a.SymbolFlags.Exported),b&&(!b.isAccessor()&&b.type.call)&&(b.flags|=a.SymbolFlags.Exported));h.scopeChain.moduleDecl&&!c.isSpecialFn()&&(c.type.symbol.flags|=a.SymbolFlags.ModuleMember,c.type.symbol.declModule=h.scopeChain.moduleDecl);b&&l&&(b.flags|=a.SymbolFlags.Optional);return v}a.Continuation=function(a){this.normalBlock=
a;this.exceptionBlock=-1};a.createNewConstructGroupForType=b;a.cloneParentConstructGroupForChildType=function(c,h){c.construct=new a.SignatureGroup;var g=null;h.construct||b(h);for(var d=0;d<h.construct.signatures.length;d++)g=new a.Signature,g.parameters=h.construct.signatures[d].parameters,g.nonOptionalParameterCount=h.construct.signatures[d].nonOptionalParameterCount,g.typeCheckStatus=h.construct.signatures[d].typeCheckStatus,g.declAST=h.construct.signatures[d].declAST,g.returnType=new a.TypeLink,
g.returnType.type=c.instanceType,c.construct.addSignature(g)};a.globalId="__GLO";a.preCollectImportTypes=d;a.preCollectModuleTypes=l;a.preCollectClassTypes=c;a.preCollectInterfaceTypes=h;a.preCollectArgDeclTypes=g;a.preCollectVarDeclTypes=k;a.preCollectFuncDeclTypes=v;a.preCollectTypes=function(b,e,f){var j=f.state,i=!1;b.nodeType==a.NodeType.Script?(j.script=b,i=!0):b.nodeType==a.NodeType.List?i=!0:b.nodeType==a.NodeType.Import?i=d(b,e,j):b.nodeType==a.NodeType.With?i=!1:b.nodeType==a.NodeType.Module?
i=l(b,e,j):b.nodeType==a.NodeType.Class?i=c(b,e,j):b.nodeType==a.NodeType.Block?i=!0:b.nodeType==a.NodeType.Interface?i=h(b,e,j):b.nodeType==a.NodeType.ArgDecl?i=g(b,e,j):b.nodeType==a.NodeType.VarDecl?i=k(b,e,j):b.nodeType==a.NodeType.FuncDecl?i=v(b,e,j):b.isStatementOrExpression()&&j.scopeChain.moduleDecl&&j.scopeChain.moduleDecl.recordNonInterface();f.options.goChildren=i;return b};a.postCollectTypes=function(c,b,h){b=h.state;c.nodeType==a.NodeType.Module?a.popTypeCollectionScope(b):c.nodeType==
a.NodeType.Class?a.popTypeCollectionScope(b):c.nodeType==a.NodeType.Interface&&a.popTypeCollectionScope(b);return c}})(TypeScript||(TypeScript={}));
(function(a){var e;e=function(a,b,g){this.container=a;this.previous=b;this.scope=g};a.ScopeChain=e;var i=function(a){this.bb=a;this.defsBySymbol=[];this.useIndexBySymbol=[]};i.prototype.updateTop=function(){for(var a=new j(this.top.bitCount),b=0,g=this.bb.successors.length;b<g;b++){var d=this.bb.successors[b];d.useDef&&a.union(d.useDef.top)}a.difference(this.kill);a.union(this.gen);b=a.notEq(this.top);this.top=a;return b};i.prototype.initialize=function(c){var b=this,g=function(a,c){if(c.isLocalSym(a)){var g=
c.getSymbolIndex(a);b.useIndexBySymbol[g]=[];b.defsBySymbol[g]=!0}},d=new a.AstWalkOptions;d.reverseSiblings=!0;a.getAstWalkerFactory().walk(this.bb.content,function(c,d,e){var f=e.state;null==c&&(c=null);if(c.nodeType==a.NodeType.VarDecl)d=c,(d.init||a.hasFlag(d.varFlags,a.VarFlags.AutoInit))&&g(d.sym,f);else if(c.nodeType==a.NodeType.Name){if(d)if(d.nodeType==a.NodeType.Asg){if(d.operand1==c)return c}else if(d.nodeType==a.NodeType.VarDecl&&d.id==c)return c;e=c.sym;d=c;if(f.isLocalSym(e)){e=f.getSymbolIndex(e);
void 0==b.useIndexBySymbol[e]&&(b.useIndexBySymbol[e]=[]);var k=b.useIndexBySymbol[e],d=f.getUseIndex(d);f.addUse(e,d);k.push(d)}}else c.nodeType>=a.NodeType.Asg&&c.nodeType<=a.NodeType.LastAsg?(d=c,d.operand1&&d.operand1.nodeType==a.NodeType.Name&&(d=d.operand1,g(d.sym,f))):c.nodeType==a.NodeType.FuncDecl&&(e.options.goChildren=!1);return c},null,d,c)};i.prototype.initializeGen=function(a){var b=this.useIndexBySymbol.length;this.gen=new j(a.uses.length);for(a=0;a<b;a++){var d=this.useIndexBySymbol[a];
if(void 0!=d&&0<d.length)for(var e=0,f=d.length;e<f;e++)this.gen.set(d[e],!0)}this.top=this.gen};i.prototype.initializeKill=function(a){this.kill=new j(this.gen.bitCount);for(var b=0,d=this.defsBySymbol.length;b<d;b++)if(this.defsBySymbol[b]){var e=a.useIndexBySymbol[b];if(e)for(var f=0,i=e.length;f<i;f++)this.kill.set(e[f],!0)}};a.BBUseDefInfo=i;var b=function(){this.useIndexBySymbol=[];this.uses=[];this.symbols=[];this.symbolMap=new a.StringHashTable;this.symbolCount=0};b.prototype.getSymbolIndex=
function(a){var b=a.name,d=this.symbolMap.lookup(b);null==d&&(d=this.symbolCount++,this.symbols[d]=a,this.symbolMap.add(b,d));return d};b.prototype.addUse=function(a,b){var d=this.useIndexBySymbol[a];void 0==d&&(d=[],this.useIndexBySymbol[a]=d);d[d.length]=b};b.prototype.getUseIndex=function(a){this.uses[this.uses.length]=a;return this.uses.length-1};b.prototype.isLocalSym=function(c){return c&&c.container==this.func&&c.kind()==a.SymbolKind.Variable};b.prototype.killSymbol=function(a,b){for(var d=
this.symbolMap.lookup(a.name),d=this.useIndexBySymbol[d],e=0,f=d.length;e<f;e++)b.set(d[e],!0)};a.UseDefContext=b;var j,f=function(a){this.bitCount=a;this.firstBits=0;this.restOfBits=null;if(this.bitCount>f.packBits){this.restOfBits=[];for(var a=Math.floor(this.bitCount/f.packBits),b=0;b<a;b++)this.restOfBits[b]=0}};f.packBits=30;f.prototype.set=function(a,b){if(a<f.packBits)this.firstBits=b?this.firstBits|1<<a:this.firstBits&~(1<<a);else{var d=Math.floor(a/f.packBits)-1,e=a%f.packBits;this.restOfBits[d]=
b?this.restOfBits[d]|1<<e:this.restOfBits[d]&~(1<<e)}};f.prototype.map=function(a){var b;for(b=0;b<f.packBits;b++){if(b==this.bitCount)return;0!=(1<<b&this.firstBits)&&a(b)}if(this.restOfBits){var d,e=f.packBits;b=0;for(d=this.restOfBits.length;b<d;b++)for(var j=this.restOfBits[b],i=0;i<f.packBits;i++)if(0!=(1<<i&j)&&a(e),e++,e==this.bitCount)return}};f.prototype.union=function(a){this.firstBits|=a.firstBits;if(this.restOfBits)for(var b=0,d=this.restOfBits.length;b<d;b++)this.restOfBits[b]|=a.restOfBits[b]};
f.prototype.intersection=function(a){this.firstBits&=a.firstBits;if(this.restOfBits)for(var b=0,d=this.restOfBits.length;b<d;b++)this.restOfBits[b]&=a.restOfBits[b]};f.prototype.notEq=function(a){if(this.firstBits!=a.firstBits)return!0;if(this.restOfBits)for(var b=0,d=this.restOfBits.length;b<d;b++)if(this.restOfBits[b]!=a.restOfBits[b])return!0;return!1};f.prototype.difference=function(a){this.firstBits&=~a.firstBits;if(this.restOfBits)for(var b=0,d=this.restOfBits.length;b<d;b++)this.restOfBits[b]&=
~a.restOfBits[b]};j=f;a.BitVector=j;var d=function(){this.predecessors=[];this.index=-1;this.markValue=0;this.successors=[];this.useDef=null;this.content=new a.ASTList};d.prototype.marked=function(a){return this.markValue>a};d.prototype.mark=function(){this.markValue++};d.prototype.addSuccessor=function(a){this.successors[this.successors.length]=a;a.predecessors[a.predecessors.length]=this};a.BasicBlock=d;d=function(a,b){this.current=a;this.exit=b;this.unreachable=this.entry=null;this.noContinuation=
!1;this.statementStack=[];this.currentSwitch=[];this.markBase=0;this.linearBBs=[];this.entry=this.current};d.prototype.walk=function(a,b){return this.walker.walk(a,b)};d.prototype.pushSwitch=function(a){this.currentSwitch.push(a)};d.prototype.popSwitch=function(){return this.currentSwitch.pop()};d.prototype.reportUnreachable=function(c){if(this.unreachable&&0<this.unreachable.length)for(var b=this.unreachable.length,d=0;d<b;d++){var e=this.unreachable[d];e.nodeType!=a.NodeType.EndCode&&c.simpleError(e,
"unreachable code")}};d.prototype.printAST=function(c,b){var d=new a.PrintContext(b,null);d.increaseIndent();a.getAstWalkerFactory().walk(c,a.prePrintAST,a.postPrintAST,null,d);d.decreaseIndent()};d.prototype.printBlockContent=function(a,b){for(var d=a.content,e=0,f=d.members.length;e<f;e++)this.printAST(d.members[e],b)};d.prototype.bfs=function(a,b,d,e){var f=this.markBase++,j=[];for(j[j.length]=this.entry;0<j.length;){var i=j.pop();if(!i.marked(f)){i.mark();a&&a(i);var l=i.successors.length;if(0<
l){d&&d();for(l-=1;0<=l;l--){var n=i.successors[l];n.marked(this.markBase)||(b&&b(i,n),j[j.length]=n)}e&&e()}}}};d.prototype.useDef=function(a,d){var g=this,e=new b;e.func=d;this.bfs(function(a){a.useDef=new i(a);a.useDef.initialize(e);g.linearBBs[g.linearBBs.length]=a},null,null,null);var f,j;f=0;for(j=this.linearBBs.length;f<j;f++)this.linearBBs[f].useDef.initializeGen(e),this.linearBBs[f].useDef.initializeKill(e);for(var l=!0;l;){l=!1;for(f=0;f<j;f++)l=this.linearBBs[f].useDef.updateTop()||l}this.entry.useDef.top.map(function(b){b=
e.uses[b];a.simpleError(b,"use of variable '"+b.text+"' that is not definitely assigned")})};d.prototype.print=function(a){var b=this,d=0;this.bfs(function(e){0>e.index&&(e.index=d++);e==b.exit?a.WriteLine("Exit block with index "+e.index):(a.WriteLine("Basic block with index "+e.index),b.printBlockContent(e,a))},function(b,e){0>e.index&&(e.index=d++);a.Write(e.index+" ")},function(){a.Write("  Branches to ")},function(){a.WriteLine("")});if(null!=this.unreachable)for(var e=0,f=this.unreachable.length;e<
f;e++)a.WriteLine("Unreachable basic block ..."),this.printAST(this.unreachable[e],a)};d.prototype.pushStatement=function(a,b,d){this.statementStack.push({stmt:a,continueBB:b,breakBB:d})};d.prototype.popStatement=function(){return this.statementStack.pop()};d.prototype.returnStmt=function(){this.current.addSuccessor(this.exit);this.setUnreachable()};d.prototype.setUnreachable=function(){this.current=null;this.noContinuation=!0};d.prototype.addUnreachable=function(a){null===this.unreachable&&(this.unreachable=
[]);this.unreachable[this.unreachable.length]=a};d.prototype.unconditionalBranch=function(a,b){for(var d=null,e=0,f=this.statementStack.length;e<f;e++){var j=this.statementStack[e];if(j.stmt==a){d=b?j.continueBB:j.breakBB;break}}d&&this.current.addSuccessor(d);this.setUnreachable()};d.prototype.addContent=function(a){this.current&&this.current.content.append(a)};a.ControlFlowContext=d;var l=function(){this.cacheSize=16;this.rdCache=[];for(var a=this.nextUp=0;a<this.cacheSize;a++)this.rdCache[a]={actuals:[],
exactCandidates:[],conversionCandidates:[],id:a}};l.prototype.getResolutionData=function(){var a=null;this.nextUp<this.cacheSize&&(a=this.rdCache[this.nextUp]);null==a&&(this.cacheSize++,a={actuals:[],exactCandidates:[],conversionCandidates:[],id:this.cacheSize},this.rdCache[this.cacheSize]=a);this.nextUp++;return a};l.prototype.returnResolutionData=function(a){a.actuals.length=0;a.exactCandidates.length=0;a.conversionCandidates.length=0;this.nextUp=a.id};a.ResolutionDataCache=l;d=function(a,b,d,
e){this.logger=a;this.initScope=b;this.parser=d;this.checker=e;this.thisClassNode=this.thisFnc=null;this.enclosingFncIsMethod=!1;this.currentScript=this.booleanInterfaceType=this.numberInterfaceType=this.functionInterfaceType=this.objectInterfaceType=this.stringInterfaceType=this.arrayInterfaceType=null;this.inArrayElementTypeCheck=this.inTypeRefTypeCheck=this.inImportTypeCheck=this.inNewTargetTypeCheck=!1;this.resolutionDataCache=new l;this.nestingLevel=0;this.inSuperCall=this.inBoundPropTypeCheck=
!1;this.checker.typeFlow=this;this.globalScope=this.scope=this.initScope;this.doubleType=this.checker.numberType;this.booleanType=this.checker.booleanType;this.stringType=this.checker.stringType;this.regexType=this.anyType=this.checker.anyType;this.nullType=this.checker.nullType;this.voidType=this.checker.voidType;this.arrayAnyType=this.checker.makeArrayType(this.anyType)};d.prototype.initLibs=function(){var c=this.globalScope.find("Array",!1,!0);c&&c.kind()==a.SymbolKind.Type&&(this.arrayInterfaceType=
c.type);if((c=this.globalScope.find("String",!1,!0))&&c.kind()==a.SymbolKind.Type)this.stringInterfaceType=c.type;if((c=this.globalScope.find("Object",!1,!0))&&c.kind()==a.SymbolKind.Type)this.objectInterfaceType=c.type;if((c=this.globalScope.find("Function",!1,!0))&&c.kind()==a.SymbolKind.Type)this.functionInterfaceType=c.type;if((c=this.globalScope.find("Number",!1,!0))&&c.kind()==a.SymbolKind.Type)this.numberInterfaceType=c.type;if((c=this.globalScope.find("Boolean",!1,!0))&&c.kind()==a.SymbolKind.Type)this.booleanInterfaceType=
c.type;if((c=this.globalScope.find("RegExp",!1,!0))&&c.kind()==a.SymbolKind.Type)this.regexType=c.type};d.prototype.cast=function(a,b){return this.castWithCoercion(a,b,!0,!1)};d.prototype.castWithCoercion=function(c,b,d,e){var f=new a.TypeComparisonInfo;this.checker.sourceIsAssignableToTarget(c.type,b,f)||e&&this.checker.sourceIsAssignableToTarget(b,c.type,f)?d&&(c.type=null==b?this.anyType:b.isClass()?b.instanceType:b):this.checker.errorReporter.incompatibleTypes(c,c.type,b,null,this.scope,f);return c};
d.prototype.inScopeTypeCheck=function(c,b){var d=this.scope;this.scope=b;for(var e=this.thisFnc,f=this.thisType,j=this.thisClassNode,i=this.checker.currentModDecl,l=this.enclosingFncIsMethod,n=this.scope.container,p=null;n;){if(n.kind()==a.SymbolKind.Type){var r=n,t=r.type;t.call&&null==p&&(this.enclosingFncIsMethod=r.isMethod,p=n.declAST);if(t.isClass()){this.thisType=t.instanceType;r.declAST&&r.declAST.nodeType==a.NodeType.Class&&(this.thisClassNode=r.declAST);break}if(t.isModuleType()){this.checker.currentModDecl=
r.declAST;break}}n=n.container}this.thisFnc=p;n=this.typeCheck(c);this.thisFnc=e;this.thisType=f;this.thisClassNode=j;this.checker.currentModDecl=i;this.enclosingFncIsMethod=l;this.scope=d;return n};d.prototype.typeCheck=function(a){return a?a.typeCheck(this):null};d.prototype.inScopeTypeCheckDecl=function(c){c.nodeType==a.NodeType.VarDecl||c.nodeType==a.NodeType.ArgDecl?this.inScopeTypeCheckBoundDecl(c):c.nodeType==a.NodeType.FuncDecl&&c.isAccessor()&&this.typeCheckFunction(c)};d.prototype.inScopeTypeCheckBoundDecl=
function(c){var b=c.sym,d=this.thisFnc,e=this.thisType,f=this.enclosingFncIsMethod,j=this.checker.locationInfo;if(b&&b.container){var i=a.hasFlag(c.varFlags,a.VarFlags.ClassConstructorProperty)?b.container.getType().constructorScope:b.container.instanceScope();a.hasFlag(c.varFlags,a.VarFlags.Property)&&b.container.declAST.nodeType==a.NodeType.FuncDecl&&(this.thisFnc=b.container.declAST);if(i){var l=this.scope;this.scope=i;i=b.container;for(this.checker.locationInfo=this.checker.units&&0<=b.unitIndex&&
b.unitIndex<this.checker.units.length?this.checker.units[b.unitIndex]:a.unknownLocationInfo;i;){if(i.kind()==a.SymbolKind.Type){var b=i,n=b.type;n.call&&(this.enclosingFncIsMethod=b.isMethod);if(n.isClass()){this.thisType=n.instanceType;break}}i=i.container}this.typeCheckBoundDecl(c);this.scope=l}}this.thisFnc=d;this.thisType=e;this.checker.locationInfo=j;this.enclosingFncIsMethod=f};d.prototype.resolveBoundDecl=function(a){a.typeExpr?((null==a.typeExpr.type||a.typeExpr.type&&a.typeExpr.type==this.anyType&&
this.scope||null==a.typeExpr.type.symbol||!this.checker.typeStatusIsFinished(a.typeExpr.type.symbol.typeCheckStatus))&&this.typeCheck(a.typeExpr),a.type=a.typeExpr.type,a.sym&&a.sym.setType(a.type)):null==a.init&&(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(a,"type implicitly set to 'any'"),a.type=this.anyType,a.sym&&(a.sym.isType()?a.sym.isMethod?this.checker.errorReporter.simpleError(a,"Cannot bind method group to variable.  (Did you mean to use 'declare function' instead of 'declare var'?)"):
this.checker.errorReporter.simpleError(a,"Cannot bind type to variable"):a.sym.setType(a.type)))};d.prototype.typeCheckBoundDecl=function(c){var b=c.sym;if(null==b)c.init?(c.init=this.typeCheck(c.init),c.type=this.checker.widenType(c.init.type)):(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),c.type=this.anyType);else if(b.typeCheckStatus==a.TypeCheckStatus.Started)this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,
"type implicitly set to 'any'"),c.type=this.anyType,b.setType(this.anyType);else if(b.typeCheckStatus==a.TypeCheckStatus.NotStarted){b.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(b);var d=!1;null==c.type&&c.typeExpr&&(this.resolveBoundDecl(c),d=!0,c.type=c.typeExpr.type,b.typeCheckStatus=this.checker.getTypeCheckFinishedStatus());if(c.init){a.hasFlag(c.varFlags,a.VarFlags.Ambient)&&this.checker.errorReporter.simpleError(c,"Ambient variable can not have an initializer");var e=
a.hasFlag(c.varFlags,a.VarFlags.LocalStatic),f=this.scope,d=!c.init.isParenthesized;e&&(this.scope=c.sym.container.getType().memberScope);c.varFlags&a.VarFlags.Property&&(this.inBoundPropTypeCheck=!0);this.checker.typeCheckWithContextualType(c.type,this.checker.inProvisionalTypecheckMode(),d,c.init);this.inBoundPropTypeCheck&&(this.inBoundPropTypeCheck=!1);this.scope=f;c.type?(e=!1,f=null,c.init.type&&(f=c.init.type.containedScope,e=!0,c.init.type==this.voidType&&this.checker.errorReporter.simpleError(c,
"Cannot assign type 'void' to variable '"+c.id.text+"'")),c.init=this.castWithCoercion(c.init,c.type,d,!1),e&&null==c.init.type.containedScope&&(c.init.type.containedScope=f)):(c.type=this.checker.widenType(c.init.type),c.type==this.voidType&&(this.checker.errorReporter.simpleError(c,"Cannot assign type 'void' to variable '"+c.id.text+"'"),c.type=this.anyType));b.setType(c.type)}else d||this.resolveBoundDecl(c);b.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()}else this.checker.typeStatusIsFinished(b.typeCheckStatus)&&
b.declAST!=c&&c.init&&(c.init=this.typeCheck(c.init),c.type=b.getType(),c.init=this.cast(c.init,c.type));c.id&&c.sym&&(c.id.sym=c.sym);return c};d.prototype.typeCheckSuper=function(a){this.thisType&&this.enclosingFncIsMethod&&!this.thisFnc.isStatic()&&this.thisType.baseClass()?a.type=this.thisType.baseClass():(a.type=this.anyType,this.checker.errorReporter.invalidSuperReference(a));return a};d.prototype.typeCheckThis=function(c){var b=!1;if(null==this.thisFnc)this.thisType?this.thisClassNode&&this.thisClassNode.nty==
a.NodeType.Class?(b=!0,c.type=this.anyType):c.type=this.thisType:(this.checker.currentModDecl&&this.checker.errorReporter.simpleError(c,"'this' may not be referenced within module bodies"),c.type=this.anyType);else{if((this.inBoundPropTypeCheck||this.inSuperCall)&&this.thisClassNode&&this.thisClassNode.nty==a.NodeType.Class)b=!0;c.type=this.thisFnc.isMethod()||this.thisFnc.isConstructor||this.thisFnc.isTargetTypedAsMethod?this.thisType&&!(this.thisFnc.fncFlags&a.FncFlags.Static)?this.thisType:this.anyType:
this.anyType}if(!this.enclosingFncIsMethod&&this.thisFnc&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction))if(this.thisFnc.boundToProperty){var d=this.thisFnc.boundToProperty.sym.container;d.declAST.nodeType==a.NodeType.FuncDecl&&d.declAST.setHasSelfReference()}else{for(var e=d=this.thisFnc.enclosingFnc,f=!1;d;){if(d.isMethod()||d.isConstructor||d.hasSelfReference()){d.setHasSelfReference();f=!0;break}d=d.enclosingFnc}!f&&e&&e.setHasSelfReference();f&&this.thisType&&(c.type=this.thisType)}b&&
this.checker.errorReporter.simpleError(c,"Keyword 'this' cannot be referenced in initializers in a class body, or in super constructor calls");return c};d.prototype.setTypeFromSymbol=function(c,b){b.isVariable()?(b.isInferenceSymbol()&&(b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST),this.checker.styleSettings.innerScopeDeclEscape||b.declAST&&b.declAST.nodeType==a.NodeType.VarDecl&&this.nestingLevel<b.declAST.nestingLevel&&this.checker.errorReporter.styleError(c,
"Illegal reference to a variable defined in more nested scope")),c.type=b.getType(),b.writeable()||(c.flags&=~a.ASTFlags.Writeable)):b.isType()?(c.type=b.getType(),c.flags&=~a.ASTFlags.Writeable):(c.type=this.anyType,this.checker.errorReporter.symbolDoesNotReferToAValue(c,b.name))};d.prototype.typeCheckName=function(c){var b=this;if(this.checker.inWith)c.type=this.anyType;else{var d=c.text,e=a.isQuoted(c.text),f=this.scope.find(d,!1,!1);null==f&&e&&(f=this.checker.findSymbolForDynamicModule(d,this.currentScript.locationInfo.filename,
function(a){return b.scope.find(a,!1,!1)}));if(f){this.inNewTargetTypeCheck&&(f.isInferenceSymbol()&&!this.checker.typeStatusIsFinished(f.typeCheckStatus))&&this.checker.errorReporter.simpleError(c,"Symbol '"+c.text+"' is referenced before its declaration");if(a.optimizeModuleCodeGen&&f&&f.isType()&&(d=f.getType())&&f.aliasLink&&f.onlyReferencedAsTypeRef)if((d=d.symbol.declAST)&&a.hasFlag(d.modFlags,a.ModuleFlags.IsDynamic))f.onlyReferencedAsTypeRef=this.inTypeRefTypeCheck;f.declAST&&(f.declAST.nodeType==
a.NodeType.FuncDecl&&!f.declAST.returnTypeAnnotation&&f.declAST.signature.typeCheckStatus==a.TypeCheckStatus.Started)&&(f.declAST.type.symbol.flags|=a.SymbolFlags.RecursivelyReferenced,f.declAST.signature.returnType.type=this.anyType);this.setTypeFromSymbol(c,f);c.sym=f;this.thisFnc&&this.thisFnc.type&&f.container!=this.thisFnc.type.symbol&&(this.thisFnc.freeVariables[this.thisFnc.freeVariables.length]=f)}else c.isMissing()||this.checker.errorReporter.unresolvedSymbol(c,c.text),c.type=this.anyType}return c};
d.prototype.typeCheckScript=function(a){this.checker.locationInfo=a.locationInfo;this.scope=this.checker.globalScope;a.topLevelMod||this.addLocalsFromScope(this.scope,this.checker.gloMod,a.vars,this.checker.globals,!0);this.currentScript=a;a.bod=this.typeCheck(a.bod);this.currentScript=null;return a};d.prototype.typeCheckBitNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.doubleType;return a};d.prototype.typeCheckUnaryNumberOperator=function(a){a.operand=this.typeCheck(a.operand);a.type=
this.doubleType;return a};d.prototype.typeCheckLogNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.booleanType;return a};d.prototype.astIsWriteable=function(c){return a.hasFlag(c.flags,a.ASTFlags.Writeable)};d.prototype.typeCheckIncOrDec=function(c){var b=c;this.astIsWriteable(b)?(b=this.typeCheckUnaryNumberOperator(c),b.operand.type!=this.checker.numberType&&(b.operand.type!=this.checker.anyType&&!(b.operand.type.typeFlags&a.TypeFlags.IsEnum))&&this.checker.errorReporter.simpleError(c,
"'++' and '--' may only be applied to operands of type 'number' or 'any'")):(this.checker.errorReporter.valueCannotBeModified(b),b.type=this.doubleType);return b};d.prototype.typeCheckBitwiseOperator=function(c,b){var d=null;c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);var e=c.operand1.type,f=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);this.checker.styleSettings.bitwise&&this.checker.errorReporter.styleError(c,"use of "+
a.nodeTypeTable[c.nodeType]);if(this.checker.sourceIsSubtypeOfTarget(e,this.doubleType)&&this.checker.sourceIsSubtypeOfTarget(f,this.doubleType))d=this.doubleType;else if(e==this.booleanType&&f==this.booleanType)d=this.booleanType;else if(e==this.anyType){if(f==this.anyType||f==this.doubleType||f==this.booleanType)d=this.anyType}else if(f==this.anyType&&(e==this.anyType||e==this.doubleType||e==this.booleanType))d=this.anyType;null==d&&(d=this.anyType,this.checker.errorReporter.incompatibleTypes(c,
e,f,c.printLabel(),this.scope));c.type=d;return c};d.prototype.typeCheckArithmeticOperator=function(c,b){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);var d=c.operand1.type,e=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);this.checker.styleSettings.bitwise&&(c.nodeType==a.NodeType.And||c.nodeType==a.NodeType.Or||c.nodeType==a.NodeType.AsgAnd||c.nodeType==a.NodeType.AsgOr)&&this.checker.errorReporter.styleError(c,"use of "+
a.nodeTypeTable[c.nodeType]);if(null==d||null==e)return this.checker.errorReporter.simpleError(c,"Could not typecheck arithmetic operation.  Possible recursive typecheck error?"),c.type=this.anyType,c;var f=c.nodeType;this.checker.isNullOrUndefinedType(d)&&(d=e);this.checker.isNullOrUndefinedType(e)&&(e=d);d=this.checker.widenType(d);e=this.checker.widenType(e);f==a.NodeType.Add||f==a.NodeType.AsgAdd?d==this.checker.stringType||e==this.checker.stringType?c.type=this.checker.stringType:d==this.checker.numberType&&
e==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(d,this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(e,this.checker.numberType)?c.type=this.checker.numberType:d==this.checker.anyType||e==this.checker.anyType?c.type=this.checker.anyType:(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,d,e,c.printLabel(),this.scope)):d==this.checker.numberType&&e==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(d,
this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(e,this.checker.numberType)?c.type=this.checker.numberType:d==this.checker.anyType||e==this.checker.anyType?c.type=this.checker.numberType:(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,d,e,c.printLabel(),this.scope));return c};d.prototype.typeCheckDotOperator=function(a){a.operand1=this.typeCheck(a.operand1);var b=a.operand1.type,d=null;if(b){if(b==this.anyType)return a.type=this.anyType,a;if(b==this.stringType)if(this.stringInterfaceType)d=
this.stringInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.doubleType)if(this.numberInterfaceType)d=this.numberInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.booleanType)if(this.booleanInterfaceType)d=this.booleanInterfaceType.memberScope;else return a.type=this.anyType,a;else if((b.call||b.construct)&&null==b.members)if(this.functionInterfaceType)d=this.functionInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b.elementType)if(this.arrayInterfaceType)d=
b.elementType.getArrayBase(this.arrayInterfaceType,this.checker).memberScope;else return a.type=this.anyType,a;else d=b.memberScope}if(null==d)this.checker.errorReporter.expectedClassOrInterface(a),a.type=this.anyType;else{var e=a.operand2,f=d.find(e.text,!(this.thisClassNode&&a.operand1.type==this.thisClassNode.type.instanceType),!1);if(!f&&(this.objectInterfaceType&&b)&&(b.isReferenceType()&&(f=this.objectInterfaceType.memberScope.find(e.text,!1,!1)),!f&&this.functionInterfaceType&&(b.call||b.construct)))f=
this.functionInterfaceType.memberScope.find(e.text,!1,!1);!f||!f.visible(d,this.checker)?(a.type=this.anyType,null==f?this.checker.errorReporter.simpleError(e,"The property '"+e.text+"' does not exist on value of type '"+b.getScopedTypeName(this.scope)+"'"):this.checker.errorReporter.simpleError(a,"The property '"+e.text+" on type '"+b.getScopedTypeName(this.scope)+"' is not visible")):(f.isVariable()&&f.isInferenceSymbol()&&(b=f,b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST)),
e.sym=f,a.type=f.getType())}null==a.type&&(a.type=this.anyType);return a};d.prototype.typeCheckBooleanOperator=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,d=a.operand2.type;!this.checker.sourceIsAssignableToTarget(b,d)&&!this.checker.sourceIsAssignableToTarget(d,b)&&this.checker.errorReporter.incompatibleTypes(a,b,d,a.printLabel(),this.scope);a.type=this.booleanType;return a};d.prototype.typeCheckAsgOperator=function(a){var b=!a.operand2.isParenthesized;
a.operand1=this.typeCheck(a.operand1);this.checker.typeCheckWithContextualType(a.operand1.type,this.checker.inProvisionalTypecheckMode(),b,a.operand2);var d=a.operand1.type,e=a.operand2.type;this.astIsWriteable(a.operand1)||this.checker.errorReporter.valueCannotBeModified(a);var f=!1,j=null;a.operand2.type&&(j=a.operand2.type.containedScope,f=!0);a.operand2=this.castWithCoercion(a.operand2,d,b,!1);f&&null==a.operand2.type.containedScope&&(a.operand2.type.containedScope=j);a.type=e;return a};d.prototype.typeCheckIndex=
function(c){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);this.checker.styleSettings.literalSubscript||c.operand2.nodeType==a.NodeType.QString&&this.checker.errorReporter.styleError(c,"use literal subscript ('.') notation instead)");var b=c.operand1.type,d=c.operand2.type;b.elementType?d==this.checker.anyType||d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum)?c.type=b.elementType:(d!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,
"Illegal property access"),c.type=this.checker.anyType):b.index?d==this.checker.anyType||!(b.index.flags&a.SignatureFlags.IsStringIndexer||b.index.flags&a.SignatureFlags.IsNumberIndexer)||b.index.flags&a.SignatureFlags.IsStringIndexer&&d==this.checker.stringType||b.index.flags&a.SignatureFlags.IsNumberIndexer&&(d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum))?(b=this.resolveOverload(c,b.index),c.type=b?b.returnType.type:this.checker.anyType):(d!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,
"Illegal property access"),c.type=this.checker.anyType):((!(b==this.checker.anyType||b==this.checker.stringType||b==this.checker.numberType||b==this.checker.booleanType||b.isReferenceType())||!(d==this.checker.anyType||d==this.checker.stringType||d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum)))&&this.checker.errorReporter.simpleError(c,"Illegal property access"),c.type=this.checker.anyType);return c};d.prototype.typeCheckInOperator=function(a){a.operand1=this.cast(this.typeCheck(a.operand1),
this.stringType);a.operand2=this.typeCheck(a.operand2);(!(a.operand1.type==this.checker.anyType||a.operand1.type==this.checker.stringType)||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.objectInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The in operator requires the left operand to be of type Any or the String primitive type, and the right operand to be of type Any or an object type");a.type=this.booleanType;return a};d.prototype.typeCheckShift=
function(a,b){a.operand1=this.cast(this.typeCheck(a.operand1),this.doubleType);a.operand2=this.cast(this.typeCheck(a.operand2),this.doubleType);b&&!this.astIsWriteable(a.operand1)&&this.checker.errorReporter.valueCannotBeModified(a);a.type=this.doubleType;return a};d.prototype.typeCheckQMark=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.operand3=this.typeCheck(a.operand3);var b=a.operand2.type,d=a.operand3.type;b==d?a.type=b:this.checker.sourceIsSubtypeOfTarget(b,
d)?a.type=d:this.checker.sourceIsSubtypeOfTarget(d,b)?a.type=b:(a.type=this.anyType,this.checker.errorReporter.incompatibleTypes(a,b,d,a.printLabel(),this.scope));return a};d.prototype.addFormals=function(a,b,d){for(var e=b.parameters.length,f=0;f<e;f++){var j=b.parameters[f];j.container=a;d.add(j.name,j)}};d.prototype.addLocalsFromScope=function(c,b,d,e,f){for(var j=d.members.length,i=!1,l=0;l<j;l++){var n=d.members[l];if(null==n.sym||n.sym.kind()!=a.SymbolKind.Field){var p=null;if(null==(p=e.lookup(n.id.text))){p=
new a.ValueLocation;p.typeLink=new a.TypeLink;var r=null;a.hasFlag(n.varFlags,a.VarFlags.Static)?(n.varFlags|=a.VarFlags.LocalStatic,r=new a.FieldSymbol(n.id.text,n.minChar,this.checker.locationInfo.unitIndex,!0,p)):r=new a.VariableSymbol(n.id.text,n.minChar,this.checker.locationInfo.unitIndex,p);r.transferVarFlags(n.varFlags);p.symbol=r;r.declAST=n;p.typeLink.ast=n.typeExpr;this.checker.resolveTypeLink(c,p.typeLink,!1);null==n.type&&null==n.init&&(n.type=this.anyType);p.typeLink.type=n.type;p.symbol.container=
b;n.sym=p.symbol;e.add(n.id.text,r);"arguments"==n.id.text&&(i=!0)}else n.type=p.getType(),n.sym=p}}!f&&!i&&(b=new a.ValueLocation,b.typeLink=new a.TypeLink,d=new a.VariableSymbol("arguments",d.minChar,this.checker.locationInfo.unitIndex,b),b.typeLink.ast=new a.Identifier("IArguments"),this.checker.resolveTypeLink(c,b.typeLink,!1),e.add("arguments",d))};d.prototype.addConstructorLocalArgs=function(c,b,d,e){if(b)for(var f=b.members.length,j=0;j<f;j++){var i=b.members[j];if(null==i.sym||e||i.sym.kind()!=
a.SymbolKind.Field){var l=null;if(null==(l=d.lookup(i.id.text))){this.resolveBoundDecl(i);l=new a.ValueLocation;l.typeLink=new a.TypeLink;var n=new a.ParameterSymbol(i.id.text,i.minChar,this.checker.locationInfo.unitIndex,l);n.declAST=i;l.symbol=n;l.typeLink.type=i.type;l.symbol.container=c;i.sym=l.symbol;d.add(i.id.text,n)}else i.type=l.getType(),i.sym=l}}};d.prototype.checkInitSelf=function(a){if(!a.isMethod())for(var b=a.freeVariables,d=0,e=b.length;d<e;d++)if(b[d].isInstanceProperty())return!0;
a=a.scopes;b=a.members.length;for(d=0;d<b;d++)if(this.checkInitSelf(a.members[d]))return!0;return!1};d.prototype.checkPromoteFreeVars=function(c,b){for(var d=c.freeVariables,e=0,f=d.length;e<f;e++){var j=d[e];!j.isInstanceProperty()&&j.container==b&&(a.instanceFilter.reset(),this.scope.search(a.instanceFilter,j.name,!1,!1)&&this.checker.errorReporter.simpleError(c,"Constructor-local variable shadows class property '"+j.name+"'. To access the class property, use 'self."+j.name+"'"),this.checker.errorReporter.simpleError(c,
"Constructor-local variables may not be accessed from instance method bodies. Consider changing local variable '"+j.name+"' to a class property"))}};d.prototype.allReturnsAreVoid=function(c){var b=!0;null==c.signature.returnType.type&&a.getAstWalkerFactory().walk(c.bod,function(c,d,e){d=!0;switch(c.nodeType){case a.NodeType.FuncDecl:d=!1;break;case a.NodeType.Return:c.returnExpression&&(d=b=!1)}e.options.goChildren=d;e.options.goNextSibling=d;return c});return b};d.prototype.classConstructorHasSuperCall=
function(c){var b=!1;a.getAstWalkerFactory().walk(c.bod,function(c,d,e){d=!0;switch(c.nodeType){case a.NodeType.FuncDecl:d=!1;break;case a.NodeType.Call:c.target.nodeType==a.NodeType.Super&&(d=!1,b=!0)}e.options.goChildren=d;return c});return b};d.prototype.typeCheckFunction=function(c){this.nestingLevel=0;var b=c.type,d=b.symbol,e=c.signature;if(this.checker.typeStatusIsFinished(e.typeCheckStatus))return c;if(e.typeCheckStatus==a.TypeCheckStatus.Started)return!c.returnTypeAnnotation&&c.bod&&!c.isSignature()&&
!c.isConstructor&&this.allReturnsAreVoid(c)?e.returnType.type=this.voidType:null==c.returnTypeAnnotation&&(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),e.returnType.type=this.anyType,d.flags|=a.SymbolFlags.RecursivelyReferenced),c;e.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(e);var f=this.scope,j=this.thisFnc,i=this.enclosingFncIsMethod,l=this.thisClassNode;this.enclosingFncIsMethod=c.isMethod()||c.isConstructor;
this.thisFnc=c;var n=c.type.symbol,p=this.thisType,r=this.checker.locationInfo,t=null,u=!1,w=null,A=null,C=c.isAccessor()&&a.hasFlag(c.fncFlags,a.FncFlags.GetAccessor),x=c.isAccessor()&&a.hasFlag(c.fncFlags,a.FncFlags.SetAccessor),D=(C||x)&&c.accessorSymbol?c.accessorSymbol.getType():null,C=this.checker.currentModDecl;if(c.isConstructor&&!c.isOverload){if(null==b.instanceType)return this.checker.errorReporter.simpleError(c,"Malformed function body (is this a class named the same as an existing interface?)"),
c;var E=this.scope=b.instanceType.constructorScope,t=E.valueMembers.allMembers}else if(c.isOverload)t=c.symbols,!a.hasFlag(c.fncFlags,a.FncFlags.Static)&&b.containedScope&&(this.scope=b.containedScope);else if(c.bod&&(this.scope=b.containedScope),(E=this.scope)&&E.valueMembers)t=E.valueMembers.allMembers;if(c.isConstructor&&c.bod&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)){var y=a.hasFlag(c.classDecl.type.instanceType.typeFlags,a.TypeFlags.HasBaseType),H=!y||a.hasFlag(c.classDecl.type.instanceType.typeFlags,
a.TypeFlags.HasBaseTypeOfObject),B=a.hasFlag(c.classDecl.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor);H&&this.classConstructorHasSuperCall(c)?this.checker.errorReporter.simpleError(c,"Calls to 'super' constructor are not allowed in classes that either inherit directly from 'Object' or have no base class"):y&&(B?(!c.bod||!c.bod.members.length||!(c.bod.members[0].nodeType==a.NodeType.Call&&c.bod.members[0].target.nodeType==a.NodeType.Super))&&this.checker.errorReporter.simpleError(c,
"If a derived class contains initialized properties or constructor parameter properties, the first statement in the constructor body must be a call to the super constructor"):this.classConstructorHasSuperCall(c)||this.checker.errorReporter.simpleError(c,"Constructors for derived classes must contain a call to the class's 'super' constructor"))}c.isMethod()&&c.type.enclosingType&&(y=null,c.type.enclosingType.symbol.declAST.nodeType==a.NodeType.FuncDecl?y=c.type.enclosingType.symbol.declAST.classDecl:
c.type.enclosingType.symbol.declAST.nodeType==a.NodeType.Class&&(y=c.type.enclosingType.symbol.declAST),y&&(this.thisClassNode=y));if(b.enclosingType){if((y=b.symbol.container)&&y.isType()&&y.getType().isClass())y=y.container;y&&(y.declAST&&y.declAST.nodeType==a.NodeType.Module)&&(this.checker.currentModDecl=y.declAST)}this.checker.locationInfo=this.checker.units&&0<=c.unitIndex&&c.unitIndex<this.checker.units.length?this.checker.units[c.unitIndex]:a.unknownLocationInfo;this.thisType=b.enclosingType?
b.enclosingType:p;y=e.parameters.length;if(!c.isConstructor&&c.bod&&!c.isSignature()){E=H=this.scope;if(!c.isMethod()&&null==c.returnTypeAnnotation){if(f&&c.name&&!c.name.isMissing()&&(B=f.findAmbient(c.name.text,!1,!1))&&B.declAST&&B.declAST.type)this.checker.setContextualType(B.declAST.type,!1),u=!0;if(this.checker.hasTargetType()){var B=this.checker.getTargetTypeContext(),z=B.contextualType;this.checker.canContextuallyTypeFunction(z,c,!0)?(B.targetSig=(z.construct?z.construct:z.call).signatures[0],
w=B.targetSig.parameters,A=B.targetSig.returnType.type,B.targetSig.declAST&&(B.targetSig.declAST.isConstructor?c.isTargetTypedAsMethod=!0:B.targetSig.declAST.isMethod()&&(c.isTargetTypedAsMethod=!0)),d.type=B.contextualType):z&&c.isAccessor()?(D=z,B.targetAccessorType=D):this.checker.killTargetType()}}E=E.valueMembers;this.scope=new a.SymbolScopeBuilder(E,null,null,null,f,n);for(z=0;z<y;z++){var G=e.parameters[z],F=G.declAST;this.checker.hasTargetType()&&w&&(this.checker.getTargetTypeContext().targetSig.hasVariableArgList||
z<w.length)?(B=this.checker.getTargetTypeContext(),F.type=B.targetSig.hasVariableArgList&&z>=w.length-1?w[w.length-1].getType().elementType:w[z].getType(),F.sym.setType(F.type),F.sym.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()):this.typeCheck(F);x&&D&&(F=this.cast(F,D));G.container=n;E.publicMembers.add(G.name,G)}this.scope=H}else{this.typeCheck(c.args);for(z=0;z<y;z++)e.parameters[z].parameter.typeLink.type=c.args.members[z].type,c.args.members[z].parameterPropertySym&&c.args.members[z].parameterPropertySym.setType(c.args.members[z].type);
c.fncFlags&a.FncFlags.IndexerMember&&(!y||1<y?this.checker.errorReporter.simpleError(c,"Index signatures may take only one parameter"):c.args.members[0].type==this.checker.numberType?b.index.flags|=a.SignatureFlags.IsNumberIndexer:c.args.members[0].type==this.checker.stringType?b.index.flags|=a.SignatureFlags.IsStringIndexer:this.checker.errorReporter.simpleError(c,"Index signatures may only take 'string' or 'number' as their parameter"))}if(c.bod&&!c.isSignature()&&(c.isConstructor?(this.addConstructorLocalArgs(c.type.symbol,
c.args,t,a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)),this.thisClassNode&&this.thisClassNode.extendsList&&(n=this.scope,t=new a.ScopedMembers(t),this.scope=new a.FilteredSymbolScopeBuilder(t,f,c.type.symbol,function(c){return c.kind()==a.SymbolKind.Parameter}),this.typeCheckBaseCalls(this.thisClassNode.extendsList),this.scope=n)):this.addFormals(n,e,t),t=this.checker.currentModDecl,c.type&&(c.type.symbol&&!c.isMethod()&&c.type.symbol.declModule)&&(this.checker.currentModDecl=c.type.symbol.declModule),
this.typeCheck(c.bod),this.checker.currentModDecl=t,this.checker.checkControlFlow&&(t=c.buildControlFlow(),this.checker.printControlFlowGraph&&t.print(this.checker.errorReporter.outfile),t.reportUnreachable(this.checker.errorReporter),this.checker.checkControlFlowUseDef&&t.useDef(this.checker.errorReporter,c.type.symbol)),c.isConstructor)){t=c.scopes;n=t.members.length;for(w=0;w<n;w++)x=t.members[w],x.isSignature()||a.hasFlag(x.fncFlags,a.FncFlags.Method)&&!a.hasFlag(x.fncFlags,a.FncFlags.Static)&&
this.checkPromoteFreeVars(x,c.type.symbol)}this.scope=f;this.thisFnc=j;this.thisClassNode=l;this.enclosingFncIsMethod=i;this.thisType=p;this.checker.locationInfo=r;this.checker.currentModDecl=C;e.typeCheckStatus=this.checker.getTypeCheckFinishedStatus();c.returnTypeAnnotation?(this.checkForVoidConstructor(c.returnTypeAnnotation.type,c.returnTypeAnnotation),null==e.returnType.type&&this.checker.resolveTypeLink(this.scope,e.returnType,!1)):A&&(e.returnType.type=A);if(!(d.flags&a.SymbolFlags.RecursivelyReferenced)&&
0<c.returnStatementsWithExpressions.length)if(d=c.returnStatementsWithExpressions[0].type,d=this.checker.findBestCommonType(d,null,{getLength:function(){return c.returnStatementsWithExpressions.length},setTypeAtIndex:function(a,b){c.returnStatementsWithExpressions[a].type=b},getTypeAtIndex:function(a){return c.returnStatementsWithExpressions[a].type}}))e.returnType.type=this.checker.widenType(d);else{for(d=0;d<c.returnStatementsWithExpressions.length;d++)this.checker.errorReporter.simpleError(c.returnStatementsWithExpressions[d],
"Incompatible return type");e.returnType.type=this.anyType}null==e.returnType.type?a.hasFlag(c.fncFlags,a.FncFlags.HasReturnExpression)?(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),e.returnType.type=this.anyType):e.returnType.type=this.voidType:e.returnType.type==this.nullType||e.returnType.type==this.checker.undefinedType?e.returnType.type=this.anyType:e.returnType.type!=this.voidType&&(e.returnType.type!=this.checker.undefinedType&&
e.returnType.type!=this.anyType)&&c.returnTypeAnnotation&&!c.isSignature()&&(!c.isConstructor&&!a.hasFlag(c.fncFlags,a.FncFlags.HasReturnExpression)&&!a.hasFlag(c.fncFlags,a.FncFlags.IsFatArrowFunction))&&(0<c.bod.members.length&&c.bod.members[0].nodeType==a.NodeType.Throw||this.checker.errorReporter.simpleError(c,"Function declared a non-void return type, but has no return expression"));u&&this.checker.unsetContextualType();c.accessorSymbol&&((D=c.accessorSymbol.getType())?(a.hasFlag(c.fncFlags,
a.FncFlags.GetAccessor)&&D!=e.returnType.type||0<c.args.members.length&&D!=c.args.members[0].type)&&this.checker.errorReporter.simpleError(c,"Getter and setter types do not agree"):a.hasFlag(c.fncFlags,a.FncFlags.GetAccessor)?c.accessorSymbol.setType(e.returnType.type):1!=c.args.members.length?this.checker.errorReporter.simpleError(c,"Setters may have one and only one argument"):c.accessorSymbol.setType(c.args.members[0].type));this.typeCheckOverloadSignatures(b,c);return c};d.prototype.typeCheckBases=
function(c){var b=!1,d=c.extendsList;if(d){var e=d.length;this.inNewTargetTypeCheck=!0;0<e&&(c.typeFlags|=a.TypeFlags.HasBaseType);for(var f=0;f<e;f++){var j=d[f];j.symbol&&("Object"==j.symbol.name&&j.symbol.container==this.checker.gloMod)&&(c.typeFlags|=a.TypeFlags.HasBaseTypeOfObject);if(j.isClassInstance())c.isClassInstance()&&(!this.checker.typeStatusIsFinished(j.symbol.typeCheckStatus)&&j.symbol.declAST)&&(this.checker.errorReporter.simpleErrorFromSym(j.symbol,"Base type '"+j.symbol.name+"' is referenced before its declaration"),
this.typeCheck(j.symbol.declAST)),this.currentScript&&(this.currentScript.requiresInherits=!0),c.isClassInstance()?b&&this.checker.errorReporter.simpleErrorFromSym(j.symbol,"Class may not follow interface as base type"):this.checker.errorReporter.simpleErrorFromSym(j.symbol,"Interface base type must be interface");else if(j.isModuleType())this.checker.errorReporter.simpleErrorFromSym(j.symbol,"Types may not be derived from module types");else if(j.members)b||(b=!0);else{c.isClassInstance()?this.checker.errorReporter.simpleErrorFromSym(j.symbol,
"Base type must be interface or class"):this.checker.errorReporter.simpleErrorFromSym(j.symbol,"Interface base type must be interface");break}}this.inNewTargetTypeCheck=!1}};d.prototype.checkMembersImplementInterfaces=function(c){c=c.getInstanceType();if(c.implementsList){var b=c.implementsList.length;this.inNewTargetTypeCheck=!0;for(var d=0;d<b;d++){var e=c.implementsList[d],f=new a.TypeComparisonInfo;this.checker.sourceIsSubtypeOfTarget(c,e,f)||(e="Class '"+c.getTypeName()+"' declares interface '"+
e.getTypeName()+"' but does not implement it",f.message?this.checker.errorReporter.simpleErrorFromSym(c.symbol,e+": "+f.message):this.checker.errorReporter.simpleErrorFromSym(c.symbol,e))}this.inNewTargetTypeCheck=!1}};d.prototype.typeCheckBaseCalls=function(c){if(null!=c)for(var b=c.members.length,d=0;d<b;d++){var e=c.members[d];e.nodeType==a.NodeType.Call&&this.typeCheckNew(e)}};d.prototype.assertUniqueNamesInBaseTypes=function(c,b,d,e){var f=this;if(b&&(b.members&&b.members.publicMembers.map(function(a,
j){var i=c.lookup(j.name);i?e&&f.checker.errorReporter.simpleError(d,"duplicate member name in bases for "+d.name.text+": "+b.symbol.name+" and "+i.container.name+" both contain member with name "+j.name):c.add(j.name,j)},null),b.extendsList))for(var j=b.extendsList.length,i=0;i<j;i++)b.extendsList[i].symbol.flags&a.SymbolFlags.RecursivelyReferenced||this.assertUniqueNamesInBaseTypes(c,b.extendsList[i],d,e)};d.prototype.checkBaseTypeMemberInheritance=function(c,b){var d=this,e=c.getInstanceType();
if(null!=e.extendsList){var f=e.extendsList.length;if(0<f){var j=new a.StringHashTable;if(e.isClassInstance())for(var i=0;i<f;i++)this.assertUniqueNamesInBaseTypes(j,e.extendsList[i],b,0<i);e.members&&e.members.publicMembers.map(function(c,j){for(var i=0;i<f;i++){var l=e.extendsList[i];if(null==l.memberScope)d.checker.errorReporter.simpleError(b,"Base type '"+l.symbol.name+"' lacks an implementation.");else if(l=l.memberScope.find(j.name,!1,!1)){var m=j.getType(),q=l.getType();d.checker.sourceIsSubtypeOfTarget(m,
q)?j.kind()==a.SymbolKind.Type&&l.kind()==a.SymbolKind.Field&&d.checker.errorReporter.simpleErrorFromSym(j,"Cannot override field '"+j.name+"' with method"):d.checker.errorReporter.simpleErrorFromSym(j,"Type of overridden member '"+j.name+"' is not subtype of original member defined by type '"+l.container.name+"'")}}},null)}}};d.prototype.typeCheckClass=function(c){var b=c.type.symbol;if(b.typeCheckStatus==a.TypeCheckStatus.Finished||b.typeCheckStatus==a.TypeCheckStatus.Started)return c;b.typeCheckStatus=
a.TypeCheckStatus.Started;this.checker.addStartedPTO(b);var d=this.scope,e=this.thisClassNode;this.thisClassNode=c;var f=c.type;this.typeCheckBases(f.instanceType);var j=this.thisType;this.thisType=f.instanceType;this.scope=f.instanceType.containedScope;c.constructorDecl&&(this.scope=f.instanceType.constructorScope,this.addConstructorLocalArgs(c.constructorDecl.type.symbol,c.constructorDecl.args,this.scope.valueMembers.allMembers,!0));this.typeCheck(c.members);b.typeCheckStatus=a.TypeCheckStatus.Finished;
this.checkBaseTypeMemberInheritance(f,c);this.checkMembersImplementInterfaces(f);this.typeCheckOverloadSignatures(f,c);this.typeCheckOverloadSignatures(f.instanceType,c);c.constructorDecl||c.baseClass&&(c.baseClass.members.length&&c.baseClass.members[0].type&&c.baseClass.members[0].type.symbol.type.isClass())&&a.cloneParentConstructGroupForChildType(c.type,c.baseClass.members[0].type.symbol.type);this.thisType=j;this.thisClassNode=e;this.scope=d;return c};d.prototype.typeCheckOverloadSignatures=function(a,
b){a.call&&a.call.typeCheck(this.checker,b,null!=a.construct);a.construct&&a.construct.typeCheck(this.checker,b,!1);a.index&&a.index.typeCheck(this.checker,b,!1)};d.prototype.typeCheckInterface=function(a){this.typeCheckBases(a.type);this.typeCheck(a.members);this.checkBaseTypeMemberInheritance(a.type,a);if(a.extendsList)for(var b=0;b<a.extendsList.members.length;b++)a.extendsList.members[b].type.call&&(a.type.call?a.type.call.signatures=a.type.call.signatures.concat(a.extendsList.members[b].type.call.signatures):
a.type.call=a.extendsList.members[b].type.call),a.extendsList.members[b].type.construct&&(a.type.construct?a.type.construct.signatures=a.type.construct.signatures.concat(a.extendsList.members[b].type.construct.signatures):a.type.construct=a.extendsList.members[b].type.construct),a.extendsList.members[b].type.index&&(a.type.index?a.type.index.signatures=a.type.index.signatures.concat(a.extendsList.members[b].type.index.signatures):a.type.index=a.extendsList.members[b].type.index);return a};d.prototype.typeCheckImportDecl=
function(c){var b=c.alias.type,d=null,e=this.inImportTypeCheck;this.inImportTypeCheck=!0;this.typeCheck(c.alias);b=c.alias.type;null==b&&(this.checker.errorReporter.simpleError(c.alias,"Could not resolve module alias '"+c.id.text+"'"),b=this.checker.anyType,c.id.sym.type=b);c.id.type=b;d=b.symbol;b.isModuleType()?(d.type=b,this.checker.currentModDecl&&this.checker.currentModDecl.mod&&this.checker.currentModDecl.mod.importedModules.push(c),c.id.sym.type=b,b.symbol&&b.symbol.declAST&&(b.symbol.declAST.modFlags&=
~a.ModuleFlags.ShouldEmitModuleDecl)):this.checker.errorReporter.simpleError(c.alias,"A module cannot be aliased to a non-module type");this.inImportTypeCheck=e;return c};d.prototype.typeCheckModule=function(c){if(!c.mod)return c;this.currentScript&&(this.currentScript.requiresGlobal=!0);var b=c.mod,d=null,e=this.scope,f=this.thisType,j=this.checker.currentModDecl;this.checker.currentModDecl=c;!this.inImportTypeCheck&&(j&&a.hasFlag(c.modFlags,a.ModuleFlags.IsDynamic)&&!a.hasFlag(c.modFlags,a.ModuleFlags.Ambient))&&
this.checker.errorReporter.simpleError(c,"Dynamic modules may not be nested within other modules");this.thisType=null;this.scope=b.containedScope;this.typeCheck(c.members);d=b.symbol;this.checker.currentModDecl=j;this.thisType=f;this.scope=e;c.type=b;d&&(d.typeCheckStatus=a.TypeCheckStatus.Finished);return c};d.prototype.typeCheckFor=function(a){a.init=this.typeCheck(a.init);this.nestingLevel++;a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.incr=this.typeCheck(a.incr);this.nestingLevel--;
a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"for statement");a.type=this.voidType;return a};d.prototype.typeCheckWith=function(a){this.checker.errorsOnWith&&this.checker.errorReporter.simpleError(a.expr,"All symbols within a 'with' block will be typed as 'any'");a.expr=this.typeCheck(a.expr);this.checker.inWith=!0;a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"with statement");this.checker.inWith=!1;return a};d.prototype.typeCheckForIn=function(c){c.obj=
this.typeCheck(c.obj);c.lval=this.cast(this.typeCheck(c.lval),this.checker.stringType);if(c.lval.nodeType==a.NodeType.VarDecl){var b=c.lval;b.typeExpr&&this.checker.errorReporter.simpleError(b,"Variable declarations for for/in expressions may not contain a type annotation");b.sym&&b.sym.setType(this.checker.stringType)}c.body=this.typeCheck(c.body);this.typeCheckCompoundStmtBlock(c.body,"for in statement");return c};d.prototype.typeCheckWhile=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);
a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"while statement");a.type=this.voidType;return a};d.prototype.typeCheckDoWhile=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"do while statement");a.type=this.voidType;return a};d.prototype.typeCheckCondExpr=function(b){this.checker.styleSettings.assignmentInCond&&null!==b&&(b.nodeType>=a.NodeType.Asg&&b.nodeType<=a.NodeType.LastAsg)&&
this.checker.errorReporter.simpleError(b,"top-level assignment statement in conditional expression")};d.prototype.typeCheckCompoundStmtBlock=function(b,d){this.checker.styleSettings.blockInCompoundStmt&&b&&b.nodeType!=a.NodeType.Block&&this.checker.errorReporter.styleError(b,d+" requires a block")};d.prototype.typeCheckIf=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.thenBod=this.typeCheck(a.thenBod);a.elseBod=this.typeCheck(a.elseBod);this.typeCheckCompoundStmtBlock(a.thenBod,
"if statement");this.typeCheckCompoundStmtBlock(a.elseBod,"if statement");a.type=this.voidType;return a};d.prototype.typeFromAccessorFuncDecl=function(b){return!b.isAccessor()?null:a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?b.type.call.signatures[0].returnType.type:b.type.call.signatures[0].parameters[0].getType()};d.prototype.typeCheckObjectLit=function(b){var d=new a.Type;d.symbol=new a.TypeSymbol(this.checker.anon,b.minChar,this.checker.locationInfo.unitIndex,d);d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable));d.memberScope=new a.SymbolTableScope(d.members,null,null,null,null);var e=new a.SymbolAggregateScope(d.symbol);e.addParentScope(d.memberScope);e.addParentScope(this.scope);d.containedScope=e;var e=b.operand,f=this.thisType,j=!1,i=null;this.checker.hasTargetType()&&((i=this.checker.getTargetTypeContext().contextualType)&&i.symbol&&!this.checker.typeStatusIsFinished(i.symbol.typeCheckStatus)&&i.symbol.declAST&&this.typeCheck(i.symbol.declAST),j=!0);if(e)for(var l=0,s=e.members.length;l<
s;l++){var n=e.members[l],p=n.operand1,r,t=null,u=null;if(p.nodeType==a.NodeType.Name)r=p.text;else if(p.nodeType==a.NodeType.QString)r=p.text,r=r.substring(1,r.length-1);else{this.checker.errorReporter.simpleError(b,"malformed object literal");d=this.anyType;break}j&&i.memberScope&&(t=i.memberScope.find(r,!1,!1));if(n.operand2.nodeType==a.NodeType.FuncDecl&&n.operand2.isAccessor()){var u=n.operand2,w=d.members.publicMembers.lookup(r),w=this.checker.createAccessorSymbol(u,w,d,!0,!1,d.memberScope,
null),u=u.accessorSymbol=w;p.nodeType==a.NodeType.Name&&(p.sym=w)}this.checker.typeCheckWithContextualType(j&&t?t.getType():null,!1,j,n.operand2);if(j&&t){if(n.operand2.type==this.anyType||this.checker.sourceIsAssignableToTarget(n.operand2.type,t.getType())||n.operand2.nodeType==a.NodeType.FuncDecl&&n.operand2.isAccessor()&&this.typeFromAccessorFuncDecl(n.operand2)==t.getType())n.operand1.type=t.getType()}else n.operand2.type=n.operand2.type==this.checker.undefinedType?this.anyType:n.operand2.type;
null==u&&(n=n.operand2.type,t=new a.ValueLocation,u=new a.FieldSymbol(r,p.minChar,this.checker.locationInfo.unitIndex,!0,t),u.flags|=a.SymbolFlags.Property,t.symbol=u,u.typeCheckStatus=this.checker.getTypeCheckFinishedStatus(),t.typeLink=new a.TypeLink,t.typeLink.type=n,d.members.publicMembers.add(r,u));u.isObjectLitField=!0}this.thisType=f;b.type=d;i&&(b.targetType=i)};d.prototype.typeCheckArrayLit=function(b){var d=b.operand,e=this.anyType,f=null,j=new a.TypeComparisonInfo;j.onlyCaptureFirstError=
!0;if(this.checker.hasTargetType()){var i=this.checker.getTargetTypeContext().contextualType;i.elementType&&(f=i.elementType)}if(d&&(i=this.inArrayElementTypeCheck,this.inArrayElementTypeCheck=!0,this.checker.typeCheckWithContextualType(f,this.checker.inProvisionalTypecheckMode(),null!=f,d),this.inArrayElementTypeCheck=i,e=d.members[0].type,e=this.checker.findBestCommonType(e,f,{getLength:function(){return d.members.length},setTypeAtIndex:function(a,b){d.members[a].type=b},getTypeAtIndex:function(a){return d.members[a].type}},
j),e==this.checker.undefinedType||!i&&e==this.nullType))e=this.anyType;e?f&&this.checker.sourceIsAssignableToTarget(e,f)&&(e=f):(j.message?this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression: "+j.message):this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression"),e=this.anyType);b.type=this.checker.makeArrayType(e)};d.prototype.checkForVoidConstructor=function(a,b){if(a&&a.construct&&0<a.construct.signatures.length)for(var d=0;d<
a.construct.signatures.length;d++)if(a.construct.signatures[d].returnType.type==this.checker.voidType){this.checker.errorReporter.simpleError(b,"Constructors may not have a return type of 'void'");break}};d.prototype.typeCheckReturn=function(b){if(this.thisFnc){var d=null;if(this.checker.hasTargetType()){var e=this.checker.getTargetTypeContext().targetAccessorType;if(e)d=e;else if((e=this.checker.getTargetTypeContext().targetSig)&&e.returnType.type!=this.voidType)d=e.returnType.type}b.returnExpression?
(this.thisFnc.fncFlags|=a.FncFlags.HasReturnExpression,null==d&&(this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type&&this.thisFnc.returnTypeAnnotation.type!=this.voidType)&&(d=this.thisFnc.returnTypeAnnotation.type),this.checker.typeCheckWithContextualType(d,this.checker.inProvisionalTypecheckMode(),null!=d,b.returnExpression),(e=this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type?this.thisFnc.returnTypeAnnotation.type:d)?e==this.voidType&&b.returnExpression.type!=
this.voidType?(this.checker.errorReporter.simpleError(b,"Return with value expression in void function"),b.type=b.returnExpression.type):(b.returnExpression=this.cast(b.returnExpression,e),b.type=e):(d&&(b.returnExpression.type!=this.voidType?b.returnExpression=this.cast(b.returnExpression,d):b.returnExpression.type=d),b.type=b.returnExpression.type),this.thisFnc.returnStatementsWithExpressions[this.thisFnc.returnStatementsWithExpressions.length]=b):b.type=null==d?this.checker.voidType:d}return b};
d.prototype.typeCheckInstOf=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);(!(a.operand1.type==this.checker.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand1.type,this.objectInterfaceType))||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.functionInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The instanceof operator requires the left operand to be of type Any or an object type, and the right operand to be of type Any or a subtype of the Function interface type");
a.type=this.booleanType;return a};d.prototype.typeCheckCommaOperator=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};d.prototype.typeCheckLogOr=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,d=a.operand2.type;a.type=b==this.checker.anyType||d==this.checker.anyType?this.checker.anyType:b==this.checker.booleanType?d==this.checker.booleanType?this.checker.booleanType:
this.checker.anyType:b==this.checker.numberType?d==this.checker.numberType?this.checker.numberType:this.checker.anyType:b==this.checker.stringType?d==this.checker.stringType?this.checker.stringType:this.checker.anyType:this.checker.sourceIsSubtypeOfTarget(b,d)?d:this.checker.sourceIsSubtypeOfTarget(d,b)?b:this.checker.anyType;return a};d.prototype.typeCheckLogAnd=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};d.prototype.tryAddCandidates=
function(a,b,d,e,f){var j=a.nonOptionalParameterCount,i=a.parameters.length,l=j,n=!1;if(b.length>=j&&(a.hasVariableArgList||b.length<=i))l=a.hasVariableArgList?a.parameters.length:b.length,n=!0;j=null;if(n||a.hasVariableArgList){a.hasVariableArgList&&(l-=1,j=a.parameters[l].parameter.typeLink.type,j=j.elementType,n=b.length>=l);for(var i=b.length,p=n,r=0;r<i;r++){var t;t=r<l?a.parameters[r].parameter.typeLink.type:j;var u=b[r];if(!t||!u||!this.checker.typesAreIdentical(t,u))p=!1;this.checker.sourceIsAssignableToTarget(u,
t,f)||(n=!1);if(!p&&!n)break}p?d[d.length]=a:n&&0==d.length&&(e[e.length]=a)}};d.prototype.resolveOverload=function(b,d){var e=this.resolutionDataCache.getResolutionData(),f=e.actuals,j=e.exactCandidates,i=e.conversionCandidates,l=null,s=1<d.signatures.length,n=new a.TypeComparisonInfo,p=null,r=null;if(b.nodeType==a.NodeType.Call||b.nodeType==a.NodeType.New){if(p=b.args,r=b.target,b.args)for(var t=b.args.members.length,u=0;u<t;u++)f[u]=b.args.members[u].type}else b.nodeType==a.NodeType.Index&&(r=
b.operand1,p=new a.ASTList,p.members[0]=b.operand2,f[0]=b.operand2.type);u=0;for(t=d.signatures.length;u<t;u++){var w=d.signatures[u];if(!s||w!=d.definitionSignature||this.checker.canCallDefinitionSignature)!w.returnType.type&&(w.declAST&&w.typeCheckStatus!=a.TypeCheckStatus.Finished)&&this.typeCheckFunction(w.declAST),this.tryAddCandidates(w,f,j,i,n)}if(0==j.length)j=this.checker.getApplicableSignatures(i,p,n),0<j.length?(p=this.checker.findMostApplicableSignature(j,p),p.ambiguous&&this.checker.errorReporter.simpleError(r,
"Ambiguous call expression - could not choose overload"),l=p.sig):n.message?this.checker.errorReporter.simpleError(r,"Supplied parameters do not match any signature of call target:\n\t"+n.message):this.checker.errorReporter.simpleError(r,"Supplied parameters do not match any signature of call target");else if(1<j.length){l=[];for(u=0;u<j.length;u++)l[u]={signature:j[u],hadProvisionalErrors:!1};p=this.checker.findMostApplicableSignature(l,p);p.ambiguous&&this.checker.errorReporter.simpleError(r,"Ambiguous call expression - could not choose overload");
l=p.sig}else l=j[0];this.resolutionDataCache.returnResolutionData(e);return l};d.prototype.typeCheckNew=function(a){a.target=this.typeCheck(a.target);var b=a.target;b.type.construct||b.type.call?this.preTypeCheckCallArgs(a.args):a.args=this.typeCheck(a.args);b.type==this.anyType?(a.type=this.anyType,a.args=this.typeCheck(a.args)):b.type.construct?(b=this.resolveOverload(a,b.type.construct),null==b?a.type=this.anyType:(a.type=b.returnType.type==this.voidType?this.anyType:b.returnType.type,a.signature=
b)):b.type.call?(b=this.resolveOverload(a,b.type.call),null==b?a.type=this.anyType:b.returnType.type==this.voidType||b.returnType.type==this.anyType?(a.type=this.anyType,a.signature=b):this.checker.errorReporter.simpleError(a.target,"new expression only valid on constructors")):b.type.elementType?a.type=b.type:(this.checker.errorReporter.invalidCall(a,a.nodeType,this.scope),a.type=this.anyType);this.postTypeCheckCallArgs(a);return a};d.prototype.preTypeCheckCallArgs=function(b){if(b)for(var d=0;d<
b.members.length;d++)switch(b.members[d].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:continue;default:this.typeCheck(b.members[d])}};d.prototype.postTypeCheckCallArgs=function(b){var d=!1,e=0;if(b.target&&b.target.type&&b.signature&&b.args){var f=b.signature;if(f&&b.args.members.length>=f.nonOptionalParameterCount)for(var d=!0,j=null,i=b.args.members.length<f.parameters.length?b.args.members.length:f.parameters.length,e=0;e<i;e++){if((j=f.parameters[e].getType())&&
f.hasVariableArgList&&e>=f.nonOptionalParameterCount-1)j=j.elementType;switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.checker.typeCheckWithContextualType(j,this.checker.inProvisionalTypecheckMode(),!f.parameters[e].declAST.isParenthesized,b.args.members[e])}}}if(!d&&b.args){this.checker.killTargetType();for(e=0;e<b.args.members.length;e++)switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.typeCheck(b.args.members[e])}}};
d.prototype.typeCheckCall=function(b){this.checker.styleSettings.newMustBeUsed&&b.nodeType==a.NodeType.New?a.hasFlag(b.flags,a.ASTFlags.IsStatement)&&this.checker.errorReporter.styleError(b,"use of new expression as a statement"):!this.checker.styleSettings.evalOK&&b.nodeType==a.NodeType.Call&&b.target.nodeType==a.NodeType.Name&&"eval"==b.target.text&&this.checker.errorReporter.styleError(b,"eval not permitted");b.target.nodeType==a.NodeType.FuncDecl&&(b.target.isInlineCallLiteral=!0);var d=this.inSuperCall;
b.target.nodeType==a.NodeType.Super&&(this.inSuperCall=!0);b.target=this.typeCheck(b.target);this.preTypeCheckCallArgs(b.args);var e=b.target;null==e.type||e.type==this.anyType||this.functionInterfaceType&&e.type==this.functionInterfaceType?b.type=this.anyType:(e=e.type,e.call?(e=this.resolveOverload(b,e.call),null==e?b.type=this.anyType:(b.type=e.returnType.type,b.signature=e)):b.target.nodeType==a.NodeType.Super&&this.thisFnc&&this.thisFnc.isConstructor&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.ClassMethod)?
(e=e.symbol.type.construct?this.resolveOverload(b,e.symbol.type.construct):null,null==e?b.type=this.anyType:(b.flags|=a.ASTFlags.ClassBaseConstructorCall,b.type=e.returnType.type,b.signature=e)):(b.type=this.anyType,this.checker.errorReporter.invalidCall(b,b.nodeType,this.scope)));this.postTypeCheckCallArgs(b);this.inSuperCall=d;return b};d.prototype.assignScopes=function(b){this.checker.locationInfo=b.locationInfo;var d=new e(null,null,this.globalScope),d=new a.AssignScopeContext(d,this,[this.checker.currentModDecl]);
a.getAstWalkerFactory().walk(b,a.preAssignScopes,a.postAssignScopes,null,d)};d.prototype.findMemberScope=function(b,d){var e=b.getScope(),f=b.pos-b.getScriptFragmentPosition(),j=b.getScriptFragment(),f=new a.MemberScopeContext(this,f,d);f.scope=e;if(j.nodeType==a.NodeType.Name)return j.type.getMemberScope(this);a.getAstWalkerFactory().walk(j,a.preFindMemberScope,null,null,f);f.ast&&(b.enclosingClassDecl&&f.ast.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=!1);return f.type?f.type.getMemberScope(this):
null};d.prototype.findMemberScopeAt=function(b){return this.findMemberScope(b,a.ASTFlags.DotLHS)};d.prototype.findMemberScopeAtFullAst=function(b){var d=a.ASTFlags.DotLHS,e=b.pos,f=null,j=function(b,c,j){a.isValidAstNode(b)&&(a.hasFlag(b.flags,d)&&(b.minChar<e&&e<=b.limChar)&&(f=b),j.options.goChildren=b.minChar<=e&&e<=b.limChar);return b};a.getAstWalkerFactory().walk(b.script,function(b,c,j){if(a.isValidAstNode(b)){if(a.hasFlag(b.flags,d)&&(e==b.limChar||e-1==b.limChar))f=b,j.options.stopWalk();
j.options.goChildren=b.minChar<=e&&e<=b.limChar}return b});null==f&&a.getAstWalkerFactory().walk(b.script,j);f&&(b.enclosingClassDecl&&f.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=!1);return f&&f.type?f.type.getMemberScope(this):null};a.TypeFlow=d})(TypeScript||(TypeScript={}));
(function(a){var e=a.Primitive||(a.Primitive={});e._map=[];e.None=0;e.Void=1;e.Double=2;e.String=4;e.Boolean=8;e.Any=16;e.Null=32;e.Undefined=64;var i=a.Primitive,b=function(){this.suffix=this.prefix=""};b.prototype.isString=function(){return!1};b.prototype.isArray=function(){return!1};b.prototype.toString=function(){return b.memberNameToString(this)};b.memberNameToString=function(a){var c=a.prefix;if(a.isString())c+=a.text;else for(var d=0;d<a.entries.length;d++)c+=b.memberNameToString(a.entries[d]),
c+=a.delim;return c+=a.suffix};b.create=function(a,b,c){if("string"==typeof a)return new j(a);var d=new f;b&&(d.prefix=b);c&&(d.suffix=c);d.entries.push(a);return d};a.MemberName=b;var j,e=function(a){b.call(this);this.text=a};__extends(e,b);e.prototype.isString=function(){return!0};j=e;a.MemberNameString=j;var f,e=function(){b.apply(this,arguments);this.delim="";this.entries=[]};__extends(e,b);e.prototype.isArray=function(){return!0};e.prototype.add=function(a){this.entries.push(a)};e.prototype.addAll=
function(a){for(var b=0;b<a.length;b++)this.entries.push(a[b])};f=e;a.MemberNameArray=f;var d=-1,l=function(){this.typeID=d++;this.index=this.call=this.construct=null;this.passTypeCreated=a.CompilerDiagnostics.analysisPass;this.primitiveTypeClass=i.None;this.typeFlags=a.TypeFlags.None};l.prototype.baseClass=function(){return this.extendsList&&0<this.extendsList.length?this.extendsList[0]:null};l.prototype.getArrayBase=function(a,b){return this.arrayCache.specialize(a,b)};l.prototype.isClass=function(){return null!=
this.instanceType};l.prototype.isArray=function(){return null!=this.elementType};l.prototype.isClassInstance=function(){return this.symbol&&!this.elementType&&this.symbol.type.isClass()};l.prototype.getInstanceType=function(){return this.isClass()?this.instanceType:this};l.prototype.hasImplementation=function(){return a.hasFlag(this.typeFlags,a.TypeFlags.HasImplementation)};l.prototype.setHasImplementation=function(){this.typeFlags|=a.TypeFlags.HasImplementation};l.prototype.isDouble=function(){return a.hasFlag(this.primitiveTypeClass,
i.Double)};l.prototype.isString=function(){return a.hasFlag(this.primitiveTypeClass,i.String)};l.prototype.isBoolean=function(){return a.hasFlag(this.primitiveTypeClass,i.Boolean)};l.prototype.isNull=function(){return a.hasFlag(this.primitiveTypeClass,i.Null)};l.prototype.getTypeName=function(){return this.getMemberTypeName("",!0,!1,null)};l.prototype.getScopedTypeName=function(a){return this.getMemberTypeName("",!0,!1,a)};l.prototype.getScopedTypeNameEx=function(a){return this.getMemberTypeNameEx("",
!0,!1,a)};l.prototype.callCount=function(){var a=0;this.call&&(a+=this.call.signatures.length);this.construct&&(a+=this.construct.signatures.length);this.index&&(a+=this.index.signatures.length);return a};l.prototype.getMemberTypeName=function(a,b,c,d){return this.getMemberTypeNameEx(a,b,c,d).toString()};l.prototype.getMemberTypeNameEx=function(c,d,e,j){if(this.elementType)return b.create(this.elementType.getMemberTypeNameEx(c,!1,!0,j),"","[]");if(this.symbol&&this.symbol.name&&"_anonymous"!=this.symbol.name&&
(null==this.call&&null==this.construct&&null==this.index||a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName)||this.members&&!this.isClass()))return d=this.symbol.scopeRelativeName(j),b.create("null"==d?"any":d);if(this.members||this.call||this.construct){if(a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName))return b.create("this");this.typeFlags|=a.TypeFlags.BuildingName;var i=new f,l=e,s=e=0;this.members&&this.members.allMembers.map(function(c,d){if(!a.hasFlag(d.flags,a.SymbolFlags.BuiltIn)){var e=
d.getTypeName(j);2<=e.length&&"; "==e.substring(e.length-2)&&(e=e.substring(0,e.length-2));i.add(b.create(e));s++;d.kind()==a.SymbolKind.Type?1<d.type.callCount()&&(l=!0):l=!0}},null);var n,p=0,r=0==s&&1==this.callCount()&&d;r||(i.delim="; ");if(this.call){c=this.call.toStrings(c,r,j);n=0;for(p=c.length;n<p;n++)i.add(b.create(c[n])),e++}if(this.construct){c=this.construct.toStrings("new",r,j);n=0;for(p=c.length;n<p;n++)i.add(b.create(c[n])),e++}if(this.index){c=this.index.toStrings("",r,j);n=0;for(p=
c.length;n<p;n++)i.add(b.create(c[n])),e++}if(l||1<e&&d)i.prefix="{ ",i.suffix="}";this.typeFlags&=~a.TypeFlags.BuildingName;return 0==e&&0==s?b.create("{}"):i}return b.create("{}")};l.prototype.checkDecl=function(a){(this.isClassInstance()||this.isClass())&&this.symbol.declAST&&a.typeFlow.inScopeTypeCheckDecl(this.symbol.declAST)};l.prototype.getMemberScope=function(a){return this==a.anyType?null:this.isDouble()?a.numberInterfaceType?a.numberInterfaceType.memberScope:null:this.isBoolean()?a.booleanInterfaceType?
a.booleanInterfaceType.memberScope:null:this==a.stringType?a.stringInterfaceType?a.stringInterfaceType.memberScope:null:this.elementType?a.arrayInterfaceType?this.elementType.getArrayBase(a.arrayInterfaceType,a.checker).memberScope:null:this.memberScope};l.prototype.isReferenceType=function(){return this.members||this.extendsList||this.construct||this.call||this.index||this.elementType};l.prototype.specializeType=function(b,c,d,e){if(b==this)return c;var f=this;e?this.isReferenceType()&&(f=new l,
this.members&&(f.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),this.members.publicMembers.map(function(a,e){var j=e.specializeType(b,c,d);f.members.addPublicMember(j.name,j)},null),this.members.privateMembers.map(function(a,e){var j=e.specializeType(b,c,d);f.members.addPrivateMember(j.name,j)},null)),this.ambientMembers&&(f.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),this.ambientMembers.publicMembers.map(function(a,
e){var j=e.specializeType(b,c,d);f.ambientMembers.addPublicMember(j.name,j)},null),this.ambientMembers.privateMembers.map(function(a,e){var j=e.specializeType(b,c,d);f.ambientMembers.addPrivateMember(j.name,j)},null)),f.containedScope=d.scopeOf(f),f.memberScope=f.containedScope):this.elementType?this.elementType==b?f=d.makeArrayType(c):this.elementType.elementType==b&&(f=d.makeArrayType(d.makeArrayType(c))):this.call&&(f=new l,f.call=this.call.specializeType(b,c,d));return f};l.prototype.hasBase=
function(a){if(a==this)return!0;if(this.extendsList)for(var b=0,c=this.extendsList.length;b<c;b++)if(this.extendsList[b].hasBase(a))return!0;return!1};l.prototype.mergeOrdered=function(a,b,c){if(this==b.anyType||a==b.anyType)return b.anyType;if(this==a||a==b.nullType&&this!=b.nullType)return this;if(this==b.nullType&&a!=b.nullType)return a;if(a==b.voidType&&this!=b.voidType)return this;if(this==b.voidType&&a!=b.voidType)return a;if(a==b.undefinedType&&this!=b.undefinedType)return this;if(this==b.undefinedType&&
a!=b.undefinedType)return a;if(this.elementType&&a.elementType){if(this.elementType==a.elementType)return this;a=this.elementType.mergeOrdered(a.elementType,b,c);return null==a?b.makeArrayType(b.anyType):b.makeArrayType(a)}return b.sourceIsSubtypeOfTarget(this,a,c)?a:b.sourceIsSubtypeOfTarget(a,this,c)?this:null};l.prototype.isModuleType=function(){return!1};l.prototype.hasMembers=function(){return null!=this.members};l.prototype.getAllEnclosedTypes=function(){return null};l.prototype.getAllAmbientEnclosedTypes=
function(){return null};l.prototype.getPublicEnclosedTypes=function(){return null};l.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.Type=l;e=function(a,b){l.call(this);this.enclosedTypes=a;this.ambientEnclosedTypes=b;this.importedModules=[]};__extends(e,l);e.prototype.isModuleType=function(){return!0};e.prototype.hasMembers=function(){return null!=this.members||null!=this.enclosedTypes};e.prototype.getAllEnclosedTypes=function(){return this.enclosedTypes};e.prototype.getAllAmbientEnclosedTypes=
function(){return this.ambientEnclosedTypes};e.prototype.getPublicEnclosedTypes=function(){return null};e.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.ModuleType=e;var c;c=function(){this.ast=this.type=null};a.TypeLink=c;a.getTypeLink=function(a,b,d){var e=new c;e.ast=a;e.type=null==a&&d?b.anyType:null;return e}})(TypeScript||(TypeScript={}));
(function(a){function e(a){return a.replace('"',"").replace("'","").replace("'","").replace('"',"")}function i(a){return'"'+a+'"'}function b(a){return a.replace(/\\/g,"/")}function j(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)?a.substring(0,a.length-6):4<a.length&&".str"==a.substring(a.length-4,a.length)?a.substring(0,a.length-4):5<a.length&&".d.ts"==a.substring(a.length-5,a.length)?a.substring(0,a.length-5):3<a.length&&".ts"==a.substring(a.length-3,a.length)||3<a.length&&".js"==
a.substring(a.length-3,a.length)?a.substring(0,a.length-3):a}function f(a){return""==a?a:-1!=a.indexOf("/")?d(a):""}function d(a){a=b(a);a=a.split("/");return a.slice(0,a.length-1).join("/")+"/"}function l(a){for(var a=b(a),d="/"===a.charAt(0),a=a.split("/"),e=0;e<a.length;e++){if("."===a[e]||""===a[e])a.splice(e,1),e--;0<e&&(".."===a[e]&&".."!==a[e-1])&&(a.splice(e-1,2),e-=2)}return(d?"/":"")+a.join("/")}a.stripQuotes=e;a.isQuoted=function(a){return-1!=a.indexOf('"')||-1!=a.indexOf("'")||-1!=a.indexOf("'")||
-1!=a.indexOf('"')};a.quoteStr=i;a.swapQuotes=function(a){-1!=a.indexOf('"')?(a=a.replace('"',"'"),a=a.replace('"',"'")):(a=a.replace("'",'"'),a=a.replace("'",'"'));return a};a.switchToForwardSlashes=b;a.trimModName=j;a.isSTRFile=function(a){return 4<a.length&&".str"==a.substring(a.length-4,a.length)};a.isTSFile=function(a){return 3<a.length&&".ts"==a.substring(a.length-3,a.length)};a.isDSTRFile=function(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)};a.isDTSFile=function(a){return 5<
a.length&&".d.ts"==a.substring(a.length-5,a.length)};a.getPrettyName=function(a,d,f){"undefined"===typeof d&&(d=!0);"undefined"===typeof f&&(f=!1);f=(f?b(a):j(e(a))).split("/");return f.length?d?i(f[f.length-1]):f[f.length-1]:a};a.quoteBaseName=function(a){var b=j(e(a)),d=f(b);if(""==d)return a;a=b.split(d);return i(a[1<a.length?1:0])};a.changePathToSTR=function(a){return j(e(a))+".str"};a.changePathToDSTR=function(a){return j(e(a))+".d.str"};a.changePathToTS=function(a){return j(e(a))+".ts"};a.changePathToDTS=
function(a){return j(e(a))+".d.ts"};a.isRelative=function(a){return"."==a.charAt(0)};a.isRooted=function(a){return"\\"==a.charAt(0)||"/"==a.charAt(0)||-1!=a.indexOf(":\\")||-1!=a.indexOf(":/")};a.getRootFilePath=f;a.filePath=d;a.normalizeURL=function(a){var b=/^(https?:\/\/[\-\w\.]+(:\d+)?\/)(.*)$/i.exec(a);return b?b[1]+l(b[3]):l(a)};a.pathNormalizeRegExp=/\//g;a.normalizePath=l;a.normalizeImportPath=function(a){return l(a)}})(TypeScript||(TypeScript={}));
(function(a){var e=function(a,e){this.path=a;this.content=e};e.prototype.getText=function(a,e){return this.content.substring(a,e)};e.prototype.getLength=function(){return this.content.length};a.SourceUnit=e;a.CompilationEnvironment=function(a,e){this.compilationSettings=a;this.ioHost=e;this.residentCode=[];this.code=[]};var i=function(a){this.environment=a;this.visited={}};i.prototype.resolveCode=function(b,j,f,d){var i={content:"",path:b},c=this.environment.ioHost,h=a.isRelative(b),g=h?!1:a.isRooted(b),
k=h?c.resolvePath(j+"/"+b):g||!j||f?b:j+"/"+b;!a.isSTRFile(k)&&!a.isTSFile(k)&&(k+=".ts");var k=a.switchToForwardSlashes(a.stripQuotes(k)),v=this.environment.compilationSettings.useCaseSensitiveFileResolution?k:k.toLocaleUpperCase();if(!this.visited[v]){if(h||g||!f)try{a.CompilerDiagnostics.debugPrint("   Reading code from "+k);try{i.content=c.readFile(k)}catch(q){try{a.isSTRFile(k)?k=a.changePathToTS(k):a.isTSFile(k)&&(k=a.changePathToSTR(k)),a.CompilerDiagnostics.debugPrint("   Reading code from "+
k),i.content=c.readFile(k)}catch(m){k=a.changePathToDSTR(k);a.CompilerDiagnostics.debugPrint("   Reading code from "+k);try{i.content=c.readFile(k)}catch(s){k=a.changePathToDTS(k),a.CompilerDiagnostics.debugPrint("   Reading code from "+k),i.content=c.readFile(k)}}}a.CompilerDiagnostics.debugPrint("   Found code at "+k);i.path=k;this.visited[v]=!0}catch(n){a.CompilerDiagnostics.debugPrint("   Did not find code for "+b)}else i=c.findFile(j,k),i||(a.isSTRFile(k)?k=a.changePathToTS(k):a.isTSFile(k)&&
(k=a.changePathToSTR(k)),i=c.findFile(j,k)),i||(k=a.changePathToDTS(k),i=c.findFile(j,k),i||(k=a.changePathToDSTR(k),i=c.findFile(j,k))),i?(i.path=a.switchToForwardSlashes(a.stripQuotes(i.path)),a.CompilerDiagnostics.debugPrint(b+" resolved to: "+i.path),i.content=i.content,this.visited[v]=!0):a.CompilerDiagnostics.debugPrint("Could not find "+b);if(i&&i.content){j=c.dirName(i.path);i=new e(i.path,i.content);f=a.preProcessFile(i,this.environment.compilationSettings);for(h=0;h<f.referencedFiles.length;h++)g=
f.referencedFiles[h],k=a.isRooted(g.path)?g.path:j+"/"+g.path,k=c.resolvePath(k),b==k?d.postResolutionError(k,"File contains reference to itself",null):this.resolveCode(g.path,j,!1,d);for(h=0;h<f.importedFiles.length;h++)this.resolveCode(f.importedFiles[h].path,j,!0,d);d.postResolution(i.path,i)}}};a.CodeResolver=i})(TypeScript||(TypeScript={}));
(function(a){function e(a,b){var d=/^(\/\/\/\s*<style\s+)(([a-zA-Z])+=('|").+('|"))\s*\/>/igm.exec(a);if(d&&(d=/^([a-zA-Z]+=['"]on['|"])/igm.exec(d[2])))for(var e=0;e<d.length;e++){var c=d[e].split("=");switch(c[0]){case "blockInCompoundStmt":b.blockInCompoundStmt='"on"'==c[1];break;case "eqeqeq":b.eqeqeq='"on"'==c[1];break;case "forin":b.forin='"on"'==c[1];break;case "emptyBlocks":b.emptyBlocks='"on"'==c[1];break;case "newMustBeUsed":b.newMustBeUsed='"on"'==c[1];break;case "requireSemi":b.requireSemi=
'"on"'==c[1];break;case "assignmentInCond":b.assignmentInCond='"on"'==c[1];break;case "eqnull":b.eqnull='"on"'==c[1];break;case "evalOK":b.evalOK='"on"'==c[1];break;case "innerScopeDeclEscape":b.innerScopeDeclEscape='"on"'==c[1];break;case "funcInLoop":b.funcInLoop='"on"'==c[1];break;case "reDeclareLocal":b.reDeclareLocal='"on"'==c[1];break;case "literalSubscript":b.literalSubscript='"on"'==c[1];break;case "implicitAny":b.implicitAny='"on"'==c[1]}}}var i=function(){this.forin=this.eqeqeq=this.blockInCompoundStmt=
this.bitwise=!1;this.emptyBlocks=!0;this.eqnull=this.assignmentInCond=this.requireSemi=this.newMustBeUsed=!1;this.literalSubscript=this.reDeclareLocal=this.funcInLoop=this.innerScopeDeclEscape=this.evalOK=!0;this.implicitAny=!1};i.prototype.setOption=function(a,b){return void 0!==this[a]?(this[a]=b,!0):!1};i.prototype.parseOptions=function(a){for(var a=a.split(";"),b=0,d=a.length;b<d;b++){var e=a[b],c=!0,h=e.lastIndexOf(":");if(0<=h){var g=e.substring(h+1),e=e.substring(0,h);"off"==g&&(c=!1)}if(!this.setOption(e,
c))return!1}return!0};a.StyleSettings=i;var b=function(){this.styleSettings=new i;this.parseOnly=this.minWhitespace=this.propagateConstants=!1;this.outputMany=!0;this.exec=this.watch=this.emitComments=this.errorRecovery=!1;this.resolve=!0;this.controlFlowUseDef=this.printControlFlow=this.controlFlow=!1;this.preprocess=this.errorOnWith=!0;this.inferPropertiesFromThisAssignment=this.canCallDefinitionSignature=!1;this.useDefaultLib=!0;this.codeGenTarget=a.CodeGenTarget.ES3;this.moduleGenTarget=a.ModuleGenTarget.Synchronous;
this.errorFileName=this.outputFileName="";this.useCaseSensitiveFileResolution=this.generateDeclarationFiles=this.mapSourceFiles=!1};b.prototype.setStyleOptions=function(a){this.styleSettings.parseOptions(a)};b.prototype.outputOne=function(a){this.outputFileName=a;this.outputMany=!1};a.CompilationSettings=b;a.getAdditionalDependencyPath=function(a){return(a=/^(\/\/\/\s*<amd-dependency\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(a))?a[3]:null};a.getStyleSettings=e;a.preProcessFile=
function(j,f){"undefined"===typeof f&&(f=new b);var d=new a.Scanner;d.resetComments();d.setSourceText(j,a.LexMode.File);for(var i=d.scan(),c=[],h=null,c=[],g=f,k=[],v=[],q=!1;i.tokenId!=a.TokenID.EOF;){if(i.tokenId==a.TokenID.IMPORT&&(i=d.scan(),i.tokenId==a.TokenID.ID||a.convertTokToID(i,!1)))i=d.scan(),i.tokenId==a.TokenID.Asg&&(i=d.scan(),i.tokenId==a.TokenID.MODULE&&(i=d.scan(),i.tokenId==a.TokenID.LParen&&(i=d.scan(),i.tokenId==a.TokenID.QString&&(h={minChar:d.startPos,limChar:d.pos,path:a.stripQuotes(a.switchToForwardSlashes(i.getText())),
isResident:!1},v.push(h)))));i.tokenId==a.TokenID.LCurly&&c.push(i);i.tokenId==a.TokenID.RCurly&&c.pop();i=d.scan()}c=d.getComments();for(d=0;d<c.length;d++)if(h=c[d],!h.isBlock){var i=h.getText(),m=/^(\/\/\/\s*<reference\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(i);if(m){var i=a.normalizePath(m[3]),s=a.normalizePath(i);(m=7<=m.length&&"true"==m[6])&&a.CompilerDiagnostics.debugPrint(i+" is resident");i={minChar:0,limChar:0,path:a.switchToForwardSlashes(s),isResident:m}}else i=null;
i&&(i.minChar=h.startPos,i.limChar=i.minChar+h.value.length,k.push(i));e(h.getText(),g.styleSettings);(h=/^(\/\/\/\s*<reference\s+no-default-lib=)('|")(.+?)\2\s*\/>/igm.exec(h.getText()))&&(q="true"==h[3])}return{settings:g,referencedFiles:k,importedFiles:v,isLibFile:q}}})(TypeScript||(TypeScript={}));
(function(a){var e=function(e){this.logger=e;this.astLogger=new a.AstLogger(this.logger)};e.prototype.getEnclosingScopeContextIfSingleScopeEdit=function(e,b,j,f){this.logger.log('checkEditsInsideSingleScope("'+b+'")');if(null===f)throw Error("editRange should be valid");if(f.isUnknown())return this.logger.log("  Bailing out because edit range is unknown"),null;b=a.findEnclosingScopeAt(this.logger,e,j,f.minChar,!1);e=a.findEnclosingScopeAt(this.logger,e,j,f.limChar,!1);return null==b||null==e?(this.logger.log("  Bailing out because containing scopes cannot be determined"),
null):b.scopeStartAST!==e.scopeStartAST?(this.logger.log("  Bailing out because edit overlaps 2 disctint scopes"),null):0>=b.scopeStartAST.limChar-b.scopeStartAST.minChar+f.delta?(this.logger.log("  Bailing out because scope has been entirely removed from new source text"),null):b};e.prototype.attemptIncrementalUpdateUnit=function(e,b,j,f){this.logger.log('attemptIncrementalUpdateUnit("'+b+'")');if(null===f)throw Error("editRange should be valid");var d=this.getEnclosingScopeContextIfSingleScopeEdit(e,
b,j,f);if(null===d)return null;b=d.scopeStartAST.limChar-d.scopeStartAST.minChar+f.delta;if(b>=j.getLength()/2)return this.logger.log("  Bailing out because range of scope to reparse ("+b+" characters) is greater than half the size of the source text"),null;var l=[],j=a.quickParse(this.logger,d.scopeStartAST,j,d.scopeStartAST.minChar,d.scopeStartAST.minChar+b,function(b,c,d,e){l.push(new a.ErrorEntry(e,b,b+c,d))});if(j.endLexState!=a.LexState.Start)return this.logger.log("  Bailing out because scope contains unterminated comment"),
null;j=j.Script;if(0!==j.vars.members.length)return this.logger.log("  Bailing out because new source text defines variables"),null;if(1!==j.bod.members.length)return this.logger.log("  Bailing out because new source text defines more than one scope (or none)"),null;var d=d.scopeStartAST,c=j.bod.members[0];return d.nodeType!=c.nodeType?(this.logger.log("  Bailing out because new source text does not define the same scope type as the existing scope"),null):!d.leftCurlyCount||!d.rightCurlyCount?(this.logger.log("  Bailing out because sopce doesn't have left/right curly count"),
null):d.leftCurlyCount!==c.leftCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) left curly braces"),null):d.rightCurlyCount!==c.rightCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) right curly braces"),null):0!==c.minChar?(this.logger.log("  Bailing out because new function declaration does not start at position 0"),null):c.limChar!==b?(this.logger.log("  Bailing out because new function declaration does not end at the new end position"),
null):a.UpdateUnitResult.singleScopeEdits(e,j,d,c,f,l)};e.prototype.mergeTrees=function(e){var b=this;a.timeFunction(this.logger,"mergeTrees()",function(){var j=new a.ScriptEditRange(e.scope1.minChar,e.scope1.limChar,e.editRange.delta);b.applyDeltaPosition(e.script1,j.limChar,j.delta);b.applyDeltaPosition(e.script2,0,j.minChar);b.mergeLocationInfo(e.script1,e.script2,j);b.replaceAST(e.script1,e.scope1,e.scope2)})};e.prototype.replaceAST=function(e,b,j){var f=this;a.getAstWalkerFactory().walk(e,function(d,
e,c){if(d===b)return j.preComments=d.preComments,j.postComments=d.postComments,f.logger.log("replaced old AST node with new one in script AST"),c.options.stopWalk(),j;if(a.isValidAstNode(d)&&(d.limChar<b.minChar||d.minChar>b.limChar))c.options.goChildren=!1;return d})};e.prototype.mergeLocationInfo=function(a,b,e){a=a.locationInfo.lineMap;b=b.locationInfo.lineMap;this.logger.information()&&(this.logger.log("lineMap1 (before):"),this.astLogger.logLinemap(a),this.logger.log("lineMap2 (quick parse):"),
this.astLogger.logLinemap(b),this.logger.log("EditRange="+e));for(var f=2,d=2,l=a.length,c=b.length;f<l||d<c;)f<l?a[f]<=e.minChar?f++:a[f]>=e.limChar?(a[f]+=e.delta,f++):d<c?(a.splice(f,0,b[d]+e.minChar),f++,l++,d++):(a.splice(f,1),l--):(a.push(b[d]+e.minChar),d++);this.logger.information()&&(this.logger.log("lineMap1 (after merge):"),this.astLogger.logLinemap(a))};e.prototype.applyDeltaPosition=function(e,b,j){var f=function(a){-1!==a.minChar&&a.minChar>=b&&(a.minChar+=j);-1!==a.limChar&&a.limChar>=
b&&(a.limChar+=j)},d=function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)f(a[b])};a.getAstWalkerFactory().walk(e,function(a,c,e){-1!==a.limChar&&a.limChar<b&&(e.options.goChildren=!1);f(a);d(a.preComments);d(a.postComments);return a})};a.IncrementalParser=e})(TypeScript||(TypeScript={}));
(function(a){var e=a.UpdateUnitKind||(a.UpdateUnitKind={});e._map=[];e._map[0]="Unknown";e.Unknown=0;e._map[1]="NoEdits";e.NoEdits=1;e._map[2]="EditsInsideSingleScope";e.EditsInsideSingleScope=2;var i=a.UpdateUnitKind,b=function(a,b,d){this.minChar=a;this.limChar=b;this.delta=d};b.unknown=function(){return new b(-1,-1,-1)};b.prototype.isUnknown=function(){return-1===this.minChar&&-1===this.limChar&&-1===this.delta};b.prototype.containsPosition=function(a){return this.minChar<=a&&a<this.limChar||this.minChar<=
a&&a<this.limChar+this.delta};b.prototype.toString=function(){return"editRange(minChar="+this.minChar+", limChar="+this.limChar+", delta="+this.delta+")"};a.ScriptEditRange=b;var j=function(a,b,d,e){this.kind=a;this.unitIndex=b;this.script1=d;this.script2=e;this.editRange=this.scope2=this.scope1=null;this.parseErrors=[]};j.noEdits=function(a){return new j(i.NoEdits,a,null,null)};j.unknownEdits=function(a,b,d){a=new j(i.Unknown,a.locationInfo.unitIndex,a,b);a.parseErrors=d;return a};j.singleScopeEdits=
function(a,b,d,e,f,v){a=new j(i.EditsInsideSingleScope,a.locationInfo.unitIndex,a,b);a.scope1=d;a.scope2=e;a.editRange=f;a.parseErrors=v;return a};a.UpdateUnitResult=j;var f;f=function(a,b,d,e){this.unitIndex=a;this.minChar=b;this.limChar=d;this.message=e};a.ErrorEntry=f;a.defaultSettings=new a.CompilationSettings;e=function(b,c,d,e){"undefined"===typeof d&&(d=new a.NullLogger);"undefined"===typeof e&&(e=a.defaultSettings);this.outfile=b;this.errorOutput=c;this.logger=d;this.settings=e;this.parser=
new a.Parser;this.typeFlow=null;this.scripts=new a.ASTList;this.units=[];this.errorReporter=new a.ErrorReporter(this.outfile);this.persistentTypeState=new a.PersistentGlobalTypeState(this.errorReporter);this.errorReporter.parser=this.parser;this.initTypeChecker(this.errorOutput);this.parser.style_requireSemi=this.settings.styleSettings.requireSemi;this.parser.style_funcInLoop=this.settings.styleSettings.funcInLoop;this.parser.inferPropertiesFromThisAssignment=this.settings.inferPropertiesFromThisAssignment;
this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany};a.codeGenTarget=e.codeGenTarget};e.prototype.timeFunction=function(b,c){return a.timeFunction(this.logger,b,c)};e.prototype.initTypeChecker=function(){this.persistentTypeState.refreshPersistentState();this.typeChecker=new a.TypeChecker(this.persistentTypeState);
this.typeChecker.errorReporter=this.errorReporter;this.typeChecker.checkControlFlow=this.settings.controlFlow;this.typeChecker.checkControlFlowUseDef=this.settings.controlFlowUseDef;this.typeChecker.printControlFlowGraph=this.settings.printControlFlow;this.typeChecker.errorsOnWith=this.settings.errorOnWith;this.typeChecker.styleSettings=this.settings.styleSettings;this.typeChecker.canCallDefinitionSignature=this.settings.canCallDefinitionSignature;this.errorReporter.checker=this.typeChecker;this.setErrorOutput(this.errorOutput)};
e.prototype.setErrorOutput=function(a){this.errorOutput=a;this.errorReporter.setErrOut(a);this.parser.outfile=a};e.prototype.emitCommentsToOutput=function(){this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany}};e.prototype.setErrorCallback=function(a){this.parser.errorCallback=a};e.prototype.updateUnit=function(b,
c,d){return this.updateSourceUnit(new a.StringSourceText(b),c,d)};e.prototype.updateSourceUnit=function(a,b,d){var e=this;return this.timeFunction("updateSourceUnit("+b+")",function(){var f=e.partialUpdateUnit(a,b,d);return e.applyUpdateResult(f)})};e.prototype.applyUpdateResult=function(b){switch(b.kind){case i.NoEdits:return!1;case i.Unknown:this.scripts.members[b.unitIndex]=b.script2;this.units[b.unitIndex]=b.script2.locationInfo;for(var c=0,d=b.parseErrors.length;c<d;c++){var e=b.parseErrors[c];
this.parser.errorCallback&&this.parser.errorCallback(e.minChar,e.limChar-e.minChar,e.message,e.unitIndex)}return!0;case i.EditsInsideSingleScope:return(new a.IncrementalParser(this.logger)).mergeTrees(b),!0}};e.prototype.partialUpdateUnit=function(a,b,d){var e=this;return this.timeFunction("partialUpdateUnit("+b+")",function(){for(var i=0,v=e.units.length;i<v;i++)if(e.units[i].filename==b){if(e.scripts.members[i].isResident)return j.noEdits(i);d&&e.parser.setErrorRecovery(null,0,0);var q=[],m=function(a,
b,c,d){q.push(new f(d,a,a+b,c))};if(v=e.parser.errorCallback)e.parser.errorCallback=m;m=e.scripts.members[i];i=e.parser.parse(a,b,i);v&&(e.parser.errorCallback=v);return j.unknownEdits(m,i,q)}throw Error('Unknown file "'+b+'"');})};e.prototype.addUnit=function(b,c,d){"undefined"===typeof d&&(d=!1);return this.addSourceUnit(new a.StringSourceText(b),c,d)};e.prototype.addSourceUnit=function(b,c,d){"undefined"===typeof d&&(d=!1);var e=this;return this.timeFunction("addSourceUnit("+c+", "+d+")",function(){var f=
e.parser.parse(b,c,e.units.length,a.AllowedElements.Global);f.isResident=d;e.persistentTypeState.setCollectionMode(d?a.TypeCheckCollectionMode.Resident:a.TypeCheckCollectionMode.Transient);e.units[e.units.length]=f.locationInfo;e.typeChecker.collectTypes(f);e.scripts.append(f);return f})};e.prototype.parseUnit=function(b,c){return this.parseSourceUnit(new a.StringSourceText(b),c)};e.prototype.parseSourceUnit=function(b,c){this.parser.setErrorRecovery(this.outfile,-1,-1);var d=this.parser.parse(b,
c,0),e=new a.PrintContext(this.outfile,this.parser);a.getAstWalkerFactory().walk(d,a.prePrintAST,a.postPrintAST,null,e)};e.prototype.typeCheck=function(){var b=this;return this.timeFunction("typeCheck()",function(){var c=new a.Binder(b.typeChecker);b.typeChecker.units=b.units;c.bind(b.typeChecker.globalScope,b.typeChecker.globals);c.bind(b.typeChecker.globalScope,b.typeChecker.ambientGlobals);c.bind(b.typeChecker.globalScope,b.typeChecker.globalTypes);c.bind(b.typeChecker.globalScope,b.typeChecker.ambientGlobalTypes);
b.typeFlow=new a.TypeFlow(b.logger,b.typeChecker.globalScope,b.parser,b.typeChecker);var c=0,d=null,e=b.scripts.members.length;b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Resident);for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.typeCheck(d),d.hasBeenTypeChecked=!0);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);
e=b.scripts.members.length;for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||b.typeFlow.typeCheck(d);return null})};e.prototype.cleanASTTypesForReTypeCheck=function(b){a.getAstWalkerFactory().walk(b,function(b){b.type=null;b.nodeType==a.NodeType.VarDecl?b.sym=null:b.nodeType==a.NodeType.ArgDecl?b.sym=null:b.nodeType==a.NodeType.Name?b.sym=null:b.nodeType==a.NodeType.FuncDecl?(b.signature=null,
b.freeVariables=[],b.symbols=null,b.accessorSymbol=null,b.scopeType=null):b.nodeType==a.NodeType.Module?b.mod=null:b.nodeType==a.NodeType.With?b.withSym=null:b.nodeType==a.NodeType.Catch&&(b.containedScope=null);return b})};e.prototype.cleanTypesForReTypeCheck=function(){var a=this;return this.timeFunction("cleanTypesForReTypeCheck()",function(){for(var b=0,d=a.scripts.members.length;b<d;b++){var e=a.scripts.members[b];e.isResident||(a.cleanASTTypesForReTypeCheck(e),a.typeChecker.collectTypes(e))}return null})};
e.prototype.attemptIncrementalTypeCheck=function(){return this.timeFunction("attemptIncrementalTypeCheck()",function(){return!1})};e.prototype.reTypeCheck=function(){var b=this;return this.timeFunction("reTypeCheck()",function(){a.CompilerDiagnostics.analysisPass++;b.initTypeChecker(b.errorOutput);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);b.cleanTypesForReTypeCheck();return b.typeCheck()})};e.prototype.emit=function(b,c){var d=null;this.emitSettings.createFile=c;
for(var e=0,f=this.scripts.members.length;e<f;e++){var j=this.scripts.members[e];if(j.emitRequired()){var i=this.outfile;if(b){var m=this.units[e].filename,d=m.split(".");d.pop();var s=d.join(".")+".js";this.emitSettings.path=s;i=c(s);d=new a.Emitter(this.typeChecker,i,this.emitSettings);this.settings.mapSourceFiles&&d.setSourceMappings(new a.SourceMapper(m,s,i,c(s+a.SourceMapper.MapFileExtension)));this.settings.generateDeclarationFiles&&(m=a.isSTRFile(m)?a.changePathToDSTR(m):(a.isTSFile(m),a.changePathToDTS(m)),
d.setDeclarationFile(c(m)))}else null==d?(d=new a.Emitter(this.typeChecker,this.outfile,this.emitSettings),this.settings.mapSourceFiles&&d.setSourceMappings(new a.SourceMapper(j.locationInfo.filename,this.settings.outputFileName,this.outfile,c(this.settings.outputFileName+a.SourceMapper.MapFileExtension))),this.settings.generateDeclarationFiles&&(m=this.settings.outputFileName,m=a.isSTRFile(m)?a.changePathToDSTR(m):(a.isTSFile(m),a.changePathToDTS(m)),d.setDeclarationFile(c(m)))):this.settings.mapSourceFiles&&
d.setSourceMappings(new a.SourceMapper(j.locationInfo.filename,d.sourceMapper.jsFileName,this.outfile,d.sourceMapper.sourceMapOut));this.typeChecker.locationInfo=j.locationInfo;d.emitJavascript(j,a.TokenID.Comma,!1,d.canWriteDeclFile());b&&(this.settings.mapSourceFiles&&d.emitSourceMappings(),this.settings.generateDeclarationFiles&&d.declFile.Close(),i.Close())}}b||(this.settings.mapSourceFiles&&d.emitSourceMappings(),this.settings.generateDeclarationFiles&&d.declFile.Close())};e.prototype.emitToOutfile=
function(){var b=null;if(this.settings.mapSourceFiles)throw Error("Cannot generate source map");if(this.settings.generateDeclarationFiles)throw Error("Cannot generate declaration files");for(var c=0,d=this.scripts.members.length;c<d;c++){null==b&&(b=new a.Emitter(this.typeChecker,this.outfile,this.emitSettings));var e=this.scripts.members[c];this.typeChecker.locationInfo=e.locationInfo;b.emitJavascript(e,a.TokenID.Comma,!1)}};a.TypeScriptCompiler=e;var d;d=function(a,b,d){this.name=a;this.type=b;
this.sym=d};a.ScopeEntry=d;e=function(a){this.compiler=a};e.prototype.getScope=function(a){return a.enclosingObjectLit&&a.isMemberCompletion?a.getObjectLiteralScope():a.isMemberCompletion?a.useFullAst?this.compiler.typeFlow.findMemberScopeAtFullAst(a):this.compiler.typeFlow.findMemberScopeAt(a):a.getScope()};e.prototype.getScopeEntries=function(b){var c=this.getScope(b);if(null==c)return[];for(var d=new a.StringHashTable,e=c.getAllSymbolNames(b.isMemberCompletion),f=0;f<e.length;f++){var j=e[f];j==
a.globalId||("_Core"==j||"_element"==j)||d.add(j,"")}e=this.compiler.typeChecker.currentModDecl;this.compiler.typeChecker.currentModDecl=b.deepestModuleDecl;b=this.getTypeNamesForNames(b,d.getAllKeys(),c);this.compiler.typeChecker.currentModDecl=e;return b};e.prototype.getTypeNamesForNames=function(b,c,e){for(var f=[],j=b.getScope(),i=0;i<c.length;i++){var q=c[i],m=b.publicsOnly&&b.isMemberCompletion,s=e.find(q,m,!1);null==s&&(s=e.find(q,m,!0));m=s&&s.flags&a.SymbolFlags.Private?s.container==e.container:
!0;s?m&&(!a.isQuoted(s.name)&&!a.isRelative(s.name))&&(m=s.getType().getScopedTypeName(j),f.push(new d(q,m,s))):("true"==q||"false"==q)&&f.push(new d(q,"bool",this.compiler.typeChecker.booleanType.symbol))}return f};a.ScopeTraversal=e})(TypeScript||(TypeScript={}));
(function(a){var e=a.CompilerDiagnostics||(a.CompilerDiagnostics={}),i=function(a){e.diagnosticWriter&&e.diagnosticWriter.Alert(a)};e.debug=!1;e.diagnosticWriter=null;e.analysisPass=0;e.Alert=i;e.debugPrint=function(a){e.debug&&i(a)};e.assert=function(a,b){e.debug&&(a||i(b))};var b=function(){};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=
function(){};a.NullLogger=b;b=function(a){this.logger=a;this._information=this.logger.information();this._debug=this.logger.debug();this._warning=this.logger.warning();this._error=this.logger.error();this._fatal=this.logger.fatal()};b.prototype.information=function(){return this._information};b.prototype.debug=function(){return this._debug};b.prototype.warning=function(){return this._warning};b.prototype.error=function(){return this._error};b.prototype.fatal=function(){return this._fatal};b.prototype.log=
function(a){this.logger.log(a)};a.LoggerAdapter=b;b=function(){this.logContents=[]};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=function(a){this.logContents.push(a)};a.BufferedLogger=b;a.timeFunction=function(a,b,d){var e=+new Date,d=d();a.log(b+" completed in "+(+new Date-e)+" msec");return d};a.stringToLiteral=function(a,b){var d=
"",e=function(b){switch(a.charCodeAt(b)){case 9:d+="\\t";break;case 10:d+="\\n";break;case 11:d+="\\v";break;case 12:d+="\\f";break;case 13:d+="\\r";break;case 34:d+='\\"';break;case 39:d+="\\'";break;case 92:d+="\\";break;default:d+=a.charAt(b)}};if(a.length>b){for(var c=b>>1,h=0;h<c;h++)e(h);d+="(...)";for(h=a.length-c;h<a.length;h++)e(h)}else{b=a.length;for(h=0;h<b;h++)e(h)}return d}})(TypeScript||(TypeScript={}));var TSCompiler;
(function(a){function e(b,d){"undefined"==typeof d&&(d=new a.Types.CompileInfo);var e=new TypeScript.CompilationSettings;e.generateDeclarationFiles=!0===b.produceDeclarations;e=new TypeScript.TypeScriptCompiler(d.emittedUnits.getDefaultStream(),null,new TypeScript.NullLogger,e);e.parser.errorRecovery=!0;e.setErrorCallback(d.getErrorCallback());for(var c=0;c<b.units.length;c++){var h=b.units[c];e.addUnit(h.data,h.name)}e.typeCheck();e.emit(!0,d.emittedUnits.getEmitCallback());return d.emittedUnits.getDefJS()}function i(a,
b,j){b||(b={units:[]});b.units.push({data:a,name:""});return e(b,j)}function b(b,d,e){"string"==typeof b&&(b=document.getElementById(b));if(!b||!b.tagName||"script"!=b.tagName.toLowerCase())throw Error("Invalid script block.");b=i(b.innerHTML,d,e);a.Helpers.insertScriptBlock(b)}function j(b,d,e,c,h){e||(e=function(){});"undefined"==typeof d&&(d=!0);if("undefined"==typeof h||null===h)h=new a.Types.CompileInfo;var g=new XMLHttpRequest;g.open("GET",b);g.onreadystatechange=function(){if(4==g.readyState)if(200==
g.status){var b=i(g.responseText,c,h);d&&a.Helpers.insertScriptBlock(b);e({result:b,compileInfo:h})}else e({error:!0})};g.send(null)}a.API_VERSION=0.1;a.compile=e;a.compileStr=i;a.runStr=function(b,d,e){b=i(b,d,e);a.Helpers.insertScriptBlock(b);return b};a.runScriptBlock=b;a.runAllScriptBlocks=function(e,d,i){if("undefined"==typeof e||null===e)e=["text/typescript","application/typescript"];a.Helpers.filterScriptBlocks(e,function(a){a.src?j(a.src):b(a,d,i)})};a.compileExtern=j})(TSCompiler||(TSCompiler=
{}));
(function(a){var a=a.Types||(a.Types={}),e=function(){this.errors=[];this.emittedUnits=new i};e.prototype.addError=function(a,b,d,e){this.errors.push({start:a,len:b,msg:d,block:e})};e.prototype.getErrorCallback=function(){var a=this;return function(){a.addError.apply(a,arguments)}};e.prototype.getErrorCount=function(){return this.errors.length};e.prototype.addOutputUnit=function(){};a.CompileInfo=e;var i,e=function(){this.units={};this.units[".js"]=new b};e.prototype.getEmitCallback=function(){var a=this;
return function(b){return a.emitCallback.apply(a,[b])}};e.prototype.emitCallback=function(a){"undefined"==typeof this.units[a]&&(this.units[a]=new b);return this.units[a]};e.prototype.getDefaultStream=function(){return this.units[".js"]};e.prototype.getDefJS=function(){return this.units[".js"].data};e.prototype.getDefDecl=function(){return this.units[".d.ts"]?this.units[".d.ts"].data:""};e.prototype.getUnit=function(a){return this.units[a].data};e.prototype.getAllUnits=function(){return this.units};
i=e;a.EmitDataStore=i;var b,a=function(){this.data=""};a.prototype.Write=function(a){this.data+=a};a.prototype.WriteLine=function(a){this.data+=a+"\n"};a.prototype.Close=function(){};b=a})(TSCompiler||(TSCompiler={}));
(function(a){a=a.Helpers||(a.Helpers={});a.insertScriptBlock=function(a){var i=document.createElement("script");i.setAttribute("type","text/javascript");i.innerHTML=a;document.body.appendChild(i)};a.filterScriptBlocks=function(a,i){var b=!0,j=null;if(document.querySelectorAll){for(var b=!1,j="",f=0,d=a.length;f<d;f++)j+='script[type="'+a[f]+'"]',f!=d-1&&(j+=",");j=document.querySelectorAll(j)}else j=document.getElementsByTagName("script");f=0;for(d=j.length;f<d;f++){var l=j[f];if(b){for(var c=l.getAttribute("type").toLowerCase(),
h=!1,g=0,k=a.length;g<k;g++)if(c==a[g]){h=!0;break}if(!h)continue}i(l)}}})(TSCompiler||(TSCompiler={}));
