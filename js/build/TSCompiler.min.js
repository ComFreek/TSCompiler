var TypeScript;
(function(a){a.hasFlag=function(a,g){return 0!=(a&g)};var d=a.ErrorRecoverySet||(a.ErrorRecoverySet={});d._map=[];d.None=0;d.Comma=1;d.SColon=2;d.Asg=4;d.BinOp=8;d.RBrack=16;d.RCurly=32;d.RParen=64;d.Dot=128;d.Colon=256;d.PrimType=512;d.AddOp=1024;d.LCurly=2048;d.PreOp=4096;d.RegExp=8192;d.LParen=16384;d.LBrack=32768;d.Scope=65536;d.In=131072;d.SCase=262144;d.Else=524288;d.Catch=1048576;d.Var=2097152;d.Stmt=4194304;d.While=8388608;d.ID=16777216;d.Prefix=33554432;d.Literal=67108864;d.RLit=134217728;
d.Func=268435456;d.EOF=536870912;d.TypeScriptS=1073741824;d.ExprStart=d.SColon|d.AddOp|d.LCurly|d.PreOp|d.RegExp|d.LParen|d.LBrack|d.ID|d.Prefix|d.RLit|d.Func|d.Literal;d.StmtStart=d.ExprStart|d.SColon|d.Var|d.Stmt|d.While|d.TypeScriptS;d.Postfix=d.Dot|d.LParen|d.LBrack;d=a.AllowedElements||(a.AllowedElements={});d._map=[];d.None=0;d.Statements=1;d.FunctionDecls=2;d.ModuleDecls=4;d.ClassDecls=8;d.InterfaceDecls=16;d.TypedFuncDecls=32;d.TypedDecls=64;d.TypedFuncSignatures=256;d.TypedSignatures=512;
d.AmbientDecls=1024;d.Properties=2048;d.Block=d.Statements|d.FunctionDecls|d.TypedFuncDecls|d.TypedDecls;d.Global=d.Statements|d.FunctionDecls|d.ModuleDecls|d.ClassDecls|d.InterfaceDecls|d.AmbientDecls;d.FunctionBody=d.Statements|d.FunctionDecls;d.ModuleMembers=d.TypedFuncDecls|d.FunctionDecls|d.ModuleDecls|d.ClassDecls|d.InterfaceDecls|d.TypedDecls|d.Statements|d.AmbientDecls;d.ClassMembers=d.TypedFuncDecls|d.FunctionDecls|d.Statements|d.TypedDecls|d.Properties;d.InterfaceMembers=d.TypedFuncSignatures|
d.TypedSignatures;d.QuickParse=d.Global|d.Properties;d=a.Modifiers||(a.Modifiers={});d._map=[];d.None=0;d.Private=1;d.Public=2;d.Readonly=4;d.Ambient=8;d.Exported=16;d.Getter=32;d.Setter=64;d.Static=128;d=a.ASTFlags||(a.ASTFlags={});d._map=[];d.None=0;d.ExplicitSemicolon=1;d.AutomaticSemicolon=2;d.Writeable=4;d.Error=8;d.DotLHSPartial=16;d.DotLHS=32;d.IsStatement=64;d.StrictMode=128;d.PossibleOptionalParameter=256;d.ClassBaseConstructorCall=512;d.OptionalName=1024;d=a.DeclFlags||(a.DeclFlags={});
d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d=a.ModuleFlags||(a.ModuleFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.IsEnum=256;d.ShouldEmitModuleDecl=512;d.IsWholeFile=1024;d.IsDynamic=2048;d.MustCaptureThis=4096;d=a.SymbolFlags||(a.SymbolFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=
16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.Property=256;d.Readonly=512;d.ModuleMember=1024;d.InterfaceMember=2048;d.ClassMember=4096;d.BuiltIn=8192;d.TypeSetDuringScopeAssignment=16384;d.Constant=32768;d.Optional=65536;d.RecursivelyReferenced=131072;d.Bound=262144;d=a.VarFlags||(a.VarFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.AutoInit=256;d.Property=512;d.Readonly=1024;d.Class=2048;d.ClassProperty=
4096;d.ClassBodyProperty=8192;d.ClassConstructorProperty=16384;d.ClassSuperMustBeFirstCallInConstructor=32768;d.Constant=65536;d.MustCaptureThis=131072;d=a.FncFlags||(a.FncFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.Definition=256;d.Signature=512;d.Method=1024;d.HasReturnExpression=2048;d.CallMember=4096;d.ConstructMember=8192;d.HasSelfReference=16384;d.IsFatArrowFunction=32768;d.IndexerMember=65536;
d.IsFunctionExpression=131072;d.ClassMethod=262144;d.ClassPropertyMethodExported=524288;d=a.SignatureFlags||(a.SignatureFlags={});d._map=[];d.None=0;d.IsIndexer=1;d.IsStringIndexer=2;d.IsNumberIndexer=4;a.ToDeclFlags=function(a){return a};d=a.TypeFlags||(a.TypeFlags={});d._map=[];d.None=0;d.HasImplementation=1;d.HasSelfReference=2;d.MergeResult=4;d.IsEnum=8;d.BuildingName=16;d.HasBaseType=32;d.HasBaseTypeOfObject=64;d.IsClass=128;d=a.TypeRelationshipFlags||(a.TypeRelationshipFlags={});d._map=[];d.SuccessfulComparison=
0;d.SourceIsNullTargetIsVoidOrUndefined=1;d.RequiredPropertyIsMissing=2;d.IncompatibleSignatures=4;d.SourceSignatureHasTooManyParameters=3;d.IncompatibleReturnTypes=16;d.IncompatiblePropertyTypes=32;d.IncompatibleParameterTypes=64;d=a.CodeGenTarget||(a.CodeGenTarget={});d._map=[];d.ES3=0;d.ES5=1;var d=a.CodeGenTarget,j=a.ModuleGenTarget||(a.ModuleGenTarget={});j._map=[];j.Synchronous=0;j.Asynchronous=1;j.Local=2;j=a.ModuleGenTarget;a.codeGenTarget=d.ES3;a.moduleGenTarget=j.Synchronous;a.optimizeModuleCodeGen=
!0;a.flagsToString=function(a,g){for(var k="",i=1;-2147483648>i;i<<=1)if(0!=(g&i))for(var h in a)if(a[h]==i){0<k.length&&(k+="|");k+=h;break}return k}})(TypeScript||(TypeScript={}));
(function(a){a=a.NodeType||(a.NodeType={});a._map=[];a._map[0]="None";a.None=0;a._map[1]="Empty";a.Empty=1;a._map[2]="EmptyExpr";a.EmptyExpr=2;a._map[3]="True";a.True=3;a._map[4]="False";a.False=4;a._map[5]="This";a.This=5;a._map[6]="Super";a.Super=6;a._map[7]="QString";a.QString=7;a._map[8]="Regex";a.Regex=8;a._map[9]="Null";a.Null=9;a._map[10]="ArrayLit";a.ArrayLit=10;a._map[11]="ObjectLit";a.ObjectLit=11;a._map[12]="Void";a.Void=12;a._map[13]="Comma";a.Comma=13;a._map[14]="Pos";a.Pos=14;a._map[15]=
"Neg";a.Neg=15;a._map[16]="Delete";a.Delete=16;a._map[17]="Await";a.Await=17;a._map[18]="In";a.In=18;a._map[19]="Dot";a.Dot=19;a._map[20]="From";a.From=20;a._map[21]="Is";a.Is=21;a._map[22]="InstOf";a.InstOf=22;a._map[23]="Typeof";a.Typeof=23;a._map[24]="NumberLit";a.NumberLit=24;a._map[25]="Name";a.Name=25;a._map[26]="TypeRef";a.TypeRef=26;a._map[27]="Index";a.Index=27;a._map[28]="Call";a.Call=28;a._map[29]="New";a.New=29;a._map[30]="Asg";a.Asg=30;a._map[31]="AsgAdd";a.AsgAdd=31;a._map[32]="AsgSub";
a.AsgSub=32;a._map[33]="AsgDiv";a.AsgDiv=33;a._map[34]="AsgMul";a.AsgMul=34;a._map[35]="AsgMod";a.AsgMod=35;a._map[36]="AsgAnd";a.AsgAnd=36;a._map[37]="AsgXor";a.AsgXor=37;a._map[38]="AsgOr";a.AsgOr=38;a._map[39]="AsgLsh";a.AsgLsh=39;a._map[40]="AsgRsh";a.AsgRsh=40;a._map[41]="AsgRs2";a.AsgRs2=41;a._map[42]="QMark";a.QMark=42;a._map[43]="LogOr";a.LogOr=43;a._map[44]="LogAnd";a.LogAnd=44;a._map[45]="Or";a.Or=45;a._map[46]="Xor";a.Xor=46;a._map[47]="And";a.And=47;a._map[48]="Eq";a.Eq=48;a._map[49]=
"Ne";a.Ne=49;a._map[50]="Eqv";a.Eqv=50;a._map[51]="NEqv";a.NEqv=51;a._map[52]="Lt";a.Lt=52;a._map[53]="Le";a.Le=53;a._map[54]="Gt";a.Gt=54;a._map[55]="Ge";a.Ge=55;a._map[56]="Add";a.Add=56;a._map[57]="Sub";a.Sub=57;a._map[58]="Mul";a.Mul=58;a._map[59]="Div";a.Div=59;a._map[60]="Mod";a.Mod=60;a._map[61]="Lsh";a.Lsh=61;a._map[62]="Rsh";a.Rsh=62;a._map[63]="Rs2";a.Rs2=63;a._map[64]="Not";a.Not=64;a._map[65]="LogNot";a.LogNot=65;a._map[66]="IncPre";a.IncPre=66;a._map[67]="DecPre";a.DecPre=67;a._map[68]=
"IncPost";a.IncPost=68;a._map[69]="DecPost";a.DecPost=69;a._map[70]="TypeAssertion";a.TypeAssertion=70;a._map[71]="FuncDecl";a.FuncDecl=71;a._map[72]="Member";a.Member=72;a._map[73]="VarDecl";a.VarDecl=73;a._map[74]="ArgDecl";a.ArgDecl=74;a._map[75]="Return";a.Return=75;a._map[76]="Break";a.Break=76;a._map[77]="Continue";a.Continue=77;a._map[78]="Throw";a.Throw=78;a._map[79]="For";a.For=79;a._map[80]="ForIn";a.ForIn=80;a._map[81]="If";a.If=81;a._map[82]="While";a.While=82;a._map[83]="DoWhile";a.DoWhile=
83;a._map[84]="Block";a.Block=84;a._map[85]="Case";a.Case=85;a._map[86]="Switch";a.Switch=86;a._map[87]="Try";a.Try=87;a._map[88]="TryCatch";a.TryCatch=88;a._map[89]="TryFinally";a.TryFinally=89;a._map[90]="Finally";a.Finally=90;a._map[91]="Catch";a.Catch=91;a._map[92]="List";a.List=92;a._map[93]="Script";a.Script=93;a._map[94]="Class";a.Class=94;a._map[95]="Interface";a.Interface=95;a._map[96]="Module";a.Module=96;a._map[97]="Import";a.Import=97;a._map[98]="With";a.With=98;a._map[99]="Label";a.Label=
99;a._map[100]="LabeledStatement";a.LabeledStatement=100;a._map[101]="EBStart";a.EBStart=101;a._map[102]="GotoEB";a.GotoEB=102;a._map[103]="EndCode";a.EndCode=103;a._map[104]="Error";a.Error=104;a._map[105]="Comment";a.Comment=105;a._map[106]="Debugger";a.Debugger=106;a.GeneralNode=a.FuncDecl;a.LastAsg=a.AsgRs2})(TypeScript||(TypeScript={}));
(function(a){var d;d=function(){this.constructor=this.isPrototypeOf=this.propertyIsEnumerable=this.hasOwnProperty=this.valueOf=this.toLocaleString=this.toString=this.prototype=void 0};a.BlockIntrinsics=d;var j=function(){this.itemCount=0;this.table=new d};j.prototype.getAllKeys=function(){var a=[],b;for(b in this.table)void 0!=this.table[b]&&(a[a.length]=b);return a};j.prototype.add=function(a,b){if(void 0!=this.table[a])return!1;this.table[a]=b;this.itemCount++;return!0};j.prototype.addOrUpdate=
function(a,b){if(void 0!=this.table[a])return this.table[a]=b,!1;this.table[a]=b;this.itemCount++;return!0};j.prototype.map=function(a,b){for(var i in this.table)void 0!=this.table[i]&&a(i,this.table[i],b)};j.prototype.every=function(a,b){for(var i in this.table)if(void 0!=this.table[i]&&!a(i,this.table[i],b))return!1;return!0};j.prototype.some=function(a,b){for(var i in this.table)if(void 0!=this.table[i]&&a(i,this.table[i],b))return!0;return!1};j.prototype.count=function(){return this.itemCount};
j.prototype.lookup=function(a){a=this.table[a];return void 0!=a?a:null};a.StringHashTable=j;j=function(a,b){this.primaryTable=a;this.secondaryTable=b;this.insertPrimary=!0};j.prototype.getAllKeys=function(){return this.primaryTable.getAllKeys().concat(this.secondaryTable.getAllKeys())};j.prototype.add=function(a,b){return this.insertPrimary?this.primaryTable.add(a,b):this.secondaryTable.add(a,b)};j.prototype.addOrUpdate=function(a,b){return this.insertPrimary?this.primaryTable.addOrUpdate(a,b):this.secondaryTable.addOrUpdate(a,
b)};j.prototype.map=function(a,b){this.primaryTable.map(a,b);this.secondaryTable.map(a,b)};j.prototype.every=function(a,b){return this.primaryTable.every(a,b)&&this.secondaryTable.every(a,b)};j.prototype.some=function(a,b){return this.primaryTable.some(a,b)||this.secondaryTable.some(a,b)};j.prototype.count=function(){return this.primaryTable.count()+this.secondaryTable.count()};j.prototype.lookup=function(a){var b=this.primaryTable.lookup(a);return void 0!=b?b:this.secondaryTable.lookup(a)};a.DualStringHashTable=
j;a.numberHashFn=function(a){a=a^61^a>>>16;a+=a<<3;a=668265261*(a^a>>>4);return a^=a>>>15};a.combineHashes=function(a,b){return b^(a>>5)+a};var b;b=function(a,b){this.key=a;this.data=b};a.HashEntry=b;j=function(a,b,i){this.size=a;this.hashFn=b;this.equalsFn=i;this.itemCount=0;this.table=[];for(a=0;a<this.size;a++)this.table[a]=null};j.prototype.add=function(a,k){var i,h=new b(a,k),c=this.hashFn(a),c=c%this.size;for(i=this.table[c];null!=i;i=i.next)if(this.equalsFn(a,i.key))return!1;h.next=this.table[c];
this.table[c]=h;this.itemCount++;return!0};j.prototype.remove=function(a){var b,i=this.hashFn(a),i=i%this.size,h=null,c=null;for(b=this.table[i];null!=b;b=b.next){if(this.equalsFn(a,b.key)){h=b.data;this.itemCount--;c?c.next=b.next:this.table[i]=b.next;break}c=b}return h};j.prototype.count=function(){return this.itemCount};j.prototype.lookup=function(a){var b;b=this.hashFn(a);b%=this.size;for(b=this.table[b];null!=b;b=b.next)if(this.equalsFn(a,b.key))return b.data;return null};a.HashTable=j})(TypeScript||
(TypeScript={}));var __extends=this.__extends||function(a,d){function j(){this.constructor=a}j.prototype=d.prototype;a.prototype=new j};
(function(a){var d=function(c){this.nodeType=c;this.type=null;this.flags=a.ASTFlags.Writeable;this.limChar=this.minChar=-1;this.passCreated=a.CompilerDiagnostics.analysisPass;this.postComments=this.preComments=null;this.isParenthesized=!1};d.prototype.isStatementOrExpression=function(){return!1};d.prototype.isCompoundStatement=function(){return!1};d.prototype.isLeaf=function(){return this.isStatementOrExpression()&&!this.isCompoundStatement()};d.prototype.typeCheck=function(c){switch(this.nodeType){case a.NodeType.Error:case a.NodeType.EmptyExpr:this.type=
c.anyType;break;case a.NodeType.This:return c.typeCheckThis(this);case a.NodeType.Null:this.type=c.nullType;break;case a.NodeType.False:case a.NodeType.True:this.type=c.booleanType;break;case a.NodeType.Super:return c.typeCheckSuper(this);case a.NodeType.EndCode:case a.NodeType.Empty:case a.NodeType.Void:this.type=c.voidType;break;default:throw Error("please implement in derived class");}return this};d.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
switch(this.nodeType){case a.NodeType.This:c.thisFnc&&a.hasFlag(c.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction)?c.writeToOutput("_this"):c.writeToOutput("this");break;case a.NodeType.Null:c.writeToOutput("null");break;case a.NodeType.False:c.writeToOutput("false");break;case a.NodeType.True:c.writeToOutput("true");break;case a.NodeType.Super:c.emitSuperReference();case a.NodeType.EndCode:break;case a.NodeType.Error:case a.NodeType.EmptyExpr:break;case a.NodeType.Empty:c.writeToOutput("; ");break;
case a.NodeType.Void:c.writeToOutput("void ");break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};d.prototype.print=function(c){c.startLine();var f={line:-1,col:-1},i={line:-1,col:-1};null!==c.parser&&(c.parser.getSourceLineCol(f,this.minChar),c.parser.getSourceLineCol(i,this.limChar),c.write("("+f.line+","+f.col+")--("+i.line+","+i.col+"): "));f=this.printLabel();a.hasFlag(this.flags,a.ASTFlags.Error)&&(f+=" (Error)");
c.writeLine(f)};d.prototype.printLabel=function(){return void 0!==a.nodeTypeTable[this.nodeType]?a.nodeTypeTable[this.nodeType]:a.NodeType._map[this.nodeType]};d.prototype.addToControlFlow=function(a){a.walker.options.goChildren=!1;a.addContent(this)};d.prototype.netFreeUses=function(){};d.prototype.treeViewLabel=function(){return a.NodeType._map[this.nodeType]};a.AST=d;var j=function(c,f){d.call(this,a.NodeType.Error);this.minChar=c;this.limChar=f};__extends(j,d);a.IncompleteAST=j;var b=function(){d.call(this,
a.NodeType.List);this.enclosingScope=null;this.members=[]};__extends(b,d);b.prototype.addToControlFlow=function(a){for(var c=this.members.length,f=0;f<c;f++)if(a.noContinuation){a.addUnreachable(this.members[f]);break}else this.members[f]=a.walk(this.members[f],this);a.walker.options.goChildren=!1};b.prototype.append=function(a){this.members[this.members.length]=a;return this};b.prototype.appendAll=function(c){if(c.nodeType==a.NodeType.List)for(var f=0,i=c.members.length;f<i;f++)this.append(c.members[f]);
else this.append(c);return this};b.prototype.emit=function(c,f,i){c.emitJavascriptList(this,null,a.TokenID.SColon,i,!1,!1)};b.prototype.typeCheck=function(a){var c=this.members.length;a.nestingLevel++;for(var f=0;f<c;f++)this.members[f]&&(this.members[f]=this.members[f].typeCheck(a));a.nestingLevel--;return this};a.ASTList=b;var g=function(c){d.call(this,a.NodeType.Name);this.text=c;this.sym=null;this.cloId=-1};__extends(g,d);g.prototype.isMissing=function(){return!1};g.prototype.isLeaf=function(){return!0};
g.prototype.treeViewLabel=function(){return"id: "+this.text};g.prototype.printLabel=function(){return this.text?"id: "+this.text:"name node"};g.prototype.typeCheck=function(a){return a.typeCheckName(this)};g.prototype.emit=function(a){a.emitJavascriptName(this,!0)};a.Identifier=g;j=function(){g.call(this,"__missing")};__extends(j,g);j.prototype.isMissing=function(){return!0};j.prototype.emit=function(){};a.MissingIdentifier=j;j=function(c){d.call(this,a.NodeType.Label);this.id=c};__extends(j,d);j.prototype.printLabel=
function(){return this.id.text+":"};j.prototype.typeCheck=function(a){this.type=a.voidType;return this};j.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput(this.id.text+":");a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.Label=j;j=function(a,c){d.call(this,a);this.operand=c;this.castTerm=this.targetType=null;this.nty=a};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.addToControlFlow=
function(c){d.prototype.addToControlFlow.call(this,c);this.nodeType==a.NodeType.Throw&&c.returnStmt()};j.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Not:return c.typeCheckBitNot(this);case a.NodeType.LogNot:return c.typeCheckLogNot(this);case a.NodeType.Pos:case a.NodeType.Neg:return c.typeCheckUnaryNumberOperator(this);case a.NodeType.IncPost:case a.NodeType.IncPre:case a.NodeType.DecPost:case a.NodeType.DecPre:return c.typeCheckIncOrDec(this);case a.NodeType.ArrayLit:c.typeCheckArrayLit(this);
break;case a.NodeType.ObjectLit:c.typeCheckObjectLit(this);break;case a.NodeType.Throw:this.operand=c.typeCheck(this.operand);this.type=c.voidType;break;case a.NodeType.Typeof:this.operand=c.typeCheck(this.operand);this.type=c.stringType;break;case a.NodeType.Delete:this.operand=c.typeCheck(this.operand);this.type=c.booleanType;break;case a.NodeType.TypeAssertion:this.castTerm=c.typeCheck(this.castTerm);c.checker.typeCheckWithContextualType(!this.operand.isParenthesized?this.castTerm.type:null,c.checker.inProvisionalTypecheckMode(),
!0,this.operand);c.castWithCoercion(this.operand,this.castTerm.type,!1,!0);this.type=this.castTerm.type;break;case a.NodeType.Void:this.operand=c.typeCheck(this.operand);this.type=c.checker.undefinedType;break;default:throw Error("please implement in derived class");}return this};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);switch(this.nty){case a.NodeType.IncPost:c.emitJavascript(this.operand,a.TokenID.Inc,!1);c.writeToOutput("++");break;case a.NodeType.LogNot:c.writeToOutput("!");
c.emitJavascript(this.operand,a.TokenID.Bang,!1);break;case a.NodeType.DecPost:c.emitJavascript(this.operand,a.TokenID.Dec,!1);c.writeToOutput("--");break;case a.NodeType.ObjectLit:c.emitObjectLiteral(this.operand);break;case a.NodeType.ArrayLit:c.emitArrayLiteral(this.operand);break;case a.NodeType.Not:c.writeToOutput("~");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Neg:c.writeToOutput("-");this.operand.nodeType==a.NodeType.Neg&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,
a.TokenID.Sub,!1);break;case a.NodeType.Pos:c.writeToOutput("+");this.operand.nodeType==a.NodeType.Pos&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,a.TokenID.Add,!1);break;case a.NodeType.IncPre:c.writeToOutput("++");c.emitJavascript(this.operand,a.TokenID.Inc,!1);break;case a.NodeType.DecPre:c.writeToOutput("--");c.emitJavascript(this.operand,a.TokenID.Dec,!1);break;case a.NodeType.Throw:c.writeToOutput("throw ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);c.writeToOutput(";");
break;case a.NodeType.Typeof:c.writeToOutput("typeof ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Delete:c.writeToOutput("delete ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Void:c.writeToOutput("void ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.TypeAssertion:c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.UnaryExpression=j;j=function(a,c,f){d.call(this,a);this.target=c;this.args=f;this.signature=null;this.nty=a;this.minChar=this.target.minChar};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.typeCheck=function(c){return this.nty==a.NodeType.New?c.typeCheckNew(this):c.typeCheckCall(this)};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.New?c.emitNew(this.target,this.args):c.emitCall(this,
this.target,this.args);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.CallExpression=j;j=function(a,c,f){d.call(this,a);this.operand1=c;this.operand2=f;this.nty=a};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Dot:return c.typeCheckDotOperator(this);case a.NodeType.Asg:return c.typeCheckAsgOperator(this);case a.NodeType.Add:case a.NodeType.Sub:case a.NodeType.Mul:case a.NodeType.Div:case a.NodeType.Mod:case a.NodeType.Or:case a.NodeType.And:return c.typeCheckArithmeticOperator(this,
!1);case a.NodeType.Xor:return c.typeCheckBitwiseOperator(this,!1);case a.NodeType.Ne:case a.NodeType.Eq:var f;c.checker.styleSettings.eqeqeq?(f=a.nodeTypeTable[this.nty],c.checker.errorReporter.styleError(this,"use of "+f)):c.checker.styleSettings.eqnull&&(f=a.nodeTypeTable[this.nty],null!==this.operand2&&this.operand2.nodeType==a.NodeType.Null&&c.checker.errorReporter.styleError(this,"use of "+f+" to compare with null"));case a.NodeType.Eqv:case a.NodeType.NEqv:case a.NodeType.Lt:case a.NodeType.Le:case a.NodeType.Ge:case a.NodeType.Gt:return c.typeCheckBooleanOperator(this);
case a.NodeType.Index:return c.typeCheckIndex(this);case a.NodeType.Member:this.type=c.voidType;break;case a.NodeType.LogOr:return c.typeCheckLogOr(this);case a.NodeType.LogAnd:return c.typeCheckLogAnd(this);case a.NodeType.AsgAdd:case a.NodeType.AsgSub:case a.NodeType.AsgMul:case a.NodeType.AsgDiv:case a.NodeType.AsgMod:case a.NodeType.AsgOr:case a.NodeType.AsgAnd:return c.typeCheckArithmeticOperator(this,!0);case a.NodeType.AsgXor:return c.typeCheckBitwiseOperator(this,!0);case a.NodeType.Lsh:case a.NodeType.Rsh:case a.NodeType.Rs2:return c.typeCheckShift(this,
!1);case a.NodeType.AsgLsh:case a.NodeType.AsgRsh:case a.NodeType.AsgRs2:return c.typeCheckShift(this,!0);case a.NodeType.Comma:return c.typeCheckCommaOperator(this);case a.NodeType.InstOf:return c.typeCheckInstOf(this);case a.NodeType.In:return c.typeCheckInOperator(this);case a.NodeType.From:c.checker.errorReporter.simpleError(this,"Illegal use of 'from' keyword in binary expression");break;default:throw Error("please implement in derived class");}return this};j.prototype.emit=function(c){var f=
a.nodeTypeToTokTable[this.nodeType];c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);if(void 0!=f)c.emitJavascript(this.operand1,f,!1),"instanceof"==a.tokenTable[f].text?c.writeToOutput(" instanceof "):"in"==a.tokenTable[f].text?c.writeToOutput(" in "):c.writeToOutputTrimmable(" "+a.tokenTable[f].text+" "),c.emitJavascript(this.operand2,f,!1);else switch(this.nty){case a.NodeType.Dot:c.tryEmitConstant(this)||(c.emitJavascript(this.operand1,a.TokenID.Dot,!1),c.writeToOutput("."),
c.emitJavascriptName(this.operand2,!1));break;case a.NodeType.Index:c.emitIndex(this.operand1,this.operand2);break;case a.NodeType.Member:this.operand2.nodeType==a.NodeType.FuncDecl&&this.operand2.isAccessor()?(a.hasFlag(this.operand2.fncFlags,a.FncFlags.GetAccessor)?c.writeToOutput("get "):c.writeToOutput("set "),c.emitJavascript(this.operand1,a.TokenID.Colon,!1)):(c.emitJavascript(this.operand1,a.TokenID.Colon,!1),c.writeToOutputTrimmable(": "));c.emitJavascript(this.operand2,a.TokenID.Comma,!1);
break;case a.NodeType.Comma:c.emitJavascript(this.operand1,a.TokenID.Comma,!1);c.emitState.inObjectLiteral?c.writeLineToOutput(", "):c.writeToOutput(",");c.emitJavascript(this.operand2,a.TokenID.Comma,!1);break;case a.NodeType.Is:throw Error("should be de-sugared during type check");default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.BinaryExpression=j;j=function(a,c,f,i){d.call(this,a);this.operand1=c;this.operand2=f;
this.operand3=i;this.nty=a};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.typeCheck=function(a){return a.typeCheckQMark(this)};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.operand1,a.TokenID.QMark,!1);c.writeToOutput(" ? ");c.emitJavascript(this.operand2,a.TokenID.QMark,!1);c.writeToOutput(" : ");c.emitJavascript(this.operand3,a.TokenID.QMark,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.TrinaryExpression=j;j=function(c){d.call(this,a.NodeType.NumberLit);this.value=c;this.isNegativeZero=!1};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.typeCheck=function(a){this.type=a.doubleType;return this};j.prototype.treeViewLabel=function(){return"num: "+this.value};j.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);this.isNegativeZero&&a.writeToOutput("-");a.writeToOutput(this.value.toString());a.recordSourceMappingEnd(this);
a.emitParensAndCommentsInPlace(this,!1)};j.prototype.printLabel=function(){return Math.floor(this.value)!=this.value?this.value.toFixed(2).toString():this.value.toString()};a.NumberLiteral=j;j=function(c){d.call(this,a.NodeType.Regex);this.regex=c};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.typeCheck=function(a){this.type=a.regexType;return this};j.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.regex.toString());
a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.RegexLiteral=j;j=function(c){d.call(this,a.NodeType.QString);this.text=c};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.emitStringLiteral(this.text);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){this.type=a.stringType;return this};j.prototype.treeViewLabel=
function(){return"st: "+this.text};j.prototype.printLabel=function(){return this.text};a.StringLiteral=j;j=function(c,f){d.call(this,a.NodeType.Import);this.id=c;this.alias=f;this.varFlags=a.VarFlags.None;this.isDynamicImport=!1};__extends(j,d);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.emit=function(c){if(!this.isDynamicImport||this.id.sym&&!this.id.sym.onlyReferencedAsTypeRef){var f=c.modAliasId,i=c.firstModAlias;c.recordSourceMappingStart(this);c.emitParensAndCommentsInPlace(this,
!0);c.writeToOutput("var "+this.id.text+" = ");c.modAliasId=this.id.text;c.firstModAlias=this.firstAliasedModToString();c.emitJavascript(this.alias,a.TokenID.Tilde,!1);this.isDynamicImport||c.writeToOutput(";");c.emitParensAndCommentsInPlace(this,!1);c.recordSourceMappingEnd(this);c.modAliasId=f;c.firstModAlias=i}};j.prototype.typeCheck=function(a){return a.typeCheckImportDecl(this)};j.prototype.getAliasName=function(c){"undefined"===typeof c&&(c=this.alias);return c.nodeType==a.NodeType.Name?c.text:
this.getAliasName(c.operand1)+"."+this.getAliasName(c.operand2)};j.prototype.firstAliasedModToString=function(){return this.alias.nodeType==a.NodeType.Name?this.alias.text:this.alias.operand1.text};a.ImportDecl=j;var k=function(c,f,i){d.call(this,f);this.id=c;this.nestingLevel=i;this.typeExpr=this.init=null;this.varFlags=a.VarFlags.None;this.sym=null};__extends(k,d);k.prototype.isStatementOrExpression=function(){return!0};k.prototype.isPrivate=function(){return a.hasFlag(this.varFlags,a.VarFlags.Private)};
k.prototype.isPublic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Public)};k.prototype.isProperty=function(){return a.hasFlag(this.varFlags,a.VarFlags.Property)};k.prototype.typeCheck=function(a){return a.typeCheckBoundDecl(this)};k.prototype.printLabel=function(){return this.treeViewLabel()};a.BoundDecl=k;j=function(c,f){k.call(this,c,a.NodeType.VarDecl,f)};__extends(j,k);j.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};j.prototype.isExported=function(){return a.hasFlag(this.varFlags,
a.VarFlags.Exported)};j.prototype.isStatic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Static)};j.prototype.emit=function(a,c){a.emitJavascriptVarDecl(this,c)};j.prototype.treeViewLabel=function(){return"var "+this.id.text};a.VarDecl=j;j=function(c){k.call(this,c,a.NodeType.ArgDecl,0);this.isOptional=!1;this.parameterPropertySym=null};__extends(j,k);j.prototype.isOptionalArg=function(){return this.isOptional||this.init};j.prototype.treeViewLabel=function(){return"arg: "+this.id.text};j.prototype.emit=
function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.id.text);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.ArgDecl=j;var i=0,h=function(c,f,i,e,b,h,k,j){d.call(this,j);this.name=c;this.bod=f;this.isConstructor=i;this.args=e;this.vars=b;this.scopes=h;this.statics=k;this.hint=null;this.fncFlags=a.FncFlags.None;this.returnTypeAnnotation=null;this.variableArgList=!1;this.internalNameCache=this.jumpRefs=null;this.tmp1Declared=
!1;this.enclosingFnc=null;this.freeVariables=[];this.unitIndex=-1;this.boundToProperty=this.classDecl=null;this.isOverload=!1;this.innerStaticFuncs=[];this.isInlineCallLiteral=this.isTargetTypedAsMethod=!1;this.accessorSymbol=null;this.rightCurlyCount=this.leftCurlyCount=0;this.returnStatementsWithExpressions=[];this.scopeType=null};__extends(h,d);h.prototype.internalName=function(){if(null==this.internalNameCache){var a=this.getNameText();this.internalNameCache=a?"_internal_"+a:"_internal_"+i++}return this.internalNameCache};
h.prototype.hasSelfReference=function(){return a.hasFlag(this.fncFlags,a.FncFlags.HasSelfReference)};h.prototype.setHasSelfReference=function(){this.fncFlags|=a.FncFlags.HasSelfReference};h.prototype.addCloRef=function(a,c){null==this.envids&&(this.envids=[]);this.envids[this.envids.length]=a;var f=this.enclosingFnc;if(c)for(;f&&f.type.symbol!=c.container;)f.addJumpRef(c),f=f.enclosingFnc;return this.envids.length-1};h.prototype.addJumpRef=function(a){null==this.jumpRefs&&(this.jumpRefs=[]);var c=
new g(a.name);this.jumpRefs[this.jumpRefs.length]=c;c.sym=a;c.cloId=this.addCloRef(c,null)};h.prototype.buildControlFlow=function(){var c=new a.BasicBlock,f=new a.BasicBlock,c=new a.ControlFlowContext(c,f),f=a.getAstWalkerFactory().getWalker(function(a,c,l){a.addToControlFlow(l.state);return a},null,null,c);c.walker=f;f.walk(this.bod,this);return c};h.prototype.typeCheck=function(a){return a.typeCheckFunction(this)};h.prototype.emit=function(a){a.emitJavascriptFunction(this)};h.prototype.getNameText=
function(){return this.name?this.name.text:this.hint};h.prototype.isMethod=function(){return(this.fncFlags&a.FncFlags.Method)!=a.FncFlags.None};h.prototype.isCallMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.CallMember)};h.prototype.isConstructMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.ConstructMember)};h.prototype.isIndexerMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.IndexerMember)};h.prototype.isSpecialFn=function(){return this.isCallMember()||this.isIndexerMember()||
this.isConstructMember()};h.prototype.isAnonymousFn=function(){return null===this.name};h.prototype.isAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)||a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};h.prototype.isGetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)};h.prototype.isSetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};h.prototype.isAmbient=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Ambient)};h.prototype.isExported=
function(){return a.hasFlag(this.fncFlags,a.FncFlags.Exported)};h.prototype.isPrivate=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Private)};h.prototype.isPublic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Public)};h.prototype.isStatic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Static)};h.prototype.treeViewLabel=function(){return null==this.name?"funcExpr":"func: "+this.name.text};h.prototype.ClearFlags=function(){this.fncFlags=a.FncFlags.None};h.prototype.isSignature=function(){return(this.fncFlags&
a.FncFlags.Signature)!=a.FncFlags.None};h.prototype.hasStaticDeclarations=function(){return!this.isConstructor&&(0<this.statics.members.length||0<this.innerStaticFuncs.length)};a.FuncDecl=h;j=function(a,c,f){this.filename=a;this.lineMap=c;this.unitIndex=f};a.LocationInfo=j;a.unknownLocationInfo=new j("unknown",null,-1);j=function(c,f){h.call(this,new g("script"),null,!1,null,c,f,null,a.NodeType.Script);this.locationInfo=null;this.referencedFiles=[];this.hasBeenTypeChecked=this.isDeclareFile=this.isResident=
this.requiresInherits=this.requiresGlobal=!1;this.topLevelMod=null;this.rightCurlyCount=this.leftCurlyCount=0;this.vars=c;this.scopes=f};__extends(j,h);j.prototype.typeCheck=function(a){return a.typeCheckScript(this)};j.prototype.treeViewLabel=function(){return"Script"};j.prototype.emitRequired=function(){if(!this.isDeclareFile&&!this.isResident&&this.bod)for(var c=0,f=this.bod.members.length;c<f;c++){var i=this.bod.members[c];if(i.nodeType==a.NodeType.Module){if(!a.hasFlag(i.modFlags,a.ModuleFlags.ShouldEmitModuleDecl|
a.ModuleFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.Class){if(!a.hasFlag(i.varFlags,a.VarFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.VarDecl){if(!a.hasFlag(i.varFlags,a.VarFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.FuncDecl){if(!i.isSignature())return!0}else if(i.nodeType!=a.NodeType.Interface&&i.nodeType!=a.NodeType.Empty)return!0}return!1};j.prototype.emit=function(c){this.emitRequired()&&(c.emitParensAndCommentsInPlace(this,!0),c.recordSourceMappingStart(this),
c.emitPrologue(this.requiresInherits),c.emitJavascriptList(this.bod,null,a.TokenID.SColon,!0,!1,!1),c.recordSourceMappingEnd(this),c.emitParensAndCommentsInPlace(this,!1))};a.Script=j;var c=function(a,c,f){d.call(this,a);this.name=c;this.members=f;this.nty=a};__extends(c,d);a.Record=c;j=function(l,f,i,e){c.call(this,a.NodeType.Module,l,f);this.modFlags=a.ModuleFlags.ShouldEmitModuleDecl;this.alias=null;this.rightCurlyCount=this.leftCurlyCount=0;this.amdDependencies=[];this.members=f;this.vars=i;this.name=
l;this.scopes=e;this.prettyName=this.name.text};__extends(j,c);j.prototype.isExported=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Exported)};j.prototype.isAmbient=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Ambient)};j.prototype.isEnum=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.IsEnum)};j.prototype.recordNonInterface=function(){this.modFlags&=~a.ModuleFlags.ShouldEmitModuleDecl};j.prototype.typeCheck=function(a){return a.typeCheckModule(this)};j.prototype.emit=
function(c){a.hasFlag(this.modFlags,a.ModuleFlags.ShouldEmitModuleDecl)||(c.emitParensAndCommentsInPlace(this,!0),c.emitJavascriptModule(this),c.emitParensAndCommentsInPlace(this,!1))};a.ModuleDecl=j;var f=function(a,f,i,e,b){c.call(this,a,f,b);this.extendsList=i;this.implementsList=e;this.name=f;this.members=b};__extends(f,c);a.NamedType=f;j=function(c,i,e,h){f.call(this,a.NodeType.Class,c,e,h,i);this.varFlags=a.VarFlags.None;this.rightCurlyCount=this.leftCurlyCount=0;this.knownMemberNames={};this.constructorDecl=
null;this.constructorNestingLevel=0;this.allMemberDefinitions=new b;this.name=c;this.baseClass=e;this.implementsList=h;this.definitionMembers=i};__extends(j,f);j.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};j.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};j.prototype.typeCheck=function(a){return a.typeCheckClass(this)};j.prototype.emit=function(a){a.emitJavascriptClass(this)};a.ClassDecl=j;j=function(c,i,e,b,h,k){f.call(this,
c,i,h,k,e);this.args=b;this.varFlags=a.VarFlags.None;this.isOverload=!1;this.rightCurlyCount=this.leftCurlyCount=0;this.nty=c;this.name=i;this.extendsList=h;this.implementsList=k;this.members=e};__extends(j,f);j.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};j.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};j.prototype.typeCheck=function(c){if(this.nty==a.NodeType.Interface)return c.typeCheckInterface(this);throw Error("please implement type check for node type"+
this.nty);};j.prototype.emit=function(){if(this.nty!=a.NodeType.Interface)throw Error("please implement emit for node type"+this.nty);};a.TypeDecl=j;var e=function(c){d.call(this,c);this.flags|=a.ASTFlags.IsStatement};__extends(e,d);e.prototype.isLoop=function(){return!1};e.prototype.isCompoundStatement=function(){return this.isLoop()};e.prototype.typeCheck=function(a){this.type=a.voidType;return this};a.Statement=e;j=function(c,f){e.call(this,a.NodeType.LabeledStatement);this.labels=c;this.stmt=
f};__extends(j,e);j.prototype.emit=function(a,c,f){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);if(this.labels)for(var i=this.labels.members.length,e=0;e<i;e++)this.labels.members[e].emit(a,c,f);this.stmt.emit(a,c,!0);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){a.typeCheck(this.labels);this.stmt=this.stmt.typeCheck(a);return this};j.prototype.addToControlFlow=function(c){var f=c.current,i=new a.BasicBlock;c.current=
i;f.addSuccessor(i)};a.LabeledStatement=j;j=function(c,f){e.call(this,a.NodeType.Block);this.stmts=c;this.visible=f};__extends(j,e);j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.visible&&(c.writeLineToOutput(" {"),c.indenter.increaseIndent());var f=c.setInObjectLiteral(!1);this.stmts&&c.emitJavascriptList(this.stmts,null,a.TokenID.SColon,!0,!1,!1);this.visible&&(c.indenter.decreaseIndent(),c.emitIndent(),c.writeToOutput("}"));c.setInObjectLiteral(f);
c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.addToControlFlow=function(c){var f=new a.BasicBlock;c.pushStatement(this,c.current,f);this.stmts&&c.walk(this.stmts,this);c.walker.options.goChildren=!1;c.popStatement();0<f.predecessors.length&&(c.current.addSuccessor(f),c.current=f)};j.prototype.typeCheck=function(a){a.checker.styleSettings.emptyBlocks||(null===this.stmts||0==this.stmts.members.length)&&a.checker.errorReporter.styleError(this,"empty block");a.typeCheck(this.stmts);
return this};a.Block=j;j=function(a){e.call(this,a);this.resolvedTarget=this.target=null;this.nty=a};__extends(j,e);j.prototype.hasExplicitTarget=function(){return this.target};j.prototype.setResolvedTarget=function(c,f){if(f.isLoop())return this.resolvedTarget=f,!0;if(this.nty===a.NodeType.Continue)return c.reportParseError("continue statement applies only to loops"),!1;if(f.nodeType==a.NodeType.Switch||this.hasExplicitTarget())return this.resolvedTarget=f,!0;c.reportParseError("break statement with no label can apply only to a loop or switch statement");
return!1};j.prototype.addToControlFlow=function(c){e.prototype.addToControlFlow.call(this,c);c.unconditionalBranch(this.resolvedTarget,this.nty==a.NodeType.Continue)};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.Break?c.writeToOutput("break"):c.writeToOutput("continue");this.hasExplicitTarget()&&c.writeToOutput(" "+this.target);c.writeToOutput(";");c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};
a.Jump=j;j=function(c){e.call(this,a.NodeType.While);this.cond=c;this.body=null};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isLoop=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);c.writeToOutput("while(");c.emitJavascript(this.cond,a.TokenID.WHILE,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!1,!1);c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);
c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){return a.typeCheckWhile(this)};j.prototype.addToControlFlow=function(c){var f=c.current,i=new a.BasicBlock,e=new a.BasicBlock;f.addSuccessor(i);c.current=i;c.addContent(this.cond);f=c.current;this.body&&(c.current=new a.BasicBlock,f.addSuccessor(c.current),c.pushStatement(this,i,e),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(i);c.current=e;f.addSuccessor(e);c.noContinuation=!1;c.walker.options.goChildren=
!1};a.WhileStatement=j;j=function(){e.call(this,a.NodeType.DoWhile);this.cond=this.whileAST=this.body=null};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isLoop=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);c.writeToOutput("do");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingStart(this.whileAST);c.writeToOutput("while");c.recordSourceMappingEnd(this.whileAST);
c.writeToOutput("(");c.emitJavascript(this.cond,a.TokenID.RParen,!1);c.writeToOutput(")");c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){return a.typeCheckDoWhile(this)};j.prototype.addToControlFlow=function(c){var f=c.current,i=new a.BasicBlock,e=new a.BasicBlock;f.addSuccessor(i);c.current=i;this.body&&(c.pushStatement(this,i,e),c.walk(this.body,this),c.popStatement());c.noContinuation?c.addUnreachable(this.cond):
(f=c.current,f.addSuccessor(i),c.addContent(this.cond),c.current=e,f.addSuccessor(e));c.walker.options.goChildren=!1};a.DoWhileStatement=j;j=function(c){e.call(this,a.NodeType.If);this.cond=c;this.elseBod=null};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isCompoundStatement=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);c.writeToOutput("if(");c.emitJavascript(this.cond,
a.TokenID.IF,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.thenBod,!0,!1);this.elseBod&&(c.writeToOutput(" else"),c.emitJavascriptStatements(this.elseBod,!0,!0));c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){return a.typeCheckIf(this)};j.prototype.addToControlFlow=function(c){this.cond.addToControlFlow(c);var f=new a.BasicBlock,i=c.current;c.pushStatement(this,i,f);var e=!1;c.current=new a.BasicBlock;i.addSuccessor(c.current);
c.walk(this.thenBod,this);c.noContinuation||(e=!0,c.current.addSuccessor(f));this.elseBod?(c.current=new a.BasicBlock,c.noContinuation=!1,i.addSuccessor(c.current),c.walk(this.elseBod,this),c.noContinuation?e&&(c.noContinuation=!1):(e=!0,c.current.addSuccessor(f))):(i.addSuccessor(f),c.noContinuation=!1,e=!0);c.popStatement();0<f.predecessors.length&&(c.noContinuation=!1,e=!0);e&&(c.current=f);c.walker.options.goChildren=!1};a.IfStatement=j;j=function(){e.call(this,a.NodeType.Return);this.returnExpression=
null};__extends(j,e);j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);this.returnExpression?(c.writeToOutput("return "),c.emitJavascript(this.returnExpression,a.TokenID.SColon,!1)):c.writeToOutput("return;");c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.addToControlFlow=function(a){e.prototype.addToControlFlow.call(this,a);a.returnStmt()};j.prototype.typeCheck=
function(a){return a.typeCheckReturn(this)};a.ReturnStatement=j;j=function(){d.call(this,a.NodeType.EndCode)};__extends(j,d);a.EndCode=j;j=function(c,f){e.call(this,a.NodeType.ForIn);this.lval=c;this.obj=f;this.lval&&this.lval.nodeType==a.NodeType.VarDecl&&(this.lval.varFlags|=a.VarFlags.AutoInit)};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isLoop=function(){return!0};j.prototype.isFiltered=function(){if(this.body){var c=null;if(this.body.nodeType==a.NodeType.List){var f=
this.body;1==f.members.length&&(c=f.members[0])}else c=this.body;if(null!==c&&(c.nodeType==a.NodeType.Block&&(f=c,null!==f.stmts&&1==f.stmts.members.length&&(c=f.stmts.members[0])),c.nodeType==a.NodeType.If&&(c=c.cond,c.nodeType==a.NodeType.Call&&(f=c.target,f.nodeType==a.NodeType.Dot&&(f.operand1.nodeType==a.NodeType.Name&&(this.obj.nodeType==a.NodeType.Name&&f.operand1.text==this.obj.text)&&"hasOwnProperty"==f.operand2.text)&&(c=c.args,null!==c&&1==c.members.length&&(c=c.members[0],c.nodeType==
a.NodeType.Name&&this.lval.nodeType==a.NodeType.Name&&this.lval.text==c.text))))))return!0}return!1};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);c.writeToOutput("for(");c.emitJavascript(this.lval,a.TokenID.FOR,!1);c.writeToOutput(" in ");c.emitJavascript(this.obj,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};j.prototype.typeCheck=function(a){a.checker.styleSettings.forin&&(this.isFiltered()||a.checker.errorReporter.styleError(this,"no hasOwnProperty filter"));return a.typeCheckForIn(this)};j.prototype.addToControlFlow=function(c){this.lval&&c.addContent(this.lval);this.obj&&c.addContent(this.obj);var f=c.current,i=new a.BasicBlock,e=new a.BasicBlock;f.addSuccessor(i);c.current=i;this.body&&(c.pushStatement(this,i,e),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(i);
c.current=e;c.noContinuation=!1;f.addSuccessor(e);c.walker.options.goChildren=!1};a.ForInStatement=j;j=function(c){e.call(this,a.NodeType.For);this.init=c};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isLoop=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var f=c.setInObjectLiteral(!1);c.writeToOutput("for(");this.init&&(this.init.nodeType!=a.NodeType.List?c.emitJavascript(this.init,a.TokenID.FOR,
!1):c.emitForVarList(this.init));c.writeToOutput("; ");c.emitJavascript(this.cond,a.TokenID.FOR,!1);c.writeToOutput("; ");c.emitJavascript(this.incr,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){return a.typeCheckFor(this)};j.prototype.addToControlFlow=function(c){this.init&&c.addContent(this.init);var f=c.current,i=new a.BasicBlock,
e=new a.BasicBlock;f.addSuccessor(i);c.current=i;var f=null,b=i,h=null;this.incr&&(b=h=new a.BasicBlock);this.cond&&(f=c.current,c.addContent(this.cond),c.current=new a.BasicBlock,f.addSuccessor(c.current));this.body&&(c.pushStatement(this,b,e),c.walk(this.body,this),c.popStatement());this.incr&&(c.noContinuation?0==h.predecessors.length&&c.addUnreachable(this.incr):(c.current.addSuccessor(h),c.current=h,c.addContent(this.incr)));b=c.current;c.noContinuation||b.addSuccessor(i);f&&(f.addSuccessor(e),
c.noContinuation=!1);0<e.predecessors.length&&(c.noContinuation=!1,c.current=e);c.walker.options.goChildren=!1};a.ForStatement=j;j=function(c){e.call(this,a.NodeType.With);this.expr=c;this.withSym=null};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isCompoundStatement=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("with (");this.expr&&c.emitJavascript(this.expr,a.TokenID.WITH,
!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){return a.typeCheckWith(this)};a.WithStatement=j;j=function(c){e.call(this,a.NodeType.Switch);this.val=c;this.defaultCase=null};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isCompoundStatement=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
var f=c.setInObjectLiteral(!1);c.writeToOutput("switch(");c.emitJavascript(this.val,a.TokenID.ID,!1);c.writeLineToOutput(") {");c.indenter.increaseIndent();for(var i=this.caseList.members.length,e=0;e<i;e++)c.emitJavascript(this.caseList.members[e],a.TokenID.CASE,!0),c.writeLineToOutput("");c.indenter.decreaseIndent();c.emitIndent();c.writeToOutput("}");c.setInObjectLiteral(f);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){var c=this.caseList.members.length;
this.val=a.typeCheck(this.val);for(var f=0;f<c;f++)this.caseList.members[f]=a.typeCheck(this.caseList.members[f]);this.defaultCase=a.typeCheck(this.defaultCase);this.type=a.voidType;return this};j.prototype.addToControlFlow=function(c){var f=c.current;c.addContent(this.val);var i=new a.BasicBlock,e=new a.BasicBlock;f.addSuccessor(i);c.pushSwitch(i);c.current=i;c.pushStatement(this,i,e);c.walk(this.caseList,this);c.popSwitch();c.popStatement();null==this.defaultCase&&f.addSuccessor(e);0<e.predecessors.length?
(c.noContinuation=!1,c.current=e):c.noContinuation=!0;c.walker.options.goChildren=!1};a.SwitchStatement=j;j=function(){e.call(this,a.NodeType.Case);this.expr=null};__extends(j,e);j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.expr?(c.writeToOutput("case "),c.emitJavascript(this.expr,a.TokenID.ID,!1)):c.writeToOutput("default");c.writeToOutput(":");c.emitJavascriptStatements(this.body,!1,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};j.prototype.typeCheck=function(a){this.expr=a.typeCheck(this.expr);a.typeCheck(this.body);this.type=a.voidType;return this};j.prototype.addToControlFlow=function(c){var f=new a.BasicBlock,i=c.currentSwitch[c.currentSwitch.length-1];if(this.expr){var e=new a.BasicBlock;c.current=e;i.addSuccessor(e);c.addContent(this.expr);e.addSuccessor(f)}else i.addSuccessor(f);c.current=f;this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};a.CaseStatement=j;j=function(c,f){d.call(this,
a.NodeType.TypeRef);this.term=c;this.arrayCount=f};__extends(j,d);j.prototype.emit=function(){throw Error("should not emit a type ref");};j.prototype.typeCheck=function(c){var f=c.inTypeRefTypeCheck;c.inTypeRefTypeCheck=!0;var i=a.getTypeLink(this,c.checker,!0);c.checker.resolveTypeLink(c.scope,i,!1);this.term&&c.typeCheck(this.term);c.checkForVoidConstructor(i.type,this);this.type=i.type;this.term&&(this.term.type=this.type);c.inTypeRefTypeCheck=f;return this};a.TypeReference=j;j=function(c,f){e.call(this,
a.NodeType.TryFinally);this.tryNode=c;this.finallyNode=f};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isCompoundStatement=function(){return!0};j.prototype.emit=function(c){c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,a.TokenID.TRY,!1);c.emitJavascript(this.finallyNode,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this)};j.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.finallyNode=a.typeCheck(this.finallyNode);
this.type=a.voidType;return this};j.prototype.addToControlFlow=function(c){var f=new a.BasicBlock;c.walk(this.tryNode,this);var i=new a.BasicBlock;c.current&&c.current.addSuccessor(i);c.current=i;c.pushStatement(this,null,f);c.walk(this.finallyNode,this);!c.noContinuation&&c.current&&c.current.addSuccessor(f);0<f.predecessors.length?c.current=f:c.noContinuation=!0;c.popStatement();c.walker.options.goChildren=!1};a.TryFinally=j;j=function(c,f){e.call(this,a.NodeType.TryCatch);this.tryNode=c;this.catchNode=
f};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.isCompoundStatement=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,a.TokenID.TRY,!1);c.emitJavascript(this.catchNode,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.addToControlFlow=function(c){var f=c.current,i=new a.BasicBlock;f.addSuccessor(i);c.current=
i;i=new a.BasicBlock;c.pushStatement(this,null,i);c.walk(this.tryNode,this);c.noContinuation||c.current&&c.current.addSuccessor(i);c.current=new a.BasicBlock;f.addSuccessor(c.current);c.walk(this.catchNode,this);c.popStatement();c.noContinuation||c.current&&c.current.addSuccessor(i);c.current=i;c.walker.options.goChildren=!1};j.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.catchNode=a.typeCheck(this.catchNode);this.type=a.voidType;return this};a.TryCatch=j;j=function(c){e.call(this,
a.NodeType.Try);this.body=c};__extends(j,e);j.prototype.isStatementOrExpression=function(){return!0};j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("try ");c.emitJavascript(this.body,a.TokenID.TRY,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};j.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,this);a.walker.options.goChildren=
!1;a.noContinuation=!1};a.Try=j;j=function(c,f){e.call(this,a.NodeType.Catch);this.param=c;this.body=f;this.containedScope=null;this.param&&(this.param.varFlags|=a.VarFlags.AutoInit)};__extends(j,e);j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput(" catch (");c.emitJavascript(this.param,a.TokenID.LParen,!1);c.writeToOutput(")");c.emitJavascript(this.body,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};j.prototype.addToControlFlow=function(c){if(this.param){c.addContent(this.param);var f=new a.BasicBlock;c.current.addSuccessor(f);c.current=f}this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};j.prototype.typeCheck=function(c){var f=c.scope;c.scope=this.containedScope;this.param=c.typeCheck(this.param);var i=new a.ValueLocation,e=new a.VariableSymbol(this.param.id.text,this.param.minChar,c.checker.locationInfo.unitIndex,i);i.symbol=e;i.typeLink=new a.TypeLink;
i.typeLink.type=c.anyType;e=c.thisFnc;i.symbol.container=e&&e.type?e.type.symbol:null;this.param.sym=i.symbol;c.scope.enter(i.symbol.container,this.param,i.symbol,c.checker.errorReporter,!1,!1,!1);this.body=c.typeCheck(this.body);c.checker.inProvisionalTypecheckMode()&&(c.scope.getTable().secondaryTable.table[i.symbol.name]=void 0);this.type=c.voidType;c.scope=f;return this};a.Catch=j;j=function(c){e.call(this,a.NodeType.Finally);this.body=c};__extends(j,e);j.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);c.writeToOutput("finally");c.emitJavascript(this.body,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};j.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,this);a.walker.options.goChildren=!1;a.noContinuation=!1};j.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};a.Finally=j;j=function(c,f,i){d.call(this,a.NodeType.Comment);this.content=c;this.isBlockComment=f;this.endsLine=
i;this.text=null};__extends(j,d);j.prototype.getText=function(){if(null==this.text)if(this.isBlockComment){this.text=this.content.split("\n");for(var a=0;a<this.text.length;a++)this.text[a]=this.text[a].replace(/^\s+|\s+$/g,"")}else this.text=[this.content.replace(/^\s+|\s+$/g,"")];return this.text};a.Comment=j;j=function(){e.call(this,a.NodeType.Debugger)};__extends(j,e);j.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput("debugger;");
a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.DebuggerStatement=j})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.goNextSibling=this.goChildren=!0;this.reverseSiblings=!1};d.prototype.stopWalk=function(a){"undefined"===typeof a&&(a=!0);this.goChildren=!a;this.goNextSibling=!a};a.AstWalkOptions=d;var j=function(a,f,i,b,h){this.childrenWalkers=a;this.pre=f;this.post=i;this.options=b;this.state=h};j.prototype.walk=function(a,f){var i=this.pre(a,f,this);void 0===i&&(i=a);if(this.options.goChildren){var b=this.options.goNextSibling;this.options.goNextSibling=!0;this.childrenWalkers[a.nodeType](a,
f,this);this.options.goNextSibling=b}else this.options.goChildren=!0;return this.post?(b=this.post(i,f,this),void 0===b&&(b=i),b):i};var b=function(){this.childrenWalkers=[];this.initChildrenWalkers()};b.prototype.walk=function(a,f,i,b,h){return this.getWalker(f,i,b,h).walk(a,null)};b.prototype.getWalker=function(a,f,i,b){return this.getSlowWalker(a,f,i,b)};b.prototype.getSlowWalker=function(a,f,i,b){i||(i=new d);return new j(this.childrenWalkers,a,f,i,b)};b.prototype.initChildrenWalkers=function(){this.childrenWalkers[a.NodeType.None]=
k.walkNone;this.childrenWalkers[a.NodeType.Empty]=k.walkNone;this.childrenWalkers[a.NodeType.EmptyExpr]=k.walkNone;this.childrenWalkers[a.NodeType.True]=k.walkNone;this.childrenWalkers[a.NodeType.False]=k.walkNone;this.childrenWalkers[a.NodeType.This]=k.walkNone;this.childrenWalkers[a.NodeType.Super]=k.walkNone;this.childrenWalkers[a.NodeType.QString]=k.walkNone;this.childrenWalkers[a.NodeType.Regex]=k.walkNone;this.childrenWalkers[a.NodeType.Null]=k.walkNone;this.childrenWalkers[a.NodeType.ArrayLit]=
k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.ObjectLit]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Void]=k.walkNone;this.childrenWalkers[a.NodeType.Comma]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Pos]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Neg]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Delete]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Await]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.In]=
k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Dot]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.From]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Is]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.InstOf]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Typeof]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.NumberLit]=k.walkNone;this.childrenWalkers[a.NodeType.Name]=k.walkNone;this.childrenWalkers[a.NodeType.TypeRef]=
k.walkTypeReferenceChildren;this.childrenWalkers[a.NodeType.Index]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Call]=k.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.New]=k.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.Asg]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAdd]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgSub]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgDiv]=k.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.AsgMul]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgMod]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAnd]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgXor]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgOr]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgLsh]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRsh]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRs2]=
k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.QMark]=k.walkTrinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogOr]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogAnd]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Or]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Xor]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.And]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eq]=k.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Ne]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eqv]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.NEqv]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lt]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Le]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Gt]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Ge]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Add]=
k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Sub]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mul]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Div]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mod]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lsh]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rsh]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rs2]=k.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Not]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.LogNot]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPre]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPre]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPost]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPost]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.TypeAssertion]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.FuncDecl]=
k.walkFuncDeclChildren;this.childrenWalkers[a.NodeType.Member]=k.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.VarDecl]=k.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.ArgDecl]=k.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.Return]=k.walkReturnStatementChildren;this.childrenWalkers[a.NodeType.Break]=k.walkNone;this.childrenWalkers[a.NodeType.Continue]=k.walkNone;this.childrenWalkers[a.NodeType.Throw]=k.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.For]=
k.walkForStatementChildren;this.childrenWalkers[a.NodeType.ForIn]=k.walkForInStatementChildren;this.childrenWalkers[a.NodeType.If]=k.walkIfStatementChildren;this.childrenWalkers[a.NodeType.While]=k.walkWhileStatementChildren;this.childrenWalkers[a.NodeType.DoWhile]=k.walkDoWhileStatementChildren;this.childrenWalkers[a.NodeType.Block]=k.walkBlockChildren;this.childrenWalkers[a.NodeType.Case]=k.walkCaseStatementChildren;this.childrenWalkers[a.NodeType.Switch]=k.walkSwitchStatementChildren;this.childrenWalkers[a.NodeType.Try]=
k.walkTryChildren;this.childrenWalkers[a.NodeType.TryCatch]=k.walkTryCatchChildren;this.childrenWalkers[a.NodeType.TryFinally]=k.walkTryFinallyChildren;this.childrenWalkers[a.NodeType.Finally]=k.walkFinallyChildren;this.childrenWalkers[a.NodeType.Catch]=k.walkCatchChildren;this.childrenWalkers[a.NodeType.List]=k.walkListChildren;this.childrenWalkers[a.NodeType.Script]=k.walkScriptChildren;this.childrenWalkers[a.NodeType.Class]=k.walkClassDeclChildren;this.childrenWalkers[a.NodeType.Interface]=k.walkTypeDeclChildren;
this.childrenWalkers[a.NodeType.Module]=k.walkModuleDeclChildren;this.childrenWalkers[a.NodeType.Import]=k.walkImportDeclChildren;this.childrenWalkers[a.NodeType.With]=k.walkWithStatementChildren;this.childrenWalkers[a.NodeType.Label]=k.walkLabelChildren;this.childrenWalkers[a.NodeType.LabeledStatement]=k.walkLabeledStatementChildren;this.childrenWalkers[a.NodeType.EBStart]=k.walkNone;this.childrenWalkers[a.NodeType.GotoEB]=k.walkNone;this.childrenWalkers[a.NodeType.EndCode]=k.walkNone;this.childrenWalkers[a.NodeType.Error]=
k.walkNone;this.childrenWalkers[a.NodeType.Comment]=k.walkNone;this.childrenWalkers[a.NodeType.Debugger]=k.walkNone;for(var c in a.NodeType._map)if(void 0===this.childrenWalkers[c])throw Error("initWalkers function is not up to date with enum content!");};a.AstWalkerFactory=b;var g;a.getAstWalkerFactory=function(){g||(g=new b);return g};var k,i=k||(k={}),h=function(a,f,i){a.name=i.walk(a.name,a);i.options.goNextSibling&&a.members&&(a.members=i.walk(a.members,a))};i.walkNone=function(){};i.walkListChildren=
function(a,f,i){f=a.members.length;if(i.options.reverseSiblings)for(var b=f-1;0<=b;b--)i.options.goNextSibling&&(a.members[b]=i.walk(a.members[b],a));else for(b=0;b<f;b++)i.options.goNextSibling&&(a.members[b]=i.walk(a.members[b],a))};i.walkUnaryExpressionChildren=function(a,f,i){a.castTerm&&(a.castTerm=i.walk(a.castTerm,a));a.operand&&(a.operand=i.walk(a.operand,a))};i.walkBinaryExpressionChildren=function(a,f,i){i.options.reverseSiblings?(a.operand2&&(a.operand2=i.walk(a.operand2,a)),a.operand1&&
i.options.goNextSibling&&(a.operand1=i.walk(a.operand1,a))):(a.operand1&&(a.operand1=i.walk(a.operand1,a)),a.operand2&&i.options.goNextSibling&&(a.operand2=i.walk(a.operand2,a)))};i.walkTypeReferenceChildren=function(a,f,i){a.term&&(a.term=i.walk(a.term,a))};i.walkCallExpressionChildren=function(a,f,i){i.options.reverseSiblings||(a.target=i.walk(a.target,a));a.args&&i.options.goNextSibling&&(a.args=i.walk(a.args,a));i.options.reverseSiblings&&i.options.goNextSibling&&(a.target=i.walk(a.target,a))};
i.walkTrinaryExpressionChildren=function(a,f,i){a.operand1&&(a.operand1=i.walk(a.operand1,a));a.operand2&&i.options.goNextSibling&&(a.operand2=i.walk(a.operand2,a));a.operand3&&i.options.goNextSibling&&(a.operand3=i.walk(a.operand3,a))};i.walkFuncDeclChildren=function(a,f,i){a.name&&(a.name=i.walk(a.name,a));a.args&&(0<a.args.members.length&&i.options.goNextSibling)&&(a.args=i.walk(a.args,a));a.returnTypeAnnotation&&i.options.goNextSibling&&(a.returnTypeAnnotation=i.walk(a.returnTypeAnnotation,a));
a.bod&&(0<a.bod.members.length&&i.options.goNextSibling)&&(a.bod=i.walk(a.bod,a))};i.walkBoundDeclChildren=function(a,f,i){a.id&&(a.id=i.walk(a.id,a));a.init&&(a.init=i.walk(a.init,a));a.typeExpr&&i.options.goNextSibling&&(a.typeExpr=i.walk(a.typeExpr,a))};i.walkReturnStatementChildren=function(a,f,i){a.returnExpression&&(a.returnExpression=i.walk(a.returnExpression,a))};i.walkForStatementChildren=function(a,f,i){a.init&&(a.init=i.walk(a.init,a));a.cond&&i.options.goNextSibling&&(a.cond=i.walk(a.cond,
a));a.incr&&i.options.goNextSibling&&(a.incr=i.walk(a.incr,a));a.body&&i.options.goNextSibling&&(a.body=i.walk(a.body,a))};i.walkForInStatementChildren=function(a,f,i){a.lval=i.walk(a.lval,a);i.options.goNextSibling&&(a.obj=i.walk(a.obj,a));a.body&&i.options.goNextSibling&&(a.body=i.walk(a.body,a))};i.walkIfStatementChildren=function(a,f,i){a.cond=i.walk(a.cond,a);a.thenBod&&i.options.goNextSibling&&(a.thenBod=i.walk(a.thenBod,a));a.elseBod&&i.options.goNextSibling&&(a.elseBod=i.walk(a.elseBod,a))};
i.walkWhileStatementChildren=function(a,f,i){a.cond=i.walk(a.cond,a);a.body&&i.options.goNextSibling&&(a.body=i.walk(a.body,a))};i.walkDoWhileStatementChildren=function(a,i,e){a.cond=e.walk(a.cond,a);a.body&&e.options.goNextSibling&&(a.body=e.walk(a.body,a))};i.walkBlockChildren=function(a,i,e){a.stmts&&(a.stmts=e.walk(a.stmts,a))};i.walkCaseStatementChildren=function(a,i,e){a.expr&&(a.expr=e.walk(a.expr,a));a.body&&e.options.goNextSibling&&(a.body=e.walk(a.body,a))};i.walkSwitchStatementChildren=
function(a,i,e){a.val&&(a.val=e.walk(a.val,a));a.caseList&&e.options.goNextSibling&&(a.caseList=e.walk(a.caseList,a))};i.walkTryChildren=function(a,i,e){a.body&&(a.body=e.walk(a.body,a))};i.walkTryCatchChildren=function(a,i,e){a.tryNode&&(a.tryNode=e.walk(a.tryNode,a));a.catchNode&&e.options.goNextSibling&&(a.catchNode=e.walk(a.catchNode,a))};i.walkTryFinallyChildren=function(a,i,e){a.tryNode&&(a.tryNode=e.walk(a.tryNode,a));a.finallyNode&&e.options.goNextSibling&&(a.finallyNode=e.walk(a.finallyNode,
a))};i.walkFinallyChildren=function(a,i,e){a.body&&(a.body=e.walk(a.body,a))};i.walkCatchChildren=function(a,i,e){a.param&&(a.param=e.walk(a.param,a));a.body&&e.options.goNextSibling&&(a.body=e.walk(a.body,a))};i.walkRecordChildren=h;i.walkNamedTypeChildren=function(a,i,e){h(a,i,e)};i.walkClassDeclChildren=function(a,i,e){h(a,i,e);e.options.goNextSibling&&a.baseClass&&(a.baseClass=e.walk(a.baseClass,a));e.options.goNextSibling&&a.implementsList&&(a.implementsList=e.walk(a.implementsList,a))};i.walkScriptChildren=
function(a,i,e){a.bod&&(a.bod=e.walk(a.bod,a))};i.walkTypeDeclChildren=function(a,i,e){h(a,i,e);e.options.goNextSibling&&a.extendsList&&(a.extendsList=e.walk(a.extendsList,a));e.options.goNextSibling&&a.implementsList&&(a.implementsList=e.walk(a.implementsList,a))};i.walkModuleDeclChildren=function(a,i,e){h(a,i,e);e.options.goNextSibling&&a.alias&&(a.alias=e.walk(a.alias,a))};i.walkImportDeclChildren=function(a,i,e){a.id&&(a.id=e.walk(a.id,a));a.alias&&(a.alias=e.walk(a.alias,a))};i.walkWithStatementChildren=
function(a,i,e){a.expr&&(a.expr=e.walk(a.expr,a));a.body&&e.options.goNextSibling&&(a.body=e.walk(a.body,a))};i.walkLabelChildren=function(){};i.walkLabeledStatementChildren=function(a,i,e){a.labels=e.walk(a.labels,a);e.options.goNextSibling&&(a.stmt=e.walk(a.stmt,a))}})(TypeScript||(TypeScript={}));
(function(a){var d=function(j,b,g){switch(b.nodeType){case a.NodeType.Empty:if(g.EmptyCallback)return g.EmptyCallback(j,b);break;case a.NodeType.EmptyExpr:if(g.EmptyExprCallback)return g.EmptyExprCallback(j,b);break;case a.NodeType.True:if(g.TrueCallback)return g.TrueCallback(j,b);break;case a.NodeType.False:if(g.FalseCallback)return g.FalseCallback(j,b);break;case a.NodeType.This:if(g.ThisCallback)return g.ThisCallback(j,b);break;case a.NodeType.Super:if(g.SuperCallback)return g.SuperCallback(j,
b);break;case a.NodeType.QString:if(g.QStringCallback)return g.QStringCallback(j,b);break;case a.NodeType.Regex:if(g.RegexCallback)return g.RegexCallback(j,b);break;case a.NodeType.Null:if(g.NullCallback)return g.NullCallback(j,b);break;case a.NodeType.ArrayLit:if(g.ArrayLitCallback)return g.ArrayLitCallback(j,b);break;case a.NodeType.ObjectLit:if(g.ObjectLitCallback)return g.ObjectLitCallback(j,b);break;case a.NodeType.Void:if(g.VoidCallback)return g.VoidCallback(j,b);break;case a.NodeType.Comma:if(g.CommaCallback)return g.CommaCallback(j,
b);break;case a.NodeType.Pos:if(g.PosCallback)return g.PosCallback(j,b);break;case a.NodeType.Neg:if(g.NegCallback)return g.NegCallback(j,b);break;case a.NodeType.Delete:if(g.DeleteCallback)return g.DeleteCallback(j,b);break;case a.NodeType.Await:if(g.AwaitCallback)return g.AwaitCallback(j,b);break;case a.NodeType.In:if(g.InCallback)return g.InCallback(j,b);break;case a.NodeType.Dot:if(g.DotCallback)return g.DotCallback(j,b);break;case a.NodeType.From:if(g.FromCallback)return g.FromCallback(j,b);
break;case a.NodeType.Is:if(g.IsCallback)return g.IsCallback(j,b);break;case a.NodeType.InstOf:if(g.InstOfCallback)return g.InstOfCallback(j,b);break;case a.NodeType.Typeof:if(g.TypeofCallback)return g.TypeofCallback(j,b);break;case a.NodeType.NumberLit:if(g.NumberLitCallback)return g.NumberLitCallback(j,b);break;case a.NodeType.Name:if(g.NameCallback)return g.NameCallback(j,b);break;case a.NodeType.TypeRef:if(g.TypeRefCallback)return g.TypeRefCallback(j,b);break;case a.NodeType.Index:if(g.IndexCallback)return g.IndexCallback(j,
b);break;case a.NodeType.Call:if(g.CallCallback)return g.CallCallback(j,b);break;case a.NodeType.New:if(g.NewCallback)return g.NewCallback(j,b);break;case a.NodeType.Asg:if(g.AsgCallback)return g.AsgCallback(j,b);break;case a.NodeType.AsgAdd:if(g.AsgAddCallback)return g.AsgAddCallback(j,b);break;case a.NodeType.AsgSub:if(g.AsgSubCallback)return g.AsgSubCallback(j,b);break;case a.NodeType.AsgDiv:if(g.AsgDivCallback)return g.AsgDivCallback(j,b);break;case a.NodeType.AsgMul:if(g.AsgMulCallback)return g.AsgMulCallback(j,
b);break;case a.NodeType.AsgMul:if(g.AsgMulCallback)return g.AsgMulCallback(j,b);break;case a.NodeType.AsgAnd:if(g.AsgAndCallback)return g.AsgAndCallback(j,b);break;case a.NodeType.AsgXor:if(g.AsgXorCallback)return g.AsgXorCallback(j,b);break;case a.NodeType.AsgOr:if(g.AsgOrCallback)return g.AsgOrCallback(j,b);break;case a.NodeType.AsgLsh:if(g.AsgLshCallback)return g.AsgLshCallback(j,b);break;case a.NodeType.AsgRsh:if(g.AsgRshCallback)return g.AsgRshCallback(j,b);break;case a.NodeType.AsgRs2:if(g.AsgRs2Callback)return g.AsgRs2Callback(j,
b);break;case a.NodeType.QMark:if(g.QMarkCallback)return g.QMarkCallback(j,b);break;case a.NodeType.LogOr:if(g.LogOrCallback)return g.LogOrCallback(j,b);break;case a.NodeType.LogAnd:if(g.LogAndCallback)return g.LogAndCallback(j,b);break;case a.NodeType.Or:if(g.OrCallback)return g.OrCallback(j,b);break;case a.NodeType.Xor:if(g.XorCallback)return g.XorCallback(j,b);break;case a.NodeType.And:if(g.AndCallback)return g.AndCallback(j,b);break;case a.NodeType.Eq:if(g.EqCallback)return g.EqCallback(j,b);
break;case a.NodeType.Ne:if(g.NeCallback)return g.NeCallback(j,b);break;case a.NodeType.Eqv:if(g.EqvCallback)return g.EqvCallback(j,b);break;case a.NodeType.NEqv:if(g.NEqvCallback)return g.NEqvCallback(j,b);break;case a.NodeType.Lt:if(g.LtCallback)return g.LtCallback(j,b);break;case a.NodeType.Le:if(g.LeCallback)return g.LeCallback(j,b);break;case a.NodeType.Gt:if(g.GtCallback)return g.GtCallback(j,b);break;case a.NodeType.Ge:if(g.GeCallback)return g.GeCallback(j,b);break;case a.NodeType.Add:if(g.AddCallback)return g.AddCallback(j,
b);break;case a.NodeType.Sub:if(g.SubCallback)return g.SubCallback(j,b);break;case a.NodeType.Mul:if(g.MulCallback)return g.MulCallback(j,b);break;case a.NodeType.Div:if(g.DivCallback)return g.DivCallback(j,b);break;case a.NodeType.Mod:if(g.ModCallback)return g.ModCallback(j,b);break;case a.NodeType.Lsh:if(g.LshCallback)return g.LshCallback(j,b);break;case a.NodeType.Rsh:if(g.RshCallback)return g.RshCallback(j,b);break;case a.NodeType.Rs2:if(g.Rs2Callback)return g.Rs2Callback(j,b);break;case a.NodeType.Not:if(g.NotCallback)return g.NotCallback(j,
b);break;case a.NodeType.LogNot:if(g.LogNotCallback)return g.LogNotCallback(j,b);break;case a.NodeType.IncPre:if(g.IncPreCallback)return g.IncPreCallback(j,b);break;case a.NodeType.DecPre:if(g.DecPreCallback)return g.DecPreCallback(j,b);break;case a.NodeType.IncPost:if(g.IncPostCallback)return g.IncPostCallback(j,b);break;case a.NodeType.DecPost:if(g.DecPostCallback)return g.DecPostCallback(j,b);break;case a.NodeType.TypeAssertion:if(g.TypeAssertionCallback)return g.TypeAssertionCallback(j,b);break;
case a.NodeType.FuncDecl:if(g.FuncDeclCallback)return g.FuncDeclCallback(j,b);break;case a.NodeType.Member:if(g.MemberCallback)return g.MemberCallback(j,b);break;case a.NodeType.VarDecl:if(g.VarDeclCallback)return g.VarDeclCallback(j,b);break;case a.NodeType.ArgDecl:if(g.ArgDeclCallback)return g.ArgDeclCallback(j,b);break;case a.NodeType.Return:if(g.ReturnCallback)return g.ReturnCallback(j,b);break;case a.NodeType.Break:if(g.BreakCallback)return g.BreakCallback(j,b);break;case a.NodeType.Continue:if(g.ContinueCallback)return g.ContinueCallback(j,
b);break;case a.NodeType.Throw:if(g.ThrowCallback)return g.ThrowCallback(j,b);break;case a.NodeType.For:if(g.ForCallback)return g.ForCallback(j,b);break;case a.NodeType.ForIn:if(g.ForInCallback)return g.ForInCallback(j,b);break;case a.NodeType.If:if(g.IfCallback)return g.IfCallback(j,b);break;case a.NodeType.While:if(g.WhileCallback)return g.WhileCallback(j,b);break;case a.NodeType.DoWhile:if(g.DoWhileCallback)return g.DoWhileCallback(j,b);break;case a.NodeType.Block:if(g.BlockCallback)return g.BlockCallback(j,
b);break;case a.NodeType.Case:if(g.CaseCallback)return g.CaseCallback(j,b);break;case a.NodeType.Switch:if(g.SwitchCallback)return g.SwitchCallback(j,b);break;case a.NodeType.Try:if(g.TryCallback)return g.TryCallback(j,b);break;case a.NodeType.TryCatch:if(g.TryCatchCallback)return g.TryCatchCallback(j,b);break;case a.NodeType.TryFinally:if(g.TryFinallyCallback)return g.TryFinallyCallback(j,b);break;case a.NodeType.Finally:if(g.FinallyCallback)return g.FinallyCallback(j,b);break;case a.NodeType.Catch:if(g.CatchCallback)return g.CatchCallback(j,
b);break;case a.NodeType.List:if(g.ListCallback)return g.ListCallback(j,b);break;case a.NodeType.Script:if(g.ScriptCallback)return g.ScriptCallback(j,b);break;case a.NodeType.Class:if(g.ClassCallback)return g.ClassCallback(j,b);break;case a.NodeType.Interface:if(g.InterfaceCallback)return g.InterfaceCallback(j,b);break;case a.NodeType.Module:if(g.ModuleCallback)return g.ModuleCallback(j,b);break;case a.NodeType.Import:if(g.ImportCallback)return g.ImportCallback(j,b);break;case a.NodeType.With:if(g.WithCallback)return g.WithCallback(j,
b);break;case a.NodeType.Label:if(g.LabelCallback)return g.LabelCallback(j,b);break;case a.NodeType.LabeledStatement:if(g.LabeledStatementCallback)return g.LabeledStatementCallback(j,b);break;case a.NodeType.EBStart:if(g.EBStartCallback)return g.EBStartCallback(j,b);break;case a.NodeType.GotoEB:if(g.GotoEBCallback)return g.GotoEBCallback(j,b);break;case a.NodeType.EndCode:if(g.EndCodeCallback)return g.EndCodeCallback(j,b);break;case a.NodeType.Error:if(g.ErrorCallback)return g.ErrorCallback(j,b);
break;case a.NodeType.Comment:if(g.CommentCallback)return g.CommentCallback(j,b);break;case a.NodeType.Debugger:if(g.DebuggerCallback)return g.DebuggerCallback(j,b);break;default:throw Error("please implement new NodeType Walker correctly");}return g.DefaultCallback?g.DefaultCallback(j,b):!0};(a.AstWalkerWithDetailCallback||(a.AstWalkerWithDetailCallback={})).walk=function(j,b){var g=a.getAstWalkerFactory().getWalker(function(a){g.options.goChildren=d(!0,a,b);return a},function(a){d(!1,a,b);return a});
g.walk(j,null)}})(TypeScript||(TypeScript={}));
(function(a){function d(a){return null===a||0===a.length?null:a[a.length-1]}function j(a,i){return a>=i?a:i}function b(a){return null===a||-1===a.minChar||-1===a.limChar?!1:!0}a.lastOf=d;a.max=j;a.min=function(a,i){return a<=i?a:i};var g=function(){this.asts=[];this.top=-1};g.reverseIndexOf=function(a,i){return null===a||a.length<=i?null:a[a.length-i-1]};g.prototype.clone=function(){var a=new g;a.asts=this.asts.map(function(a){return a});a.top=this.top;return a};g.prototype.pop=function(){var a=this.ast();
for(this.up();this.asts.length>this.count();)this.asts.pop();return a};g.prototype.push=function(a){for(;this.asts.length>this.count();)this.asts.pop();this.top=this.asts.length;this.asts.push(a)};g.prototype.up=function(){if(-1>=this.top)throw Error("Invalid call to 'up'");this.top--};g.prototype.down=function(){if(this.top==this.ast.length-1)throw Error("Invalid call to 'down'");this.top++};g.prototype.nodeType=function(){return null==this.ast()?a.NodeType.None:this.ast().nodeType};g.prototype.ast=
function(){return g.reverseIndexOf(this.asts,this.asts.length-(this.top+1))};g.prototype.parent=function(){return g.reverseIndexOf(this.asts,this.asts.length-this.top)};g.prototype.count=function(){return this.top+1};g.prototype.get=function(a){return this.asts[a]};g.prototype.isNameOfClass=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Class&&this.parent().name===this.ast()};g.prototype.isNameOfInterface=function(){return null===
this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Interface&&this.parent().name===this.ast()};g.prototype.isNameOfArgument=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.ArgDecl&&this.parent().id===this.ast()};g.prototype.isNameOfVariable=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===
a.NodeType.VarDecl&&this.parent().id===this.ast()};g.prototype.isNameOfModule=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Module&&this.parent().name===this.ast()};g.prototype.isNameOfFunction=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.FuncDecl&&this.parent().name===this.ast()};g.prototype.isChildOfScript=function(){var c=
d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Script};g.prototype.isChildOfModule=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Module};g.prototype.isChildOfClass=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Class};g.prototype.isArgumentOfClassConstructor=function(){var c=d(this.asts);return 5<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-3].nodeType===a.NodeType.List&&this.asts[this.top-4].nodeType===a.NodeType.Class&&this.asts[this.top-2].isConstructor&&this.asts[this.top-2].args===this.asts[this.top-1]&&this.asts[this.top-
4].constructorDecl===this.asts[this.top-2]};g.prototype.isChildOfInterface=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Interface};g.prototype.isTopLevelImplicitModule=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.Module&&a.hasFlag(this.asts[this.top].modFlags,a.ModuleFlags.IsWholeFile)};g.prototype.isBodyOfTopLevelImplicitModule=function(){return 2<=
this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]&&a.hasFlag(this.asts[this.top-1].modFlags,a.ModuleFlags.IsWholeFile)};g.prototype.isBodyOfScript=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Script&&this.asts[this.top-1].bod==this.asts[this.top-0]};g.prototype.isBodyOfSwitch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Switch&&
this.asts[this.top-1].caseList==this.asts[this.top-0]};g.prototype.isBodyOfModule=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]};g.prototype.isBodyOfClass=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Class&&this.asts[this.top-1].members==this.asts[this.top-0]};g.prototype.isBodyOfFunction=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&
this.asts[this.top-1].bod==this.asts[this.top-0]};g.prototype.isBodyOfInterface=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Interface&&this.asts[this.top-1].members==this.asts[this.top-0]};g.prototype.isBodyOfBlock=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Block&&this.asts[this.top-1].stmts==this.asts[this.top-0]};g.prototype.isBodyOfFor=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.For&&this.asts[this.top-
1].body==this.asts[this.top-0]};g.prototype.isBodyOfCase=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Case&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfTry=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Try&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfCatch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Catch&&this.asts[this.top-1].body==this.asts[this.top-
0]};g.prototype.isBodyOfDoWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.DoWhile&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.While&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfForIn=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ForIn&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfWith=
function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.With&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isBodyOfFinally=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Finally&&this.asts[this.top-1].body==this.asts[this.top-0]};g.prototype.isCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-
1]};g.prototype.isDefaultCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-1]&&this.asts[this.top-2].defaultCase==this.asts[this.top-0]};g.prototype.isListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-
0]};g.prototype.isBodyOfObjectLit=function(){return this.isListOfObjectLit()};g.prototype.isEmptyListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]&&0==this.asts[this.top-0].members.length};g.prototype.isMemberOfObjectLit=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-0].nodeType===a.NodeType.Member&&this.asts[this.top-2].operand==this.asts[this.top-1]};g.prototype.isNameOfMemberOfObjectLit=function(){return 4<=this.count()&&this.asts[this.top-3].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-2].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-0].nodeType===a.NodeType.Name&&this.asts[this.top-3].operand==this.asts[this.top-2]};g.prototype.isListOfArrayLit=function(){return 2<=
this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ArrayLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]};g.prototype.isTargetOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand1===this.asts[this.top-0]};g.prototype.isMemberOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand2===this.asts[this.top-
0]};g.prototype.isItemOfList=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List};g.prototype.isThenOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].thenBod==this.asts[this.top-0]};g.prototype.isElseOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].elseBod==this.asts[this.top-0]};g.prototype.isBodyOfDefaultCase=function(){return this.isBodyOfCase()};
g.prototype.isSingleStatementList=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.List&&1===this.asts[this.top].members.length};g.prototype.isArgumentListOfFunction=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-1].args===this.asts[this.top-0]};g.prototype.isArgumentOfFunction=function(){return 3<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List&&
this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-2].args===this.asts[this.top-1]};g.prototype.isArgumentListOfCall=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Call&&this.asts[this.top-1].args===this.asts[this.top-0]};g.prototype.isArgumentListOfNew=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.New&&this.asts[this.top-
1].args===this.asts[this.top-0]};g.prototype.isSynthesizedBlock=function(){return 1<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.Block&&!1===this.asts[this.top-0].visible};a.AstPath=g;a.isValidAstNode=b;var k;k=function(){this.path=new a.AstPath};a.AstPathContext=k;var i=a.GetAstPathOptions||(a.GetAstPathOptions={});i._map=[];i.Default=0;i.EdgeInclusive=1;i.DontPruneSearchBasedOnPosition=2;var h=a.GetAstPathOptions;a.getAstPathToPosition=function(c,i,e){"undefined"===typeof e&&(e=h.Default);
var l=function(a){if(a&&0<a.length)for(var c=0;c<a.length;c++){var e=a[c].minChar,b=a[c].limChar;a[c].isBlockComment||b++;i>=e&&i<b&&n.path.push(a[c])}},n=new k;a.getAstWalkerFactory().walk(c,function(k,j,g){if(b(k)){var d=a.hasFlag(e,h.EdgeInclusive)||k.nodeType===a.NodeType.Name||i===c.limChar,j=k.minChar,d=k.limChar+(d?1:0);if(i>=j&&i<d){var p=n.path.ast();(null==p||k.minChar>=p.minChar&&k.limChar<=p.limChar)&&n.path.push(k)}i<d&&l(k.preComments);i>=j&&l(k.postComments);a.hasFlag(e,h.DontPruneSearchBasedOnPosition)||
(g.options.goChildren=j<=i&&i<=d)}return k},null,null,n);return n.path};a.getTokenizationOffset=function(c,i){var e=0;a.getAstWalkerFactory().walk(c,function(c,b,h){if(a.isValidAstNode(c)&&(c.minChar<=i&&(e=j(e,c.minChar)),c.minChar>i||c.limChar<e))h.options.goChildren=!1;return c});return e};a.walkAST=function(c,i){var e=new g;a.getAstWalkerFactory().walk(c,function(a,c,e){c=e.state;c.push(a);i(c,e);return a},function(a,c,i){i.state.pop();return a},null,e)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.logger=a};d.prototype.logScript=function(j){var b=this;this.logLinemap(j.locationInfo.lineMap);var g=[];a.getAstWalkerFactory().walk(j,function(a){g.push(a);var i=2*(g.length-1);b.logComments(j,a.preComments,i);b.logNode(j,a,i);b.logComments(j,a.postComments,i);return a},function(a){g.pop();return a})};d.prototype.logNode=function(a,b,g){g=this.addPadding("",g,"| ",!0);g=g.concat("+ "+b.treeViewLabel());g=this.addPadding(g,70," ",!1);g+=this.addLineColumn(a,b.minChar);
g=this.addPadding(g,80," ",!1);g=g+"=> "+this.addLineColumn(a,b.limChar);g=this.addPadding(g,102," ",!1);g=g.concat("["+this.addPadding(b.minChar.toString(),1," ",!0)+", "+this.addPadding(b.limChar.toString(),1," ",!0)+"]");g=this.addPadding(g,115," ",!1);g=g.concat("sym="+b.sym);g=this.addPadding(g,135," ",!1);g=g.concat("type="+(null===b.type?"null":b.type.getTypeName()));this.logger.log(g)};d.prototype.logComments=function(a,b,g){if(null!=b)for(var k=0;k<b.length;k++)this.logNode(a,b[k],g)};d.prototype.logLinemap=
function(a){for(var b="[",g=0;g<a.length;g++)0<g&&(b+=","),b+=a[g];this.logger.log("linemap: "+(b+"]"))};d.prototype.addPadding=function(a,b,g,k){for(var i=k?"":a,h=a.length;h<b;h++)i+=g;return i+(k?a:"")};d.prototype.addLineColumn=function(j,b){var g={line:-1,col:-1};a.getSourceLineColFromMap(g,b,j.locationInfo.lineMap);-1!==g.col&&g.col++;return"("+g.line+", "+g.col+")"};a.AstLogger=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.checker=a};d.prototype.resolveBaseTypeLinks=function(a,b){var g=null;if(a)for(var g=[],k=0,i=a.length;k<i;k++){var h=a[k];this.checker.resolvingBases=!0;this.checker.resolveTypeLink(b,h,!0);this.checker.resolvingBases=!1;g[k]=h.type.isClass()?h.type.instanceType:h.type}return g};d.prototype.resolveBases=function(a,b){b.extendsList=this.resolveBaseTypeLinks(b.extendsTypeLinks,a);for(var g=0,k=b.extendsList.length,i=b.isClassInstance();g<k;g++){var h=b.extendsList[g].isClassInstance();
b.extendsList[g]!=this.checker.anyType&&(i?h||this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A export class may only extend other classes, "+b.extendsList[g].symbol.fullName()+" is an interface."):h&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"An interface may only extend other interfaces, "+b.extendsList[g].symbol.fullName()+" is a class."))}b.implementsList=this.resolveBaseTypeLinks(b.implementsTypeLinks,a);if(b.implementsList){g=0;for(k=b.implementsList.length;g<k;g++)h=b.implementsList[g],
h.isClassInstance()&&i&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A class may only implement an interface; "+h.symbol.fullName()+" is a class.")}};d.prototype.resolveSignatureGroup=function(a,b,g){for(var k=!a.hasImplementation,i=0,h=a.signatures.length;i<h;i++){var c=a.signatures[i];g?c.returnType.type=g:this.checker.resolveTypeLink(b,c.returnType,k);for(var f=c.parameters.length,e=0;e<f;e++)this.bindSymbol(b,c.parameters[e]);c.hasVariableArgList&&(c=c.parameters[f-1],c.argsOffset=
f-1,c.getType().isArray()||(this.checker.errorReporter.simpleErrorFromSym(c,"... parameter must have array type"),c.parameter.typeLink.type=this.checker.makeArrayType(c.parameter.typeLink.type)))}};d.prototype.bindType=function(j,b,g){g&&this.bindType(j,g,null);if(b.hasMembers()){var k=b.members,i=b.ambientMembers,h=b.getAllEnclosedTypes(),c=b.getAllAmbientEnclosedTypes(),f=new a.SymbolTableScope(k,i,h,c,b.symbol),e=new a.SymbolAggregateScope(b.symbol),l=this.checker.currentModDecl,n=this.checker.inBind;
e.addParentScope(f);e.addParentScope(j);b.isModuleType()&&(this.checker.currentModDecl=b.symbol.declAST,this.checker.inBind=!0);k&&this.bind(e,b.members.allMembers);h&&this.bind(e,h.allMembers);i&&this.bind(e,i.allMembers);c&&this.bind(e,c.allMembers);this.checker.currentModDecl=l;this.checker.inBind=n}b.extendsTypeLinks&&this.resolveBases(j,b);b.construct&&this.resolveSignatureGroup(b.construct,j,g);b.call&&this.resolveSignatureGroup(b.call,j,null);b.index&&this.resolveSignatureGroup(b.index,j,null);
b.elementType&&this.bindType(j,b.elementType,null)};d.prototype.bindSymbol=function(j,b){if(!b.bound){var g=this.checker.locationInfo;this.checker.units&&(0<=b.unitIndex&&b.unitIndex<this.checker.units.length)&&(this.checker.locationInfo=this.checker.units[b.unitIndex]);switch(b.kind()){case a.SymbolKind.Type:if(b.flags&a.SymbolFlags.Bound)break;b.flags|=a.SymbolFlags.Bound;if(b.aliasLink&&!b.type&&b.aliasLink.alias.nodeType==a.NodeType.Name){var k=this.checker.findSymbolForDynamicModule(b.aliasLink.alias.text,
this.checker.locationInfo.filename,function(a){return j.find(a,!1,!0)});k&&(b.type=k.getType())}if(b.type&&b.type!=this.checker.gloModType&&(this.bindType(j,b.type,b.instanceType),b.type.isModuleType()))for(k=0;k<b.expansions.length;k++)this.bindType(j,b.expansions[k],b.instanceType);break;case a.SymbolKind.Field:this.checker.resolveTypeLink(j,b.field.typeLink,!1);break;case a.SymbolKind.Parameter:this.checker.resolveTypeLink(j,b.parameter.typeLink,!0)}this.checker.locationInfo=g}b.bound=!0};d.prototype.bind=
function(a,b){b.map(function(b,k,i){i.bindSymbol(a,k)},this)};a.Binder=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(){};d.encodedValues="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";d.encode=function(a){if(64>a)return d.encodedValues.charAt(a);throw TypeError(a+": not a 64 based value");};d.decodeChar=function(a){if(1===a.length)return d.encodedValues.indexOf(a);throw TypeError('"'+a+'" must have length 1');};var j=function(){};j.encode=function(a){var a=0>a?(-a<<1)+1:a<<1,j="";do{var k=a&31,a=a>>5;0<a&&(k|=32);j+=d.encode(k)}while(0<a);return j};j.decode=function(a){for(var j=
0,k=!1,i=0,h=0;h<a.length;h++){var c=d.decodeChar(a[h]);0===h?(1===(c&1)&&(k=!0),j=c>>1&15):j|=(c&31)<<i;i+=0==h?4:5;if(32!==(c&32))return{value:k?-j:j,rest:a.substr(h+1)}}throw Error('Base64 value "'+a+'" finished with a continuation bit');};a.Base64VLQFormat=j})(TypeScript||(TypeScript={}));
(function(a){a.SourceMapping=function(){this.firstChild=this.parent=-1};var d=function(j,b,g,k){this.jsFile=g;this.sourceMapOut=k;this.sourceMappings=[];this.currentMapping=-1;this.jsFileName=a.getPrettyName(b,!1,!0);this.tsFileName=a.getPrettyName(j,!1,!0)};d.MapFileExtension=".map";d.CanEmitMapping=function(a,b){if(-1!==b.firstChild){var g=a[b.firstChild];if(g.emittedStartLine===b.emittedStartLine&&g.emittedStartColumn===b.emittedStartColumn)return!1}return!0};d.EmitSourceMapping=function(j){var b=
j[0];b.jsFile.WriteLine("//@ sourceMappingURL="+b.jsFileName+d.MapFileExtension);for(var g=b.sourceMapOut,k="",i=[],h=0,c=0,f=0,e=0,l=0,n=!1,m=0;m<j.length;m++)if(b=j[m],b.sourceMappings){var y=i.length;i.push(b.tsFileName);for(var u=b.sourceMappings,s=0,p=u.length;s<p;s++){var q=u[s];if(d.CanEmitMapping(u,q)){if(c!==q.emittedStartLine)for(;c<q.emittedStartLine;)h=0,k+=";",c++;else n&&(k+=",");k+=a.Base64VLQFormat.encode(q.emittedStartColumn-h);h=q.emittedStartColumn;k+=a.Base64VLQFormat.encode(y-
l);l=y;k+=a.Base64VLQFormat.encode(q.sourceStartLine-1-e);e=q.sourceStartLine-1;k+=a.Base64VLQFormat.encode(q.sourceStartColumn-f);f=q.sourceStartColumn;n=!0}}}""!=k&&(g.Write("{"),g.Write('"version":3,'),g.Write('"file":"'+b.jsFileName+'",'),g.Write('"sources":["'+i.join('","')+'"],'),g.Write('"names":[],'),g.Write('"mappings":"'+k),g.Write('"'),g.Write("}"));g.Close()};a.SourceMapper=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.EmitContainer||(a.EmitContainer={});d._map=[];d._map[0]="Prog";d.Prog=0;d._map[1]="Module";d.Module=1;d._map[2]="DynamicModule";d.DynamicModule=2;d._map[3]="Class";d.Class=3;d._map[4]="Constructor";d.Constructor=4;d._map[5]="Function";d.Function=5;d._map[6]="Args";d.Args=6;d._map[7]="Interface";d.Interface=7;var j=a.EmitContainer,b;b=function(){this.line=this.column=0;this.inObjectLiteral=this.pretty=!1;this.container=j.Prog};a.EmitState=b;var g=function(){this.indentAmt=0};g.indentStep=
4;g.indentStepString="    ";g.indentStrings=[];g.prototype.increaseIndent=function(){this.indentAmt+=g.indentStep};g.prototype.decreaseIndent=function(){this.indentAmt-=g.indentStep};g.prototype.getIndent=function(){var a=g.indentStrings[this.indentAmt];if(void 0===a){for(var a="",i=0;i<this.indentAmt;i+=g.indentStep)a+=g.indentStepString;g.indentStrings[this.indentAmt]=a}return a};a.Indenter=g;d=function(a,i,h){this.checker=a;this.outfile=i;this.emitOptions=h;this.prologueEmitted=!1;this.thisFnc=
this.thisClassNode=null;this.moduleDeclList=[];this.moduleName="";this.emitState=new b;this.indenter=new g;this.ambientModule=!1;this.firstModAlias=this.modAliasId=null;this.allSourceMappers=[];this.sourceMapper=null;this.captureThisStmtString="var _this = this;"};d.prototype.setSourceMappings=function(a){this.allSourceMappers.push(a);this.sourceMapper=a};d.prototype.writeToOutput=function(a){this.outfile.Write(a);this.emitState.column+=a.length};d.prototype.writeToOutputTrimmable=function(a){this.emitOptions.minWhitespace&&
(a=a.replace(/[\s]*/g,""));this.writeToOutput(a)};d.prototype.writeLineToOutput=function(b){this.emitOptions.minWhitespace?(this.writeToOutput(b),b=b.charCodeAt(b.length-1),b==a.LexCodeSpace||(b==a.LexCodeSMC||b==a.LexCodeLBR)||this.writeToOutput(" ")):(this.outfile.WriteLine(b),this.emitState.column=0,this.emitState.line++)};d.prototype.setInObjectLiteral=function(a){var i=this.emitState.inObjectLiteral;this.emitState.inObjectLiteral=a;return i};d.prototype.setContainer=function(a){var i=this.emitState.container;
this.emitState.container=a;return i};d.prototype.getIndentString=function(){return this.emitOptions.minWhitespace?"":this.indenter.getIndent()};d.prototype.emitIndent=function(){this.writeToOutput(this.getIndentString())};d.prototype.emitCommentInPlace=function(a){this.recordSourceMappingStart(a);var i=a.getText(),b=!1;if(a.isBlockComment){if(0==this.emitState.column&&this.emitIndent(),this.writeToOutput(i[0]),1<i.length||a.endsLine){this.writeLineToOutput("");for(b=1;b<i.length;b++)this.emitIndent(),
this.writeLineToOutput(i[b]);b=!0}}else 0==this.emitState.column&&this.emitIndent(),this.writeLineToOutput(i[0]),b=!0;b?this.emitIndent():this.writeToOutput(" ");this.recordSourceMappingEnd(a)};d.prototype.emitParensAndCommentsInPlace=function(a,i){var b=i?a.preComments:a.postComments;a.isParenthesized&&!i&&this.writeToOutput(")");if(this.emitOptions.emitComments&&b&&0!=b.length)for(var c=0;c<b.length;c++)this.emitCommentInPlace(b[c]);a.isParenthesized&&i&&this.writeToOutput("(")};d.prototype.emitObjectLiteral=
function(b){this.writeLineToOutput("{");this.indenter.increaseIndent();var i=this.setInObjectLiteral(!0);this.emitJavascriptList(b,",",a.TokenID.Comma,!0,!1,!1);this.setInObjectLiteral(i);this.indenter.decreaseIndent();this.emitIndent();this.writeToOutput("}")};d.prototype.emitArrayLiteral=function(b){this.writeToOutput("[");b&&(this.writeLineToOutput(""),this.indenter.increaseIndent(),this.emitJavascriptList(b,", ",a.TokenID.Comma,!0,!1,!1),this.indenter.decreaseIndent(),this.emitIndent());this.writeToOutput("]")};
d.prototype.emitNew=function(b,i){this.recordSourceMappingStart(b);this.writeToOutput("new ");b.nodeType==a.NodeType.TypeRef?this.writeToOutput("Array()"):(this.emitJavascript(b,a.TokenID.Tilde,!1),this.writeToOutput("("),this.emitJavascriptList(i,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")"));this.recordSourceMappingEnd(b)};d.prototype.tryEmitConstant=function(b){if(!this.emitOptions.propagateConstants)return!1;if((b=b.operand2)&&b.sym&&b.sym.isVariable()&&a.hasFlag(b.sym.flags,a.SymbolFlags.Constant)&&
b.sym.declAST){var i=b.sym.declAST;if(i.init&&i.init.nodeType==a.NodeType.NumberLit)return this.writeToOutput(i.init.value.toString()),b=" /* "+b.text,this.writeToOutput(b+" */ "),!0}return!1};d.prototype.emitCall=function(b,i,h){this.emitSuperCall(b)||(a.hasFlag(b.flags,a.ASTFlags.ClassBaseConstructorCall)?(this.indenter.decreaseIndent(),this.indenter.decreaseIndent(),i=new a.ASTList,i.members[0]=b,this.emitConstructorCalls(i,this.thisClassNode),this.indenter.increaseIndent(),this.indenter.increaseIndent()):
(i.nodeType==a.NodeType.FuncDecl&&!i.isParenthesized&&this.writeToOutput("("),this.emitJavascript(i,a.TokenID.LParen,!1),i.nodeType==a.NodeType.FuncDecl&&!i.isParenthesized&&this.writeToOutput(")"),this.writeToOutput("("),this.emitJavascriptList(h,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")")))};d.prototype.defaultValue=function(a){return a==this.checker.anyType?"undefined":a==this.checker.numberType?"0":a==this.checker.stringType?'""':a==this.checker.booleanType?"false":"null"};d.prototype.emitConstructorCalls=
function(b,i){if(null!=b){var h=b.members.length;this.recordSourceMappingStart(i);for(var c=0;c<h;c++){var f=b.members[c],e=null,e=f.nodeType==a.NodeType.Call?f.target.type.symbol:f.type.symbol;e.declModule!=i.type.symbol.declModule&&e.fullName();if(f.nodeType==a.NodeType.Call){this.emitIndent();this.writeToOutput("_super.call(this");if((f=f.args)&&0<f.members.length)this.writeToOutput(", "),this.emitJavascriptList(f,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput(")")}else f.type&&f.type.isClassInstance()&&
(this.emitIndent(),this.writeToOutput(i.name.text+"._super.constructor"),this.writeToOutput(".call(this)"))}this.recordSourceMappingEnd(i)}};d.prototype.emitInnerFunction=function(b,i,h,c,f,e){var l=b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&(a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseType)&&!a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseTypeOfObject))&&a.hasFlag(this.thisClassNode.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor);
this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);(!b.isAccessor()||!b.accessorSymbol.isObjectLitField)&&this.writeToOutput("function ");i&&(i=b.getNameText())&&!b.isAccessor()&&this.writeToOutput(i);this.writeToOutput("(");var n=0,i=0,m,g=[];if(b.args){var d=this.setContainer(j.Args),n=b.args.members.length;b.variableArgList&&n--;for(i=0;i<n;i++)m=b.args.members[i],m.init&&g.push(m),this.emitJavascript(m,a.TokenID.LParen,!1),i<n-1&&this.writeToOutput(", ");this.setContainer(d)}this.writeLineToOutput(") {");
this.indenter.increaseIndent();for(i=0;i<g.length;i++)m=g[i],this.emitIndent(),this.recordSourceMappingStart(m),this.writeToOutput("if (typeof "+m.id.text+' === "undefined") { '),this.recordSourceMappingStart(m.id),this.writeToOutput(m.id.text),this.recordSourceMappingEnd(m.id),this.writeToOutput(" = "),this.emitJavascript(m.init,a.TokenID.LParen,!1),this.writeLineToOutput("; }"),this.recordSourceMappingEnd(m);b.isConstructor&&b.classDecl.varFlags&a.VarFlags.MustCaptureThis&&(this.emitIndent(),this.writeLineToOutput(this.captureThisStmtString));
if(b.isConstructor&&!l){if(b.args){n=b.args.members.length;for(i=0;i<n;i++)m=b.args.members[i],(m.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(m),this.recordSourceMappingStart(m.id),this.writeToOutput("this."+m.id.text),this.recordSourceMappingEnd(m.id),this.writeToOutput(" = "),this.recordSourceMappingStart(m.id),this.writeToOutput(m.id.text),this.recordSourceMappingEnd(m.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(m))}a.hasFlag(b.fncFlags,
a.FncFlags.ClassMethod)||this.emitConstructorCalls(c,e)}f&&(this.emitIndent(),this.writeLineToOutput(this.captureThisStmtString));b.variableArgList&&(n=b.args.members.length,i=b.args.members[n-1],this.emitIndent(),this.recordSourceMappingStart(i),this.writeToOutput("var "),this.recordSourceMappingStart(i.id),this.writeToOutput(i.id.text),this.recordSourceMappingEnd(i.id),this.writeLineToOutput(" = [];"),this.recordSourceMappingEnd(i),this.emitIndent(),this.writeLineToOutput("for (var _i = 0; _i < (arguments.length - "+
(n-1)+"); _i++) {"),this.indenter.increaseIndent(),this.emitIndent(),this.writeLineToOutput(i.id.text+"[_i] = arguments[_i + "+(n-1)+"];"),this.indenter.decreaseIndent(),this.emitIndent(),this.writeLineToOutput("}"));if(b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&!l){c=this.thisClassNode.members.members.length;for(i=0;i<c;i++)this.thisClassNode.members.members[i].nodeType==a.NodeType.VarDecl&&(f=this.thisClassNode.members.members[i],!a.hasFlag(f.varFlags,a.VarFlags.Static)&&f.init&&
(this.emitIndent(),this.emitJavascriptVarDecl(f,a.TokenID.Tilde),this.writeLineToOutput("")))}this.emitBareJavascriptStatements(b.bod,l);this.indenter.decreaseIndent();this.emitIndent();this.writeToOutput("}");!h&&(!a.hasFlag(b.fncFlags,a.FncFlags.IsFunctionExpression)&&(a.hasFlag(b.fncFlags,a.FncFlags.Definition)||b.isConstructor))&&this.writeLineToOutput("");if(b.hasStaticDeclarations()){this.writeLineToOutput("");this.emitIndent();l=b.getNameText();this.writeLineToOutput("(function ("+l+") {");
this.indenter.increaseIndent();c=0;c=b.innerStaticFuncs.length;for(i=0;i<c;i++)f=b.innerStaticFuncs[i],f.isOverload||(this.emitIndent(),f.isAccessor()?this.emitPropertyAccessor(f,b.name.text,!1):(this.writeToOutput(l+"."+f.name.text+" = "),this.emitInnerFunction(f,f.name&&!f.name.isMissing(),!1,null,f.hasSelfReference(),null)));if(b.statics){this.recordSourceMappingStart(b.statics);c=b.statics.members.length;for(i=0;i<c;i++)this.emitIndent(),this.writeToOutput(l),this.emitJavascript(b.statics.members[i],
a.TokenID.Tilde,!1),this.writeLineToOutput("");this.recordSourceMappingEnd(b.statics)}this.indenter.decreaseIndent();this.emitIndent();this.writeLineToOutput("})("+(h&&this.thisClassNode?this.thisClassNode.name.text+".prototype.":"")+l+");")}this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1)};d.prototype.emitJavascriptModule=function(b){var i=b.name.text;a.isTSFile(i)?b.name.text=i.substring(0,i.length-3):a.isSTRFile(i)&&(b.name.text=i.substring(0,i.length-4));if(!a.hasFlag(b.modFlags,
a.ModuleFlags.Ambient)){var h=a.hasFlag(b.modFlags,a.ModuleFlags.IsDynamic),c=this.outfile,i=this.setContainer(j.Module),f=this.moduleName,e=a.hasFlag(b.modFlags,a.ModuleFlags.Exported);this.moduleDeclList[this.moduleDeclList.length]=b;this.moduleName=b.name.text;this.recordSourceMappingStart(b);if(h){var l=a.stripQuotes(a.trimModName(b.name.text))+".js";this.emitOptions.createFile&&(l!=this.emitOptions.path?this.outfile=this.emitOptions.createFile(l):this.emitOptions.outputMany||this.checker.errorReporter.emitterError(b,
"Module emit collides with emitted script: "+l));this.setContainer(j.DynamicModule);if(a.moduleGenTarget==a.ModuleGenTarget.Asynchronous){for(var l='["require", "exports"',n="require, exports",m=null,g=0;g<b.mod.importedModules.length;g++)m=b.mod.importedModules[g],m.id.sym&&!m.id.sym.onlyReferencedAsTypeRef&&(g<=b.mod.importedModules.length-1&&(l+=", ",n+=", "),n+="__"+m.id.text+"__",l+=m.firstAliasedModToString());for(g=0;g<b.amdDependencies.length;g++)l+=', "'+b.amdDependencies[g]+'"';this.writeLineToOutput("define("+
(l+"]")+", function("+n+") {")}}else e||(this.writeLineToOutput("var "+this.moduleName+";"),this.emitIndent()),this.writeLineToOutput("(function ("+this.moduleName+") {");(!h||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)&&this.indenter.increaseIndent();b.modFlags&a.ModuleFlags.MustCaptureThis&&(this.emitIndent(),this.writeLineToOutput(this.captureThisStmtString));this.emitJavascriptList(b.members,null,a.TokenID.SColon,!0,!1,!1);(!h||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)&&this.indenter.decreaseIndent();
this.emitIndent();h?(a.moduleGenTarget==a.ModuleGenTarget.Asynchronous&&this.writeLineToOutput("})"),this.outfile!=c&&(this.outfile.Close(),this.outfile=c)):(h=null,b.type&&(b.type.symbol.container&&b.type.symbol.container.declAST)&&(h=b.type.symbol.container.declAST),h=h&&a.hasFlag(h.modFlags,a.ModuleFlags.IsDynamic),i==j.Prog&&e?this.writeLineToOutput("})(this."+this.moduleName+" || (this."+this.moduleName+" = {}));"):e||i==j.Prog?(c=""!=f?(h?"exports":f)+".":f,this.writeLineToOutput("})("+c+this.moduleName+
" || ("+c+this.moduleName+" = {}));")):!e&&i!=j.Prog?this.writeLineToOutput("})("+this.moduleName+" || ("+this.moduleName+" = {}));"):this.writeLineToOutput("})();"),i!=j.Prog&&(!h&&e)&&(this.emitIndent(),this.writeLineToOutput("var "+this.moduleName+" = "+f+"."+this.moduleName+";")));this.recordSourceMappingEnd(b);this.setContainer(i);this.moduleName=f;this.moduleDeclList.length--}};d.prototype.emitIndex=function(b,i){var h=this.setInObjectLiteral(!1);this.emitJavascript(b,a.TokenID.Tilde,!1);this.writeToOutput("[");
this.emitJavascriptList(i,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput("]");this.setInObjectLiteral(h)};d.prototype.emitStringLiteral=function(a){this.writeToOutput(a)};d.prototype.emitJavascriptFunction=function(b){if(!a.hasFlag(b.fncFlags,a.FncFlags.Signature)&&!b.isOverload){var i,h=this.thisFnc;this.thisFnc=b;i=b.isConstructor?this.setContainer(j.Constructor):this.setContainer(j.Function);var c=null,f=!1,e=b.getNameText();if((this.emitState.inObjectLiteral||!b.isAccessor())&&(i!=j.Constructor||
(b.fncFlags&a.FncFlags.Method)==a.FncFlags.None)){var l=this.setInObjectLiteral(!1);this.thisClassNode&&(c=this.thisClassNode.extendsList);f=b.hasSelfReference();this.recordSourceMappingStart(b);a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)&&b.type.symbol.container==this.checker.gloMod&&!b.isConstructor?(this.writeToOutput("this."+e+" = "),this.emitInnerFunction(b,!1,!1,c,f,this.thisClassNode)):this.emitInnerFunction(b,b.name&&!b.name.isMissing(),!1,c,f,this.thisClassNode);
this.recordSourceMappingEnd(b);this.setInObjectLiteral(l)}this.setContainer(i);this.thisFnc=h;if(a.hasFlag(b.fncFlags,a.FncFlags.Definition))if(a.hasFlag(b.fncFlags,a.FncFlags.Static))this.thisClassNode&&(b.isAccessor()?this.emitPropertyAccessor(b,this.thisClassNode.name.text,!1):(this.emitIndent(),this.recordSourceMappingStart(b),this.writeLineToOutput(this.thisClassNode.name.text+"."+e+" = "+e+";"),this.recordSourceMappingEnd(b)));else if((this.emitState.container==j.Module||this.emitState.container==
j.DynamicModule)&&a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported))this.emitIndent(),i=this.emitState.container==j.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeLineToOutput(i+"."+e+" = "+e+";"),this.recordSourceMappingEnd(b)}};d.prototype.emitAmbientVarDecl=function(b){b.init&&(this.emitParensAndCommentsInPlace(b,!0),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(b.id.text),this.recordSourceMappingEnd(b.id),
this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1),this.recordSourceMappingEnd(b),this.writeToOutput(";"),this.emitParensAndCommentsInPlace(b,!1))};d.prototype.emitForVarList=function(b){if(b){this.recordSourceMappingStart(b);for(var i=b.members.length,h=0;h<i;h++)this.emitJavascriptVarDecl(b.members[h],0==h?a.TokenID.FOR:a.TokenID.LParen),h<i-1&&this.writeToOutput(", ");this.recordSourceMappingEnd(b)}};d.prototype.emitJavascriptVarDecl=function(b,i){if((b.varFlags&a.VarFlags.Ambient)==
a.VarFlags.Ambient)this.emitAmbientVarDecl(b);else{var h=b.sym,c=null!=b.init;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);if(h&&h.isMember()&&h.container&&h.container.kind()==a.SymbolKind.Type){var f=h.container.type;f.isClass()&&!a.hasFlag(h.flags,a.SymbolFlags.ModuleMember)?this.emitState.container!=j.Args&&(a.hasFlag(h.flags,a.SymbolFlags.Static)?this.writeToOutput(h.container.name+"."):this.writeToOutput("this.")):f.hasImplementation()?!a.hasFlag(h.flags,a.SymbolFlags.Exported)&&
(h.container==this.checker.gloMod||!a.hasFlag(h.flags,a.SymbolFlags.Property))?this.writeToOutput("var "):a.hasFlag(b.varFlags,a.VarFlags.LocalStatic)?this.writeToOutput("."):this.emitState.container==j.DynamicModule?this.writeToOutput("exports."):this.writeToOutput(this.moduleName+"."):i!=a.TokenID.LParen&&(a.hasFlag(h.flags,a.SymbolFlags.Exported)&&h.container==this.checker.gloMod?this.writeToOutput("this."):this.writeToOutput("var "))}else i!=a.TokenID.LParen&&this.writeToOutput("var ");this.recordSourceMappingStart(b.id);
this.writeToOutput(b.id.text);this.recordSourceMappingEnd(b.id);c?(this.writeToOutputTrimmable(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1)):h&&(h.isMember()&&this.emitState.container==j.Constructor)&&(this.writeToOutputTrimmable(" = "),this.writeToOutput(this.defaultValue(b.type)));i!=a.TokenID.FOR&&i!=a.TokenID.LParen&&this.writeToOutputTrimmable(";");this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1)}};d.prototype.declEnclosed=function(a){if(null==a)return!0;for(var i=
0,b=this.moduleDeclList.length;i<b;i++)if(this.moduleDeclList[i]==a)return!0;return!1};d.prototype.emitJavascriptName=function(b,i){var h=b.sym;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);if(!b.isMissing()){if(i&&this.emitState.container!=j.Args&&h)if(h.container&&h.container.name!=a.globalId)if(a.hasFlag(h.flags,a.SymbolFlags.Static)&&a.hasFlag(h.flags,a.SymbolFlags.Property))h.declModule&&a.hasFlag(h.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):
this.writeToOutput(h.container.name+".");else if(h.kind()==a.SymbolKind.Field)if(a.hasFlag(h.flags,a.SymbolFlags.ModuleMember)){if(h.container!=this.checker.gloMod&&(a.hasFlag(h.flags,a.SymbolFlags.Property)||a.hasFlag(h.flags,a.SymbolFlags.Exported)))a.hasFlag(h.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):this.writeToOutput(h.container.name+".")}else h.isInstanceProperty()&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?this.writeToOutput("_this."):
this.writeToOutput("this."));else h.kind()==a.SymbolKind.Type&&(h.isInstanceProperty()?h.type.call&&!a.hasFlag(h.flags,a.SymbolFlags.ModuleMember)&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?this.writeToOutput("_this."):this.writeToOutput("this.")):(h.unitIndex!=this.checker.locationInfo.unitIndex||!this.declEnclosed(h.declModule))&&this.writeToOutput(h.container.name+"."));else h.container==this.checker.gloMod&&(a.hasFlag(h.flags,a.SymbolFlags.Exported)&&!a.hasFlag(h.flags,
a.SymbolFlags.Ambient)&&(!h.isType()&&!h.isMember()||!h.declModule||!a.hasFlag(h.declModule.modFlags,a.ModuleFlags.Ambient))&&this.emitState.container==j.Prog&&h.declAST.nodeType!=a.NodeType.FuncDecl)&&this.writeToOutput("this.");if(h&&h.declAST&&h.declAST.nodeType==a.NodeType.Module&&a.hasFlag(h.declAST.modFlags,a.ModuleFlags.IsDynamic)){var c=h.declAST;a.moduleGenTarget==a.ModuleGenTarget.Asynchronous?this.writeLineToOutput("__"+this.modAliasId+"__;"):(h=b.text,h=(c=c.mod.symbol.declAST&&a.hasFlag(c.mod.symbol.declAST.modFlags,
a.ModuleFlags.Ambient))?h:this.firstModAlias?this.firstModAlias:a.quoteBaseName(h),h=c?h:!a.isRelative(a.stripQuotes(h))?a.quoteStr("./"+a.stripQuotes(h)):h,this.writeToOutput("require("+h+")"))}else this.writeToOutput(b.text)}this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1)};d.prototype.emitJavascriptStatements=function(b,i){if(b)if(b.nodeType!=a.NodeType.Block){var h=b&&(b.nodeType!=a.NodeType.List||0<b.members.length);if(i||h)h=b.nodeType==a.NodeType.Block||b.nodeType==a.NodeType.List&&
1==b.members.length&&b.members[0].nodeType==a.NodeType.Block,this.recordSourceMappingStart(b),h||(this.writeLineToOutput(" {"),this.indenter.increaseIndent()),this.emitJavascriptList(b,null,a.TokenID.SColon,!0,!1,!1),h||(this.writeLineToOutput(""),this.indenter.decreaseIndent(),this.emitIndent(),this.writeToOutput("}")),this.recordSourceMappingEnd(b)}else this.emitJavascript(b,a.TokenID.SColon,!0);else i&&this.writeToOutput("{ }")};d.prototype.emitBareJavascriptStatements=function(b,i){b.nodeType!=
a.NodeType.Block?b.nodeType==a.NodeType.List?2==b.members.length&&b.members[0].nodeType==a.NodeType.Block&&b.members[1].nodeType==a.NodeType.EndCode?(this.emitJavascript(b.members[0],a.TokenID.SColon,!0),this.writeLineToOutput("")):this.emitJavascriptList(b,null,a.TokenID.SColon,!0,!1,i):this.emitJavascript(b,a.TokenID.SColon,!0):this.emitJavascript(b,a.TokenID.SColon,!0)};d.prototype.recordSourceMappingStart=function(b){if(this.sourceMapper&&b){var i={line:-1,col:-1},h=new a.SourceMapping(b);h.emittedStartColumn=
this.emitState.column;h.emittedStartLine=this.emitState.line;a.getSourceLineColFromMap(i,b.minChar,this.checker.locationInfo.lineMap);h.sourceStartColumn=i.col;h.sourceStartLine=i.line;a.getSourceLineColFromMap(i,b.limChar,this.checker.locationInfo.lineMap);h.sourceEndColumn=i.col;h.sourceEndLine=i.line;h.parent=this.sourceMapper.currentMapping;this.sourceMapper.currentMapping=this.sourceMapper.sourceMappings.length;this.sourceMapper.sourceMappings.push(h);0<=h.parent&&(b=this.sourceMapper.sourceMappings[h.parent],
-1==b.firstChild&&(b.firstChild=this.sourceMapper.currentMapping))}};d.prototype.recordSourceMappingEnd=function(a){this.sourceMapper&&a&&(a=this.sourceMapper.sourceMappings[this.sourceMapper.currentMapping],a.emittedEndColumn=this.emitState.column,a.emittedEndLine=this.emitState.line,this.sourceMapper.currentMapping=a.parent)};d.prototype.emitSourceMappings=function(){a.SourceMapper.EmitSourceMapping(this.allSourceMappers)};d.prototype.emitJavascriptList=function(b,i,h,c,f,e){if(null!=b)if(b.nodeType!=
a.NodeType.List)this.emitJavascript(b,h,c);else if(0!=b.members.length){this.emitParensAndCommentsInPlace(b,!0);for(var l=b.members.length,n=0;n<l;n++){if(1==n&&e){var m=this.thisClassNode.constructorDecl;if(m&&m.args)for(var j=m.args.members.length,g=0;g<j;g++){var d=m.args.members[g];(d.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(d),this.recordSourceMappingStart(d.id),this.writeToOutput("this."+d.id.text),this.recordSourceMappingEnd(d.id),this.writeToOutput(" = "),
this.recordSourceMappingStart(d.id),this.writeToOutput(d.id.text),this.recordSourceMappingEnd(d.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(d))}m=this.thisClassNode.members.members.length;for(j=0;j<m;j++)this.thisClassNode.members.members[j].nodeType==a.NodeType.VarDecl&&(g=this.thisClassNode.members.members[j],!a.hasFlag(g.varFlags,a.VarFlags.Static)&&g.init&&(this.emitIndent(),this.emitJavascriptVarDecl(g,a.TokenID.Tilde),this.writeLineToOutput("")))}m=b.members[n];j=m.nodeType==
a.NodeType.FuncDecl&&a.hasFlag(m.fncFlags,a.FncFlags.Static)||m.nodeType==a.NodeType.VarDecl&&a.hasFlag(m.varFlags,a.VarFlags.Static);if(!(f?!j:j))this.emitJavascript(m,h,c),i&&n<l-1?c?this.writeLineToOutput(i):this.writeToOutput(i):c&&(m.nodeType!=a.NodeType.Module&&m.nodeType!=a.NodeType.Interface&&!(m.nodeType==a.NodeType.VarDecl&&(m.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient&&null==m.init)&&m.nodeType!=a.NodeType.EndCode&&m.nodeType!=a.NodeType.FuncDecl)&&this.writeLineToOutput("")}this.emitParensAndCommentsInPlace(b,
!1)}};d.prototype.emitJavascript=function(b,i,h){null!=b&&(h&&0<this.indenter.indentAmt&&b.nodeType!=a.NodeType.List&&b.nodeType!=a.NodeType.Block&&b.nodeType!=a.NodeType.Interface&&(!(b.nodeType==a.NodeType.VarDecl&&(b.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient&&null==b.init)&&b.nodeType!=a.NodeType.EndCode&&(b.nodeType!=a.NodeType.FuncDecl||this.emitState.container!=j.Constructor))&&this.emitIndent(),b.emit(this,i,h),i==a.TokenID.SColon&&b.nodeType<a.NodeType.GeneralNode&&this.writeToOutput(";"))};
d.prototype.emitPropertyAccessor=function(a,i,b){if(!a.accessorSymbol.hasBeenEmitted){var c=a.accessorSymbol;this.emitIndent();this.recordSourceMappingStart(a);this.writeLineToOutput("Object.defineProperty("+i+(b?'.prototype, "':', "')+a.name.text+'", {');this.indenter.increaseIndent();c.getter&&(i=c.getter.declAST,this.emitIndent(),this.writeToOutput("get: "),this.emitInnerFunction(i,!1,b,null,a.hasSelfReference(),null),this.writeLineToOutput(","));c.setter&&(i=c.setter.declAST,this.emitIndent(),
this.writeToOutput("set: "),this.emitInnerFunction(i,!1,b,null,a.hasSelfReference(),null),this.writeLineToOutput(","));this.emitIndent();this.writeLineToOutput("enumerable: true,");this.emitIndent();this.writeLineToOutput("configurable: true");this.indenter.decreaseIndent();this.emitIndent();this.writeLineToOutput("});");this.recordSourceMappingEnd(a);c.hasBeenEmitted=!0}};d.prototype.emitPrototypeMember=function(b,i){b.nodeType==a.NodeType.FuncDecl?b.isAccessor()?this.emitPropertyAccessor(b,i,!0):
(this.emitIndent(),this.recordSourceMappingStart(b),this.writeToOutput(i+".prototype."+b.getNameText()+" = "),this.emitInnerFunction(b,!1,!0,null,b.hasSelfReference(),null),this.recordSourceMappingEnd(b),this.writeLineToOutput(";")):b.nodeType==a.NodeType.VarDecl&&b.init&&(this.emitIndent(),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(i+".prototype."+b.id.text),this.recordSourceMappingEnd(b.id),this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Asg,
!1),this.recordSourceMappingEnd(b),this.writeLineToOutput(";"))};d.prototype.emitAddBaseMethods=function(b,i,h){if(i.members){var c=i.symbol,f=c.name;c.declModule!=h.type.symbol.declModule&&(f=c.fullName());i.members.allMembers.map(function(c,i){i.kind()==a.SymbolKind.Type&&i.type.call&&(this.recordSourceMappingStart(i.declAST),this.writeLineToOutput(b+".prototype."+i.name+" = "+f+".prototype."+i.name+";"),this.recordSourceMappingEnd(i.declAST))},null)}if(i.extendsList)for(var c=0,e=i.extendsList.length;c<
e;c++)this.emitAddBaseMethods(b,i.extendsList[c],h)};d.prototype.emitJavascriptClass=function(b){if(!a.hasFlag(b.varFlags,a.VarFlags.Ambient)){var i=this.thisClassNode,h=0;this.thisClassNode=b;var c=b.name.text;this.emitParensAndCommentsInPlace(b,!0);var f=this.setContainer(j.Class);this.recordSourceMappingStart(b);a.hasFlag(b.varFlags,a.VarFlags.Exported)&&b.type.symbol.container==this.checker.gloMod?this.writeToOutput("this."+c):this.writeToOutput("var "+c);var e=b.type.instanceType,l=e?e.baseClass():
null,n=null,n=null;l?this.writeLineToOutput(" = (function (_super) {"):this.writeLineToOutput(" = (function () {");this.indenter.increaseIndent();if(l){n=b.extendsList.members[0];n=n.nodeType==a.NodeType.Call?n.target:n;this.emitIndent();this.writeLineToOutput("__extends("+c+", _super);");var m=e.extendsList.length;if(1<m)for(h=1;h<m;h++)this.emitAddBaseMethods(c,e.extendsList[h],b)}this.emitIndent();if(b.constructorDecl)this.emitJavascript(b.constructorDecl,a.TokenID.LParen,!1);else{m=0;this.recordSourceMappingStart(b);
this.indenter.increaseIndent();this.writeToOutput("function "+b.name.text+"() {");l&&(this.writeLineToOutput(""),this.emitIndent(),this.writeLineToOutput("_super.apply(this, arguments);"),m++);b.varFlags&a.VarFlags.MustCaptureThis&&(this.emitIndent(),this.writeLineToOutput(this.captureThisStmtString));for(var g=this.thisClassNode.members.members,h=0;h<g.length;h++)g[h].nodeType==a.NodeType.VarDecl&&(e=g[h],!a.hasFlag(e.varFlags,a.VarFlags.Static)&&e.init&&(this.writeLineToOutput(""),this.emitIndent(),
this.emitJavascriptVarDecl(e,a.TokenID.Tilde),m++));m?(this.writeLineToOutput(""),this.indenter.decreaseIndent(),this.emitIndent(),this.writeLineToOutput("}")):(this.writeLineToOutput(" }"),this.indenter.decreaseIndent());this.recordSourceMappingEnd(b)}h=b.definitionMembers.members.length;for(m=0;m<h;m++)if(e=b.definitionMembers.members[m],e.nodeType==a.NodeType.FuncDecl)a.hasFlag(e.fncFlags,a.FncFlags.Method)&&!e.isSignature()&&(a.hasFlag(e.fncFlags,a.FncFlags.Static)?e.isAccessor()?this.emitPropertyAccessor(e,
this.thisClassNode.name.text,!1):(this.emitIndent(),this.recordSourceMappingStart(e),this.writeToOutput(b.name.text+"."+e.name.text+" = "),this.emitInnerFunction(e,e.name&&!e.name.isMissing(),!1,null,e.hasSelfReference(),null),this.recordSourceMappingEnd(e)):this.emitPrototypeMember(e,c));else if(e.nodeType==a.NodeType.VarDecl)a.hasFlag(e.varFlags,a.VarFlags.Static)&&(this.emitIndent(),this.recordSourceMappingStart(e),this.writeToOutput(b.name.text+"."+e.id.text+" = "),e.init?(this.emitJavascript(e.init,
a.TokenID.Asg,!1),this.writeLineToOutput(";")):this.writeLineToOutput(this.defaultValue(e.type)+";"),this.recordSourceMappingEnd(e));else throw Error("We want to catch this");this.emitIndent();this.recordSourceMappingStart(b);this.writeLineToOutput("return "+c+";");this.recordSourceMappingEnd(b);this.indenter.decreaseIndent();this.emitIndent();this.writeToOutput("})(");l&&this.emitJavascript(n,a.TokenID.Tilde,!1);this.writeToOutput(");");if((f==j.Module||f==j.DynamicModule)&&a.hasFlag(b.varFlags,
a.VarFlags.Exported))this.writeLineToOutput(""),this.emitIndent(),l=f==j.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeToOutput(l+"."+c+" = "+c+";"),this.recordSourceMappingEnd(b);this.emitIndent();this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1);this.setContainer(f);this.thisClassNode=i}};d.prototype.emitPrologue=function(a){this.prologueEmitted||(a&&(this.prologueEmitted=!0,this.writeLineToOutput("var __extends = this.__extends || function (d, b) {"),
this.writeLineToOutput("    function __() { this.constructor = d; }"),this.writeLineToOutput("    __.prototype = b.prototype;"),this.writeLineToOutput("    d.prototype = new __();"),this.writeLineToOutput("};")),this.checker.mustCaptureGlobalThis&&this.writeLineToOutput(this.captureThisStmtString))};d.prototype.emitSuperReference=function(){this.writeToOutput("_super.prototype")};d.prototype.emitSuperCall=function(b){if(b.target.nodeType==a.NodeType.Dot){var i=b.target;if(i.operand1.nodeType==a.NodeType.Super)return this.emitJavascript(i,
a.TokenID.LParen,!1),this.writeToOutput(".call(this"),b.args&&0<b.args.members.length&&(this.writeToOutput(", "),this.emitJavascriptList(b.args,", ",a.TokenID.Comma,!1,!1,!1)),this.writeToOutput(")"),!0}return!1};a.Emitter=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.outfile=a;this.checker=this.parser=null;this.lineCol={line:0,col:0};this.emitAsComments=!0;this.pushToErrorSink=this.hasErrors=!1;this.errorSink=[]};d.prototype.getCapturedErrors=function(){return this.errorSink};d.prototype.freeCapturedErrors=function(){this.errorSink=[]};d.prototype.captureError=function(a){this.errorSink[this.errorSink.length]=a};d.prototype.setErrOut=function(a){this.outfile=a;this.emitAsComments=!1};d.prototype.emitPrefix=function(){this.emitAsComments&&
this.outfile.Write("// ");this.outfile.Write(this.checker.locationInfo.filename+"("+this.lineCol.line+","+this.lineCol.col+"): ")};d.prototype.writePrefix=function(a){a?this.setError(a):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};d.prototype.writePrefixFromSym=function(j){j&&this.checker.locationInfo.lineMap?a.getSourceLineColFromMap(this.lineCol,j.location,this.checker.locationInfo.lineMap):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};d.prototype.setError=function(j){j&&
(j.flags|=a.ASTFlags.Error,this.checker.locationInfo.lineMap&&a.getSourceLineColFromMap(this.lineCol,j.minChar,this.checker.locationInfo.lineMap))};d.prototype.reportError=function(a,b){if(this.pushToErrorSink)this.captureError(b);else{this.hasErrors=!0;var g=a.limChar-a.minChar;this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.minChar,g,b,this.checker.locationInfo.unitIndex):(this.writePrefix(a),this.outfile.WriteLine(b))}};d.prototype.reportErrorFromSym=function(a,
b){this.pushToErrorSink?this.captureError(b):(this.hasErrors=!0,this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.location,1,b,this.checker.locationInfo.unitIndex):(this.writePrefixFromSym(a),this.outfile.WriteLine(b)))};d.prototype.emitterError=function(a,b){this.reportError(a,b);throw Error("EmitError");};d.prototype.duplicateIdentifier=function(a,b){this.reportError(a,"Duplicate identifier '"+b+"'")};d.prototype.showRef=function(a,b,g){var d={line:-1,col:-1};this.parser.getSourceLineCol(d,
g.location);this.reportError(a,"symbol "+b+" defined at ("+d.line+","+d.col+")")};d.prototype.unresolvedSymbol=function(a,b){this.reportError(a,"The name '"+b+"' does not exist in the current scope")};d.prototype.symbolDoesNotReferToAValue=function(a,b){this.reportError(a,"The name '"+b+"' does not refer to a value")};d.prototype.styleError=function(a,b){var g=this.pushToErrorSink;this.pushToErrorSink=!1;this.reportError(a,"STYLE: "+b);this.pushToErrorSink=g};d.prototype.simpleError=function(a,b){this.reportError(a,
b)};d.prototype.simpleErrorFromSym=function(a,b){this.reportErrorFromSym(a,b)};d.prototype.invalidSuperReference=function(a){this.simpleError(a,"Keyword 'super' can only be used inside a class instance method")};d.prototype.valueCannotBeModified=function(a){this.simpleError(a,"The left-hand side of an assignment expression must be a variable, property or indexer")};d.prototype.invalidCall=function(d,b,g){var k=d.target.type,g=k.getScopedTypeName(g);k.construct&&b==a.NodeType.Call?this.reportError(d,
"Value of type '"+g+"' is not callable.  Did you mean to include 'new'?"):this.reportError(d,"Value of type '"+g+"' is not "+(b==a.NodeType.Call?"callable":"newable"))};d.prototype.indexLHS=function(a,b){var g=a.operand1.type.getScopedTypeName(b),d=a.operand2.type.getScopedTypeName(b);this.simpleError(a,"Value of type '"+g+"' is not indexable by type '"+d+"'")};d.prototype.incompatibleTypes=function(a,b,g,d,i,h){b||(b=this.checker.anyType);g||(g=this.checker.anyType);h=h?h.message:"";d?this.reportError(a,
"Operator '"+d+"' cannot be applied to types '"+b.getScopedTypeName(i)+"' and '"+g.getScopedTypeName(i)+"'"+(h?": "+h:"")):this.reportError(a,"Cannot convert '"+b.getScopedTypeName(i)+"' to '"+g.getScopedTypeName(i)+"'"+(h?": "+h:""))};d.prototype.expectedClassOrInterface=function(a){this.simpleError(a,"Expected var, class, interface, or module")};d.prototype.unaryOperatorTypeError=function(a,b,g){this.reportError(a,"Operator '"+b+"' cannot be applied to type '"+g.getTypeName()+"'")};a.ErrorReporter=
d})(TypeScript||(TypeScript={}));
(function(a){var d=a.TypeContext||(a.TypeContext={});d._map=[];d.NoTypes=0;d.ArraySuffix=1;d.Primitive=2;d.Named=4;d.AllSimpleTypes=d.Primitive|d.Named;d.AllTypes=d.Primitive|d.Named|d.ArraySuffix;var j=a.TypeContext,d=a.ParseState||(a.ParseState={});d._map=[];d._map[0]="None";d.None=0;d._map[1]="StartScript";d.StartScript=1;d._map[2]="StartStmtList";d.StartStmtList=2;d._map[3]="StartStatement";d.StartStatement=3;d._map[4]="StartFncDecl";d.StartFncDecl=4;d._map[5]="FncDeclName";d.FncDeclName=5;d._map[6]=
"FncDeclArgs";d.FncDeclArgs=6;d._map[7]="FncDeclReturnType";d.FncDeclReturnType=7;d._map[8]="ForInit";d.ForInit=8;d._map[9]="ForInitAfterVar";d.ForInitAfterVar=9;d._map[10]="ForCondStart";d.ForCondStart=10;d._map[11]="EndStmtList";d.EndStmtList=11;d._map[12]="EndScript";d.EndScript=12;var b=a.ParseState,g;g=function(a,b){this.Script=a;this.endLexState=b};a.QuickParseResult=g;var k=function(){this.varLists=[];this.scopeLists=[];this.staticsLists=[];this.scanner=new a.Scanner;this.tok=null;this.inInterfaceDecl=
this.inStaticFnc=this.inFnc=this.needTerminator=!1;this.currentClassDecl=null;this.inFncDecl=!1;this.anonId=new a.Identifier("_anonymous");this.style_requireSemi=!1;this.style_funcInLoop=!0;this.errorRecovery=this.incremental=!1;this.outfile=void 0;this.errorCallback=null;this.state=b.StartStmtList;this.cursorColumn=this.cursorLine=-1;this.cursorState=b.None;this.errorMessage="";this.ambientClass=this.ambientModule=!1;this.topLevel=!0;this.currentUnitIndex=-1;this.prevIDTok=null;this.stmtStack=[];
this.strictMode=this.hasTopLevelImportOrExport=!1;this.nestingLevel=0;this.currentClassDefinition=this.prevExpr=null;this.parsingDeclareFile=this.parsingClassConstructorDefinition=!1;this.amdDependencies=[];this.inferPropertiesFromThisAssignment=!1;this.fname="";this.parseError=!1};k.prototype.resetStmtStack=function(){this.stmtStack=[]};k.prototype.inLoop=function(){for(var a=this.stmtStack.length-1;0<=a;a--)if(this.stmtStack[a].stmt.isLoop())return!0;return!1};k.prototype.pushStmt=function(a,b){this.stmtStack.push({stmt:a,
labels:b})};k.prototype.popStmt=function(){return this.stmtStack.pop()};k.prototype.resolveJumpTarget=function(i){for(var b=this.stmtStack.length-1;0<=b;b--){var c=this.stmtStack[b];if(i.target){if(c.labels&&0<c.labels.members.length)for(var f=0,e=c.labels.members.length;f<e;f++)if(c.labels.members[f].id.text==i.target){i.setResolvedTarget(this,c.stmt);return}}else{if(c.stmt.isLoop()){i.setResolvedTarget(this,c.stmt);return}if(c.stmt.nodeType==a.NodeType.Switch&&i.nodeType==a.NodeType.Break){i.setResolvedTarget(this,
c.stmt);return}}}i.target?this.reportParseError("could not find enclosing statement with label "+i.target):i.nodeType==a.NodeType.Break?this.reportParseError("break statement requires enclosing loop or switch"):this.reportParseError("continue statement requires enclosing loop")};k.prototype.setNonInteractive=function(){this.errorRecovery=!1};k.prototype.setErrorRecovery=function(a,h,c){this.outfile=a;this.cursorLine=h;this.cursorColumn=c;this.cursorState=b.None;this.errorRecovery=!0};k.prototype.posMatchesCursor=
function(a){var b={line:-1,col:-1};this.getSourceLineCol(b,a);return b.line==this.cursorLine&&b.col==this.cursorColumn};k.prototype.getSourceLineCol=function(i,b){a.getSourceLineColFromMap(i,b,this.scanner.lineMap)};k.prototype.createRef=function(i,b){var c=new a.Identifier(i);c.minChar=b;return c};k.prototype.reportParseStyleError=function(a){this.reportParseError("STYLE: "+a)};k.prototype.reportParseError=function(a,b,c){"undefined"===typeof b&&(b=this.scanner.startPos);"undefined"===typeof c&&
(c=this.scanner.pos);c=Math.max(1,c-b);if(this.errorCallback)this.errorCallback(b,c,a,this.currentUnitIndex);else if(this.errorRecovery)c={line:-1,col:-1},this.getSourceLineCol(c,b),this.outfile&&this.outfile.WriteLine("// "+this.fname+" ("+c.line+","+c.col+"): "+a);else throw new SyntaxError(this.fname+" ("+this.scanner.line+","+this.scanner.col+"): "+a);};k.prototype.chkNxtTok=function(a,b,c){this.tok=this.scanner.scan();this.chkCurTok(a,b,c)};k.prototype.skip=function(i){var i=i|a.ErrorRecoverySet.EOF,
b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId);void 0!=c&&(b=c.ers);for(var f=0;(b&i)==a.ErrorRecoverySet.None||this.tok.tokenId==a.TokenID.RCurly&&0<f;)this.tok.tokenId==a.TokenID.LCurly?f++:this.tok.tokenId==a.TokenID.RCurly&&f--,this.tok=this.scanner.scan(),b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId),void 0!=c&&(b=c.ers)};k.prototype.chkCurTok=function(a,b,c){this.tok.tokenId!=a?(this.reportParseError(b),this.errorRecovery&&this.skip(c)):this.tok=this.scanner.scan()};
k.prototype.pushDeclLists=function(){this.staticsLists.push(new a.ASTList);this.varLists.push(new a.ASTList);this.scopeLists.push(new a.ASTList)};k.prototype.popDeclLists=function(){this.staticsLists.pop();this.varLists.pop();this.scopeLists.pop()};k.prototype.topVarList=function(){return this.varLists[this.varLists.length-1]};k.prototype.topScopeList=function(){return this.scopeLists[this.scopeLists.length-1]};k.prototype.topStaticsList=function(){return this.staticsLists[this.staticsLists.length-
1]};k.prototype.parseComment=function(i){if(i){var b=new a.Comment(i.value,i.isBlock,i.endsLine);b.minChar=i.startPos;b.limChar=i.startPos+i.value.length;!i.isBlock&&3<i.value.length&&"///"==i.value.substring(0,3)&&(i=a.getAdditionalDependencyPath(i.value))&&this.amdDependencies.push(i);return b}return null};k.prototype.parseCommentsInner=function(a){if(a){for(var b=[],c=0;c<a.length;c++)b.push(this.parseComment(a[c]));return b}return null};k.prototype.parseComments=function(){var a=this.scanner.getComments();
return this.parseCommentsInner(a)};k.prototype.parseCommentsForLine=function(a){a=this.scanner.getCommentsForLine(a);return this.parseCommentsInner(a)};k.prototype.combineComments=function(a,b){return null==a?b:null==b?a:a.concat(b)};k.prototype.parseEnumDecl=function(b){var h=this.scanner.leftCurlyCount,c=this.scanner.rightCurlyCount,f=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(f=new a.Identifier(this.tok.getText()),f.minChar=this.scanner.startPos,f.limChar=
this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("Enum declaration requires identifier"),this.errorRecovery&&(f=new a.MissingIdentifier,f.minChar=this.scanner.startPos,f.limChar=this.scanner.startPos,f.flags|=a.ASTFlags.Error));var e=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",b|a.ErrorRecoverySet.ID);this.pushDeclLists();var l=new a.ASTList;l.minChar=e;e=new a.VarDecl(new a.Identifier("_map"),0);e.varFlags|=a.VarFlags.Exported;e.varFlags|=a.VarFlags.Private;
e.varFlags|=a.VarFlags.Property|a.VarFlags.Public;e.init=new a.UnaryExpression(a.NodeType.ArrayLit,null);l.append(e);for(e=null;;){var n=this.scanner.startPos,m,g=null,d=null,k=null,p=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok))g=new a.Identifier(this.tok.getText()),g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos;else if(this.tok.tokenId==a.TokenID.RCurly)break;else this.reportParseError("Expected identifer of enum member"),this.errorRecovery&&(g=new a.MissingIdentifier,
g.minChar=this.scanner.startPos,g.limChar=this.scanner.startPos,g.flags|=a.ASTFlags.Error);m=this.scanner.pos;k=this.parseComments();this.tok=this.scanner.scan();p=this.parseComments();if(this.tok.tokenId==a.TokenID.Asg)this.tok=this.scanner.scan(),e=d=this.parseExpr(b,a.OperatorPrecedence.Cma,!0,j.NoTypes),m=d.limChar;else{var e=d=null==e?new a.NumberLiteral(0):new a.NumberLiteral(e.value+1),q=new a.BinaryExpression(a.NodeType.Asg,new a.BinaryExpression(a.NodeType.Index,new a.Identifier("_map"),
d),new a.StringLiteral('"'+g.text+'"'));l.append(q)}g=new a.VarDecl(g,this.nestingLevel);g.minChar=n;g.limChar=m;g.init=d;g.typeExpr=new a.TypeReference(this.createRef(f.text,-1),0);g.varFlags|=a.VarFlags.Readonly|a.VarFlags.Property;d.nodeType==a.NodeType.NumberLit&&(g.varFlags|=a.VarFlags.Constant);g.preComments=k;l.append(g);g.postComments=p;g.varFlags|=a.VarFlags.Exported;if(this.tok.tokenId==a.TokenID.Comma&&(this.tok=this.scanner.scan(),g.postComments=this.combineComments(g.postComments,this.parseCommentsForLine(this.scanner.prevLine)),
this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)))continue;break}this.chkCurTok(a.TokenID.RCurly,"Expected '}'",b);l.limChar=this.scanner.lastTokenLimChar();b=new a.ModuleDecl(f,l,this.topVarList(),this.topScopeList());b.modFlags|=a.ModuleFlags.IsEnum;this.popDeclLists();b.leftCurlyCount=this.scanner.leftCurlyCount-h;b.rightCurlyCount=this.scanner.rightCurlyCount-c;return b};k.prototype.parseDottedName=function(b){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)){var h=new a.Identifier(this.tok.getText());h.preComments=this.parseComments();b[b.length]=h;h.minChar=this.scanner.startPos;h.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Dot&&this.parseDottedName(b)}else this.reportParseError("need identifier after '.'")};k.prototype.isValidImportPath=function(b){b=a.stripQuotes(b);return!b||-1!=b.indexOf(":")||-1!=b.indexOf("\\")||"/"==b.charAt(0)?!1:!0};k.prototype.parseImportDecl=function(b,h){var c=null,
f=null,c=null,e=this.scanner.startPos,l=!1;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?c=new a.Identifier(this.tok.getText()):(this.reportParseError("Expected identifer after 'import'"),c=new a.MissingIdentifier);c.minChar=this.scanner.startPos;c.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.Asg,"Expected =",b|a.ErrorRecoverySet.ID);var n=this.parseComments(),m;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode))if(this.tok.tokenId==a.TokenID.MODULE){if(m=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.QString||this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))this.tok.tokenId==a.TokenID.QString?(this.topLevel&&(this.hasTopLevelImportOrExport=!0),f=this.tok.getText(),this.isValidImportPath(f)||this.reportParseError("Invalid import path"),f=new a.Identifier(f),f.minChar=this.scanner.startPos,
f.limChar=this.scanner.pos,l=!0,this.tok=this.scanner.scan()):f=this.parseExpr(b|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,j.NoTypes),f.preComments=n;m=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",b|a.ErrorRecoverySet.ID);f&&(f.postComments=this.parseComments());this.tok.tokenId==a.TokenID.SColon&&(m=this.scanner.pos,this.tok=this.scanner.scan())}}else f=this.parseExpr(b|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,j.NoTypes),m=this.scanner.pos;else this.reportParseError("Expected module name"),
f=new a.MissingIdentifier,f.minChar=this.scanner.startPos,this.tok.tokenId==a.TokenID.SColon?f.limChar=this.scanner.startPos:(f.limChar=this.scanner.pos,this.tok=this.scanner.scan()),f.flags|=a.ASTFlags.Error,m=f.limChar;c=new a.ImportDecl(c,f);c.isDynamicImport=l;a.hasFlag(h,a.Modifiers.Exported)&&(c.varFlags|=a.VarFlags.Exported);c.minChar=e;c.limChar=m;return c};k.prototype.parseModuleDecl=function(b,h){var c=this.scanner.leftCurlyCount,f=this.scanner.rightCurlyCount,e=this.ambientModule,l=this.topLevel;
this.topLevel=!1;if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient))this.ambientModule=!0;this.tok=this.scanner.scan();var n=null,m=null;this.pushDeclLists();var g=this.parseComments(),d=this.scanner.startPos,j=!1;this.tok.tokenId==a.TokenID.ID||this.tok.tokenId==a.TokenID.QString||!a.isPrimitiveTypeToken(this.tok)&&a.convertTokToID(this.tok,this.strictMode)?(n=this.tok.getText(),this.tok.tokenId==a.TokenID.QString&&(j=!0,this.ambientModule||this.reportParseError("Only ambient dynamic modules may have string literal names")),
n=new a.Identifier(n),n.minChar=this.scanner.startPos,n.limChar=this.scanner.pos,this.tok=this.scanner.scan()):this.tok.tokenId==a.TokenID.LCurly&&(this.reportParseError("Module name missing"),n=new a.Identifier(""),n.minChar=d,n.limChar=d);this.tok.tokenId==a.TokenID.Dot&&(m=[],this.parseDottedName(m));null==n&&(n=new a.MissingIdentifier);var k=new a.ASTList,q=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",b|a.ErrorRecoverySet.ID);this.parseStmtList(b|a.ErrorRecoverySet.RCurly,
k,!0,!0,a.AllowedElements.ModuleMembers,h);k.minChar=q;k.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",b);q=this.scanner.pos;if(m&&0<m.length){var t=m.length,r=m[t-1],r=new a.ModuleDecl(r,k,this.topVarList(),this.topScopeList());if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient))r.modFlags|=a.ModuleFlags.Ambient;r.modFlags|=a.ModuleFlags.Exported;r.minChar=d;r.limChar=q;this.popDeclLists();for(t-=2;0<=t;t--){k=new a.ASTList;k.append(r);r=m[t];r=new a.ModuleDecl(r,
k,new a.ASTList,new a.ASTList);k.minChar=r.minChar=d;k.limChar=r.limChar=q;if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient))r.modFlags|=a.ModuleFlags.Ambient;r.modFlags|=a.ModuleFlags.Exported}k=new a.ASTList;k.append(r);k.minChar=d;k.limChar=q;m=new a.ModuleDecl(n,k,new a.ASTList,new a.ASTList)}else m=new a.ModuleDecl(n,k,this.topVarList(),this.topScopeList()),this.popDeclLists();if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient))m.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(h,
a.Modifiers.Exported)&&(m.modFlags|=a.ModuleFlags.Exported);j&&(m.modFlags|=a.ModuleFlags.IsDynamic);m.preComments=g;m.postComments=this.parseComments();this.ambientModule=e;this.topLevel=l;m.leftCurlyCount=this.scanner.leftCurlyCount-c;m.rightCurlyCount=this.scanner.rightCurlyCount-f;return m};k.prototype.parseTypeReferenceTail=function(b,h,c){c=new a.TypeReference(c,0);for(c.minChar=h;this.tok.tokenId==a.TokenID.LBrack;)this.tok=this.scanner.scan(),c.arrayCount++,this.chkCurTok(a.TokenID.RBrack,
"Expected ']'",b|a.ErrorRecoverySet.LBrack);c.limChar=this.scanner.lastTokenLimChar();return c};k.prototype.parseNamedType=function(b,h,c,f){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.Dot){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||(!this.errorRecovery||!this.scanner.lastTokenHadNewline())&&a.convertTokToID(this.tok,this.strictMode)){var e=new a.Identifier(this.tok.getText());e.minChar=this.scanner.startPos;e.limChar=this.scanner.pos;var l=new a.BinaryExpression(a.NodeType.Dot,
c,e);l.minChar=c.minChar;l.limChar=e.limChar;return this.parseNamedType(b,h,l,f)}this.reportParseError("need identifier after '.'");if(this.errorRecovery)return c.flags|=a.ASTFlags.DotLHS,c.limChar=this.scanner.lastTokenLimChar(),c;e=new a.MissingIdentifier;e.minChar=this.scanner.pos;e.limChar=this.scanner.pos;l=new a.BinaryExpression(a.NodeType.Dot,c,e);l.flags|=a.ASTFlags.Error;l.minChar=c.minChar;l.limChar=e.limChar;return this.parseNamedType(b,h,l,f)}return f?this.parseTypeReferenceTail(b,h,c):
c};k.prototype.parseTypeReference=function(b,h){var c=this.scanner.startPos,f=!1;switch(this.tok.tokenId){case a.TokenID.VOID:h||this.reportParseError("void not a valid type in this context");case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:return f=new a.Identifier(a.tokenTable[this.tok.tokenId].text),f.minChar=c,f.limChar=this.scanner.pos,this.tok=this.scanner.scan(),this.parseTypeReferenceTail(b,c,f);case a.TokenID.ID:return f=this.createRef(this.tok.getText(),
c),f.limChar=this.scanner.pos,this.parseNamedType(b,c,f,!0);case a.TokenID.LCurly:this.tok=this.scanner.scan();f=new a.ASTList;f.minChar=c;var e=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(b|a.ErrorRecoverySet.RCurly,f);this.inInterfaceDecl=e;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",b);e=new a.TypeDecl(a.NodeType.Interface,this.anonId,f,null,null,null);e.minChar=c;e.limChar=f.limChar;return this.parseTypeReferenceTail(b,c,e);case a.TokenID.NEW:this.tok=this.scanner.scan(),
this.tok.tokenId!=a.TokenID.LParen?this.reportParseError("Expected '('"):f=!0;case a.TokenID.LParen:var l=new a.ASTList,e=this.parseFormalParameterList(b|a.ErrorRecoverySet.RParen,l,!1,!0,!1,!1,!1,null);this.chkCurTok(a.TokenID.Arrow,"Expected '=>'",b);var n=this.parseTypeReference(b,!0),l=new a.FuncDecl(null,null,!1,l,null,null,null,a.NodeType.FuncDecl);l.returnTypeAnnotation=n;l.variableArgList=e;l.fncFlags|=a.FncFlags.Signature;f&&(l.fncFlags|=a.FncFlags.ConstructMember,l.hint="_construct",l.classDecl=
null);l.minChar=c;return this.parseTypeReferenceTail(b,c,l);default:return this.reportParseError("Expected type name"),c=new a.TypeReference(null,0),c.flags|=a.ASTFlags.Error,c.minChar=this.scanner.pos,c.limChar=this.scanner.pos,c}};k.prototype.parseFunctionStatements=function(i,h,c,f,e,l,n,m,g){this.pushDeclLists();var d=this.stmtStack;this.resetStmtStack();var k=null,p=!1,q=!1;if(!m){var k=new a.ASTList,t=this.scanner.startPos;this.tok.tokenId==a.TokenID.Arrow&&(f&&this.reportParseError("'=>' may not be used for class methods"),
p=!0,this.tok=this.scanner.scan());p&&this.tok.tokenId!=a.TokenID.LCurly?(l=this.parseExpr(i|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,j.NoTypes),g=new a.ReturnStatement,g.returnExpression=l,k.minChar=t,k.append(g)):(this.state=b.StartStmtList,this.chkCurTok(a.TokenID.LCurly,"Expected '{'",i|a.ErrorRecoverySet.StmtStart),f=this.inFnc,q=p,this.inFnc=!0,this.parseStmtList(i|a.ErrorRecoverySet.RCurly|a.ErrorRecoverySet.StmtStart,k,!0,!1,l,g),k.minChar=t,k.limChar=this.scanner.pos,this.inFnc=
f,t=new a.EndCode,t.minChar=k.limChar,t.limChar=t.minChar,k.append(t))}h=new a.FuncDecl(h,k,c,e,this.topVarList(),this.topScopeList(),this.topStaticsList(),a.NodeType.FuncDecl);this.popDeclLists();this.topScopeList().append(h);c=this.scanner.pos;m?this.chkCurTok(a.TokenID.SColon,this.tok.tokenId==a.TokenID.LCurly?"Function declarations are not permitted within interfaces, ambient modules or classes":"Expected ';'",i):!p||q?(this.chkCurTok(a.TokenID.RCurly,"Expected '}'",i),q&&(h.fncFlags|=a.FncFlags.IsFatArrowFunction)):
(h.fncFlags|=a.FncFlags.IsFatArrowFunction,this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan()));h.minChar=n;h.limChar=c;m||(h.fncFlags|=a.FncFlags.Definition);this.stmtStack=d;return h};k.prototype.transformAnonymousArgsIntoFormals=function(b,h){var c=this,f=function(f){if(f.nodeType==a.NodeType.Comma)c.transformAnonymousArgsIntoFormals(b,f);else if(f.nodeType==a.NodeType.Name||f.nodeType==a.NodeType.Asg){var h=f.nodeType==a.NodeType.Asg?f.operand1:f,n=new a.ArgDecl(h);n.preComments=
h.preComments;n.postComments=h.postComments;n.minChar=h.minChar;n.limChar=h.limChar;a.hasFlag(h.flags,a.ASTFlags.PossibleOptionalParameter)&&(n.isOptional=!0);f.nodeType==a.NodeType.Asg&&(n.init=f.operand2);b.append(n)}else c.reportParseError("Invalid lambda argument")};h&&(h.nodeType==a.NodeType.Comma?(f(h.operand1),f(h.operand2)):f(h))};k.prototype.parseFormalParameterList=function(b,h,c,f,e,l,n,m){h.minChar=this.scanner.startPos;e?this.tok=this.scanner.scan():m||this.chkCurTok(a.TokenID.LParen,
"Expected '('",b|a.ErrorRecoverySet.RParen);var g=!1,d=!0,k=!1,p=!1,q=!1;m&&(this.transformAnonymousArgsIntoFormals(h,m),p=!0);for(;;){var t=!1,r=a.VarFlags.None,v=this.scanner.startPos;this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),this.tok=this.scanner.scan(),r|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=
a.VarFlags.ClassSuperMustBeFirstCallInConstructor));this.tok.tokenId==a.TokenID.PUBLIC?(r|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor)):this.tok.tokenId==a.TokenID.PRIVATE?(r|=a.VarFlags.Private|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor)):this.tok.tokenId==a.TokenID.STATIC&&c&&(this.reportParseError("Static properties can not be declared as parameter properties"),
this.tok=this.scanner.scan());if(r!=a.VarFlags.None)c||this.reportParseError("only constructor parameters can be properties"),this.tok=this.scanner.scan(),a.isModifier(this.tok)&&(this.reportParseError("Multiple modifiers may not be applied to parameters"),this.tok=this.scanner.scan()),this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),this.tok=this.scanner.scan(),
this.tok=this.scanner.scan());else if(this.tok.tokenId==a.TokenID.Ellipsis&&(g=!0,this.tok=this.scanner.scan(),this.tok.tokenId!=a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))this.reportParseError("'...' parameters require both a parameter name and an array type annotation to be specified"),g=!1;var w=null;if(!p&&this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))w=new a.Identifier(this.tok.getText()),w.minChar=this.scanner.startPos,w.limChar=this.scanner.pos;if(p||
w){var t=!0,C=null,x=null;p&&h.members.length?(x=h.members[h.members.length-1],x.isOptional&&(q=k=!0)):(x=new a.ArgDecl(w),l&&this.reportParseError("Property getters may not take any arguments"),n&&!d&&this.reportParseError("Property setters may only take one argument"),x.minChar=v,x.preComments=this.parseComments(),this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(k=x.isOptional=!0,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),C=this.parseTypeReference(b,
!1),m&&(q=!0));this.tok.tokenId==a.TokenID.Asg&&(f&&this.reportParseError("Arguments in signatures may not have default values"),k=!0,this.tok=this.scanner.scan(),x.init=this.parseExpr(a.ErrorRecoverySet.Comma|b,a.OperatorPrecedence.Cma,!1,j.NoTypes));k&&(!x.isOptionalArg()&&!g)&&this.reportParseError("Optional parameters may only be followed by other optional parameters");g&&x.isOptionalArg()&&this.reportParseError("Varargs may not be optional or have default parameters");x.postComments=this.parseComments();
x.typeExpr=C;x.limChar=this.scanner.lastTokenLimChar();x.varFlags|=r;p?p=!1:h.append(x)}d=!1;if(this.tok.tokenId==a.TokenID.Comma)t&&!g?this.tok=this.scanner.scan():(this.reportParseError("Unexpected ',' in argument list"),this.errorRecovery&&(this.tok=this.scanner.scan()));else break}e?this.chkCurTok(a.TokenID.RBrack,"Expected ']'",b|a.ErrorRecoverySet.LCurly|a.ErrorRecoverySet.SColon):(!m||q)&&this.chkCurTok(a.TokenID.RParen,"Expected ')'",b|a.ErrorRecoverySet.LCurly|a.ErrorRecoverySet.SColon);
h.limChar=this.scanner.lastTokenLimChar();return g};k.prototype.parseFncDecl=function(i,h,c,f,e,l,n,m,g,d){var j=this.scanner.leftCurlyCount,k=this.scanner.rightCurlyCount,q=this.parsingClassConstructorDefinition;this.parsingClassConstructorDefinition=!1;var t=null,r=this.scanner.startPos,v=this.scanner.pos,w=this.nestingLevel;this.nestingLevel=0;!this.style_funcInLoop&&this.inLoop()&&this.reportParseStyleError("function declaration in loop");if(!f&&!n&&!l&&!d)if(this.tok=this.scanner.scan(),this.state=
b.StartFncDecl,this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)){if(h)return this.reportParseError("Function declaration must include identifier"),this.nestingLevel=w,new a.IncompleteAST(r,this.scanner.pos)}else t=new a.Identifier(this.tok.getText()),t.minChar=this.scanner.startPos,t.limChar=this.scanner.pos,this.tok=this.scanner.scan();else e&&(t=e);this.state=b.FncDeclName;var C=new a.ASTList,r=e=!1,x=a.hasFlag(g,a.Modifiers.Getter),D=a.hasFlag(g,a.Modifiers.Setter);if(this.tok.tokenId==
a.TokenID.LParen||l&&this.tok.tokenId==a.TokenID.LBrack||d&&d.preProcessedLambdaArgs)e=this.parseFormalParameterList(i,C,!1,c,l,x,D,d?d.preProcessedLambdaArgs:null);this.state=b.FncDeclArgs;d=null;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),a.hasFlag(g,a.Modifiers.Setter)&&this.reportParseError("Property setters may not declare a return type"),d=this.parseTypeReference(i,!0));l&&0==C.members.length&&this.reportParseError("Index signatures require a parameter type to be specified");
this.state=b.FncDeclReturnType;if(h&&!this.parsingDeclareFile&&!m&&(!f||!this.ambientModule&&!this.ambientClass&&!this.inInterfaceDecl)&&this.tok.tokenId==a.TokenID.SColon)c=r=!0;h=this.inFncDecl;this.inFncDecl=!0;i=this.parseFunctionStatements(i|a.ErrorRecoverySet.RCurly,t,!1,f,C,a.AllowedElements.FunctionBody,v,c,a.Modifiers.None);this.inFncDecl=h;i.variableArgList=e;i.isOverload=r;c||(i.fncFlags|=a.FncFlags.Definition);n&&(i.fncFlags|=a.FncFlags.Static);c&&(i.fncFlags|=a.FncFlags.Signature);l&&
(i.fncFlags|=a.FncFlags.IndexerMember);i.returnTypeAnnotation=d;f&&(i.fncFlags|=a.FncFlags.Method,i.fncFlags|=a.FncFlags.ClassPropertyMethodExported);i.leftCurlyCount=this.scanner.leftCurlyCount-j;i.rightCurlyCount=this.scanner.rightCurlyCount-k;this.nestingLevel=w;this.parsingClassConstructorDefinition=q;return i};k.prototype.convertToTypeReference=function(b){var h;switch(b.nodeType){case a.NodeType.TypeRef:return b;case a.NodeType.Name:return h=new a.TypeReference(b,0),h.minChar=b.minChar,h.limChar=
b.limChar,h;case a.NodeType.Index:return(h=this.convertToTypeReference(b.operand1))?(h.arrayCount++,h.minChar=b.minChar,h.limChar=b.limChar,h):new a.AST(a.NodeType.Error)}return null};k.prototype.parseArgList=function(b){var h=new a.ASTList;h.minChar=this.scanner.startPos;this.tok=this.scanner.scan();if(this.tok.tokenId!==a.TokenID.RParen)for(;;){if(65535<h.members.length){this.reportParseError("max number of args exceeded");break}var c=this.parseExpr(a.ErrorRecoverySet.Comma|b,a.OperatorPrecedence.Cma,
!1,j.NoTypes);h.append(c);if(this.tok.tokenId!=a.TokenID.Comma)break;this.tok=this.scanner.scan()}h.limChar=this.scanner.pos;return h};k.prototype.parseBaseList=function(b,h,c,f,e){for(var l=!0,n=b;;){l&&(this.tok.tokenId==a.TokenID.IMPLEMENTS&&(f&&this.reportParseError("interfaces can not implement other types"),n=h),this.tok=this.scanner.scan(),l=!1);var m=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)){var g=this.scanner.startPos,m=new a.Identifier(this.tok.getText());
m.minChar=g;m.limChar=this.scanner.pos;m=this.parseNamedType(c|a.ErrorRecoverySet.LCurly,g,m,!1)}else this.reportParseError("Expected base name"),this.errorRecovery&&(m=new a.MissingIdentifier,m.minChar=this.scanner.pos,m.limChar=this.scanner.pos,m.flags|=a.ASTFlags.Error);this.tok.tokenId==a.TokenID.LParen&&(e&&this.reportParseError("Base classes may only be initialized via a 'super' call within the constructor body"),g=this.parseArgList(c|a.ErrorRecoverySet.RParen),m=new a.CallExpression(a.NodeType.Call,
m,g),this.tok=this.scanner.scan(),m.limChar=this.scanner.pos);n.append(m);!f&&(n==b&&1<b.members.length)&&this.reportParseError("A class may only extend one other class");if(this.tok.tokenId==a.TokenID.Comma)this.tok=this.scanner.scan();else if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)n=b,l=!0;else break}};k.prototype.parseClassDecl=function(b,h,c){var h=this.scanner.leftCurlyCount,f=this.scanner.rightCurlyCount;(c&a.Modifiers.Readonly)!=a.Modifiers.None&&this.reportParseError("const modifier is implicit for class");
if(this.parsingDeclareFile||this.ambientModule)c|=a.Modifiers.Ambient,c|=a.Modifiers.Exported;var e=this.ambientClass;this.ambientClass=this.parsingDeclareFile||(c&a.Modifiers.Ambient)!=a.Modifiers.None;this.tok=this.scanner.scan();var l=null;this.tok.tokenId==a.TokenID.ID||!a.isPrimitiveTypeToken(this.tok)&&a.convertTokToID(this.tok,this.strictMode)?(l=new a.Identifier(this.tok.getText()),l.minChar=this.scanner.startPos,l.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("class missing name"),
this.errorRecovery&&(l=new a.MissingIdentifier,l.minChar=this.scanner.pos,l.limChar=this.scanner.pos,l.flags|=a.ASTFlags.Error));var n=null,m=null;if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)n=new a.ASTList,m=new a.ASTList,this.parseBaseList(n,m,b,!1,!0);this.currentClassDefinition=l=new a.ClassDecl(l,new a.ASTList,n,m);this.parseClassElements(l,b,c);if(this.ambientModule||this.parsingDeclareFile||a.hasFlag(c,a.Modifiers.Exported))l.varFlags|=a.VarFlags.Exported;
if(this.ambientModule||a.hasFlag(c,a.Modifiers.Ambient))l.varFlags|=a.VarFlags.Ambient;l.varFlags|=a.VarFlags.Class;this.ambientClass=e;l.leftCurlyCount=this.scanner.leftCurlyCount-h;l.rightCurlyCount=this.scanner.rightCurlyCount-f;return l};k.prototype.parseClassElements=function(b,h,c){var f=c,e=!1,b=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",h);this.nestingLevel++;for(var l=this.scanner.startPos,n=!1;!(this.tok.tokenId==a.TokenID.RCurly||this.tok.tokenId==a.TokenID.EOF);){var m=
!0,g=a.Modifiers.Public|a.Modifiers.Private;this.tok.tokenId==a.TokenID.GET?(f&a.Modifiers.Getter&&this.reportParseError("Duplicate 'get' declaration in class body"),f&a.Modifiers.Setter&&this.reportParseError("Getter already marked as a setter"),f|=a.Modifiers.Getter):this.tok.tokenId==a.TokenID.SET?(f&a.Modifiers.Setter&&this.reportParseError("Duplicate 'set' declaration in class body"),f&a.Modifiers.Getter&&this.reportParseError("Setter already marked as a getter"),f|=a.Modifiers.Setter):this.tok.tokenId==
a.TokenID.PRIVATE?(f&g&&this.reportParseError("Multiple modifiers may not be applied to class members"),f|=a.Modifiers.Private):this.tok.tokenId==a.TokenID.PUBLIC?(f&g&&this.reportParseError("Multiple modifiers may not be applied to class members"),f|=a.Modifiers.Public):this.tok.tokenId==a.TokenID.STATIC?(f&a.Modifiers.Static&&this.reportParseError("Multiple modifiers may not be applied to class members"),f|=a.Modifiers.Static):this.tok.tokenId==a.TokenID.CONSTRUCTOR?(f!=c&&this.reportParseError("Constructors may not have modifiers"),
this.parseClassConstructorDeclaration(l,h,f),m=!1,e=!0):n||this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(e=n?f&a.Modifiers.Getter?"get":"set":this.tok.getText(),e=new a.Identifier(e),e.minChar=this.scanner.startPos,e.limChar=this.scanner.pos,n?(f^=f&a.Modifiers.Getter?a.Modifiers.Getter:a.Modifiers.Setter,n=!1):this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen?(this.parseClassMemberFunctionDeclaration(e,l,h,f),m=!1):((f&a.Modifiers.Getter||f&a.Modifiers.Setter)&&this.reportParseError("Property accessors must be functions"),
e=this.parseClassMemberVariableDeclaration(e,l,!1,h,f),e.init&&e.init.nodeType==a.NodeType.FuncDecl?this.tok.tokenId==a.TokenID.RCurly&&(m=!1):e.init&&e.init.nodeType==a.NodeType.ObjectLit&&this.tok.tokenId!=a.TokenID.SColon?(m=!1,e.init.flags|=a.ASTFlags.AutomaticSemicolon):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Expected ';'"),m=!1)),e=!0):this.tok.tokenId==a.TokenID.SUPER?this.reportParseError("Base class initializers must be the first statement in a class definition"):!n&&
(f&a.Modifiers.Getter||f&a.Modifiers.Setter)&&this.tok.tokenId==a.TokenID.LParen||this.tok.tokenId==a.TokenID.Asg?(n=!0,m=!1):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Unexpected '"+this.tok.getText()+"' in class definition"),e=!0);m&&(this.tok=this.scanner.scan());e&&(f=c,l=this.scanner.startPos,e=!1)}h=this.scanner.pos;this.tok.tokenId==a.TokenID.RCurly&&(this.currentClassDefinition.definitionMembers.members.length||(this.currentClassDefinition.preComments=this.parseComments()),
this.tok=this.scanner.scan());this.nestingLevel--;this.currentClassDefinition.members.minChar=b;this.currentClassDefinition.members.limChar=h;this.currentClassDefinition.limChar=h;this.currentClassDefinition=null};k.prototype.parseClassConstructorDeclaration=function(b,h,c){this.parsingClassConstructorDefinition=!0;var f=this.parsingDeclareFile||a.hasFlag(c,a.Modifiers.Ambient),e=new a.ASTList,l=!1,n=this.parseComments();this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.LParen&&(l=this.parseFormalParameterList(h,
e,!0,f,!1,!1,!1,null));var m=f||this.tok.tokenId==a.TokenID.SColon;if(m)for(var g=0;g<e.members.length;g++)a.hasFlag(e.members[g].varFlags,a.VarFlags.Property)&&this.reportParseError("Overload or ambient signatures may not specify parameter properties");m||(this.currentClassDefinition.constructorNestingLevel=this.nestingLevel+1);b=this.parseFunctionStatements(h|a.ErrorRecoverySet.RCurly,this.currentClassDefinition.name,!0,!1,e,a.AllowedElements.ClassMembers,b,m,c);b.preComments=n;m&&!f&&(b.isOverload=
!0);b.variableArgList=l;this.currentClassDecl=null;b.returnTypeAnnotation=this.convertToTypeReference(this.currentClassDefinition.name);b.classDecl=this.currentClassDefinition;f&&(b.fncFlags|=a.FncFlags.Ambient);m&&(b.fncFlags|=a.FncFlags.Signature);if(this.ambientModule||a.hasFlag(c,a.Modifiers.Exported))b.fncFlags|=a.FncFlags.Exported;this.currentClassDefinition.constructorDecl&&!f&&(!this.currentClassDefinition.constructorDecl.isSignature()&&!b.isSignature())&&this.reportParseError("Duplicate constructor definition");
if(f||!b.isSignature())this.currentClassDefinition.constructorDecl=b;b.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=b;this.parsingClassConstructorDefinition=!1;b.postComments=this.parseComments();return b};k.prototype.parseClassMemberVariableDeclaration=function(b,h,c,f,e){var l=new a.VarDecl(b,this.nestingLevel);l.minChar=h;h=!1;l.preComments=this.parseComments();this.tok.tokenId==a.TokenID.Colon&&
(this.tok=this.scanner.scan(),l.typeExpr=this.parseTypeReference(f|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(this.parsingDeclareFile||a.hasFlag(e,a.Modifiers.Ambient))if(this.reportParseError("context does not permit variable initializer"),this.errorRecovery)return this.skip(f),l.flags|=a.ASTFlags.Error,l.limChar=this.scanner.lastTokenLimChar(),l;this.tok=this.scanner.scan();l.init=this.parseExpr(a.ErrorRecoverySet.Comma|f,a.OperatorPrecedence.Cma,
!0,j.NoTypes);l.limChar=l.init.limChar;this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor}else l.limChar=this.scanner.pos;e&a.Modifiers.Static&&(l.varFlags|=a.VarFlags.Static,h=!0);l.varFlags=(e&a.Modifiers.Private)!=a.Modifiers.None?l.varFlags|a.VarFlags.Private:l.varFlags|a.VarFlags.Public;l.varFlags|=a.VarFlags.Property;c&&(l.varFlags|=a.VarFlags.ClassConstructorProperty);!c&&!h&&(l.varFlags|=a.VarFlags.ClassBodyProperty);this.currentClassDefinition.knownMemberNames[b.text]=
!0;c||(this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=l);this.currentClassDefinition.allMemberDefinitions.members[this.currentClassDefinition.allMemberDefinitions.members.length]=l;l.postComments=this.parseComments();return l};k.prototype.parseClassMemberFunctionDeclaration=function(b,h,c,f){var e=a.hasFlag(f,a.Modifiers.Getter)||a.hasFlag(f,a.Modifiers.Setter),l=a.hasFlag(f,a.Modifiers.Static),n=this.ambientModule||a.hasFlag(f,
a.Modifiers.Ambient),c=c|a.ErrorRecoverySet.RParen,m=this.parseComments();e&&f&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient classes");c=this.parseFncDecl(c,!0,n,!0,b,!1,l,n,f,null);if(c.nodeType==a.NodeType.Error)return c;c.preComments=m;c.minChar=h;null!==c.bod&&(c.limChar=c.bod.limChar);c.fncFlags=f&a.Modifiers.Private?c.fncFlags|a.FncFlags.Private:c.fncFlags|a.FncFlags.Public;l&&(c.fncFlags|=a.FncFlags.Static);e&&(a.hasFlag(f,a.Modifiers.Getter)?
(c.fncFlags|=a.FncFlags.GetAccessor,c.hint="get"+c.name.text):(c.fncFlags|=a.FncFlags.SetAccessor,c.hint="set"+c.name.text),c.fncFlags|=a.FncFlags.IsFunctionExpression,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"));c.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.knownMemberNames[b.text]=!0;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=
c;c.postComments=this.parseComments();return c};k.prototype.parseInterfaceMember=function(b){var h=this.scanner.startPos,c=this.parsePropertyDecl(b,a.Modifiers.Public,!0,!1);c.nodeType==a.NodeType.VarDecl&&this.chkCurTok(a.TokenID.SColon,"Expected ';'",b);c&&(c.minChar=h);return c};k.prototype.parseInterfaceMembers=function(b,h){for(;;){switch(this.tok.tokenId){case a.TokenID.RCurly:case a.TokenID.EOF:h.limChar=this.scanner.pos;return}var c=this.parseInterfaceMember(b|a.ErrorRecoverySet.TypeScriptS);
c&&h.append(c)}};k.prototype.parseInterfaceDecl=function(b,h){var c=this.scanner.leftCurlyCount,f=this.scanner.rightCurlyCount;this.tok=this.scanner.scan();var e=null;this.tok.tokenId==a.TokenID.ID||!a.isPrimitiveTypeToken(this.tok)&&a.convertTokToID(this.tok,this.strictMode)?(e=new a.Identifier(this.tok.getText()),e.minChar=this.scanner.startPos,e.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("interface missing name"),this.errorRecovery&&(e=new a.MissingIdentifier,
e.minChar=this.scanner.pos,e.limChar=this.scanner.pos,e.flags|=a.ASTFlags.Error));var l=null;this.tok.tokenId==a.TokenID.EXTENDS&&(l=new a.ASTList,l.minChar=this.scanner.startPos,this.parseBaseList(l,null,b,!0,!1));var n=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",b|a.ErrorRecoverySet.TypeScriptS);var m=new a.ASTList;m.minChar=n;n=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(b|a.ErrorRecoverySet.RCurly,m);this.inInterfaceDecl=n;this.chkCurTok(a.TokenID.RCurly,
"Expected '}'",b);e=new a.TypeDecl(a.NodeType.Interface,e,m,null,l,null);a.hasFlag(h,a.Modifiers.Private)&&(e.varFlags|=a.VarFlags.Private);a.hasFlag(h,a.Modifiers.Public)&&(e.varFlags|=a.VarFlags.Public);if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Exported))e.varFlags|=a.VarFlags.Exported;e.leftCurlyCount=this.scanner.leftCurlyCount-c;e.rightCurlyCount=this.scanner.rightCurlyCount-f;return e};k.prototype.makeVarDecl=function(b,h){var c=new a.VarDecl(b,h),f=this.topVarList();f&&f.append(c);
return c};k.prototype.parsePropertyDecl=function(b,h,c,f){var e=null,l=this.scanner.startPos,n=l,m=!1,g=!1,d=null!=this.prevIDTok,k=a.hasFlag(h,a.Modifiers.Getter)||a.hasFlag(h,a.Modifiers.Setter);if(this.parsingDeclareFile||this.ambientModule||a.hasFlag(h,a.Modifiers.Ambient))c=!0;if(this.tok.tokenId==a.TokenID.LParen&&!d)!c&&!f&&(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery&&(this.skip(b),e=new a.MissingIdentifier));else if(this.tok.tokenId==a.TokenID.NEW)c&&
(this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen&&(m=!0)),m||(c||(this.tok=this.scanner.scan()),e=new a.Identifier("new"),e.minChar=this.scanner.pos-3,n=e.limChar=this.scanner.pos);else if(this.tok.tokenId==a.TokenID.LBrack&&c)g=!0,e=new a.Identifier("__item");else if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToIDName(this.tok)&&!d){if(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery)return h=this.scanner.startPos,f=this.scanner.pos,this.skip(b&
~a.ErrorRecoverySet.Comma),this.scanner.pos==f&&(this.tok=this.scanner.scan()),b=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),b.flags|=a.ASTFlags.Error,b.minChar=h,b.limChar=this.scanner.lastTokenLimChar(),b}else d?(e=new a.Identifier(this.prevIDTok.getText()),e.minChar=this.scanner.lastTokenLimChar()-3,e.limChar=this.scanner.lastTokenLimChar(),n=e.limChar,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.getText()==e.text&&this.tok!=this.prevIDTok&&(this.tok=this.scanner.scan()),this.prevIDTok=null):(e=new a.Identifier(this.tok.getText()),e.minChar=this.scanner.startPos,n=e.limChar=this.scanner.pos,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(this.inInterfaceDecl&&e?e.flags|=a.ASTFlags.OptionalName:this.reportParseError("Optional properties may only be declared on interface or object types"),this.tok=this.scanner.scan());if(this.tok.tokenId==a.TokenID.LParen||g&&this.tok.tokenId==
a.TokenID.LBrack){d=b|a.ErrorRecoverySet.RParen;g&&(d=b|a.ErrorRecoverySet.RBrack);b=this.parseFncDecl(d,!0,c,!this.inFncDecl,e,g,f,this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient),h,null);if(b.nodeType==a.NodeType.Error)return b;b.name&&(b.name.minChar=l,b.name.limChar=n);(h&a.Modifiers.Public)!=a.Modifiers.None&&(b.fncFlags|=a.FncFlags.Public);(h&a.Modifiers.Private)!=a.Modifiers.None&&(b.fncFlags|=a.FncFlags.Private);f&&(b.fncFlags|=a.FncFlags.Static);if(this.parsingDeclareFile||a.hasFlag(h,
a.Modifiers.Ambient))b.fncFlags|=a.FncFlags.Ambient;k&&(a.hasFlag(h,a.Modifiers.Getter)?(b.fncFlags|=a.FncFlags.GetAccessor,b.hint="get"+b.name.text):(b.fncFlags|=a.FncFlags.SetAccessor,b.hint="set"+b.name.text),b.fncFlags|=a.FncFlags.IsFunctionExpression,h&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient types"));null==e&&(m?(b.fncFlags|=a.FncFlags.ConstructMember,b.hint="_construct",b.classDecl=this.currentClassDecl):(b.hint="_call",b.fncFlags|=a.FncFlags.CallMember));
return b}e=new a.VarDecl(e,this.nestingLevel);e.minChar=l;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),e.typeExpr=this.parseTypeReference(b|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(c&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(b),e.flags|=a.ASTFlags.Error,e.limChar=this.scanner.lastTokenLimChar(),e;this.tok=this.scanner.scan();e.init=this.parseExpr(a.ErrorRecoverySet.Comma|
b,a.OperatorPrecedence.Cma,!0,j.NoTypes);e.limChar=e.init.limChar;e.init.nodeType==a.NodeType.FuncDecl?(b=e.init,b.hint=e.id.text,b.boundToProperty=e):k&&this.reportParseError("Accessors may only be functions")}else e.limChar=this.scanner.pos;(h&a.Modifiers.Readonly)!=a.Modifiers.None&&(e.varFlags|=a.VarFlags.Readonly);f&&(e.varFlags|=a.VarFlags.Static);(h&a.Modifiers.Public)!=a.Modifiers.None&&(e.varFlags|=a.VarFlags.Public);(h&a.Modifiers.Private)!=a.Modifiers.None&&(e.varFlags|=a.VarFlags.Private);
e.varFlags|=a.VarFlags.Property;return e};k.prototype.parseVarDecl=function(b,h,c,f,e){var l=a.hasFlag(h,a.Modifiers.Readonly),n=this.scanner.startPos;this.tok=this.scanner.scan();for(var m=null,g=null,d=!1,k=this.parseComments();;){if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)&&(this.reportParseError("Expected identifier in variable declaration"),this.errorRecovery))return m=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),m.minChar=n,this.skip(b),m.flags|=
a.ASTFlags.Error,m.limChar=this.scanner.lastTokenLimChar(),m;m=this.tok.getText();this.strictMode&&"eval"==m&&this.reportParseError("'eval' may not name a variable in strict mode");m=this.makeVarDecl(new a.Identifier(m),this.nestingLevel);m.id.minChar=this.scanner.startPos;m.id.limChar=this.scanner.pos;m.preComments=k;e&&(m.varFlags|=a.VarFlags.Static);a.hasFlag(h,a.Modifiers.Readonly)&&(m.varFlags|=a.VarFlags.Readonly);if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Ambient))m.varFlags|=a.VarFlags.Ambient;
if(this.parsingDeclareFile||a.hasFlag(h,a.Modifiers.Exported))m.varFlags|=a.VarFlags.Exported;m.minChar=n;g&&g.append(m);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),n=this.inFncDecl,this.inFncDecl=!1,m.typeExpr=this.parseTypeReference(b|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1),this.inFncDecl=n);if(this.tok.tokenId==a.TokenID.Asg){if(f&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(b),
m.flags|=a.ASTFlags.Error,m;this.tok=this.scanner.scan();m.init=this.parseExpr(a.ErrorRecoverySet.Comma|b,a.OperatorPrecedence.Cma,c,j.NoTypes);m.limChar=m.init.limChar;m.init.nodeType==a.NodeType.FuncDecl&&(m.init.hint=m.id.text)}else l&&this.reportParseError("const declaration requires initializer"),m.limChar=this.scanner.pos;m.postComments=this.parseCommentsForLine(this.scanner.line);if(this.tok.tokenId!=a.TokenID.Comma)return g?(g.limChar=m.limChar,g):m;d||(g=new a.ASTList,g.minChar=m.minChar,
g.append(m),d=!0);this.tok=this.scanner.scan();n=this.scanner.startPos}};k.prototype.parseMemberList=function(b){var h=new a.ASTList;if(this.tok.tokenId==a.TokenID.RCurly)return h;for(var c=null,f=null,e=null,l=null,g=this.scanner.startPos,m=!1,d=!1,e=null,k=0,s=0;;){var p=!1;this.tok.tokenId==a.TokenID.GET||this.tok.tokenId==a.TokenID.SET?(m=this.tok.tokenId==a.TokenID.SET,e=this.tok,k=this.scanner.startPos,s=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?
(c=m?"set":"get",c+=this.tok.getText(),f=new a.Identifier(this.tok.getText()),f.minChar=this.scanner.startPos,p=!0,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater")):this.tok.tokenId!=a.TokenID.Colon?this.reportParseError("Expected identifier, string or number as accessor name"):(d=!0,f=new a.Identifier(e.getText()),f.minChar=k,f.limChar=s)):this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(c=this.tok.getText(),
f=new a.Identifier(c),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.QString?(c=this.tok.getText(),f=new a.StringLiteral(c),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.NumberLit?(c=this.tok.value.toString(),f=new a.StringLiteral(c),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos):(this.reportParseError("Expected identifier, string or number as member name"),this.errorRecovery&&(f=new a.MissingIdentifier,
f.minChar=this.scanner.startPos,f.flags|=a.ASTFlags.Error,this.skip(b|a.ErrorRecoverySet.Comma),f.limChar=this.scanner.lastTokenLimChar()));d?d=!1:this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.QMark&&(f.flags|=a.ASTFlags.OptionalName,this.tok=this.scanner.scan());if(p)l=new a.ASTList,this.parseFormalParameterList(b|a.ErrorRecoverySet.RParen,l,!1,!0,!1,!m,m,null),e=this.parseFunctionStatements(b|a.ErrorRecoverySet.RCurly,f,!1,!0,l,a.AllowedElements.FunctionDecls,this.scanner.startPos,!1,
a.Modifiers.None),m&&e.returnTypeAnnotation&&this.reportParseError("Property setters may not declare a return type"),e.fncFlags|=m?a.FncFlags.SetAccessor:a.FncFlags.GetAccessor,e.fncFlags|=a.FncFlags.IsFunctionExpression,e.hint=c,l=new a.BinaryExpression(a.NodeType.Member,f,e),l.minChar=f.minChar,e.nodeType==a.NodeType.FuncDecl&&(e.hint=c);else if(this.tok.tokenId==a.TokenID.Colon)this.tok=this.scanner.scan(),e=this.parseExpr(a.ErrorRecoverySet.Comma|b,a.OperatorPrecedence.Cma,!0,j.NoTypes),e.nodeType==
a.NodeType.TypeRef&&this.reportParseError("Expected 'new' on array declaration in member definition"),l=new a.BinaryExpression(a.NodeType.Member,f,e),l.minChar=f.minChar,e.nodeType==a.NodeType.FuncDecl&&(e.hint=c);else if(this.reportParseError("Expected ':' in member definition"),this.errorRecovery)return this.skip(b),h.flags|=a.ASTFlags.Error,h.minChar=g,h.limChar=this.scanner.lastTokenLimChar(),h;c=null;h.append(l);l.limChar=this.scanner.lastTokenLimChar();if(this.tok.tokenId!=a.TokenID.Comma)break;
else this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RCurly)break}l&&(h.limChar=l.limChar);h.minChar=g;return h};k.prototype.parseArrayList=function(b){var h=null;if(this.tok.tokenId==a.TokenID.RBrack)return h;h=new a.ASTList;h.minChar=this.scanner.startPos;for(var c;;){c=this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RBrack?new a.AST(a.NodeType.EmptyExpr):this.parseExpr(a.ErrorRecoverySet.Comma|b,a.OperatorPrecedence.Cma,!0,j.NoTypes);h.append(c);if(this.tok.tokenId!=
a.TokenID.Comma)break;this.tok=this.scanner.scan()}h.limChar=this.scanner.lastTokenLimChar();return h};k.prototype.parseArrayLiteral=function(b){var h=null;return h=new a.UnaryExpression(a.NodeType.ArrayLit,this.parseArrayList(b))};k.prototype.parseTerm=function(b,h,c,f){var e=null,l=!1,g=!1,m=this.scanner.startPos,d=this.scanner.pos,k=!1;switch(this.tok.tokenId){case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:l=new a.Identifier(a.tokenTable[this.tok.tokenId].text);
e=a.hasFlag(c,j.Primitive)?new a.TypeReference(l,0):l;l=!0;e.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.THIS:e=new a.AST(a.NodeType.This);e.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.SUPER:e=new a.AST(a.NodeType.Super);e.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.TRUE:e=new a.AST(a.NodeType.True);this.tok=this.scanner.scan();e.minChar=m;break;case a.TokenID.FALSE:e=
new a.AST(a.NodeType.False);this.tok=this.scanner.scan();e.minChar=m;break;case a.TokenID.NULL:e=new a.AST(a.NodeType.Null);this.tok=this.scanner.scan();e.minChar=m;break;case a.TokenID.NEW:m=this.scanner.pos;this.tok=this.scanner.scan();e=new a.CallExpression(a.NodeType.New,this.parseTerm(b,!1,j.AllSimpleTypes,f),null);e.minChar=m;d=this.scanner.lastTokenLimChar();g=!0;break;case a.TokenID.FUNCTION:m=this.scanner.pos,e=this.parseFncDecl(b,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,null),e.fncFlags|=
a.FncFlags.IsFunctionExpression,e.minChar=m,d=this.scanner.lastTokenLimChar(),e.limChar=d}if(null==e&&(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))l=this.tok.getText(),e=this.createRef(l,m),l=!0,e.minChar=m,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.QMark?e.flags|=a.ASTFlags.PossibleOptionalParameter:this.tok.tokenId==a.TokenID.Arrow&&(k=!0),d=this.scanner.lastTokenLimChar();f&&this.chkCurTok(a.TokenID.GT,"Expected '>'",b);if(null==e)switch(this.tok.tokenId){case a.TokenID.LParen:m=
this.scanner.pos;k=this.scanner.previousToken().tokenId;this.tok=this.scanner.scan();(k=k==a.TokenID.LParen||k==a.TokenID.Comma||k==a.TokenID.EQ||k==a.TokenID.Colon)&&this.tok.tokenId==a.TokenID.RParen?(k=!0,this.tok=this.scanner.scan()):(e=this.parseExpr(b|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes),d=this.scanner.lastTokenLimChar(),k=k&&(e.nodeType==a.NodeType.Name||e.nodeType==a.NodeType.Comma)&&(this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.QMark));e&&!k&&
(this.chkCurTok(a.TokenID.RParen,"Expected ')'",b),e.isParenthesized=!0);break;case a.TokenID.NumberLit:d=this.tok;this.tok=this.scanner.scan();e=new a.NumberLiteral(d.value);e.minChar=m;d=this.scanner.lastTokenLimChar();break;case a.TokenID.QString:e=new a.StringLiteral(this.tok.getText());this.tok=this.scanner.scan();e.minChar=m;d=this.scanner.lastTokenLimChar();break;case a.TokenID.Regex:e=new a.RegexLiteral(this.tok.regex);this.tok=this.scanner.scan();e.minChar=m;d=this.scanner.lastTokenLimChar();
break;case a.TokenID.LBrack:m=this.scanner.startPos;this.tok=this.scanner.scan();e=this.parseArrayLiteral(a.ErrorRecoverySet.RBrack|b);e.minChar=m;d=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,"Expected ']'",b);break;case a.TokenID.LCurly:m=this.scanner.startPos;this.tok=this.scanner.scan();f=this.parseMemberList(a.ErrorRecoverySet.RCurly|b);this.chkCurTok(a.TokenID.RCurly,"Expected '}'",b);e=new a.UnaryExpression(a.NodeType.ObjectLit,f);e.minChar=m;d=this.scanner.lastTokenLimChar();f.minChar=
m;f.limChar=d;break;case a.TokenID.LT:m=this.scanner.startPos;this.tok=this.scanner.scan();f=this.parseTypeReference(a.ErrorRecoverySet.BinOp,!1);this.chkCurTok(a.TokenID.GT,"Expected '>'",b);e=new a.UnaryExpression(a.NodeType.TypeAssertion,this.parseExpr(b,a.OperatorPrecedence.Uni,!1,j.NoTypes));e.castTerm=f;break;default:if(this.prevExpr&&a.hasFlag(this.prevExpr.flags,a.ASTFlags.PossibleOptionalParameter))k=!0,e=this.prevExpr;else if(this.reportParseError("Check format of expression term"),this.errorRecovery){e=
new a.MissingIdentifier;e.minChar=m;e.flags|=a.ASTFlags.Error;this.skip(b|a.ErrorRecoverySet.Postfix);if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))e.text=this.tok.getText(),this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar()}}k&&(this.tok.tokenId==a.TokenID.Arrow||this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RParen?(e=this.parseFncDecl(b,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:e}),
e.fncFlags|=a.FncFlags.IsFunctionExpression,e.fncFlags|=a.FncFlags.IsFatArrowFunction,e.minChar=m,d=this.scanner.lastTokenLimChar(),e.limChar=d):e&&(e.isParenthesized=!0));l&&c!=j.NoTypes&&(c|=j.ArraySuffix);return(b=this.parsePostfixOperators(b,e,h,g,c,m,d))?(l&&b.nodeType==a.NodeType.Index&&null==b.operand2&&(b=this.convertToTypeReference(b)),b.minChar=m,b.limChar=a.max(b.limChar,this.scanner.lastTokenLimChar()),b):new a.AST(a.NodeType.Error)};k.prototype.parseExpr=function(b,h,c,f){var e=null,
l=a.lookupToken(this.tok.tokenId),g=!0,m=null,d=this.scanner.startPos,k=this.parseComments(),s=!1;if(void 0!=l&&l.unopNodeType!=a.NodeType.None)g=!1,this.tok=this.scanner.scan(),f=this.parseExpr(a.ErrorRecoverySet.BinOp|b,l.unopPrecedence,c,j.NoTypes),l.unopNodeType==a.NodeType.Pos&&f.nodeType==a.NodeType.NumberLit?e=f:l.unopNodeType==a.NodeType.Neg&&f.nodeType==a.NodeType.NumberLit?(f.value=-f.value,0==f.value&&(f.isNegativeZero=!0),e=f):(e=new a.UnaryExpression(l.unopNodeType,f),e.limChar=f.limChar),
e.minChar=d;else{e=this.parseTerm(a.ErrorRecoverySet.BinOp|a.ErrorRecoverySet.AddOp|b,!0,f,!1);if(e.nodeType==a.NodeType.Name)m=e.text;else if(e.nodeType==a.NodeType.Dot){l=!1;if(this.inferPropertiesFromThisAssignment&&((this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Asg)&&this.parsingClassConstructorDefinition&&this.nestingLevel==this.currentClassDefinition.constructorNestingLevel&&e.operand1.nodeType==a.NodeType.This)&&e.operand2.nodeType==a.NodeType.Name)f=e.operand2,this.currentClassDefinition.knownMemberNames[f.text]||
(e=this.parseClassMemberVariableDeclaration(f,e.minChar,!0,b,a.Modifiers.Public),l=!0);if(!l){for(l=e;l.nodeType==a.NodeType.Dot;)l=l.operand2;l.nodeType==a.NodeType.Name&&(m=l.text)}}if(!this.scanner.lastTokenHadNewline()&&(this.tok.tokenId==a.TokenID.Inc||this.tok.tokenId==a.TokenID.Dec))g=!1,l=e,e=new a.UnaryExpression(this.tok.tokenId==a.TokenID.Inc?a.NodeType.IncPost:a.NodeType.DecPost,l),e.limChar=this.scanner.pos,e.minChar=l.minChar,this.tok=this.scanner.scan()}for(;;){l=a.lookupToken(this.tok.tokenId);
if(void 0==l||l.binopNodeType==a.NodeType.None)break;if(!c&&l.binopNodeType==a.NodeType.In)break;if(l.binopPrecedence==a.OperatorPrecedence.Asg){if(l.binopPrecedence<h)break;g||this.reportParseError("illegal assignment")}else if(l.binopPrecedence<=h)break;this.tok=this.scanner.scan();g=!1;l.binopNodeType==a.NodeType.QMark?(this.prevExpr=e,l=this.parseExpr(b|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.Asg,c,j.NoTypes),this.prevExpr=null,l.nodeType==a.NodeType.FuncDecl&&a.hasFlag(l.fncFlags,a.FncFlags.IsFatArrowFunction)?
(e=l,s=!0):(this.chkCurTok(a.TokenID.Colon,"Expected :",b|a.ErrorRecoverySet.ExprStart),e=new a.TrinaryExpression(a.NodeType.QMark,e,l,this.parseExpr(b|a.ErrorRecoverySet.BinOp,a.OperatorPrecedence.Asg,c,j.NoTypes)))):(l=new a.BinaryExpression(l.binopNodeType,e,this.parseExpr(b|a.ErrorRecoverySet.BinOp,l.binopPrecedence,c,j.NoTypes)),l.operand2.nodeType==a.NodeType.FuncDecl&&(l.operand2.hint=m),l.minChar=e.minChar,l.limChar=this.scanner.lastTokenLimChar(),m=null,e=l)}g&&(e.flags|=a.ASTFlags.Writeable);
s||(e.minChar=d,e.limChar=a.max(e.limChar,this.scanner.lastTokenLimChar()),e.preComments=k,e.postComments=this.parseCommentsForLine(this.scanner.line));return e};k.prototype.parsePostfixOperators=function(b,h,c,f,e,l,g){h||(h=new a.AST(a.NodeType.EmptyExpr),h.isParenthesized=!0);h.minChar=l;for(h.limChar=g;;)switch(this.tok.tokenId){case a.TokenID.LParen:if(f)h.args=this.parseArgList(b),f=!1;else{if(!c)return h;h=new a.CallExpression(a.NodeType.Call,h,this.parseArgList(b));h.minChar=l}h.limChar=this.scanner.pos;
this.chkCurTok(a.TokenID.RParen,"Expected ')'",b);break;case a.TokenID.LBrack:this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RBrack&&a.hasFlag(e,j.ArraySuffix)){this.tok=this.scanner.scan();h.nodeType==a.NodeType.TypeRef?h.arrayCount++:h=new a.BinaryExpression(a.NodeType.Index,h,null);h.limChar=this.scanner.pos;break}h=new a.BinaryExpression(a.NodeType.Index,h,this.parseExpr(b|a.ErrorRecoverySet.RBrack,a.OperatorPrecedence.No,!0,j.NoTypes));h.minChar=l;h.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,
"Expected ']'",b);break;case a.TokenID.Dot:g=null;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||(!this.errorRecovery||!this.scanner.lastTokenHadNewline())&&a.convertTokToIDName(this.tok))h.flags|=a.ASTFlags.DotLHS,g=this.createRef(this.tok.getText(),this.scanner.startPos),g.limChar=this.scanner.pos,this.tok=this.scanner.scan();else{this.reportParseError("Expected identifier following dot");if(this.errorRecovery)return this.skip(b),h.flags|=a.ASTFlags.Error|a.ASTFlags.DotLHS,h;g=
new a.MissingIdentifier}h=new a.BinaryExpression(a.NodeType.Dot,h,g);h.minChar=l;h.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.Arrow:h=this.parseFncDecl(b,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:h});h.fncFlags|=a.FncFlags.IsFunctionExpression;h.minChar=l;h.limChar=this.scanner.lastTokenLimChar();break;default:return h}};k.prototype.parseTry=function(b,h,c,f){var e=this.scanner.startPos,l=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=
a.TokenID.LCurly&&(this.reportParseError("Expected '{'"),this.errorRecovery))return b.minChar=e,b.limChar=this.scanner.lastTokenLimChar(),b.flags|=a.ASTFlags.Error,b;b.body=this.parseStatement(h,c,f);b.minChar=e;b.limChar=b.body.limChar;b.preComments=l;b.postComments=this.parseComments();return b};k.prototype.parseCatch=function(b,h,c){var f=this.scanner.startPos,e=this.parseComments();this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.LParen,"Expected '('",b|a.ErrorRecoverySet.ExprStart);if(this.tok.tokenId!=
a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))if(this.reportParseError("Expected identifier in catch header"),this.errorRecovery)return this.skip(b),f=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,f.flags|=a.ASTFlags.Error,f;var l=new a.VarDecl(new a.Identifier(this.tok.getText()),this.nestingLevel);l.id.minChar=this.scanner.startPos;l.id.limChar=this.scanner.pos;l.minChar=
l.id.minChar;l.limChar=l.id.limChar;this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.RParen,"Expected ')'",b|a.ErrorRecoverySet.StmtStart);if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start catch body"),this.errorRecovery))return this.skip(b),f=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,f.flags|=a.ASTFlags.Error,f;b=this.parseStatement(b,h,
c);l=new a.Catch(l,b);l.minChar=f;l.limChar=b.limChar;l.preComments=e;l.postComments=this.parseComments();return l};k.prototype.parseFinally=function(b,h,c){var f=this.scanner.startPos,e=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start body of finally statement"),this.errorRecovery))return this.skip(b),f=new a.Finally(new a.Statement(a.NodeType.Empty)),f.flags|=a.ASTFlags.Error,f.minChar=this.scanner.startPos,f.limChar=
this.scanner.pos,f;b=this.parseStatement(b,h,c);b=new a.Finally(b);b.minChar=f;b.limChar=b.body.limChar;b.preComments=e;b.postComments=this.parseComments();return b};k.prototype.parseTryCatchFinally=function(b,h,c,f){var e=new a.Try(null),l=this.scanner.startPos;this.pushStmt(e,f);this.parseTry(e,b|a.ErrorRecoverySet.Catch,h,c);this.popStmt();var g=f=null;this.tok.tokenId==a.TokenID.CATCH&&(g=this.parseCatch(b|a.ErrorRecoverySet.Catch,h,c),f=new a.TryCatch(e,g),f.minChar=e.minChar,f.limChar=g.limChar);
if(this.tok.tokenId!=a.TokenID.FINALLY)return null==f?(this.reportParseError("try with neither catch nor finally"),this.errorRecovery?(e=new a.TryFinally(e,new a.Finally(new a.AST(a.NodeType.Empty))),e.flags|=a.ASTFlags.Error,e.minChar=this.scanner.startPos,e.limChar=this.scanner.pos,e):new a.TryFinally(e,new a.Finally(new a.AST(a.NodeType.Empty)))):f;f&&(e=f);b=this.parseFinally(b,h,c);g=new a.TryFinally(e,b);g.minChar=l;g.limChar=b.limChar;return g};k.prototype.parseStatement=function(i,h,c){function f(){return a.hasFlag(d,
a.Modifiers.Ambient)||a.hasFlag(c,a.Modifiers.Ambient)}function e(){a.hasFlag(d,a.Modifiers.Exported)&&this.reportError("Statement may not be exported")}var l=null,g=null,m,d=a.Modifiers.None,k=this.scanner.startPos,s=!1,p=!1;m=null;var q=this.parseComments();for(this.state=b.StartStatement;;){switch(this.tok.tokenId){case a.TokenID.EOF:l=new a.AST(a.NodeType.Error);l.minChar=k;l.limChar=this.scanner.pos;break;case a.TokenID.FUNCTION:this.inStaticFnc&&this.reportParseError("Ambient static function delarations may only contain other ambient static function declarations");
if(this.parsingDeclareFile||f()||this.ambientModule){this.tok=this.scanner.scan();m=this.parsePropertyDecl(i|a.ErrorRecoverySet.SColon,d,!0,!1);if(m.nodeType==a.NodeType.VarDecl)this.reportParseError("function keyword can only introduce function declaration");else if(m.nodeType==a.NodeType.FuncDecl&&(m.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;l=m}else l=this.parseFncDecl(i,!0,!1,!1,null,!1,!1,f(),d,null),a.hasFlag(l.fncFlags,a.FncFlags.IsFatArrowFunction)&&(p=!0),this.ambientModule&&this.reportParseError("function declaration not permitted within ambient module"),
a.hasFlag(d,a.Modifiers.Exported)&&(l.fncFlags|=a.FncFlags.Exported);break;case a.TokenID.MODULE:(h&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):l=this.parseModuleDecl(i,d);break;case a.TokenID.IMPORT:(h&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),
this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):(l=this.parseImportDecl(i,d),p=!0);break;case a.TokenID.EXPORT:(h&a.AllowedElements.ModuleDecls)==a.AllowedElements.None&&(this.reportParseError("'export' statements are only allowed at the global and module levels"),this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar());this.topLevel&&(this.hasTopLevelImportOrExport=!0);d|=a.Modifiers.Exported;
this.tok=this.scanner.scan();break;case a.TokenID.PRIVATE:d|=a.Modifiers.Private;this.tok=this.scanner.scan();if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),k=this.scanner.pos,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=
this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),l=new a.Identifier(this.tok.getText()),l.minChar=this.scanner.startPos,l.limChar=this.scanner.pos,this.tok=this.scanner.scan(),l=this.parseClassMemberVariableDeclaration(l,k,this.parsingClassConstructorDefinition,i,d));else if(this.tok.tokenId!=a.TokenID.INTERFACE){if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<
a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))d|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)))d|=a.Modifiers.Setter,this.prevIDTok=null;m=this.parsePropertyDecl(i|a.ErrorRecoverySet.SColon,d,f(),!1);if(m.nodeType==a.NodeType.VarDecl||m.nodeType==a.NodeType.FuncDecl&&a.hasFlag(m.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;l=m}break;case a.TokenID.PUBLIC:if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),this.tok=this.scanner.scan(),k=this.scanner.pos,
d|=a.Modifiers.Public,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),l=new a.Identifier(this.tok.getText()),l.minChar=this.scanner.startPos,l.limChar=this.scanner.pos,this.tok=this.scanner.scan(),l=this.parseClassMemberVariableDeclaration(l,
k,this.parsingClassConstructorDefinition,i,d));else if((h&a.AllowedElements.Properties)==a.AllowedElements.None)this.reportParseError("'property' statements are only allowed within classes"),this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar();else{d|=a.Modifiers.Public;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))d|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))d|=a.Modifiers.Setter,this.prevIDTok=null;m=this.parsePropertyDecl(i|a.ErrorRecoverySet.SColon,
d,f(),!1);if(m.nodeType==a.NodeType.VarDecl||m.nodeType==a.NodeType.FuncDecl&&a.hasFlag(m.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;l=m}break;case a.TokenID.DECLARE:h&a.AllowedElements.AmbientDecls||this.reportParseError("Ambient declarations are only allowed at the top-level or module scopes");!this.parsingDeclareFile&&a.hasFlag(c,a.Modifiers.Ambient)&&this.reportParseError("Duplicate ambient declaration in this context. (Is the enclosing module or class already ambient?)");d|=a.Modifiers.Ambient;
this.tok=this.scanner.scan();break;case a.TokenID.CLASS:(h&a.AllowedElements.ClassDecls)==a.AllowedElements.None?(this.reportParseError("class not allowed in this context"),this.tok=this.scanner.scan(),l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):l=this.parseClassDecl(i,k,d);break;case a.TokenID.INTERFACE:(h&a.AllowedElements.InterfaceDecls)==a.AllowedElements.None?(this.reportParseError("interface not allowed in this context"),this.tok=this.scanner.scan(),
l=new a.AST(a.NodeType.Error),l.minChar=k,l.limChar=this.scanner.lastTokenLimChar()):l=this.parseInterfaceDecl(i,d);break;case a.TokenID.VAR:p=this.parseVarDecl(i|a.ErrorRecoverySet.StmtStart,d,!0,!1,!1);l=p.nodeType==a.NodeType.VarDecl?p:new a.Block(p,!1);p=!0;if(this.parsingDeclareFile||this.ambientModule&&l.nodeType==a.NodeType.VarDecl)l.varFlags|=a.VarFlags.Exported;break;case a.TokenID.STATIC:null==this.currentClassDecl&&this.reportParseError("Statics may only be class members");e();d|=a.Modifiers.Public;
this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))d|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))d|=a.Modifiers.Setter;f()&&(d|=a.Modifiers.Ambient);m=this.parsePropertyDecl(i|a.ErrorRecoverySet.SColon,d,this.parsingDeclareFile||(d&a.Modifiers.Ambient)!=a.Modifiers.None,!0);(l=this.topStaticsList())&&m.nodeType==a.NodeType.VarDecl&&l.append(m);if(m.nodeType==a.NodeType.VarDecl||m.nodeType==a.NodeType.FuncDecl&&a.hasFlag(m.fncFlags,a.FncFlags.IsFatArrowFunction))p=!0;l=m;break;case a.TokenID.FOR:e();d!=a.Modifiers.None&&
this.reportParseError("syntax error: for statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",i|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);this.state=b.ForInit;s=!0;switch(this.tok.tokenId){case a.TokenID.VAR:m=this.parseVarDecl(i|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,a.Modifiers.None,!1,!1,!1);break;case a.TokenID.SColon:m=null;this.state=b.ForCondStart;break;default:m=this.parseExpr(i|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,
a.OperatorPrecedence.No,!1,j.NoTypes)}this.state=b.ForInitAfterVar;this.tok.tokenId==a.TokenID.IN?null==m||!s?(this.reportParseError("malformed for statement"),this.errorRecovery&&(this.skip(i|a.ErrorRecoverySet.StmtStart),l=new a.AST(a.NodeType.Empty),l.flags|=a.ASTFlags.Error)):(this.tok=this.scanner.scan(),l=new a.ForInStatement(m,this.parseExpr(a.ErrorRecoverySet.RParen|i,a.OperatorPrecedence.Cma,!1,j.NoTypes)),l.limChar=this.scanner.pos,this.chkCurTok(a.TokenID.RParen,"Expected ')'",a.ErrorRecoverySet.StmtStart|
i),this.pushStmt(l,g),l.body=this.parseStatement(i,h,c),this.popStmt(),l.minChar=k):(m=new a.ForStatement(m),m.minChar=k,this.chkCurTok(a.TokenID.SColon,"Expected ';'",i),this.tok.tokenId==a.TokenID.SColon?m.cond=null:(m.cond=this.parseExpr(i|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes),this.tok.tokenId!=a.TokenID.SColon&&(this.skip(i|a.ErrorRecoverySet.StmtStart),l=m,l.flags|=a.ASTFlags.Error)),this.tok=this.scanner.scan(),m.incr=this.tok.tokenId==a.TokenID.RParen?
null:this.parseExpr(i|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes),this.chkCurTok(a.TokenID.RParen,"Expected ')'",i|a.ErrorRecoverySet.LCurly),this.pushStmt(m,g),m.body=this.parseStatement(i,h,c),this.popStmt(),m.limChar=m.body.limChar,l=m);break;case a.TokenID.WITH:a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("'with' statements are only available in ES5 codegen mode or better");this.strictMode&&this.reportParseError("'with' statements are not available in strict mode");
e();d!=a.Modifiers.None&&this.reportParseError("'with' statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",i|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);l=this.parseExpr(i|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,j.NoTypes);this.chkCurTok(a.TokenID.RParen,"Expected ')'",i|a.ErrorRecoverySet.LCurly);l=new a.WithStatement(l);l.body=this.parseStatement(i,h,c);l.minChar=k;l.limChar=l.body.limChar;break;case a.TokenID.SWITCH:e();
d!=a.Modifiers.None&&this.reportParseError("'switch' statement does not take modifiers");this.chkNxtTok(a.TokenID.LParen,"Expected '('",i|a.ErrorRecoverySet.ExprStart);l=new a.SwitchStatement(this.parseExpr(i|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes));this.chkCurTok(a.TokenID.RParen,"Expected ')'",i|a.ErrorRecoverySet.LCurly);m=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",i|a.ErrorRecoverySet.SCase);l.defaultCase=null;l.caseList=new a.ASTList;s=null;for(this.pushStmt(l,
g);;)if(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT){var t=this.tok.tokenId==a.TokenID.DEFAULT,s=new a.CaseStatement;s.minChar=this.scanner.startPos;this.tok=this.scanner.scan();t?l.defaultCase=s:s.expr=this.parseExpr(i|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,j.NoTypes);this.chkCurTok(a.TokenID.Colon,"Expected ':'",i|a.ErrorRecoverySet.StmtStart);s.body=new a.ASTList;this.parseStmtList(i|a.ErrorRecoverySet.RCurly,s.body,!1,!0,h,d);s.limChar=s.body.limChar;l.caseList.append(s)}else break;
l.caseList.minChar=m;l.caseList.limChar=this.scanner.pos;l.limChar=l.caseList.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",i);this.popStmt();break;case a.TokenID.WHILE:e();d!=a.Modifiers.None&&this.reportParseError("'while' statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",a.ErrorRecoverySet.ExprStart|i);l=new a.WhileStatement(this.parseExpr(i|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes));l.minChar=k;this.chkCurTok(a.TokenID.RParen,
"Expected ')'",i|a.ErrorRecoverySet.StmtStart);this.pushStmt(l,g);l.body=this.parseStatement(i,h,c);l.limChar=l.body.limChar;this.popStmt();break;case a.TokenID.DO:e();d!=a.Modifiers.None&&this.reportParseError("'do' statement does not take modifiers");k=this.scanner.startPos;this.tok=this.scanner.scan();l=new a.DoWhileStatement;l.minChar=k;this.pushStmt(l,g);l.body=this.parseStatement(i|a.ErrorRecoverySet.While,h,c);this.popStmt();l.whileAST=new a.Identifier("while");l.whileAST.minChar=this.scanner.startPos;
this.chkCurTok(a.TokenID.WHILE,"Expected 'while'",i|a.ErrorRecoverySet.LParen);l.whileAST.limChar=l.whileAST.minChar+5;this.chkCurTok(a.TokenID.LParen,"Expected '('",i|a.ErrorRecoverySet.ExprStart);l.cond=this.parseExpr(i|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,j.NoTypes);l.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",i);this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan());break;case a.TokenID.IF:e();d!=a.Modifiers.None&&this.reportParseError("if statement does not take modifiers");
k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",i|a.ErrorRecoverySet.ExprStart);l=new a.IfStatement(this.parseExpr(i|a.ErrorRecoverySet.LParen,a.OperatorPrecedence.No,!0,j.NoTypes));l.minChar=k;this.chkCurTok(a.TokenID.RParen,"Expected ')'",i|a.ErrorRecoverySet.StmtStart);this.pushStmt(l,g);l.thenBod=this.parseStatement(a.ErrorRecoverySet.Else|i,h,c);l.limChar=l.thenBod.limChar;this.tok.tokenId==a.TokenID.ELSE&&(this.tok=this.scanner.scan(),l.elseBod=this.parseStatement(i,h,
c),l.limChar=l.elseBod.limChar);this.popStmt();break;case a.TokenID.TRY:e();d!=a.Modifiers.None&&this.reportParseError("try statement does not take modifiers");k=this.scanner.startPos;l=this.parseTryCatchFinally(i,a.AllowedElements.FunctionBody,c,g);break;case a.TokenID.LCurly:e();d!=a.Modifiers.None&&this.reportParseError("block does not take modifiers");k=this.scanner.startPos;this.tok=this.scanner.scan();l=new a.Block(new a.ASTList,!0);this.pushStmt(l,g);this.parseStmtList(i|a.ErrorRecoverySet.RCurly,
l.stmts,!1,!1,a.AllowedElements.Block,d);this.popStmt();l.stmts.minChar=k;l.stmts.limChar=this.scanner.pos;l.minChar=l.stmts.minChar;l.limChar=l.stmts.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",i);break;case a.TokenID.SColon:e();d!=a.Modifiers.None&&this.reportParseError("modifier can not appear here");l=new a.AST(a.NodeType.Empty);this.tok=this.scanner.scan();break;case a.TokenID.BREAK:case a.TokenID.CONTINUE:e();d!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before jump statement");
p=new a.Jump(this.tok.tokenId==a.TokenID.BREAK?a.NodeType.Break:a.NodeType.Continue);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID&&!this.scanner.lastTokenHadNewline()&&(p.target=this.tok.getText(),this.tok=this.scanner.scan());this.resolveJumpTarget(p);l=p;p=!0;break;case a.TokenID.RETURN:e();d!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before return statement");this.inFnc||this.reportParseError("return statement outside of function body");k=this.scanner.startPos;
this.tok=this.scanner.scan();l=new a.ReturnStatement;l.minChar=k;this.tok.tokenId!=a.TokenID.SColon&&(this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline())&&(l.returnExpression=this.parseExpr(i|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,j.NoTypes));p=!0;l.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.THROW:e();d!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before a throw statement");k=this.scanner.startPos;this.tok=this.scanner.scan();
this.tok.tokenId!=a.TokenID.SColon&&this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline()?m=this.parseExpr(i|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,j.NoTypes):(this.reportParseError("throw with no target"),m=null);l=new a.UnaryExpression(a.NodeType.Throw,m);l.limChar=this.scanner.lastTokenLimChar();p=!0;break;case a.TokenID.ENUM:this.tok=this.scanner.scan();l=this.parseEnumDecl(i,d);l.minChar=k;l.limChar=this.scanner.lastTokenLimChar();if(this.parsingDeclareFile||a.hasFlag(d,
a.Modifiers.Ambient))l.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(d,a.Modifiers.Exported)&&(l.modFlags|=a.ModuleFlags.Exported);break;case a.TokenID.DEBUGGER:e();d!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before debugger statement");k=this.scanner.startPos;this.tok=this.scanner.scan();l=new a.DebuggerStatement;l.minChar=k;p=!0;l.limChar=this.scanner.lastTokenLimChar();break;default:d!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before an expression statement or label"),
k=this.scanner.startPos,s=this.scanner.pos,m=this.parseExpr(a.ErrorRecoverySet.Colon|a.ErrorRecoverySet.StmtStart|i,a.OperatorPrecedence.No,!0,j.NoTypes),this.scanner.pos==s?(this.tok=this.scanner.scan(),l=m):this.tok.tokenId==a.TokenID.Colon&&!this.scanner.lastTokenHadNewline()&&m&&m.nodeType==a.NodeType.Name?(null==g&&(g=new a.ASTList),g.append(new a.Label(m)),this.tok=this.scanner.scan()):(l=m,p=!0)}if(l)break}if(p)switch(this.tok.tokenId){case a.TokenID.SColon:this.tok=this.scanner.scan();l.flags|=
a.ASTFlags.ExplicitSemicolon;break;case a.TokenID.EOF:l.limChar=this.scanner.pos;case a.TokenID.RCurly:l.flags|=a.ASTFlags.AutomaticSemicolon;this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon");break;default:this.scanner.lastTokenHadNewline()?(l.flags|=a.ASTFlags.AutomaticSemicolon,this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon")):this.reportParseError("Expected ';'")}g&&(l=new a.LabeledStatement(g,l));l.minChar=k;l.limChar=a.max(l.limChar,this.scanner.lastTokenLimChar());
l.preComments=q;this.ambientModule&&!this.okAmbientModuleMember(l)&&this.reportParseError("statement not permitted within ambient module");l.flags|=a.ASTFlags.IsStatement;return l};k.prototype.okAmbientModuleMember=function(b){var h=b.nodeType;return h==a.NodeType.Class||h==a.NodeType.Import||h==a.NodeType.Interface||h==a.NodeType.Module||h==a.NodeType.Empty||h==a.NodeType.VarDecl&&(a.hasFlag(b.varFlags,a.VarFlags.Property)||a.hasFlag(b.varFlags,a.VarFlags.Exported))||h==a.NodeType.FuncDecl&&b.isMethod()};
k.prototype.parseStmtList=function(i,h,c,f,e,l){h.minChar=this.scanner.startPos;var d=this.scanner.pos,m=(e&a.AllowedElements.ModuleDecls)==a.AllowedElements.None,g=(e&a.AllowedElements.ClassDecls)==a.AllowedElements.None,i=i|a.ErrorRecoverySet.TypeScriptS|a.ErrorRecoverySet.RCurly;this.state=b.StartStmtList;var k=this.strictMode;for(this.nestingLevel++;;){if(this.tok.tokenId==a.TokenID.RCurly||f&&(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT)||m&&this.tok.tokenId==a.TokenID.EXPORT||
g&&this.tok.tokenId==a.TokenID.CLASS||this.tok.tokenId==a.TokenID.EOF){this.state=b.EndStmtList;h.limChar=d;0==h.members.length?h.preComments=this.parseComments():h.postComments=this.parseComments();this.strictMode=k;this.nestingLevel--;break}var j=this.parseStatement(i&~(a.ErrorRecoverySet.Else|a.ErrorRecoverySet.RParen|a.ErrorRecoverySet.Catch|a.ErrorRecoverySet.Colon),e,l);j&&(j.postComments=this.combineComments(j.postComments,this.parseCommentsForLine(this.scanner.prevLine)),h.append(j),d=j.limChar,
c&&(j.nodeType==a.NodeType.QString?"use strict"==j.text?(h.flags|=a.ASTFlags.StrictMode,this.strictMode=!0):c=!1:c=!1))}};k.prototype.quickParse=function(b,h,c){var f=a.moduleGenTarget;try{a.moduleGenTarget=a.ModuleGenTarget.Local;var e=this.parse(b,h,c,a.AllowedElements.QuickParse);return new g(e,this.scanner.lexState)}finally{a.moduleGenTarget=f}};k.prototype.parse=function(i,h,c,f){"undefined"===typeof f&&(f=a.AllowedElements.Global);var e=this;this.ambientModule=!1;this.topLevel=!0;this.hasTopLevelImportOrExport=
this.parseError=!1;this.fname=h;this.currentUnitIndex=c;this.amdDependencies=[];this.scanner.resetComments();this.scanner.setErrorHandler(function(a){return e.reportParseError(a)});this.scanner.setSourceText(i,a.LexMode.File);var i=this.scanner.leftCurlyCount,l=this.scanner.rightCurlyCount,d=this.scanner.pos;this.tok=this.scanner.scan();this.pushDeclLists();var m=new a.ASTList;m.minChar=d;this.state=b.StartScript;this.parsingDeclareFile=a.isDSTRFile(h)||a.isDTSFile(h);this.parseStmtList(a.ErrorRecoverySet.EOF|
a.ErrorRecoverySet.Func,m,!0,!1,f,a.Modifiers.None);this.tok.tokenId!=a.TokenID.EOF&&this.reportParseError("Unexpected statement block terminator '"+a.tokenTable[this.tok.tokenId].text+"'");this.state=b.EndScript;m.limChar=this.scanner.pos;f=null;if(a.moduleGenTarget!=a.ModuleGenTarget.Local&&this.hasTopLevelImportOrExport){var g=a.switchToForwardSlashes(h),f=new a.Identifier(g),f=new a.ModuleDecl(f,m,this.topVarList(),this.topScopeList());f.modFlags|=a.ModuleFlags.IsDynamic;f.modFlags|=a.ModuleFlags.IsWholeFile;
f.modFlags|=a.ModuleFlags.Exported;this.parsingDeclareFile&&(f.modFlags|=a.ModuleFlags.Ambient);f.minChar=d;f.limChar=this.scanner.pos;f.prettyName=a.getPrettyName(g);f.amdDependencies=this.amdDependencies;m=new a.ASTList;m.minChar=f.minChar;m.limChar=f.limChar;m.append(f)}g=new a.Script(this.topVarList(),this.topScopeList());g.bod=m;this.popDeclLists();g.minChar=d;g.limChar=this.scanner.pos;g.locationInfo=new a.LocationInfo(h,this.scanner.lineMap,c);g.leftCurlyCount=this.scanner.leftCurlyCount-i;
g.rightCurlyCount=this.scanner.rightCurlyCount-l;g.isDeclareFile=this.parsingDeclareFile;g.topLevelMod=f;return g};a.Parser=k;a.quickParse=function(b,h,c,f,e,l){h=c.getText(f,e);b.log("Quick parse range ("+f+","+e+'): "'+a.stringToLiteral(h,100)+'"');b=new k;b.setErrorRecovery(null,-1,-1);b.errorCallback=l;l=new a.TypeDecl(a.NodeType.Class,null,null,null,null,null);b.currentClassDecl=l;return b.quickParse(new a.StringSourceText(h),"",0)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(a,b){this.outfile=a;this.parser=b;this.builder="";this.indent1="  ";this.indentStrings=[];this.indentAmt=0};d.prototype.increaseIndent=function(){this.indentAmt++};d.prototype.decreaseIndent=function(){this.indentAmt--};d.prototype.startLine=function(){0<this.builder.length&&a.CompilerDiagnostics.Alert(this.builder);var d=this.indentStrings[this.indentAmt];if(void 0===d){for(var d="",b=0;b<this.indentAmt;b++)d+=this.indent1;this.indentStrings[this.indentAmt]=d}this.builder+=
d};d.prototype.write=function(a){this.builder+=a};d.prototype.writeLine=function(a){this.builder+=a;this.outfile.WriteLine(this.builder);this.builder=""};a.PrintContext=d;a.prePrintAST=function(a,b,d){b=d.state;a.print(b);b.increaseIndent();return a};a.postPrintAST=function(a,b,d){d.state.decreaseIndent();return a}})(TypeScript||(TypeScript={}));
(function(a){function d(){a.initializeStaticTokens();h[a.LexCodeLPR]=a.staticTokens[a.TokenID.LParen];h[a.LexCodeRPR]=a.staticTokens[a.TokenID.RParen];h[a.LexCodeCMA]=a.staticTokens[a.TokenID.Comma];h[a.LexCodeSMC]=a.staticTokens[a.TokenID.SColon];h[a.LexCodeLBR]=a.staticTokens[a.TokenID.LBrack];h[a.LexCodeRBR]=a.staticTokens[a.TokenID.RBrack];h[a.LexCodeTIL]=a.staticTokens[a.TokenID.Tilde];h[a.LexCodeQUE]=a.staticTokens[a.TokenID.QMark];h[a.LexCodeLC]=a.staticTokens[a.TokenID.LCurly];h[a.LexCodeRC]=
a.staticTokens[a.TokenID.RCurly];h[a.LexCodeCOL]=a.staticTokens[a.TokenID.Colon];a.LexKeywordTable=new a.StringHashTable;for(var b in a.TokenID._map)b<=a.TokenID.LimKeyword&&a.LexKeywordTable.add(a.TokenID._map[b].toLowerCase(),b);for(b=0;128>b;b++)c[b]=j(b)?!0:!1}function j(c){return 97<=c&&122>=c||65<=c&&90>=c||c==a.LexCodeDollar||c==a.LexCodeUnderscore}function b(a){return 48<=a&&57>=a}function g(c,b,f){if(c.tokenId<=a.TokenID.LimKeyword)if(c=a.lookupToken(c.tokenId),void 0!=c){var e=a.Reservation.Javascript|
a.Reservation.JavascriptFuture;f&&(e|=a.Reservation.JavascriptFutureStrict);if(b||!a.hasFlag(c.reservation,e))return!0}else return!1;else return!1}function k(a,c){if(-1===c)return 0;for(var b=0,f=a.length-1;b<f;){var e=b+f>>1;c<a[e]?f=e-1:b=c<a[e+1]?f=e:e+1}return b}function i(a,c,b){var f=k(b,c);0<f&&(a.line=f,a.col=c-b[f])}a.LexEOF=-1;a.LexCodeNWL=10;a.LexCodeRET=13;a.LexCodeTAB=9;a.LexCodeVTAB=11;a.LexCode_e=101;a.LexCode_E=69;a.LexCode_x=120;a.LexCode_X=88;a.LexCode_a=97;a.LexCode_A=65;a.LexCode_f=
102;a.LexCode_F=70;a.LexCode_g=103;a.LexCode_m=109;a.LexCode_i=105;a.LexCode_0=48;a.LexCode_9=57;a.LexCode_8=56;a.LexCode_7=55;a.LexCodeBSL=92;a.LexCodeSHP=35;a.LexCodeBNG=33;a.LexCodeQUO=34;a.LexCodeAPO=39;a.LexCodePCT=37;a.LexCodeAMP=38;a.LexCodeLPR=40;a.LexCodeRPR=41;a.LexCodePLS=43;a.LexCodeMIN=45;a.LexCodeMUL=42;a.LexCodeSLH=47;a.LexCodeXOR=94;a.LexCodeCMA=44;a.LexCodeDOT=46;a.LexCodeLT=60;a.LexCodeEQ=61;a.LexCodeGT=62;a.LexCodeQUE=63;a.LexCodeLBR=91;a.LexCodeRBR=93;a.LexCodeUSC=95;a.LexCodeLC=
123;a.LexCodeRC=125;a.LexCodeBAR=124;a.LexCodeTIL=126;a.LexCodeCOL=58;a.LexCodeSMC=59;a.LexCodeUnderscore=95;a.LexCodeDollar=36;a.LexCodeSpace=32;a.LexKeywordTable=void 0;var h=Array(128),c=Array(128);a.LexInitialize=d;a.LexAdjustIndent=function(c,b){return c==a.LexCodeLBR||c==a.LexCodeLC||c==a.LexCodeLPR?b+1:c==a.LexCodeRBR||c==a.LexCodeRC||c==a.LexCodeRPR?b-1:b};a.LexIsIdentifierStartChar=j;a.LexIsDigit=b;a.LexIsIdentifierChar=function(a){return c[a]||b(a)};a.LexMatchingOpen=function(c){return c==
a.LexCodeRBR?a.LexCodeLBR:c==a.LexCodeRC?a.LexCodeLC:c==a.LexCodeRPR?a.LexCodeLPR:0};var f=a.NumberScanState||(a.NumberScanState={});f._map=[];f._map[0]="Start";f.Start=0;f._map[1]="InFraction";f.InFraction=1;f._map[2]="InExponent";f.InExponent=2;var e=a.NumberScanState,f=a.LexState||(a.LexState={});f._map=[];f._map[0]="Start";f.Start=0;f._map[1]="InMultilineComment";f.InMultilineComment=1;var l=a.LexState,f=a.LexMode||(a.LexMode={});f._map=[];f._map[0]="Line";f.Line=0;f._map[1]="File";f.File=1;var n=
a.LexMode,f=a.CommentStyle||(a.CommentStyle={});f._map=[];f._map[0]="Line";f.Line=0;f._map[1]="Block";f.Block=1;var m=function(a){this.text=a};m.prototype.getText=function(a,c){return this.text.substring(a,c)};m.prototype.getLength=function(){return this.text.length};a.StringSourceText=m;var y=function(a,c,b){this.segmentStart=a;this.segmentEnd=c;this.segment=b};y.prototype.charCodeAt=function(a){return this.segment.charCodeAt(a-this.segmentStart)};y.prototype.substring=function(a,c){return this.segment.substring(a-
this.segmentStart,c-this.segmentStart)};a.SourceTextSegment=y;var u=function(a,c){this.seg1=a;this.seg2=c};u.prototype.charCodeAt=function(a){return this.seg1.segmentStart<=a&&a<this.seg1.segmentEnd?this.seg1.segment.charCodeAt(a-this.seg1.segmentStart):this.seg2.segment.charCodeAt(a-this.seg2.segmentStart)};u.prototype.substring=function(a,c){return this.seg1.segmentStart<=a&&c<=this.seg1.segmentEnd?this.seg1.segment.substring(a-this.seg1.segmentStart,c-this.seg1.segmentStart):this.seg2.segment.substring(a-
this.seg2.segmentStart)+this.seg1.segment.substring(0,c-this.seg1.segmentStart)};a.AggerateSourceTextSegment=u;var s=function(a){this.sourceText=a;this.agg=new u(s.emptySegment,s.emptySegment);this.len=this.sourceText.getLength()};s.emptySegment=new y(0,0,"");s.prototype.max=function(a,c){return a>=c?a:c};s.prototype.min=function(a,c){return a<=c?a:c};s.prototype.fetchSegment=function(c,b){if(this.agg.seg1.segmentStart<=c&&b<=this.agg.seg1.segmentEnd)return this.agg.seg1;if(this.agg.seg2.segmentStart<=
c&&b<=this.agg.seg1.segmentEnd)return this.agg;var f=this.agg.seg1,e=f.segmentEnd,i=a.max(e+512,b),i=a.min(i,this.len),h=this.sourceText.getText(e,i),e=new y(e,i,h);this.agg.seg2=f;this.agg.seg1=e;return this.agg};s.prototype.charCodeAt=function(a){return this.fetchSegment(a,a+1).charCodeAt(a)};s.prototype.substring=function(a,c){return this.fetchSegment(a,c).substring(a,c)};a.ScannerTextStream=s;f=function(){this.prevToken=this.prevSavedToken=this.curSavedToken=this.prevToken=null;this.currentToken=
0;this.tokens=[];this.line=this.prevLine=1;this.col=0;this.lexState=l.Start;this.commentStack=[];this.lineMap=[]};f.prototype.previousToken=function(){return this.prevToken};f.prototype.close=function(){this.currentToken=0};f.prototype.addToken=function(c,b){this.tokens[this.currentToken++]=new a.SavedToken(c,b.startPos,b.pos)};f.prototype.scan=function(){this.startLine=this.line;this.startPos=this.col;if(this.currentTokenIndex==this.currentTokens.length)if(this.line<this.lineMap.length)this.line++,
this.currentTokenIndex=this.col=0,this.currentTokens=this.tokensByLine[this.line];else return a.staticTokens[a.TokenID.EOF];if(this.currentTokenIndex<this.currentTokens.length){this.prevToken=this.curSavedToken.tok;this.prevSavedToken=this.curSavedToken;this.curSavedToken=this.currentTokens[this.currentTokenIndex++];var c=this.curSavedToken.tok;this.pos=this.curSavedToken.limChar;this.col+=this.curSavedToken.limChar-this.curSavedToken.minChar;this.startPos=this.curSavedToken.minChar;this.prevLine=
this.line;return c}return a.staticTokens[a.TokenID.EOF]};f.prototype.syncToTok=function(a){this.line=k(this.lineMap,a);this.currentTokenIndex=0;for(a-=this.lineMap[this.line];this.lexStateByLine[this.line]==l.InMultilineComment&&0<this.line;)this.line--,a=0;var c=this.lineMap.length-1;for(this.currentTokens=this.tokensByLine[this.line];0==this.currentTokens.length&&this.line<c;)this.line++,this.currentTokens=this.tokensByLine[this.line],a=0;if(this.line<=c){for(;this.currentTokenIndex<this.currentTokens.length&&
a>this.currentTokens[this.currentTokenIndex].limChar;)this.currentTokenIndex++;if(this.currentTokenIndex<this.currentTokens.length)return this.col=this.currentTokens[this.currentTokenIndex].minChar,this.col+this.lineMap[this.line]}return-1};f.prototype.lastTokenLimChar=function(){return null!==this.prevSavedToken?this.prevSavedToken.limChar:0};f.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};f.prototype.pushComment=function(a){this.commentStack.push(a)};f.prototype.getComments=
function(){var a=this.commentStack;this.commentStack=[];return a};f.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};f.prototype.resetComments=function(){this.commentStack=[]};f.prototype.setSourceText=function(){};f.prototype.setErrorHandler=function(){};a.SavedTokens=f;f=function(){this.line=this.prevLine=1;this.len=this.startPos=this.pos=this.col=
0;this.lineMap=[];this.ch=a.LexEOF;this.lexState=l.Start;this.mode=n.File;this.scanComments=!0;this.interveningWhitespace=!1;this.rightCurlyCount=this.leftCurlyCount=this.interveningWhitespacePos=0;this.commentStack=[];this.saveScan=null;this.prevTok=a.staticTokens[a.TokenID.EOF];this.startCol=this.col;this.startLine=this.line;this.lineMap[1]=0;a.LexKeywordTable||d()};f.prototype.previousToken=function(){return this.prevTok};f.prototype.setSourceText=function(a,c){this.mode=c;this.scanComments=this.mode===
n.Line;this.startPos=this.interveningWhitespacePos=this.pos=0;this.line=1;this.startCol=this.col=0;this.startLine=this.line;this.len=0;this.src=a.getText(0,a.getLength());this.len=this.src.length;this.lineMap=[];this.lineMap[1]=0;this.commentStack=[];this.rightCurlyCount=this.leftCurlyCount=0};f.prototype.setErrorHandler=function(a){this.reportError=a};f.prototype.setSaveScan=function(a){this.saveScan=a};f.prototype.setText=function(a,c){this.setSourceText(new m(a),c)};f.prototype.setScanComments=
function(a){this.scanComments=a};f.prototype.getLexState=function(){return this.lexState};f.prototype.scanLine=function(c,b){this.lexState=b;var f=[];this.setText(c,n.Line);for(var e=this.scan();e.tokenId!=a.TokenID.EOF;)f[f.length]=e,e=this.scan();return f};f.prototype.tokenStart=function(){this.startPos=this.pos;this.startLine=this.line;this.startCol=this.col;this.interveningWhitespace=!1};f.prototype.peekChar=function(){return this.pos<this.len?this.src.charCodeAt(this.pos):a.LexEOF};f.prototype.peekCharAt=
function(c){return c<this.len?this.src.charCodeAt(c):a.LexEOF};f.prototype.IsHexDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_9||c>=a.LexCode_A&&c<=a.LexCode_F||c>=a.LexCode_a&&c<=a.LexCode_f};f.prototype.IsOctalDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_7||c>=a.LexCode_a&&c<=a.LexCode_f};f.prototype.scanHexDigits=function(){for(var c=!1;;)if(this.IsHexDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,this.pos))):null};
f.prototype.scanOctalDigits=function(){for(var c=!1;;)if(this.IsOctalDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,this.pos))):null};f.prototype.scanDecimalNumber=function(c){for(var f=!1,i=this.pos,h=this.col;;)if(b(this.ch))f=!0,this.nextChar();else if(this.ch==a.LexCodeDOT)if(c==e.Start)this.nextChar(),c=e.InFraction;else{if(f)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=h;return null}else if(this.ch==
a.LexCode_e||this.ch==a.LexCode_E)if(c==e.Start)if(f)f=!1,this.nextChar(),c=e.InExponent;else return this.pos=i,this.col=h,null;else if(c==e.InFraction)this.nextChar(),c=e.InExponent,f=!1;else{if(f)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=h;return null}else if(this.ch==a.LexCodePLS||this.ch==a.LexCodeMIN)if(c==e.InExponent){if(f)return this.pos=i,this.col=h,null;this.nextChar()}else{if(c==e.InFraction||f)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,
this.pos)));this.pos=i;this.col=h;return null}else{if(f)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=h;return null}};f.prototype.scanNumber=function(){if(this.peekChar()==a.LexCode_0)switch(this.peekCharAt(this.pos+1)){case a.LexCode_x:case a.LexCode_X:return this.advanceChar(2),this.scanHexDigits();case a.LexCode_8:case a.LexCode_9:case a.LexCodeDOT:return this.scanDecimalNumber(e.Start);default:return this.scanOctalDigits()}else return this.scanDecimalNumber(e.Start)};
f.prototype.scanFraction=function(){return this.scanDecimalNumber(e.InFraction)};f.prototype.newLine=function(){this.col=0;this.mode==n.File&&(this.line++,this.lineMap[this.line]=this.pos+1)};f.prototype.finishMultilineComment=function(){var c;for(this.lexState=l.InMultilineComment;this.pos<this.len;){if(this.ch==a.LexCodeMUL){if(c=this.peekCharAt(this.pos+1),c==a.LexCodeSLH)return this.advanceChar(2),this.mode==n.File&&this.tokenStart(),this.lexState=l.Start,!0}else if(this.ch==a.LexCodeNWL&&(this.newLine(),
this.mode==n.Line)){this.nextChar();break}this.nextChar()}return!1};f.prototype.pushComment=function(a){this.commentStack.push(a)};f.prototype.getComments=function(){var a=this.commentStack;this.commentStack=[];return a};f.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};f.prototype.resetComments=function(){this.commentStack=[]};f.prototype.endsLine=
function(c){return c==a.LexCodeNWL||c==a.LexCodeRET||8232==c||8233==c};f.prototype.finishSinglelineComment=function(){for(;this.pos<this.len&&!this.endsLine(this.ch);)this.nextChar();this.mode==n.File&&this.tokenStart()};f.prototype.tokenText=function(){return this.src.substring(this.startPos,this.pos)};f.prototype.findClosingSLH=function(){for(var c=this.pos,b=this.src.charCodeAt(c),f=0,e=!1;!this.endsLine(b)&&c<this.len;){if(b==a.LexCodeSLH&&!e)return c;f=b;c++;e=e?!1:f==a.LexCodeBSL;b=this.src.charCodeAt(c)}return-1};
f.prototype.speculateRegex=function(){if(void 0!=a.noRegexTable[this.prevTok.tokenId])return null;var c=this.pos,b=this.col,f=this.findClosingSLH();if(0<f){var e=this.src.substring(c,f),i="";this.pos=f+1;this.ch=this.peekChar();for(i=this.pos;this.ch==a.LexCode_i||this.ch==a.LexCode_g||this.ch==a.LexCode_m;)this.nextChar();if(3<this.pos-i)return null;i=this.src.substring(i,this.pos);f=void 0;try{f=RegExp(e,i)}catch(h){}if(f)return this.col=b+(this.pos-this.startPos),new a.RegexToken(f)}this.pos=c;
this.col=b;return null};f.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};f.prototype.lastTokenLimChar=function(){return this.interveningWhitespace?this.interveningWhitespacePos:this.startPos};f.prototype.advanceChar=function(a){this.pos+=a;this.col+=a;this.ch=this.peekChar()};f.prototype.nextChar=function(){this.pos++;this.col++;this.ch=this.peekChar()};f.prototype.scan=function(){if(this.lexState==l.InMultilineComment&&this.scanComments){this.ch=this.peekChar();var c=
this.line;this.finishMultilineComment();if(this.startPos<this.pos){var b=this.src.substring(this.startPos,this.pos);this.tokenStart();return new a.CommentToken(a.TokenID.Comment,b,!0,this.startPos,c,!0)}return a.staticTokens[a.TokenID.EOF]}this.prevLine=this.line;this.prevTok=this.innerScan();this.saveScan&&this.saveScan.addToken(this.prevTok,this);return this.prevTok};f.prototype.innerScan=function(){var f;this.tokenStart();this.ch=this.peekChar();for(;this.pos<this.len;){if(c[this.ch]){do this.nextChar();
while(c[this.ch]||b(this.ch));var e=this.src.substring(this.startPos,this.pos);return null!=(f=a.LexKeywordTable.lookup(e))?a.staticTokens[f]:new a.StringToken(a.TokenID.ID,e)}if(this.ch==a.LexCodeSpace){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos);do this.nextChar();while(this.ch==a.LexCodeSpace);if(this.mode==n.Line)return f=this.src.substring(this.startPos,this.pos),new a.WhitespaceToken(a.TokenID.Whitespace,f);this.tokenStart();this.interveningWhitespace=!0}else if(this.ch==
a.LexCodeSLH){this.nextChar();var i;if(this.ch==a.LexCodeSLH){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos-1);var e=this.pos-1,l=this.line;this.finishSinglelineComment();i=this.src.substring(e,this.pos);i=new a.CommentToken(a.TokenID.Comment,i,!1,e,l,!1);if(this.scanComments)return this.startPos=e,i;this.pushComment(i);this.interveningWhitespace=!0}else if(this.ch==a.LexCodeMUL){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos-1);e=this.pos-1;l=this.line;
this.nextChar();this.finishMultilineComment();i=this.src.substring(e,this.pos);var m=this.peekChar()==a.LexCodeNWL||this.peekChar()==a.LexCodeRET;i=new a.CommentToken(a.TokenID.Comment,i,!0,e,l,m);if(this.scanComments)return this.startPos=e,i;this.pushComment(i);this.interveningWhitespace=!0}else return(f=this.speculateRegex())?f:this.peekCharAt(this.pos)==a.LexCodeEQ?(this.nextChar(),a.staticTokens[a.TokenID.AsgDiv]):a.staticTokens[a.TokenID.Div]}else{if(this.ch==a.LexCodeSMC)return this.nextChar(),
a.staticTokens[a.TokenID.SColon];if(this.ch==a.LexCodeAPO||this.ch==a.LexCodeQUO){f=this.ch;e=0;i=!1;do e=this.ch,i=i?!1:e==a.LexCodeBSL,this.nextChar();while(this.ch!=a.LexEOF&&(i||this.ch!=f));this.ch!=a.LexEOF&&this.nextChar();return new a.StringToken(a.TokenID.QString,this.src.substring(this.startPos,this.pos))}if(h[this.ch])return f=h[this.ch],f.tokenId==a.TokenID.LCurly?this.leftCurlyCount++:f.tokenId==a.TokenID.RCurly&&this.rightCurlyCount++,this.nextChar(),f;if(this.ch>=a.LexCode_0&&this.ch<=
a.LexCode_9){if(f=this.scanNumber())return f;this.nextChar();return a.staticTokens[a.TokenID.Error]}switch(this.ch){case a.LexCodeTAB:case a.LexCodeVTAB:this.interveningWhitespace||(this.interveningWhitespacePos=this.pos);if(this.mode==n.Line){do this.nextChar();while(this.ch==a.LexCodeSpace||9==this.ch);f=this.src.substring(this.startPos,this.pos);return new a.WhitespaceToken(a.TokenID.Whitespace,f)}this.interveningWhitespace=!0;case 255:case 254:case 239:case 187:case 191:case 8232:case 8233:case a.LexCodeNWL:case a.LexCodeRET:if(this.ch==
a.LexCodeNWL&&(this.newLine(),this.mode==n.Line))return a.staticTokens[a.TokenID.EOF];this.interveningWhitespace||(this.interveningWhitespacePos=this.pos);this.nextChar();this.tokenStart();this.interveningWhitespace=!0;break;case a.LexCodeDOT:if(this.peekCharAt(this.pos+1)==a.LexCodeDOT){if(this.peekCharAt(this.pos+2)==a.LexCodeDOT)return this.advanceChar(3),a.staticTokens[a.TokenID.Ellipsis];this.nextChar();return a.staticTokens[a.TokenID.Dot]}this.nextChar();return(f=this.scanFraction())?f:a.staticTokens[a.TokenID.Dot];
case a.LexCodeEQ:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.Eqv];this.advanceChar(2);return a.staticTokens[a.TokenID.EQ]}if(this.peekCharAt(this.pos+1)==a.LexCodeGT)return this.advanceChar(2),a.staticTokens[a.TokenID.Arrow];this.nextChar();return a.staticTokens[a.TokenID.Asg];case a.LexCodeBNG:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),
a.staticTokens[a.TokenID.NEqv];this.advanceChar(2);return a.staticTokens[a.TokenID.NE]}this.nextChar();return a.staticTokens[a.TokenID.Bang];case a.LexCodePLS:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAdd];if(this.peekCharAt(this.pos+1)==a.LexCodePLS)return this.advanceChar(2),a.staticTokens[a.TokenID.Inc];this.nextChar();return a.staticTokens[a.TokenID.Add];case a.LexCodeMIN:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),
a.staticTokens[a.TokenID.AsgSub];if(this.peekCharAt(this.pos+1)==a.LexCodeMIN)return this.advanceChar(2),a.staticTokens[a.TokenID.Dec];this.nextChar();return a.staticTokens[a.TokenID.Sub];case a.LexCodeMUL:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMul];this.nextChar();return a.staticTokens[a.TokenID.Mult];case a.LexCodePCT:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMod];this.nextChar();
return a.staticTokens[a.TokenID.Pct];case a.LexCodeLT:if(this.peekCharAt(this.pos+1)==a.LexCodeLT){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.AsgLsh];this.advanceChar(2);return a.staticTokens[a.TokenID.Lsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.LE];this.nextChar();return a.staticTokens[a.TokenID.LT];case a.LexCodeGT:if(this.peekCharAt(this.pos+1)==a.LexCodeGT){if(this.peekCharAt(this.pos+
2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.AsgRsh];if(this.peekCharAt(this.pos+2)==a.LexCodeGT){if(this.peekCharAt(this.pos+3)==a.LexCodeEQ)return this.advanceChar(4),a.staticTokens[a.TokenID.AsgRs2];this.advanceChar(3);return a.staticTokens[a.TokenID.Rs2]}this.advanceChar(2);return a.staticTokens[a.TokenID.Rsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.GE];this.nextChar();return a.staticTokens[a.TokenID.GT];case a.LexCodeXOR:if(this.peekCharAt(this.pos+
1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgXor];this.nextChar();return a.staticTokens[a.TokenID.Xor];case a.LexCodeBAR:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgOr];if(this.peekCharAt(this.pos+1)==a.LexCodeBAR)return this.advanceChar(2),a.staticTokens[a.TokenID.LogOr];this.nextChar();return a.staticTokens[a.TokenID.Or];case a.LexCodeAMP:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAnd];
if(this.peekCharAt(this.pos+1)==a.LexCodeAMP)return this.advanceChar(2),a.staticTokens[a.TokenID.LogAnd];this.nextChar();return a.staticTokens[a.TokenID.And];default:this.reportScannerError("Invalid character"),this.nextChar()}}}return a.staticTokens[a.TokenID.EOF]};f.prototype.reportScannerError=function(a){this.reportError&&this.reportError(a)};a.Scanner=f;a.convertTokToIDName=function(a){return g(a,!0,!1)};a.convertTokToID=function(a,c){return g(a,!1,c)};a.getLineNumberFromPosition=k;a.getSourceLineColFromMap=
i;a.getLineColumnFromPosition=function(a,c){var b={line:-1,col:-1};i(b,c,a.locationInfo.lineMap);0<=b.col&&b.col++;return b};a.getPositionFromLineColumn=function(a,c,b){return a.locationInfo.lineMap[c]+(b-1)};a.isPrimitiveTypeToken=function(c){switch(c.tokenId){case a.TokenID.ANY:case a.TokenID.BOOL:case a.TokenID.NUMBER:case a.TokenID.STRING:return!0}return!1};a.isModifier=function(c){switch(c.tokenId){case a.TokenID.PUBLIC:case a.TokenID.PRIVATE:case a.TokenID.STATIC:return!0}return!1}})(TypeScript||
(TypeScript={}));
(function(a){function d(c,b,f,e,i){c=new a.ScopeChain(null,b.scopeChain,c);c.thisType=f;c.classType=e;c.fnc=i;b.scopeChain=c}function j(a){a.scopeChain=a.scopeChain.previous}function b(a,c){return null==a||!a.isInstanceProperty()?c:a}function g(a){return a.isInstanceProperty()}function k(c,b){var f=null,e=null;c.name&&c.mod&&(c.name.sym=c.mod.symbol);var i=c.mod;i&&(f=new a.SymbolTableScope(i.members,i.ambientMembers,i.enclosedTypes,i.ambientEnclosedTypes,i.symbol),i.memberScope=f,b.modDeclChain.push(c),
b.typeFlow.checker.currentModDecl=c,e=new a.SymbolAggregateScope(i.symbol),e.addParentScope(f),e.addParentScope(b.scopeChain.scope),d(e,b,null,null,null),i.containedScope=e,i.symbol&&b.typeFlow.addLocalsFromScope(i.containedScope,i.symbol,c.vars,i.members.privateMembers,!0))}function i(c,b){var f=null,e=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var i=c.type;if(i){f=b.typeFlow.checker.scopeOf(i);e=new a.SymbolAggregateScope(i.symbol);e.addParentScope(f);e.addParentScope(b.scopeChain.scope);i.containedScope=
e;i.memberScope=f;var h=i.instanceType,f=b.typeFlow.checker.scopeOf(h);h.memberScope=f;e=new a.SymbolAggregateScope(h.symbol);e.addParentScope(b.scopeChain.scope);d(e,b,h,i,null);h.containedScope=e}else c.type=b.typeFlow.anyType}function h(c,b){var f=null,e=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var i=c.type,f=b.typeFlow.checker.scopeOf(i);i.memberScope=f;e=new a.SymbolAggregateScope(i.symbol);e.addParentScope(f);e.addParentScope(b.scopeChain.scope);d(e,b,null,null,null);i.containedScope=
e}function c(c,b){var f=c.type,e=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),i=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),f=new a.Type,h=new a.WithSymbol(c.minChar,b.typeFlow.checker.locationInfo.unitIndex,f);f.members=e;f.ambientMembers=i;f.symbol=h;f.setHasImplementation();c.type=f;e=new a.SymbolScopeBuilder(f.members,f.ambientMembers,null,null,b.scopeChain.scope,f.symbol);d(e,b,null,null,null);f.containedScope=
e}function f(c,b){var f=null,e=null;c.type&&(e=c.type.symbol);var i=a.hasFlag(c.fncFlags,a.FncFlags.Static),h=i&&null!=b.scopeChain.fnc?b.scopeChain.fnc.type.memberScope:b.scopeChain.scope;b.scopeChain.thisType&&(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))?(f=b.scopeChain.thisType,h=!(f.typeFlags&a.TypeFlags.IsClass)&&!a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?!c.isMethod()||i?f.constructorScope:f.containedScope:b.scopeChain.previous.scope.container&&b.scopeChain.previous.scope.container.declAST&&
b.scopeChain.previous.scope.container.declAST.nodeType==a.NodeType.FuncDecl&&b.scopeChain.previous.scope.container.declAST.isConstructor?f.constructorScope:i&&b.scopeChain.classType?b.scopeChain.classType.containedScope:f.containedScope,f=f.symbol):c.isConstructor&&b.scopeChain.thisType&&(f=b.scopeChain.thisType.symbol);if(null==c.type||a.hasFlag(c.type.symbol.flags,a.SymbolFlags.TypeSetDuringScopeAssignment)){b.scopeChain.fnc&&b.scopeChain.fnc.type&&(f=b.scopeChain.fnc.type.symbol);var l=null,g=
b.scopeChain.fnc,k=c.name?c.name.text:null,j=null;i?(null==g.type.members&&f.getType().memberScope&&(g.type.members=f.type.memberScope.valueMembers),l=b.scopeChain.fnc.type.memberScope,g.innerStaticFuncs[g.innerStaticFuncs.length]=c):l=!c.isConstructor&&f&&f.declAST&&f.declAST.nodeType==a.NodeType.FuncDecl&&f.declAST.isConstructor&&!c.isMethod()?b.scopeChain.thisType.constructorScope:b.scopeChain.scope;k&&("__missing"!=k&&!c.isAccessor())&&(j=l.findLocal(k,!1,!1));b.typeFlow.checker.createFunctionSignature(c,
f,l,j,null==j);if(!c.accessorSymbol&&c.fncFlags&a.FncFlags.ClassMethod&&f&&(!j||j.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||j&&j.isAccessor())c.accessorSymbol=b.typeFlow.checker.createAccessorSymbol(c,j,f.getType(),c.isMethod()&&i,!0,l,f);c.type.symbol.flags|=a.SymbolFlags.TypeSetDuringScopeAssignment}c.name&&c.type&&(c.name.sym=c.type.symbol);c.scopeType=c.type;if(!c.isOverload){var f=new a.StringHashTable,j=new a.ScopedMembers(new a.DualStringHashTable(f,new a.StringHashTable)),l=
new a.StringHashTable,k=new a.ScopedMembers(new a.DualStringHashTable(l,new a.StringHashTable)),l=new a.StringHashTable,g=new a.ScopedMembers(new a.DualStringHashTable(l,new a.StringHashTable)),w=new a.StringHashTable,w=new a.ScopedMembers(new a.DualStringHashTable(w,new a.StringHashTable));c.unitIndex=b.typeFlow.checker.locationInfo.unitIndex;e=new a.SymbolScopeBuilder(j,k,null,null,h,e);g=new a.SymbolScopeBuilder(g,w,null,null,h,null);c.isConstructor&&b.scopeChain.thisType&&(b.scopeChain.thisType.constructorScope=
e);c.symbols=f;if(!c.isSpecialFn()){j=c.type;h=c.signature;c.isConstructor||(j.containedScope=e,e.container=j.symbol,j.memberScope=g,g.container=j.symbol);c.enclosingFnc=b.scopeChain.fnc;j.enclosingType=i?b.scopeChain.classType:b.scopeChain.thisType;j=c.type.symbol;(c.fncFlags&a.FncFlags.Signature)==a.FncFlags.None&&c.vars&&(b.typeFlow.addLocalsFromScope(e,j,c.vars,f,!1),b.typeFlow.addLocalsFromScope(g,j,c.statics,l,!1));if(h.parameters){i=h.parameters.length;for(f=0;f<i;f++)b.typeFlow.checker.resolveTypeLink(e,
h.parameters[f].parameter.typeLink,!0)}b.typeFlow.checker.resolveTypeLink(e,h.returnType,c.isSignature())}if(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))i=c.isConstructor&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?b.scopeChain.thisType:null,d(e,b,i,null,c)}}function e(c,b){if(c.param){var f=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),f=new a.SymbolScopeBuilder(f,null,null,null,b.scopeChain.scope,b.scopeChain.scope.container);c.containedScope=
f;d(f,b,b.scopeChain.thisType,b.scopeChain.classType,b.scopeChain.fnc)}}a.AssignScopeContext=function(a,c,b){this.scopeChain=a;this.typeFlow=c;this.modDeclChain=b};a.pushAssignScope=d;a.popAssignScope=j;a.instanceCompare=b;a.instanceFilterStop=g;var l=function(a,c){this.select=a;this.stop=c;this.result=null};l.prototype.reset=function(){this.result=null};l.prototype.update=function(a){return(this.result=this.select(this.result,a))?this.stop(this.result):!1};a.ScopeSearchFilter=l;a.instanceFilter=
new l(b,g);a.preAssignModuleScopes=k;a.preAssignClassScopes=i;a.preAssignInterfaceScopes=h;a.preAssignWithScopes=c;a.preAssignFuncDeclScopes=f;a.preAssignCatchScopes=e;a.preAssignScopes=function(b,l,d){var l=d.state,g=!0;b&&(b.nodeType==a.NodeType.List?b.enclosingScope=l.scopeChain.scope:b.nodeType==a.NodeType.Module?k(b,l):b.nodeType==a.NodeType.Class?i(b,l):b.nodeType==a.NodeType.Interface?h(b,l):b.nodeType==a.NodeType.With?c(b,l):b.nodeType==a.NodeType.FuncDecl?f(b,l):b.nodeType==a.NodeType.Catch?
e(b,l):b.nodeType==a.NodeType.TypeRef&&(g=!1));d.options.goChildren=g;return b};a.postAssignScopes=function(c,b,f){var b=f.state,e=!0;c&&(c.nodeType==a.NodeType.Module?(j(b),b.modDeclChain.pop(),1<=b.modDeclChain.length&&(b.typeFlow.checker.currentModDecl=b.modDeclChain[b.modDeclChain.length-1])):c.nodeType==a.NodeType.Class?j(b):c.nodeType==a.NodeType.Interface?j(b):c.nodeType==a.NodeType.With?j(b):c.nodeType==a.NodeType.FuncDecl?(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))&&
!c.isOverload&&j(b):c.nodeType==a.NodeType.Catch?c.param&&j(b):e=!1);f.options.goChildren=e;return c}})(TypeScript||(TypeScript={}));
(function(a){function d(b,d,k){var d=k.state,i=b.minChar,h=b.limChar;b.nodeType==a.NodeType.Script&&d.pos>h&&(h=d.pos);if(i<=d.pos&&h>=d.pos){switch(b.nodeType){case a.NodeType.Script:d.scopeGetter=function(){return null===b.bod?null:b.bod.enclosingScope};d.scopeStartAST=b;break;case a.NodeType.Class:d.scopeGetter=function(){return null===b.type||null===b.type.instanceType.containedScope?null:b.type.instanceType.containedScope};d.scopeStartAST=b;d.enclosingClassDecl=b;break;case a.NodeType.ObjectLit:b.targetType&&
(d.scopeGetter=function(){return b.targetType.containedScope},d.objectLiteralScopeGetter=function(){return b.targetType.memberScope},d.enclosingObjectLit=b);break;case a.NodeType.Module:d.deepestModuleDecl=b;d.scopeGetter=function(){return null===b.type?null:b.type.containedScope};d.scopeStartAST=b;break;case a.NodeType.Interface:d.scopeGetter=function(){return null===b.type?null:b.type.containedScope};d.scopeStartAST=b;break;case a.NodeType.FuncDecl:d.skipNextFuncDeclForClass?d.skipNextFuncDeclForClass=
!1:(d.scopeGetter=function(){return b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&b.type&&b.type.enclosingType?b.type.enclosingType.constructorScope:b.scopeType?b.scopeType.containedScope:b.type?b.type.containedScope:null},d.scopeStartAST=b)}k.options.goChildren=!0}else k.options.goChildren=!1;return b}a.TypeCollectionContext=function(a,d){this.scopeChain=a;this.checker=d;this.script=null};a.MemberScopeContext=function(b,d,k){this.flow=b;this.pos=d;this.matchFlag=k;this.ast=this.type=
null;this.options=new a.AstWalkOptions};var j=function(a,d,k,i,h){this.logger=a;this.script=d;this.text=k;this.pos=i;this.isMemberCompletion=h;this.scopeStartAST=this.objectLiteralScopeGetter=this.scopeGetter=null;this.skipNextFuncDeclForClass=!1;this.enclosingObjectLit=this.enclosingClassDecl=this.deepestModuleDecl=null;this.publicsOnly=!0;this.useFullAst=!1};j.prototype.getScope=function(){return this.scopeGetter()};j.prototype.getObjectLiteralScope=function(){return this.objectLiteralScopeGetter()};
j.prototype.getScopeAST=function(){return this.scopeStartAST};j.prototype.getScopePosition=function(){return this.scopeStartAST.minChar};j.prototype.getScriptFragmentStartAST=function(){return this.scopeStartAST};j.prototype.getScriptFragmentPosition=function(){return this.getScriptFragmentStartAST().minChar};j.prototype.getScriptFragment=function(){if(null==this.scriptFragment){var b=this.getScriptFragmentStartAST();this.scriptFragment=a.quickParse(this.logger,b,this.text,b.minChar,this.isMemberCompletion?
this.pos:this.pos+1,null).Script}return this.scriptFragment};a.EnclosingScopeContext=j;a.preFindMemberScope=function(b,d,k){d=k.state;if(a.hasFlag(b.flags,d.matchFlag)&&(0>d.pos||d.pos==b.limChar))d.ast=b,null==b.type&&0<=d.pos&&d.flow.inScopeTypeCheck(b,d.scope),d.type=b.type,d.options.stopWalk();return b};a.pushTypeCollectionScope=function(b,d,k,i,h,c,f,e,l){d=new a.SymbolScopeBuilder(d,k,i,h,null,b);b=new a.ScopeChain(b,c.scopeChain,d);b.thisType=f;b.classType=e;b.moduleDecl=l;c.scopeChain=b};
a.popTypeCollectionScope=function(a){a.scopeChain=a.scopeChain.previous};a.preFindEnclosingScope=d;a.findEnclosingScopeAt=function(b,g,k,i,h){b=new j(b,g,k,i,h);a.getAstWalkerFactory().walk(g,d,null,null,b);return null===b.scopeStartAST?null:b}})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.hasVariableArgList=!1;this.declAST=this.parameters=null;this.typeCheckStatus=a.TypeCheckStatus.NotStarted;this.nonOptionalParameterCount=0};d.prototype.specializeType=function(b,g,k){var i=new d;this.hasVariableArgList&&(i.hasVariableArgList=!0);i.returnType=new a.TypeLink;i.returnType.type=this.returnType.type?this.returnType.type.specializeType(b,g,k,!1):k.anyType;if(this.parameters){i.parameters=[];for(var h=0,c=this.parameters.length;h<c;h++){var f=this.parameters[h],
e=new a.ValueLocation,l=new a.ParameterSymbol(f.name,f.location,k.locationInfo.unitIndex,e);l.declAST=this.declAST;e.symbol=l;e.typeLink=new a.TypeLink;i.parameters[h]=l;(f=f.getType())?(e.typeLink.type=f.specializeType(b,g,k,!1),l.declAST.type=e.typeLink.type):e.typeLink.type=k.anyType}}i.nonOptionalParameterCount=this.nonOptionalParameterCount;i.declAST=this.declAST;return i};d.prototype.toString=function(){return this.toStringHelper(!1,!1,null)};d.prototype.toStringHelper=function(a,d,k){var i;
i=d?"[":"(";for(var h=this.parameters.length,c=0;c<h;c++)i+=this.parameters[c].name+(this.parameters[c].isOptional()?"?":"")+": ",i+=this.parameters[c].getType().getScopedTypeName(k),c<h-1&&(i+=",");i=a?d?i+"] => ":i+") => ":d?i+"]: ":i+"): ";return i=this.returnType.type?i+this.returnType.type.getScopedTypeName(k):i+"any"};a.Signature=d;var j=function(){this.signatures=[];this.hasImplementation=!0;this.definitionSignature=null;this.hasBeenTypechecked=!1;this.flags=a.SignatureFlags.None};j.prototype.addSignature=
function(b){null==this.signatures&&(this.signatures=[]);this.signatures[this.signatures.length]=b;b.declAST&&(!b.declAST.isOverload&&!b.declAST.isSignature()&&!a.hasFlag(b.declAST.fncFlags,a.FncFlags.Ambient)&&a.hasFlag(b.declAST.fncFlags,a.FncFlags.Definition))&&(this.definitionSignature=b)};j.prototype.toString=function(){return this.signatures.toString()};j.prototype.toStrings=function(b,d,k){var i=[],h=this.signatures.length;1<h&&(d=!1);for(var c=0;c<h;c++)1<h&&this.signatures[c]==this.definitionSignature||
(i[c]=this.flags&a.SignatureFlags.IsIndexer?this.signatures[c].toStringHelper(d,!0,k):b+this.signatures[c].toStringHelper(d,!1,k));return i};j.prototype.specializeType=function(a,d,k){var i=new j;if(this.signatures)for(var h=0,c=this.signatures.length;h<c;h++)i.addSignature(this.signatures[h].specializeType(a,d,k));return i};j.prototype.verifySignatures=function(b){var d=0;if(this.signatures&&0<(d=this.signatures.length))for(var k=0;k<d;k++){for(var i=k+1;i<d;i++)this.signatures[k].declAST&&(this.signatures[i].declAST&&
!a.hasFlag(this.signatures[k].declAST.fncFlags,a.FncFlags.Definition)&&!a.hasFlag(this.signatures[i].declAST.fncFlags,a.FncFlags.Definition)&&b.signaturesAreIdentical(this.signatures[k],this.signatures[i]))&&b.errorReporter.simpleError(this.signatures[k].declAST,this.signatures[k].declAST&&this.signatures[k].declAST.name?"Signature for '"+this.signatures[k].declAST.name.text+"' is duplicated":"Signature is duplicated");this.definitionSignature&&(b.signatureIsAssignableToTarget(this.definitionSignature,
this.signatures[k])||b.errorReporter.simpleError(this.signatures[k].declAST,"Overload signature is not compatible with function definition"))}};j.prototype.typeCheck=function(b,d,k){if(!this.hasBeenTypechecked&&(this.hasBeenTypechecked=!0,d=0,this.signatures&&0<(d=this.signatures.length))){for(var i=0;i<d;i++)!k&&(!this.definitionSignature&&this.signatures[i].declAST&&this.signatures[i].declAST.isOverload&&!a.hasFlag(this.signatures[i].declAST.fncFlags,a.FncFlags.Ambient))&&b.errorReporter.simpleError(this.signatures[i].declAST,
"Overload declaration lacks definition"),this.signatures[i].declAST&&(this.signatures[i].declAST.isConstructor&&this.signatures[i].declAST.classDecl&&this.signatures[i].declAST.classDecl.type.symbol.typeCheckStatus==a.TypeCheckStatus.NotStarted)&&b.typeFlow.typeCheck(this.signatures[i].declAST.classDecl),b.typeFlow.typeCheck(this.signatures[i].declAST);this.verifySignatures(b)}};a.SignatureGroup=j})(TypeScript||(TypeScript={}));
(function(a){function d(c,b){return c.declAST&&b&&b.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl?c.declAST.minChar<=b.declAST.minChar&&c.declAST.limChar>=b.declAST.limChar:!1}function j(a,c){for(;a.container;){if(a==c||d(a.container,c))return!0;a=a.container}return!1}var b=a.TypeCheckStatus||(a.TypeCheckStatus={});b._map=[];b._map[0]="NotStarted";b.NotStarted=0;b._map[1]="Started";b.Started=1;b._map[2]="Finished";b.Finished=2;var g=a.TypeCheckStatus;a.aLexicallyEnclosesB=d;a.aEnclosesB=j;var k=
function(c,b,f){this.name=c;this.location=b;this.unitIndex=f;this.bound=!1;this.flags=a.SymbolFlags.None;this.isObjectLitField=!1;this.declModule=this.declAST=null;this.passSymbolCreated=a.CompilerDiagnostics.analysisPass};k.prototype.instanceScope=function(){return null};k.prototype.isVariable=function(){return!1};k.prototype.isMember=function(){return!1};k.prototype.isInferenceSymbol=function(){return!1};k.prototype.isWith=function(){return!1};k.prototype.writeable=function(){return!1};k.prototype.isType=
function(){return!1};k.prototype.getType=function(){return null};k.prototype.isAccessor=function(){return!1};k.prototype.isInstanceProperty=function(){return a.hasFlag(this.flags,a.SymbolFlags.Property)&&!a.hasFlag(this.flags,a.SymbolFlags.ModuleMember)};k.prototype.getTypeName=function(){return this.toString()};k.prototype.getOptionalNameString=function(){return a.hasFlag(this.flags,a.SymbolFlags.Optional)?"?":""};k.prototype.pathToRoot=function(){for(var c=[],b=this;b&&b.name!=a.globalId;)c[c.length]=
b,b=b.container;return c};k.prototype.findCommonAncestorPath=function(a){if(null==this.container)return[];for(var c=this.container.pathToRoot(),a=a?a.pathToRoot():[],b=-1,f=0,e=c.length;f<e;f++){for(var i=c[f],h=0,d=a.length;h<d;h++)if(i==a[h]){b=f;break}if(0<=b)break}return 0<=b?c.slice(0,b):c};k.prototype.scopeRelativeName=function(a){if(null==a)return this.name;for(var a=this.findCommonAncestorPath(a.container),c="",b=0,f=a.length;b<f;b++)c=a[b].name+"."+c;return c+=this.name};k.prototype.fullName=
function(){for(var c=this.name,b=this.container;b&&b.name!=a.globalId;)c=b.name+"."+c,b=b.container;return c};k.prototype.isExternallyVisible=function(c){return this==c.gloMod?!0:a.hasFlag(this.flags,a.SymbolFlags.Private)?!1:!a.hasFlag(this.flags,a.SymbolFlags.Exported)?this.container==c.gloMod:this.container.isExternallyVisible(c)};k.prototype.visible=function(c,b){if(null==b||this.container==b.gloMod)return!0;if(a.hasFlag(this.flags,a.SymbolFlags.ModuleMember))return a.hasFlag(this.flags,a.SymbolFlags.Exported)?
a.hasFlag(this.flags,a.SymbolFlags.Private)?j(this,c.container):!0:b&&b.currentModDecl==this.declModule||b.currentModDecl&&b.currentModDecl.mod&&b.currentModDecl.mod.symbol&&this.declModule&&this.declModule.mod&&this.declModule.mod.symbol&&j(b.currentModDecl.mod.symbol,this.declModule.mod.symbol);var f=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl,e=f&&this.declAST.isMethod(),f=f&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Static),i=e&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Private),
h=this.isType()&&this.aliasLink;return this.isMember()||e||f||h?a.hasFlag(this.flags,a.SymbolFlags.Private)||i?null==c.container&&this.container!=c.container?!1:null==this.container?!0:j(c.container,this.container):!0:this.container?j(this,c.container):!0};k.prototype.addRef=function(a){this.refs||(this.refs=[]);this.refs[this.refs.length]=a};k.prototype.toString=function(){return this.name?this.name:"_anonymous"};k.prototype.print=function(a){a.Write(this.toString())};k.prototype.specializeType=
function(){throw Error("please implement in derived class");};k.prototype.setType=function(){throw Error("please implement in derived class");};k.prototype.kind=function(){throw Error("please implement in derived class");};k.prototype.getInterfaceDeclFromSymbol=function(c){if(null!=this.declAST){if(this.declAST.nodeType==a.NodeType.Interface)return this.declAST;if(null!=this.container&&this.container!=c.gloMod&&this.container.declAST.nodeType==a.NodeType.Interface)return this.container.declAST}return null};
k.prototype.getVarDeclFromSymbol=function(){return null!=this.declAST&&this.declAST.nodeType==a.NodeType.VarDecl?this.declAST:null};a.Symbol=k;var i;i=function(){};a.ValueLocation=i;var h=function(a,c,b){k.call(this,a,c,b);this.typeCheckStatus=g.NotStarted};__extends(h,k);h.prototype.isInferenceSymbol=function(){return!0};h.prototype.transferVarFlags=function(c){a.hasFlag(c,a.VarFlags.Ambient)&&(this.flags|=a.SymbolFlags.Ambient);a.hasFlag(c,a.VarFlags.Constant)&&(this.flags|=a.SymbolFlags.Constant);
a.hasFlag(c,a.VarFlags.Static)&&(this.flags|=a.SymbolFlags.Static);a.hasFlag(c,a.VarFlags.Property)&&(this.flags|=a.SymbolFlags.Property);a.hasFlag(c,a.VarFlags.Private)&&(this.flags|=a.SymbolFlags.Private);a.hasFlag(c,a.VarFlags.Public)&&(this.flags|=a.SymbolFlags.Public);a.hasFlag(c,a.VarFlags.Readonly)&&(this.flags|=a.SymbolFlags.Readonly);a.hasFlag(c,a.VarFlags.Exported)&&(this.flags|=a.SymbolFlags.Exported)};a.InferenceSymbol=h;var c=function(c,b,f,e){h.call(this,c,b,f);this.type=e;this.expansions=
[];this.isMethod=!1;this.aliasLink=null;this.onlyReferencedAsTypeRef=a.optimizeModuleCodeGen;this.prettyName=this.name};__extends(c,h);c.prototype.addLocation=function(a){null==this.additionalLocations&&(this.additionalLocations=[]);this.additionalLocations[this.additionalLocations.length]=a};c.prototype.kind=function(){return a.SymbolKind.Type};c.prototype.isType=function(){return!0};c.prototype.getType=function(){return this.type};c.prototype.getTypeName=function(a){return this.type.getMemberTypeName(this.name?
this.name+this.getOptionalNameString():"",!1,!1,a)};c.prototype.instanceScope=function(){return!(this.type.typeFlags&a.TypeFlags.IsClass)&&this.type.isClass()?this.type.instanceType.constructorScope:this.type.containedScope};c.prototype.toString=function(){var a=this.type.getTypeName();this.name&&(a=this.name+":"+a);return a};c.prototype.isClass=function(){return null!=this.instanceType};c.prototype.isFunction=function(){return null!=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl};c.prototype.specializeType=
function(a,b,f){if(this.type==a)return b.symbol;a=this.type.specializeType(a,b,f,!1);return a!=this.type?new c(this.name,0,-1,a):this};c.prototype.scopeRelativeName=function(c){if(null==c)return this.prettyName+this.getOptionalNameString();for(var c=this.findCommonAncestorPath(c.container),b="",f=0,e=c.length;f<e;f++)b=(c[f].kind()==a.SymbolKind.Type?c[f].prettyName:c[f].name)+"."+b;return b+=this.prettyName+this.getOptionalNameString()};a.TypeSymbol=c;b=function(a,b,f){c.call(this,"with",a,b,f)};
__extends(b,c);b.prototype.isWith=function(){return!0};a.WithSymbol=b;var f=function(a,c,b,f,e){h.call(this,a,c,b);this.canWrite=f;this.field=e;this.setter=this.getter=null;this.hasBeenEmitted=!1;this.name=a;this.location=c};__extends(f,h);f.prototype.kind=function(){return a.SymbolKind.Field};f.prototype.writeable=function(){return this.isAccessor()?null!=this.setter:this.canWrite};f.prototype.getType=function(){return this.field.typeLink.type};f.prototype.getTypeName=function(a){return this.name+
this.getOptionalNameString()+": "+this.field.typeLink.type.getMemberTypeName("",!0,!1,a)};f.prototype.isMember=function(){return!0};f.prototype.setType=function(a){this.field.typeLink.type=a};f.prototype.isAccessor=function(){return null!=this.getter||null!=this.setter};f.prototype.isVariable=function(){return!0};f.prototype.toString=function(){return this.name+this.getOptionalNameString()+":"+this.field.typeLink.type.getTypeName()};f.prototype.specializeType=function(c,b,e){c=this.field.typeLink.type.specializeType(c,
b,e,!1);return c!=this.field.typeLink.type?(b=new i,e=new f(this.name,0,e.locationInfo.unitIndex,this.canWrite,b),e.flags=this.flags,b.symbol=e,b.typeLink=new a.TypeLink,e.setType(c),e.typeCheckStatus=g.Finished,e):this};a.FieldSymbol=f;var e=function(a,c,b,f){h.call(this,a,c,b);this.parameter=f;this.argsOffset=-1;this.name=a;this.location=c};__extends(e,h);e.prototype.kind=function(){return a.SymbolKind.Parameter};e.prototype.writeable=function(){return!0};e.prototype.getType=function(){return this.parameter.typeLink.type};
e.prototype.setType=function(a){this.parameter.typeLink.type=a};e.prototype.isVariable=function(){return!0};e.prototype.isOptional=function(){return this.parameter&&this.parameter.symbol&&this.parameter.symbol.declAST?this.parameter.symbol.declAST.isOptional:!1};e.prototype.getTypeName=function(a){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getMemberTypeName("",!1,!1,a)};e.prototype.toString=function(){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getTypeName()};
e.prototype.specializeType=function(a,c,b){a=this.parameter.typeLink.type.specializeType(a,c,b,!1);return this.parameter.typeLink.type!=a?(c=new i,b=new e(this.name,0,b.locationInfo.unitIndex,c),c.symbol=b,b.setType(a),b):this};a.ParameterSymbol=e;b=function(a,c,b,f){h.call(this,a,c,b);this.variable=f};__extends(b,h);b.prototype.kind=function(){return a.SymbolKind.Variable};b.prototype.writeable=function(){return!0};b.prototype.getType=function(){return this.variable.typeLink.type};b.prototype.getTypeName=
function(a){return this.name+":"+this.getType().getMemberTypeName("",!1,!1,a)};b.prototype.setType=function(a){this.variable.typeLink.type=a};b.prototype.isVariable=function(){return!0};a.VariableSymbol=b})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.allMembers=this.dualMembers=a;this.publicMembers=this.dualMembers.primaryTable;this.privateMembers=this.dualMembers.secondaryTable};d.prototype.addPublicMember=function(a,b){return this.dualMembers.primaryTable.add(a,b)};d.prototype.addPrivateMember=function(a,b){return this.dualMembers.secondaryTable.add(a,b)};a.ScopedMembers=d;d=a.SymbolKind||(a.SymbolKind={});d._map=[];d._map[0]="None";d.None=0;d._map[1]="Type";d.Type=1;d._map[2]="Field";d.Field=2;d._map[3]=
"Parameter";d.Parameter=3;d._map[4]="Variable";d.Variable=4;var j=a.SymbolKind,b=function(a){this.container=a};b.prototype.printLabel=function(){return"base"};b.prototype.getAllSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllTypeSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllValueSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.search=function(){return null};b.prototype.findLocal=
function(){return null};b.prototype.find=function(){return null};b.prototype.findImplementation=function(){return null};b.prototype.findAmbient=function(){return null};b.prototype.print=function(a){this.container?a.WriteLine(this.printLabel()+" scope with container: "+this.container.name+"..."):a.WriteLine(this.printLabel()+" scope...")};b.prototype.enter=function(){throw Error("please implement in derived class");};b.prototype.getTable=function(){throw Error("please implement in derived class");
};a.SymbolScope=b;d=function(a){this.container=a;this.parents=this.typeAmbientCache=this.typeImplCache=this.typeCache=this.valueAmbientCache=this.valueImplCache=this.valueCache=null;this.container=a};__extends(d,b);d.prototype.printLabel=function(){return"agg"};d.prototype.search=function(a,b,h,c){if(this.parents)for(var f=0;f<this.parents.length;f++){var e=this.parents[f].search(a,b,h,c);if(e&&a.update(e))return e}return a.result};d.prototype.getAllSymbolNames=function(a){var b=[];if(this.parents)for(var h=
0;h<this.parents.length;h++){var c=this.parents[h].getAllSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.getAllTypeSymbolNames=function(a){var b=[];if(this.parents)for(var h=0;h<this.parents.length;h++){var c=this.parents[h].getAllTypeSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.getAllValueSymbolNames=function(a){var b=[];if(this.parents)for(var h=0;h<this.parents.length;h++){var c=this.parents[h].getAllValueSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.print=function(a){b.prototype.print.call(this,
a);if(this.parents)for(var i=0;i<this.parents.length;i++)this.parents[i].print(a)};d.prototype.findImplementation=function(b,i,h){var c=null,f=0,e=this.valueImplCache;h&&(e=this.typeImplCache);if(e&&null!=(c=e.lookup(b))&&(i?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(f=0;f<this.parents.length&&!(c=this.parents[f].findImplementation(b,i,h));f++);e&&(e=h?this.typeImplCache=
new a.StringHashTable:this.valueImplCache=new a.StringHashTable);e.add(b,c);return c};d.prototype.find=function(b,i,h){var c=null,f=0,e=this.valueCache;h&&(e=this.typeCache);if(e&&null!=(c=e.lookup(b))&&(i?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(f=0;f<this.parents.length&&!(c=this.parents[f].find(b,i,h));f++);null==e&&(e=h?this.typeCache=new a.StringHashTable:this.valueCache=
new a.StringHashTable);e.add(b,c);return c};d.prototype.findAmbient=function(b,i,h){var c=null,f=0,e=this.valueAmbientCache;h&&(e=this.typeAmbientCache);if(e&&null!=(c=e.lookup(b)))return c;if(this.parents)for(f=0;f<this.parents.length&&!(c=this.parents[f].findAmbient(b,i,h));f++);null==e&&(e=h?this.typeAmbientCache=new a.StringHashTable:this.valueAmbientCache=new a.StringHashTable);e.add(b,c);return c};d.prototype.addParentScope=function(a){null==this.parents&&(this.parents=[]);this.parents[this.parents.length]=
a};a.SymbolAggregateScope=d;d=function(a,b,h,c,f){this.container=f;this.valueMembers=a;this.ambientValueMembers=b;this.enclosedTypes=h;this.ambientEnclosedTypes=c;this.container=f};__extends(d,b);d.prototype.printLabel=function(){return"table"};d.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};d.prototype.getAllTypeSymbolNames=function(){var a=[];this.ambientEnclosedTypes&&(a=a.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));
this.enclosedTypes&&(a=a.concat(this.enclosedTypes.allMembers.getAllKeys()));return a};d.prototype.getAllValueSymbolNames=function(){var a=[];this.ambientValueMembers&&(a=a.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(a=a.concat(this.valueMembers.allMembers.getAllKeys()));return a};d.prototype.search=function(a,b,h,c){b=this.find(b,h,c);a.update(b);return a.result};d.prototype.find=function(a,b,h){var c=null,f=null;h?(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:
this.enclosedTypes.allMembers,f=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers):(c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,f=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers);return f&&(b=f.lookup(a))||c&&(b=c.lookup(a))?b:null};d.prototype.findAmbient=function(a,b,h){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:
this.ambientValueMembers.allMembers;h&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&(a=c.lookup(a))?a:null};d.prototype.print=function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+
b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null)};d.prototype.findImplementation=function(a,b,h){(a=this.find(a,b,h))&&(a.kind()==j.Type?a.type.hasImplementation()||(a=null):a.container&&a.container.kind()==j.Type&&(a.container.type.hasImplementation()||(a=null)));return a};d.prototype.getTable=function(){return this.valueMembers.publicMembers};a.SymbolTableScope=d;var g=function(a,b,h,c,f,e){this.container=e;this.valueMembers=a;this.ambientValueMembers=
b;this.enclosedTypes=h;this.ambientEnclosedTypes=c;this.parent=f;this.container=e};__extends(g,b);g.prototype.printLabel=function(){return"builder"};g.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};g.prototype.getAllTypeSymbolNames=function(a){var b=[];this.ambientEnclosedTypes&&(b=b.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));this.enclosedTypes&&(b=b.concat(this.enclosedTypes.allMembers.getAllKeys()));!a&&this.parent&&
(a=this.parent.getAllTypeSymbolNames(a))&&(b=b.concat(a));return b};g.prototype.getAllValueSymbolNames=function(a){var b=[];this.ambientValueMembers&&(b=b.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(b=b.concat(this.valueMembers.allMembers.getAllKeys()));!a&&this.parent&&(a=this.parent.getAllValueSymbolNames(a))&&(b=b.concat(a));return b};g.prototype.search=function(a,b,h,c){var f=null,e=null==this.valueMembers?null:h?this.valueMembers.publicMembers:this.valueMembers.allMembers,
d=null==this.ambientValueMembers?null:h?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;c&&(e=null==this.enclosedTypes?null:h?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,d=null==this.ambientEnclosedTypes?null:h?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return d&&null!=(f=d.lookup(b))&&a.update(f)||e&&null!=(f=e.lookup(b))&&a.update(f)||this.parent&&(f=this.parent.search(a,b,h,c))&&a.update(f)?f:a.result};g.prototype.print=
function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.parent&&this.parent.print(a)};g.prototype.find=function(a,
b,h){var c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,f=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;h&&(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,f=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return f&&null!=f.lookup(a)||c&&null!=c.lookup(a)?null:this.parent?
this.parent.find(a,b,h):null};g.prototype.findAmbient=function(a,b,h){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;h&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&null!=c.lookup(a)?null:this.parent?this.parent.findAmbient(a,b,h):null};g.prototype.findLocal=function(a,b,h){var c=null,f=null==this.valueMembers?null:b?this.valueMembers.publicMembers:
this.valueMembers.allMembers,e=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;h&&(f=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,e=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return f&&null!=(c=f.lookup(a))&&c||e&&null!=(c=e.lookup(a))&&c?c:null};g.prototype.enter=function(b,i,h,c,f,e,d){var g=null;(g=d?e?null==
this.ambientEnclosedTypes?null:f?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.privateMembers:null==this.ambientValueMembers?null:f?this.ambientValueMembers.publicMembers:this.ambientValueMembers.privateMembers:e?null==this.enclosedTypes?null:f?this.enclosedTypes.publicMembers:this.enclosedTypes.privateMembers:null==this.valueMembers?null:f?this.valueMembers.publicMembers:this.valueMembers.privateMembers)?g.add(h.name,h)||c.duplicateIdentifier(i,h.name):a.CompilerDiagnostics.Alert("YYYYY");
h.container=b};g.prototype.getTable=function(){return this.valueMembers.allMembers};a.SymbolScopeBuilder=g;d=function(a,b,h){this.container=b;this.scope=a;this.filter=h};__extends(d,b);d.prototype.print=function(a){this.scope.print(a)};d.prototype.find=function(a,b,h){this.filter.reset();return this.scope.search(this.filter,a,b,h)};d.prototype.findLocal=function(a,b,h){return this.scope.findLocal(a,b,h)};a.FilteredSymbolScope=d;d=function(a,b,h,c){g.call(this,a,null,null,null,b,h);this.filter=c};
__extends(d,g);d.prototype.findLocal=function(a,b,h){return(a=g.prototype.findLocal.call(this,a,b,h))&&!this.filter(a)?null:a};d.prototype.search=function(){throw Error("please implement");};d.prototype.find=function(a,b,h){var c=g.prototype.findLocal.call(this,a,b,h);return c&&!this.filter(c)?null:g.prototype.find.call(this,a,b,h)};a.FilteredSymbolScopeBuilder=d})(TypeScript||(TypeScript={}));
(function(a){function d(c,b,h,d,g,j,k,s){void 0!==c&&(a.tokenTable[c]=new i(c,b,h,d,g,j,k,s),d!=a.NodeType.None&&(a.nodeTypeTable[d]=k,a.nodeTypeToTokTable[d]=c),j!=a.NodeType.None&&(a.nodeTypeTable[j]=k))}function j(c){return a.tokenTable[c]}var b=a.TokenID||(a.TokenID={});b._map=[];b._map[0]="ANY";b.ANY=0;b._map[1]="BOOL";b.BOOL=1;b._map[2]="BREAK";b.BREAK=2;b._map[3]="CASE";b.CASE=3;b._map[4]="CATCH";b.CATCH=4;b._map[5]="CLASS";b.CLASS=5;b._map[6]="CONST";b.CONST=6;b._map[7]="CONTINUE";b.CONTINUE=
7;b._map[8]="DEBUGGER";b.DEBUGGER=8;b._map[9]="DEFAULT";b.DEFAULT=9;b._map[10]="DELETE";b.DELETE=10;b._map[11]="DO";b.DO=11;b._map[12]="ELSE";b.ELSE=12;b._map[13]="ENUM";b.ENUM=13;b._map[14]="EXPORT";b.EXPORT=14;b._map[15]="EXTENDS";b.EXTENDS=15;b._map[16]="DECLARE";b.DECLARE=16;b._map[17]="FALSE";b.FALSE=17;b._map[18]="FINALLY";b.FINALLY=18;b._map[19]="FOR";b.FOR=19;b._map[20]="FUNCTION";b.FUNCTION=20;b._map[21]="CONSTRUCTOR";b.CONSTRUCTOR=21;b._map[22]="GET";b.GET=22;b._map[23]="IF";b.IF=23;b._map[24]=
"IMPLEMENTS";b.IMPLEMENTS=24;b._map[25]="IMPORT";b.IMPORT=25;b._map[26]="IN";b.IN=26;b._map[27]="INSTANCEOF";b.INSTANCEOF=27;b._map[28]="INTERFACE";b.INTERFACE=28;b._map[29]="LET";b.LET=29;b._map[30]="MODULE";b.MODULE=30;b._map[31]="NEW";b.NEW=31;b._map[32]="NUMBER";b.NUMBER=32;b._map[33]="NULL";b.NULL=33;b._map[34]="PACKAGE";b.PACKAGE=34;b._map[35]="PRIVATE";b.PRIVATE=35;b._map[36]="PROTECTED";b.PROTECTED=36;b._map[37]="PUBLIC";b.PUBLIC=37;b._map[38]="RETURN";b.RETURN=38;b._map[39]="SET";b.SET=39;
b._map[40]="STATIC";b.STATIC=40;b._map[41]="STRING";b.STRING=41;b._map[42]="SUPER";b.SUPER=42;b._map[43]="SWITCH";b.SWITCH=43;b._map[44]="THIS";b.THIS=44;b._map[45]="THROW";b.THROW=45;b._map[46]="TRUE";b.TRUE=46;b._map[47]="TRY";b.TRY=47;b._map[48]="TYPEOF";b.TYPEOF=48;b._map[49]="VAR";b.VAR=49;b._map[50]="VOID";b.VOID=50;b._map[51]="WITH";b.WITH=51;b._map[52]="WHILE";b.WHILE=52;b._map[53]="YIELD";b.YIELD=53;b._map[54]="SColon";b.SColon=54;b._map[55]="LParen";b.LParen=55;b._map[56]="RParen";b.RParen=
56;b._map[57]="LBrack";b.LBrack=57;b._map[58]="RBrack";b.RBrack=58;b._map[59]="LCurly";b.LCurly=59;b._map[60]="RCurly";b.RCurly=60;b._map[61]="Comma";b.Comma=61;b._map[62]="Asg";b.Asg=62;b._map[63]="AsgAdd";b.AsgAdd=63;b._map[64]="AsgSub";b.AsgSub=64;b._map[65]="AsgMul";b.AsgMul=65;b._map[66]="AsgDiv";b.AsgDiv=66;b._map[67]="AsgMod";b.AsgMod=67;b._map[68]="AsgAnd";b.AsgAnd=68;b._map[69]="AsgXor";b.AsgXor=69;b._map[70]="AsgOr";b.AsgOr=70;b._map[71]="AsgLsh";b.AsgLsh=71;b._map[72]="AsgRsh";b.AsgRsh=
72;b._map[73]="AsgRs2";b.AsgRs2=73;b._map[74]="QMark";b.QMark=74;b._map[75]="Colon";b.Colon=75;b._map[76]="LogOr";b.LogOr=76;b._map[77]="LogAnd";b.LogAnd=77;b._map[78]="Or";b.Or=78;b._map[79]="Xor";b.Xor=79;b._map[80]="And";b.And=80;b._map[81]="EQ";b.EQ=81;b._map[82]="NE";b.NE=82;b._map[83]="Eqv";b.Eqv=83;b._map[84]="NEqv";b.NEqv=84;b._map[85]="LT";b.LT=85;b._map[86]="LE";b.LE=86;b._map[87]="GT";b.GT=87;b._map[88]="GE";b.GE=88;b._map[89]="Lsh";b.Lsh=89;b._map[90]="Rsh";b.Rsh=90;b._map[91]="Rs2";b.Rs2=
91;b._map[92]="Add";b.Add=92;b._map[93]="Sub";b.Sub=93;b._map[94]="Mult";b.Mult=94;b._map[95]="Div";b.Div=95;b._map[96]="Pct";b.Pct=96;b._map[97]="Tilde";b.Tilde=97;b._map[98]="Bang";b.Bang=98;b._map[99]="Inc";b.Inc=99;b._map[100]="Dec";b.Dec=100;b._map[101]="Dot";b.Dot=101;b._map[102]="Ellipsis";b.Ellipsis=102;b._map[103]="Error";b.Error=103;b._map[104]="EOF";b.EOF=104;b._map[105]="Arrow";b.Arrow=105;b._map[106]="ID";b.ID=106;b._map[107]="QString";b.QString=107;b._map[108]="Regex";b.Regex=108;b._map[109]=
"NumberLit";b.NumberLit=109;b._map[110]="Whitespace";b.Whitespace=110;b._map[111]="Comment";b.Comment=111;b._map[112]="Lim";b.Lim=112;b.LimFixed=b.Arrow;b.LimKeyword=b.YIELD;var g=a.TokenID;a.tokenTable=[];a.nodeTypeTable=[];a.nodeTypeToTokTable=[];a.noRegexTable=[];a.noRegexTable[g.ID]=!0;a.noRegexTable[g.QString]=!0;a.noRegexTable[g.NumberLit]=!0;a.noRegexTable[g.Regex]=!0;a.noRegexTable[g.THIS]=!0;a.noRegexTable[g.Inc]=!0;a.noRegexTable[g.Dec]=!0;a.noRegexTable[g.RParen]=!0;a.noRegexTable[g.RBrack]=
!0;a.noRegexTable[g.RCurly]=!0;a.noRegexTable[g.TRUE]=!0;a.noRegexTable[g.FALSE]=!0;b=a.OperatorPrecedence||(a.OperatorPrecedence={});b._map=[];b._map[0]="No";b.No=0;b._map[1]="Cma";b.Cma=1;b._map[2]="Asg";b.Asg=2;b._map[3]="Que";b.Que=3;b._map[4]="Lor";b.Lor=4;b._map[5]="Lan";b.Lan=5;b._map[6]="Bor";b.Bor=6;b._map[7]="Xor";b.Xor=7;b._map[8]="Ban";b.Ban=8;b._map[9]="Equ";b.Equ=9;b._map[10]="Cmp";b.Cmp=10;b._map[11]="Shf";b.Shf=11;b._map[12]="Add";b.Add=12;b._map[13]="Mul";b.Mul=13;b._map[14]="Uni";
b.Uni=14;b._map[15]="Lim";b.Lim=15;var b=a.OperatorPrecedence,k=a.Reservation||(a.Reservation={});k._map=[];k.None=0;k.Javascript=1;k.JavascriptFuture=2;k.TypeScript=4;k.JavascriptFutureStrict=8;k.TypeScriptAndJS=k.Javascript|k.TypeScript;k.TypeScriptAndJSFuture=k.JavascriptFuture|k.TypeScript;k.TypeScriptAndJSFutureStrict=k.JavascriptFutureStrict|k.TypeScript;var k=a.Reservation,i;i=function(a,c,b,i,h,d,g,j){this.tokenId=a;this.reservation=c;this.binopPrecedence=b;this.binopNodeType=i;this.unopPrecedence=
h;this.unopNodeType=d;this.text=g;this.ers=j};a.TokenInfo=i;d(g.ANY,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"any",a.ErrorRecoverySet.PrimType);d(g.BOOL,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"bool",a.ErrorRecoverySet.PrimType);d(g.BREAK,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"break",a.ErrorRecoverySet.Stmt);d(g.CASE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"case",a.ErrorRecoverySet.SCase);d(g.CATCH,k.TypeScriptAndJS,b.No,a.NodeType.None,
b.No,a.NodeType.None,"catch",a.ErrorRecoverySet.Catch);d(g.CLASS,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"class",a.ErrorRecoverySet.TypeScriptS);d(g.CONST,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"const",a.ErrorRecoverySet.Var);d(g.CONTINUE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"continue",a.ErrorRecoverySet.Stmt);d(g.DEBUGGER,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.Debugger,"debugger",a.ErrorRecoverySet.Stmt);
d(g.DEFAULT,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"default",a.ErrorRecoverySet.SCase);d(g.DELETE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Delete,"delete",a.ErrorRecoverySet.Prefix);d(g.DO,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"do",a.ErrorRecoverySet.Stmt);d(g.ELSE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"else",a.ErrorRecoverySet.Else);d(g.ENUM,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"enum",a.ErrorRecoverySet.TypeScriptS);
d(g.EXPORT,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"export",a.ErrorRecoverySet.TypeScriptS);d(g.EXTENDS,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"extends",a.ErrorRecoverySet.None);d(g.DECLARE,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"declare",a.ErrorRecoverySet.Stmt);d(g.FALSE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"false",a.ErrorRecoverySet.RLit);d(g.FINALLY,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"finally",a.ErrorRecoverySet.Catch);d(g.FOR,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"for",a.ErrorRecoverySet.Stmt);d(g.FUNCTION,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"function",a.ErrorRecoverySet.Func);d(g.CONSTRUCTOR,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"constructor",a.ErrorRecoverySet.Func);d(g.GET,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"get",a.ErrorRecoverySet.Func);d(g.SET,k.TypeScript,b.No,a.NodeType.None,
b.No,a.NodeType.None,"set",a.ErrorRecoverySet.Func);d(g.IF,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"if",a.ErrorRecoverySet.Stmt);d(g.IMPLEMENTS,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"implements",a.ErrorRecoverySet.None);d(g.IMPORT,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"import",a.ErrorRecoverySet.TypeScriptS);d(g.IN,k.TypeScriptAndJS,b.Cmp,a.NodeType.In,b.No,a.NodeType.None,"in",a.ErrorRecoverySet.None);d(g.INSTANCEOF,
k.TypeScriptAndJS,b.Cmp,a.NodeType.InstOf,b.No,a.NodeType.None,"instanceof",a.ErrorRecoverySet.BinOp);d(g.INTERFACE,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"interface",a.ErrorRecoverySet.TypeScriptS);d(g.LET,k.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"let",a.ErrorRecoverySet.None);d(g.MODULE,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"module",a.ErrorRecoverySet.TypeScriptS);d(g.NEW,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"new",a.ErrorRecoverySet.PreOp);d(g.NUMBER,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"number",a.ErrorRecoverySet.PrimType);d(g.NULL,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"null",a.ErrorRecoverySet.RLit);d(g.PACKAGE,k.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"package",a.ErrorRecoverySet.None);d(g.PRIVATE,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"private",a.ErrorRecoverySet.TypeScriptS);d(g.PROTECTED,k.JavascriptFutureStrict,
b.No,a.NodeType.None,b.No,a.NodeType.None,"protected",a.ErrorRecoverySet.None);d(g.PUBLIC,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"public",a.ErrorRecoverySet.TypeScriptS);d(g.RETURN,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"return",a.ErrorRecoverySet.Stmt);d(g.STATIC,k.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"static",a.ErrorRecoverySet.None);d(g.STRING,k.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"string",a.ErrorRecoverySet.PrimType);
d(g.SUPER,k.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"super",a.ErrorRecoverySet.RLit);d(g.SWITCH,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"switch",a.ErrorRecoverySet.Stmt);d(g.THIS,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"this",a.ErrorRecoverySet.RLit);d(g.THROW,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"throw",a.ErrorRecoverySet.Stmt);d(g.TRUE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"true",a.ErrorRecoverySet.RLit);
d(g.TRY,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"try",a.ErrorRecoverySet.Stmt);d(g.TYPEOF,k.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Typeof,"typeof",a.ErrorRecoverySet.Prefix);d(g.VAR,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"var",a.ErrorRecoverySet.Var);d(g.VOID,k.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Void,"void",a.ErrorRecoverySet.Prefix);d(g.WITH,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.With,"with",a.ErrorRecoverySet.Stmt);
d(g.WHILE,k.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"while",a.ErrorRecoverySet.While);d(g.YIELD,k.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"yield",a.ErrorRecoverySet.None);d(g.ID,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"identifier",a.ErrorRecoverySet.ID);d(g.NumberLit,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"numberLiteral",a.ErrorRecoverySet.Literal);d(g.Regex,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"regex",a.ErrorRecoverySet.RegExp);
d(g.QString,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"qstring",a.ErrorRecoverySet.Literal);d(g.SColon,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,";",a.ErrorRecoverySet.SColon);d(g.RParen,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,")",a.ErrorRecoverySet.RParen);d(g.RBrack,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"]",a.ErrorRecoverySet.RBrack);d(g.LCurly,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"{",a.ErrorRecoverySet.LCurly);d(g.RCurly,k.None,b.No,a.NodeType.None,
b.No,a.NodeType.None,"}",a.ErrorRecoverySet.RCurly);d(g.Ellipsis,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"...",a.ErrorRecoverySet.None);d(g.Comma,k.None,b.Cma,a.NodeType.Comma,b.No,a.NodeType.None,",",a.ErrorRecoverySet.Comma);d(g.Asg,k.None,b.Asg,a.NodeType.Asg,b.No,a.NodeType.None,"=",a.ErrorRecoverySet.Asg);d(g.AsgAdd,k.None,b.Asg,a.NodeType.AsgAdd,b.No,a.NodeType.None,"+=",a.ErrorRecoverySet.BinOp);d(g.AsgSub,k.None,b.Asg,a.NodeType.AsgSub,b.No,a.NodeType.None,"-=",a.ErrorRecoverySet.BinOp);
d(g.AsgMul,k.None,b.Asg,a.NodeType.AsgMul,b.No,a.NodeType.None,"*=",a.ErrorRecoverySet.BinOp);d(g.AsgDiv,k.None,b.Asg,a.NodeType.AsgDiv,b.No,a.NodeType.None,"/=",a.ErrorRecoverySet.BinOp);d(g.AsgMod,k.None,b.Asg,a.NodeType.AsgMod,b.No,a.NodeType.None,"%=",a.ErrorRecoverySet.BinOp);d(g.AsgAnd,k.None,b.Asg,a.NodeType.AsgAnd,b.No,a.NodeType.None,"&=",a.ErrorRecoverySet.BinOp);d(g.AsgXor,k.None,b.Asg,a.NodeType.AsgXor,b.No,a.NodeType.None,"^=",a.ErrorRecoverySet.BinOp);d(g.AsgOr,k.None,b.Asg,a.NodeType.AsgOr,
b.No,a.NodeType.None,"|=",a.ErrorRecoverySet.BinOp);d(g.AsgLsh,k.None,b.Asg,a.NodeType.AsgLsh,b.No,a.NodeType.None,"<<=",a.ErrorRecoverySet.BinOp);d(g.AsgRsh,k.None,b.Asg,a.NodeType.AsgRsh,b.No,a.NodeType.None,">>=",a.ErrorRecoverySet.BinOp);d(g.AsgRs2,k.None,b.Asg,a.NodeType.AsgRs2,b.No,a.NodeType.None,">>>=",a.ErrorRecoverySet.BinOp);d(g.QMark,k.None,b.Que,a.NodeType.QMark,b.No,a.NodeType.None,"?",a.ErrorRecoverySet.BinOp);d(g.Colon,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,":",a.ErrorRecoverySet.Colon);
d(g.LogOr,k.None,b.Lor,a.NodeType.LogOr,b.No,a.NodeType.None,"||",a.ErrorRecoverySet.BinOp);d(g.LogAnd,k.None,b.Lan,a.NodeType.LogAnd,b.No,a.NodeType.None,"&&",a.ErrorRecoverySet.BinOp);d(g.Or,k.None,b.Bor,a.NodeType.Or,b.No,a.NodeType.None,"|",a.ErrorRecoverySet.BinOp);d(g.Xor,k.None,b.Xor,a.NodeType.Xor,b.No,a.NodeType.None,"^",a.ErrorRecoverySet.BinOp);d(g.And,k.None,b.Ban,a.NodeType.And,b.No,a.NodeType.None,"&",a.ErrorRecoverySet.BinOp);d(g.EQ,k.None,b.Equ,a.NodeType.Eq,b.No,a.NodeType.None,"==",
a.ErrorRecoverySet.BinOp);d(g.NE,k.None,b.Equ,a.NodeType.Ne,b.No,a.NodeType.None,"!=",a.ErrorRecoverySet.BinOp);d(g.Eqv,k.None,b.Equ,a.NodeType.Eqv,b.No,a.NodeType.None,"===",a.ErrorRecoverySet.BinOp);d(g.NEqv,k.None,b.Equ,a.NodeType.NEqv,b.No,a.NodeType.None,"!==",a.ErrorRecoverySet.BinOp);d(g.LT,k.None,b.Cmp,a.NodeType.Lt,b.No,a.NodeType.None,"<",a.ErrorRecoverySet.BinOp);d(g.LE,k.None,b.Cmp,a.NodeType.Le,b.No,a.NodeType.None,"<=",a.ErrorRecoverySet.BinOp);d(g.GT,k.None,b.Cmp,a.NodeType.Gt,b.No,
a.NodeType.None,">",a.ErrorRecoverySet.BinOp);d(g.GE,k.None,b.Cmp,a.NodeType.Ge,b.No,a.NodeType.None,">=",a.ErrorRecoverySet.BinOp);d(g.Lsh,k.None,b.Shf,a.NodeType.Lsh,b.No,a.NodeType.None,"<<",a.ErrorRecoverySet.BinOp);d(g.Rsh,k.None,b.Shf,a.NodeType.Rsh,b.No,a.NodeType.None,">>",a.ErrorRecoverySet.BinOp);d(g.Rs2,k.None,b.Shf,a.NodeType.Rs2,b.No,a.NodeType.None,">>>",a.ErrorRecoverySet.BinOp);d(g.Add,k.None,b.Add,a.NodeType.Add,b.Uni,a.NodeType.Pos,"+",a.ErrorRecoverySet.AddOp);d(g.Sub,k.None,b.Add,
a.NodeType.Sub,b.Uni,a.NodeType.Neg,"-",a.ErrorRecoverySet.AddOp);d(g.Mult,k.None,b.Mul,a.NodeType.Mul,b.No,a.NodeType.None,"*",a.ErrorRecoverySet.BinOp);d(g.Div,k.None,b.Mul,a.NodeType.Div,b.No,a.NodeType.None,"/",a.ErrorRecoverySet.BinOp);d(g.Pct,k.None,b.Mul,a.NodeType.Mod,b.No,a.NodeType.None,"%",a.ErrorRecoverySet.BinOp);d(g.Tilde,k.None,b.No,a.NodeType.None,b.Uni,a.NodeType.Not,"~",a.ErrorRecoverySet.PreOp);d(g.Bang,k.None,b.No,a.NodeType.None,b.Uni,a.NodeType.LogNot,"!",a.ErrorRecoverySet.PreOp);
d(g.Inc,k.None,b.No,a.NodeType.None,b.Uni,a.NodeType.IncPre,"++",a.ErrorRecoverySet.PreOp);d(g.Dec,k.None,b.No,a.NodeType.None,b.Uni,a.NodeType.DecPre,"--",a.ErrorRecoverySet.PreOp);d(g.LParen,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"(",a.ErrorRecoverySet.LParen);d(g.LBrack,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"[",a.ErrorRecoverySet.LBrack);d(g.Dot,k.None,b.Uni,a.NodeType.None,b.No,a.NodeType.None,".",a.ErrorRecoverySet.Dot);d(g.EOF,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,
"<EOF>",a.ErrorRecoverySet.EOF);d(g.Arrow,k.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"=>",a.ErrorRecoverySet.None);a.lookupToken=j;b=a.TokenClass||(a.TokenClass={});b._map=[];b._map[0]="Punctuation";b.Punctuation=0;b._map[1]="Keyword";b.Keyword=1;b._map[2]="Operator";b.Operator=2;b._map[3]="Comment";b.Comment=3;b._map[4]="Whitespace";b.Whitespace=4;b._map[5]="Identifier";b.Identifier=5;b._map[6]="Literal";b.Literal=6;var h=a.TokenClass;a.SavedToken=function(a,c,b){this.tok=a;this.minChar=c;
this.limChar=b};var c=function(a){this.tokenId=a};c.prototype.toString=function(){return"token: "+this.tokenId+" "+this.getText()+" ("+g._map[this.tokenId]+")"};c.prototype.print=function(a,c){c.WriteLine(this.toString()+",on line"+a)};c.prototype.getText=function(){return a.tokenTable[this.tokenId].text};c.prototype.classification=function(){if(this.tokenId<=g.LimKeyword)return h.Keyword;var c=j(this.tokenId);return void 0!=c&&(c.unopNodeType!=a.NodeType.None||c.binopNodeType!=a.NodeType.None)?h.Operator:
h.Punctuation};a.Token=c;b=function(a){this.tokenId=g.NumberLit;this.value=a};__extends(b,c);b.prototype.getText=function(){return this.value.toString()};b.prototype.classification=function(){return h.Literal};a.NumberToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return this.tokenId==g.ID?h.Identifier:h.Literal};a.StringToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=
a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return h.Whitespace};a.WhitespaceToken=b;b=function(a,c,b,i,h,d){this.tokenId=a;this.value=c;this.isBlock=b;this.startPos=i;this.line=h;this.endsLine=d;this.tokenID=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return h.Comment};a.CommentToken=b;b=function(a){this.tokenId=g.Regex;this.regex=a};__extends(b,c);b.prototype.getText=function(){return this.regex.toString()};
b.prototype.classification=function(){return h.Literal};a.RegexToken=b;a.staticTokens=[];a.initializeStaticTokens=function(){for(var b=0;b<=g.LimFixed;b++)a.staticTokens[b]=new c(b)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.arrayBase=null};d.prototype.specialize=function(a,b){null==this.arrayBase&&(this.arrayBase=a.specializeType(b.wildElm.type,this.arrayType.elementType,b,!0));return this.arrayBase};a.ArrayCache=d;var j=function(){this.onlyCaptureFirstError=!1;this.flags=a.TypeRelationshipFlags.SuccessfulComparison;this.message=""};j.prototype.addMessageToFront=function(a){this.onlyCaptureFirstError?this.setMessage(a):this.message=this.message?a+":\n\t"+this.message:a};j.prototype.setMessage=
function(a){this.message=a};a.TypeComparisonInfo=j;j=a.TypeCheckCollectionMode||(a.TypeCheckCollectionMode={});j._map=[];j._map[0]="Resident";j.Resident=0;j._map[1]="Transient";j.Transient=1;var b=a.TypeCheckCollectionMode,j=function(i){this.errorReporter=i;this.importedGlobalsTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.importedGlobalsTypeTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.ambientGlobalTypes=
this.ambientGlobals=this.globalTypes=this.globals=null;this.residentGlobalValues=new a.StringHashTable;this.residentGlobalTypes=new a.StringHashTable;this.residentGlobalAmbientValues=new a.StringHashTable;this.residentGlobalAmbientTypes=new a.StringHashTable;this.residentTypeCheck=!0;this.wildElm=this.gloMod=this.mod=null;this.importedGlobals=new a.SymbolScopeBuilder(null,this.importedGlobalsTable,null,this.importedGlobalsTypeTable,null,null);this.dualGlobalValues=new a.DualStringHashTable(this.residentGlobalValues,
new a.StringHashTable);this.dualGlobalTypes=new a.DualStringHashTable(this.residentGlobalTypes,new a.StringHashTable);this.dualAmbientGlobalValues=new a.DualStringHashTable(this.residentGlobalAmbientValues,new a.StringHashTable);this.dualAmbientGlobalTypes=new a.DualStringHashTable(this.residentGlobalAmbientTypes,new a.StringHashTable);var i=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalValues,new a.StringHashTable)),h=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalValues,
new a.StringHashTable)),c=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalTypes,new a.StringHashTable)),f=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalTypes,new a.StringHashTable));this.globalScope=new a.SymbolScopeBuilder(i,h,c,f,this.importedGlobals,null);this.voidType=this.enterPrimitive(a.Primitive.Void,"void");this.booleanType=this.enterPrimitive(a.Primitive.Boolean,"bool");this.doubleType=this.enterPrimitive(a.Primitive.Double,"number");this.importedGlobals.ambientEnclosedTypes.addPublicMember("number",
this.doubleType.symbol);this.stringType=this.enterPrimitive(a.Primitive.String,"string");this.anyType=this.enterPrimitive(a.Primitive.Any,"any");this.nullType=this.enterPrimitive(a.Primitive.Null,"null");this.undefinedType=this.enterPrimitive(a.Primitive.Undefined,"undefined");this.setCollectionMode(b.Resident);this.wildElm=new a.TypeSymbol("_element",0,-1,new a.Type);this.importedGlobalsTypeTable.addPublicMember(this.wildElm.name,this.wildElm);this.mod=new a.ModuleType(c,f);this.mod.members=i;this.mod.ambientMembers=
h;this.mod.containedScope=this.globalScope;this.gloMod=new a.TypeSymbol(a.globalId,0,-1,this.mod);this.mod.members.addPublicMember(this.gloMod.name,this.gloMod);this.defineGlobalValue("undefined",this.undefinedType)};j.prototype.enterPrimitive=function(b,h){var c=new a.Type;c.primitiveTypeClass=b;var f=new a.TypeSymbol(h,0,-1,c);f.typeCheckStatus=a.TypeCheckStatus.Finished;c.symbol=f;this.importedGlobals.enter(null,null,f,this.errorReporter,!0,!0,!0);return c};j.prototype.setCollectionMode=function(a){this.residentTypeCheck=
this.dualGlobalValues.insertPrimary=this.dualGlobalTypes.insertPrimary=this.dualAmbientGlobalValues.insertPrimary=this.dualAmbientGlobalTypes.insertPrimary=a==b.Resident};j.prototype.refreshPersistentState=function(){this.globals=new a.StringHashTable;this.globalTypes=new a.StringHashTable;this.ambientGlobals=new a.StringHashTable;this.ambientGlobalTypes=new a.StringHashTable;this.globalTypes.add(this.voidType.symbol.name,this.voidType.symbol);this.globalTypes.add(this.booleanType.symbol.name,this.booleanType.symbol);
this.globalTypes.add(this.doubleType.symbol.name,this.doubleType.symbol);this.globalTypes.add("number",this.doubleType.symbol);this.globalTypes.add(this.stringType.symbol.name,this.stringType.symbol);this.globalTypes.add(this.anyType.symbol.name,this.anyType.symbol);this.globalTypes.add(this.nullType.symbol.name,this.nullType.symbol);this.globalTypes.add(this.undefinedType.symbol.name,this.undefinedType.symbol);this.dualGlobalValues.secondaryTable=this.globals;this.dualGlobalTypes.secondaryTable=
this.globalTypes;this.dualAmbientGlobalValues.secondaryTable=this.ambientGlobals;this.dualAmbientGlobalTypes.secondaryTable=this.ambientGlobalTypes};j.prototype.defineGlobalValue=function(b,h){var c=new a.ValueLocation;c.typeLink=new a.TypeLink;c=new a.VariableSymbol(b,0,-1,c);c.setType(h);c.typeCheckStatus=a.TypeCheckStatus.Finished;c.container=this.gloMod;this.importedGlobalsTable.addPublicMember(b,c)};a.PersistentGlobalTypeState=j;var g;g=function(a,b,c){this.contextualType=a;this.provisional=
b;this.contextID=c;this.targetAccessorType=this.targetThis=this.targetSig=null};a.ContextualTypeContext=g;var k=function(a){this.checker=a;this.contextStack=[];this.hadProvisionalErrors=!1};k.contextID=a.TypeCheckStatus.Finished+1;k.prototype.pushContextualType=function(a,b){this.contextStack.push(new g(a,b,k.contextID++));this.checker.errorReporter.pushToErrorSink=b};k.prototype.popContextualType=function(){var a=this.contextStack.pop();this.checker.errorReporter.pushToErrorSink=this.isProvisional();
this.hadProvisionalErrors=this.hadProvisionalErrors||a.provisional&&this.checker.errorReporter.getCapturedErrors().length;this.checker.errorReporter.freeCapturedErrors();return a};k.prototype.getContextualType=function(){return!this.contextStack.length?null:this.contextStack[this.contextStack.length-1]};k.prototype.getContextID=function(){return!this.contextStack.length?a.TypeCheckStatus.Finished:this.contextStack[this.contextStack.length-1].contextID};k.prototype.isProvisional=function(){return!this.contextStack.length?
!1:this.contextStack[this.contextStack.length-1].provisional};a.ContextualTypingContextStack=k;j=function(a){this.persistentState=a;this.errorReporter=null;this.checkControlFlowUseDef=this.printControlFlowGraph=this.checkControlFlow=!1;this.units=this.styleSettings=null;this.anon="_anonymous";this.currentModDecl=this.currentCompareB=this.currentCompareA=this.typeFlow=this.locationInfo=null;this.inWith=this.inBind=!1;this.errorsOnWith=!0;this.currentContextualTypeContext=null;this.canCallDefinitionSignature=
this.resolvingBases=!1;this.assignableCache={};this.subtypeCache={};this.identicalCache={};this.provisionalStartedTypecheckObjects=[];this.mustCaptureGlobalThis=!1;this.voidType=this.persistentState.voidType;this.booleanType=this.persistentState.booleanType;this.numberType=this.persistentState.doubleType;this.stringType=this.persistentState.stringType;this.anyType=this.persistentState.anyType;this.nullType=this.persistentState.nullType;this.undefinedType=this.persistentState.undefinedType;this.globals=
this.persistentState.dualGlobalValues;this.globalTypes=this.persistentState.dualGlobalTypes;this.ambientGlobals=this.persistentState.dualAmbientGlobalValues;this.ambientGlobalTypes=this.persistentState.dualAmbientGlobalTypes;this.gloModType=this.persistentState.mod;this.gloMod=this.persistentState.gloMod;this.wildElm=this.persistentState.wildElm;this.globalScope=this.persistentState.globalScope;this.typingContextStack=new k(this)};j.prototype.setStyleOptions=function(a){this.styleSettings=a};j.prototype.setContextualType=
function(a,b){this.typingContextStack.pushContextualType(a,b);this.currentContextualTypeContext=this.typingContextStack.getContextualType()};j.prototype.unsetContextualType=function(){var a=this.typingContextStack.popContextualType();this.currentContextualTypeContext=this.typingContextStack.getContextualType();return a};j.prototype.hadProvisionalErrors=function(){return this.typingContextStack.hadProvisionalErrors};j.prototype.resetProvisionalErrors=function(){this.typingContextStack.getContextualType()||
(this.typingContextStack.hadProvisionalErrors=!1)};j.prototype.typeCheckWithContextualType=function(a,b,c,f){c&&this.setContextualType(a,this.typingContextStack.isProvisional()||b);this.typeFlow.typeCheck(f);c&&this.unsetContextualType()};j.prototype.resetTargetType=function(){this.currentContextualTypeContext=this.typingContextStack.getContextualType()};j.prototype.killCurrentContextualType=function(){this.currentContextualTypeContext=null;this.errorReporter.pushToErrorSink=!1};j.prototype.hasTargetType=
function(){return this.currentContextualTypeContext&&this.currentContextualTypeContext.contextualType};j.prototype.getTargetTypeContext=function(){return this.currentContextualTypeContext};j.prototype.inProvisionalTypecheckMode=function(){return this.typingContextStack.isProvisional()};j.prototype.getTypeCheckFinishedStatus=function(){return this.inProvisionalTypecheckMode()?this.typingContextStack.getContextID():a.TypeCheckStatus.Finished};j.prototype.typeStatusIsFinished=function(b){return b==a.TypeCheckStatus.Finished||
this.inProvisionalTypecheckMode()&&b==this.typingContextStack.getContextID()};j.prototype.addStartedPTO=function(a){this.inProvisionalTypecheckMode()&&(this.provisionalStartedTypecheckObjects[this.provisionalStartedTypecheckObjects.length]=a)};j.prototype.cleanStartedPTO=function(){for(var b=0;b<this.provisionalStartedTypecheckObjects.length;b++)this.provisionalStartedTypecheckObjects[b].typeCheckStatus==this.typingContextStack.getContextID()&&(this.provisionalStartedTypecheckObjects[b].typeCheckStatus=
a.TypeCheckStatus.NotStarted);this.provisionalStartedTypecheckObjects=[]};j.prototype.collectTypes=function(b){b.nodeType==a.NodeType.Script&&(this.locationInfo=b.locationInfo);var h=new a.ScopeChain(this.gloMod,null,this.globalScope),h=new a.TypeCollectionContext(h,this);a.getAstWalkerFactory().walk(b,a.preCollectTypes,a.postCollectTypes,null,h)};j.prototype.makeArrayType=function(b){null==b.arrayCache&&(b.arrayCache=new d,b.arrayCache.arrayType=new a.Type,b.arrayCache.arrayType.elementType=b,b.arrayCache.arrayType.symbol=
b.symbol);return b.arrayCache.arrayType};j.prototype.getParameterList=function(b,h){var c=null,c=null,f=b.members.length,e=0,d=[];if(0<f)for(var c=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),c=new a.SymbolScopeBuilder(c,null,null,null,null,h),g=0;g<f;g++){var m=b.members[g],j=new a.ValueLocation,k=new a.ParameterSymbol(m.id.text,m.minChar,this.locationInfo.unitIndex,j);k.declAST=m;m.id.sym=k;m.sym=k;j.symbol=k;j.typeLink=a.getTypeLink(m.typeExpr,this,
!1);c.enter(null,m,k,this.errorReporter,!0,!1,!1);d[d.length]=k;m.isOptionalArg()||e++}return{parameters:d,nonOptionalParameterCount:e}};j.prototype.createFunctionSignature=function(b,h,c,f,e){var d=a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)||h==this.gloMod,g=a.hasFlag(b.fncFlags,a.FncFlags.Static),m=a.hasFlag(b.fncFlags,a.FncFlags.Private),j=a.hasFlag(b.fncFlags,a.FncFlags.Definition),k=a.hasFlag(b.fncFlags,a.FncFlags.Ambient),s=b.isConstructMember()||b.isConstructor,
p=h==this.gloMod,q=new a.Signature,t=b.fncFlags&a.FncFlags.IsFunctionExpression;b.returnTypeAnnotation||j?q.returnType=a.getTypeLink(b.returnTypeAnnotation,this,!1):(q.returnType=new a.TypeLink,q.returnType.type=this.anyType);q.hasVariableArgList=b.variableArgList;j=this.getParameterList(b.args,h);q.parameters=j.parameters;q.nonOptionalParameterCount=j.nonOptionalParameterCount;b.signature=q;q.declAST=b;var r=f&&f.getType()&&!f.isAccessor()&&(b.isSignature()||k==a.hasFlag(f.flags,a.SymbolFlags.Ambient));
r&&m!=a.hasFlag(f.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Public/Private visibility of overloads does not agree");j=r?f.getType():new a.Type;s?(null==j.construct&&(j.construct=new a.SignatureGroup),j.construct.addSignature(q),j.construct.hasImplementation=!b.isSignature(),j.construct.hasImplementation&&j.setHasImplementation()):b.isIndexerMember()?(null==j.index&&(j.index=new a.SignatureGroup,j.index.flags|=a.SignatureFlags.IsIndexer),j.index.addSignature(q),j.index.hasImplementation=
!b.isSignature(),j.index.hasImplementation&&j.setHasImplementation()):(null==j.call&&(j.call=new a.SignatureGroup),j.call.addSignature(q),j.call.hasImplementation=!b.isSignature(),j.call.hasImplementation&&j.setHasImplementation());var v=j.instanceType;v&&!g&&(null==v.call?v.call=j.call:j.call&&v.call.signatures.concat(j.call.signatures));var v=null,w=!1;b.name&&!b.name.isMissing()?v=b.name.text:b.hint&&(v=b.hint,w=!0);null==j.symbol&&(j.symbol=new a.TypeSymbol(v?v:this.anon,b.minChar,this.locationInfo.unitIndex,
j),r||(j.symbol.declAST=b));g&&(j.symbol.flags|=a.SymbolFlags.Static);k&&(j.symbol.flags|=a.SymbolFlags.Ambient);m&&(j.symbol.flags|=a.SymbolFlags.Private);j.symbol.isMethod=b.isMethod();j.symbol.isMethod&&(j.symbol.flags|=a.SymbolFlags.Property);b.type=j;if(!s)if(v&&!t&&!b.isAccessor()&&!w)if(e)if(b.isMethod()&&g)h.type.members.publicMembers.add(v,j.symbol)||this.errorReporter.duplicateIdentifier(b,v),j.symbol.container=h;else{if(null==f||f.declAST&&!f.declAST.isOverload&&h.isType())c.enter(h,b,
j.symbol,this.errorReporter,!m&&(d||g||p),!1,k)}else b.isSpecialFn()||(j.symbol.container=h);else b.isSpecialFn()||(j.symbol.container=h);if(r&&(b=f?f.getType():null,j!=b&&(null==j.construct?j.construct=b&&b.construct?b.construct:new a.SignatureGroup:b&&b.construct&&j.construct.signatures.concat(b.construct.signatures),b))){null==j.call?j.call=b.call:b.call&&j.call.signatures.concat(b.call.signatures);if(!g&&(null==j.instanceType&&(j.instanceType=b.instanceType),v=j.instanceType))null==v.call?v.call=
b.call:b.call&&v.call.signatures.concat(b.call.signatures);null==j.index?j.index=b.index:b.index&&j.index.signatures.concat(b.index.signatures)}return q};j.prototype.createAccessorSymbol=function(b,h,c,f,e,d,g){var j=null,k=b.signature,u=b.name.text,s=a.hasFlag(b.fncFlags,a.FncFlags.Static),p=a.hasFlag(b.fncFlags,a.FncFlags.Private);null==h?(h=new a.ValueLocation,j=new a.FieldSymbol(u,b.minChar,this.locationInfo.unitIndex,!1,h),h.symbol=j,j.declAST=b,a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(j.getter&&
this.errorReporter.simpleError(b,"Redeclaration of property getter"),j.getter=k.declAST.type.symbol):(j.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),j.setter=k.declAST.type.symbol),h.typeLink=a.getTypeLink(null,this,!1),f?c?(c.members.publicMembers.add(u,j)||this.errorReporter.duplicateIdentifier(b,j.name),j.container=c.symbol):this.errorReporter.simpleError(b,"Accessor property may not be added in this context"):d.enter(g,b,j,this.errorReporter,!p||s,!1,!1),e&&(j.flags|=
a.SymbolFlags.Property),s&&(j.flags|=a.SymbolFlags.Static),j.flags=p?j.flags|a.SymbolFlags.Private:j.flags|a.SymbolFlags.Public):(j=h,p!=a.hasFlag(j.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Getter and setter accessors do not agree in visibility"),a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(j.getter&&this.errorReporter.simpleError(b,"Redeclaration of property getter"),j.getter=b.type.symbol):(j.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),j.setter=
b.type.symbol));return j};j.prototype.addBases=function(b,h,c){b.addParentScope(new a.SymbolTableScope(h.members,h.ambientMembers,h.getAllEnclosedTypes(),h.getAllAmbientEnclosedTypes(),h.symbol));var f=0,e;if(h.extendsList)for(var d=h.extendsList.length;f<d;f++){e=h.extendsList[f];if(c.baseId==e.typeID){this.errorReporter.reportErrorFromSym(e.symbol,"Type '"+c.base+"' is recursively referenced as a base class of itself");e.symbol.flags|=a.SymbolFlags.RecursivelyReferenced;break}this.addBases(b,e,
c)}};j.prototype.scopeOf=function(b){var h=new a.SymbolAggregateScope(b.symbol);this.addBases(h,b,{base:b.symbol&&b.symbol.name?b.symbol.name:"{}",baseId:b.typeID});return h};j.prototype.lookupMemberType=function(a,b){var c=null;a.containedScope?c=a.containedScope.find(b,!1,!0):a.members&&(c=a.members.allMembers.lookup(b),null==c&&a.ambientMembers&&(c=a.ambientMembers.allMembers.lookup(b)));if(null==c){var f=a.getAllEnclosedTypes(),e=a.getAllAmbientEnclosedTypes();f&&(c=f.allMembers.lookup(b),null==
c&&e&&(c=e.allMembers.lookup(b)))}return c&&c.isType()?c.getType():null};j.prototype.findSymbolForDynamicModule=function(b,h,c){var f=b,e=c(b);if(null==e&&(e||(b=a.swapQuotes(f),e=c(b)),e||(b=a.stripQuotes(f)+".ts",e=c(b)),e||(b=a.stripQuotes(f)+".str",e=c(b)),e||(b=a.stripQuotes(f)+".d.ts",e=c(b)),e||(b=a.stripQuotes(f)+".d.str",e=c(b)),!e&&!a.isRelative(f))){f=a.stripQuotes(f);for(h=a.getRootFilePath(a.switchToForwardSlashes(h));null==e&&""!=h&&"/"!=h;)b=a.normalizePath(h+f+".ts"),e=c(b),null==
e&&(b=a.changePathToSTR(b),e=c(b)),null==e&&(b=a.changePathToDTS(b),e=c(b)),null==e&&(b=a.changePathToDSTR(b),e=c(b)),null==e&&(h=(h=a.normalizePath(h+".."))&&"/"!=h?h+"/":h)}return e};j.prototype.resolveTypeMember=function(b,h){var c=h.operand1,f=h.operand2,e=this.anyType,d=this.anyType;if(c&&f&&f.nodeType==a.NodeType.Name){if(c.nodeType==a.NodeType.Dot)d=this.resolveTypeMember(b,c);else if(c.nodeType==a.NodeType.Name){var g=b.find(c.text,!1,!0);if(null==g)this.errorReporter.unresolvedSymbol(c,c.text);
else if(g.isType()){if(g.aliasLink&&(!g.type&&g.aliasLink.alias.nodeType==a.NodeType.Name)&&(d=this.findSymbolForDynamicModule(g.aliasLink.alias.text,this.locationInfo.filename,function(a){return b.find(a,!1,!0)})))g.type=d.getType();if(a.optimizeModuleCodeGen&&g&&(d=g.getType())&&g.aliasLink&&g.onlyReferencedAsTypeRef)if((d=d.symbol.declAST)&&a.hasFlag(d.modFlags,a.ModuleFlags.IsDynamic))g.onlyReferencedAsTypeRef=!this.resolvingBases;g.visible(b,this)||this.errorReporter.simpleError(c,"The symbol '"+
c.text+"' is not visible at this point");d=g.getType();c.sym=g}else this.errorReporter.simpleError(c,"Expected type")}d||(d=this.anyType);d!=this.anyType&&(e=this.lookupMemberType(d,f.text),null==e?(e=this.anyType,this.errorReporter.simpleError(h,"Expected type")):e.symbol.visible(b,this)||this.errorReporter.simpleError(c,"The symbol '"+f.text+"' is not visible at this point"),f.sym=e.symbol)}e.isClass()&&(e=e.instanceType);return e};j.prototype.resolveFuncDecl=function(a,b,c){var c=this.createFunctionSignature(a,
b.container,b,c,!1).declAST.type.symbol,f;f=a.isConstructMember()?c.type.construct.signatures:a.isIndexerMember()?c.type.getInstanceType().index.signatures:c.type.call.signatures;f=f[f.length-1];for(var e=f.parameters.length,d=0;d<e;d++)this.resolveTypeLink(b,f.parameters[d].parameter.typeLink,!0);e&&a.variableArgList&&!f.parameters[e-1].parameter.typeLink.type.elementType&&(this.errorReporter.simpleErrorFromSym(f.parameters[e-1].parameter.symbol,"... parameter must have array type"),f.parameters[e-
1].parameter.typeLink.type=this.makeArrayType(f.parameters[e-1].parameter.typeLink.type));this.resolveTypeLink(b,f.returnType,a.isSignature());return c};j.prototype.resolveVarDecl=function(b,h){var c=new a.ValueLocation,f=new a.FieldSymbol(b.id.text,b.minChar,this.locationInfo.unitIndex,(b.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,c);f.transferVarFlags(b.varFlags);c.symbol=f;f.declAST=b;c.typeLink=a.getTypeLink(b.typeExpr,this,null==b.init);this.resolveTypeLink(h,c.typeLink,!0);b.sym=f;b.type=
c.typeLink.type;return f};j.prototype.resolveTypeLink=function(b,h,c){var f=0;if(null==h.type){var e=h.ast;if(e)for(;null==h.type;)switch(e.nodeType){case a.NodeType.Name:var d=e,g=b.find(d.text,!1,!0);null==g?(h.type=this.anyType,this.errorReporter.unresolvedSymbol(d,d.text)):g.isType()?(g.visible(b,this)||this.errorReporter.simpleError(e,"The symbol '"+d.text+"' is not visible at this point"),d.sym=g,h.type=g.getType(),h.type?h.type.isClass()&&(h.type=h.type.instanceType):h.type=this.anyType):(h.type=
this.anyType,this.errorReporter.simpleError(e,"Expected type"));break;case a.NodeType.Dot:h.type=this.resolveTypeMember(b,e);break;case a.NodeType.TypeRef:f=e.arrayCount;e=e.term;null==e&&(h.type=this.anyType);break;case a.NodeType.Interface:var j=e,d=new a.Type,g=new a.TypeSymbol(j.name.text,e.minChar,this.locationInfo.unitIndex,d);d.symbol=g;d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));d.containedScope=new a.SymbolTableScope(d.members,null,
null,null,g);d.containedScope.container=g;d.memberScope=d.containedScope;for(var j=j.members.members,k=j.length,u=0;u<k;u++){var s=j[u],p=null,q=!0,t=null;s.nodeType==a.NodeType.FuncDecl?(t=s.name,p=d.members.allMembers.lookup(s.getNameText()),q=null==p,s.isSpecialFn()?(q=!1,p=this.resolveFuncDecl(s,b,g)):p=this.resolveFuncDecl(s,b,p),s.type=p.type):(t=s.id,p=this.resolveVarDecl(s,b));q&&(t&&a.hasFlag(t.flags,a.ASTFlags.OptionalName)&&(p.flags|=a.SymbolFlags.Optional),d.members.allMembers.add(p.name,
p)||this.errorReporter.duplicateIdentifier(e,p.name))}e.type=d;h.type=d;break;case a.NodeType.FuncDecl:d=this.resolveFuncDecl(e,b,null);h.type=d.type;break;default:h.type=this.anyType,this.errorReporter.simpleError(e,"Expected type")}for(b=f;0<b;b--)h.type=this.makeArrayType(h.type);c&&null==h.type&&(h.type=this.anyType);h.ast&&(h.ast.type=h.type)}};j.prototype.findMostApplicableSignature=function(a,b){if(1==a.length)return{sig:a[0].signature,ambiguous:!1};for(var c=a[0],f=null,e=null,d=null,g=null,
e=!1,j=1;j<a.length;j++){for(var f=a[j],k=0,k=0;b&&k<b.members.length;k++)if(e=b.members[k].type,d=k<c.signature.parameters.length?c.signature.parameters[k].getType():c.signature.parameters[c.signature.parameters.length-1].getType().elementType,g=k<f.signature.parameters.length?f.signature.parameters[k].getType():f.signature.parameters[f.signature.parameters.length-1].getType().elementType,!this.typesAreIdentical(d,g))if(this.typesAreIdentical(e,d))break;else if(this.typesAreIdentical(e,g)){c=f;break}else if(this.sourceIsSubtypeOfTarget(d,
g))break;else if(this.sourceIsSubtypeOfTarget(g,d)){c=f;break}else if(f.hadProvisionalErrors)break;else if(c.hadProvisionalErrors){c=f;break}e=!b||k==b.members.length?!this.findBestCommonType(c.signature.returnType.type,null,{getLength:function(){return 2},setTypeAtIndex:function(){},getTypeAtIndex:function(a){return a?f.signature.returnType.type:c.signature.returnType.type}}):!1}return{sig:c.signature,ambiguous:e}};j.prototype.getApplicableSignatures=function(b,h,c){for(var f=[],e=null,d=!1,g=!1,
j=0;j<b.length;j++){for(var d=!1,k=0;k<h.members.length;k++)if(!(k>=b[j].parameters.length)&&(e=b[j].parameters[k].getType(),b[j].declAST.variableArgList&&(k>=b[j].nonOptionalParameterCount-1&&e.isArray())&&(e=e.elementType),e!=this.anyType))if(h.members[k].nodeType==a.NodeType.FuncDecl){if(!(this.typeFlow.functionInterfaceType&&e==this.typeFlow.functionInterfaceType))if(this.canContextuallyTypeFunction(e,h.members[k],!0)){if(this.typeCheckWithContextualType(e,!0,!0,h.members[k]),this.cleanStartedPTO(),
g=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(h.members[k].type,e,c)||(c&&c.setMessage("Could not apply type '"+e.getTypeName()+"' to argument "+(k+1)+", which is of type '"+h.members[k].type.getTypeName()+"'"),d=!0),this.resetProvisionalErrors(),d)break}else if(this.canContextuallyTypeFunction(e,h.members[k],!1)){if(this.typeFlow.typeCheck(h.members[k]),!this.sourceIsAssignableToTarget(h.members[k].type,e,c))break}else break}else if(h.members[k].nodeType==a.NodeType.ObjectLit){if(!(this.typeFlow.objectInterfaceType&&
e==this.typeFlow.objectInterfaceType)&&(this.typeCheckWithContextualType(e,!0,!0,h.members[k]),this.cleanStartedPTO(),g=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(h.members[k].type,e,c)||(c&&c.setMessage("Could not apply type '"+e.getTypeName()+"' to argument "+(k+1)+", which is of type '"+h.members[k].type.getTypeName()+"'"),d=!0),this.resetProvisionalErrors(),d))break}else if(h.members[k].nodeType==a.NodeType.ArrayLit&&!(this.typeFlow.arrayInterfaceType&&e==this.typeFlow.arrayInterfaceType)){this.typeCheckWithContextualType(e,
!0,!0,h.members[k]);this.cleanStartedPTO();g=this.hadProvisionalErrors();if(!this.sourceIsAssignableToTarget(h.members[k].type,e,c)){c&&c.setMessage("Could not apply type '"+e.getTypeName()+"' to argument "+(k+1)+", which is of type '"+h.members[k].type.getTypeName()+"'");break}this.resetProvisionalErrors();if(d)break}k==h.members.length&&(f[f.length]={signature:b[j],hadProvisionalErrors:g});g=!1}return f};j.prototype.canContextuallyTypeFunction=function(a,b,c){if(b.isParenthesized||b.isMethod()||
c&&b.returnTypeAnnotation||b.isInlineCallLiteral)return!1;c=c||this.typeFlow.functionInterfaceType==a;if(!c)return!0;b.signature||(this.createFunctionSignature(b,this.typeFlow.scope.container,this.typeFlow.scope,null,null),this.typeFlow.typeCheck(b));for(var b=b.signature,f=b.parameters.length,e=0;e<f;e++){var d=b.parameters[e].declAST;if(c&&d.typeExpr)return!1}if(a.construct&&a.call)return!1;a=a.construct?a.construct:a.call;return!a||1<a.signatures.length?!1:!0};j.prototype.canContextuallyTypeObjectLiteral=
function(b,h){if(b==this.typeFlow.objectInterfaceType)return!0;var c=h.operand;if(!c||!b.memberScope)return!1;for(var f=null,f=null,e="",d={},g=0;g<c.members.length;g++){f=c.members[g].operand1;if(f.nodeType==a.NodeType.Name)e=f.text;else if(f.nodeType==a.NodeType.QString)f=f.text,e=f.substring(1,f.length-1);else return!1;f=b.memberScope.find(e,!0,!1);if(!f)return!1;d[e]=!0}c=b.memberScope.getAllValueSymbolNames(!0);for(g=0;g<c.length;g++)if(f=b.memberScope.find(c[g],!0,!1),!d[c[g]]&&!a.hasFlag(f.flags,
a.SymbolFlags.Optional))return!1;return!0};j.prototype.widenType=function(a){return a==this.undefinedType||a==this.nullType?this.anyType:a};j.prototype.isNullOrUndefinedType=function(a){return a==this.undefinedType||a==this.nullType};j.prototype.findBestCommonType=function(a,b,c,f){var e=0,d=c.getLength(),g=0;b&&(a=a?a.mergeOrdered(b,this):b);for(var j=a;g<d;){for(e=0;e<d;e++)if(e!=g){if(j&&(a=j.mergeOrdered(c.getTypeAtIndex(e),this,f)))j=a;if(a==this.anyType||null==a)break;else b&&c.setTypeAtIndex(e,
b)}if(j&&a)break;g++;g<d&&(j=c.getTypeAtIndex(g))}return a};j.prototype.typesAreIdentical=function(b,h){if(b==h)return!0;if(!b||!h)return!1;var c=h.typeID<<16|b.typeID;if(this.identicalCache[c])return!0;if(b.typeFlags&a.TypeFlags.IsEnum||h.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||h.isArray()){if(!b.isArray()||!h.isArray())return!1;this.identicalCache[c]=!1;var f=this.typesAreIdentical(b.elementType,h.elementType);this.subtypeCache[c]=f?!0:void 0;return f}if(b.primitiveTypeClass!=h.primitiveTypeClass)return!1;
this.identicalCache[c]=!1;if(b.memberScope&&h.memberScope){var f=b.memberScope.getAllValueSymbolNames(!0).sort(),e=h.memberScope.getAllValueSymbolNames(!0).sort();if(f.length!=e.length)return this.identicalCache[c]=void 0,!1;for(var d=null,g=null,g=d=null,j=0;j<f.length;j++){if(f[j]!=e[j])return this.identicalCache[c]=void 0,!1;d=b.memberScope.find(f[j],!1,!1);g=h.memberScope.find(e[j],!1,!1);if((d.flags&a.SymbolFlags.Optional)!=(g.flags&a.SymbolFlags.Optional))return this.identicalCache[c]=void 0,
!1;d=d.getType();g=g.getType();if((!d||!(g&&void 0!=this.identicalCache[g.typeID<<16|d.typeID]))&&!this.typesAreIdentical(d,g))return this.identicalCache[c]=void 0,!1}}else if(b.memberScope||h.memberScope)return this.identicalCache[c]=void 0,!1;return!this.signatureGroupsAreIdentical(b.call,h.call)||!this.signatureGroupsAreIdentical(b.construct,h.construct)||!this.signatureGroupsAreIdentical(b.index,h.index)?(this.identicalCache[c]=void 0,!1):this.identicalCache[c]=!0};j.prototype.signatureGroupsAreIdentical=
function(a,b){if(a==b)return!0;if(!a||!b||a.signatures.length!=b.signatures.length)return!1;for(var c=null,f=null,e=!1,d=0;d<a.signatures.length;d++){for(var c=a.signatures[d],g=0;g<b.signatures.length;g++)if(f=b.signatures[g],this.signaturesAreIdentical(c,f)){e=!0;break}if(e)e=!1;else return!1}return!0};j.prototype.signaturesAreIdentical=function(a,b){if(a.hasVariableArgList!=b.hasVariableArgList||a.nonOptionalParameterCount!=b.nonOptionalParameterCount||a.parameters.length!=b.parameters.length||
!this.typesAreIdentical(a.returnType.type,b.returnType.type))return!1;for(var c=0;c<a.parameters.length;c++)if(!this.typesAreIdentical(a.parameters[c].parameter.typeLink.type,b.parameters[c].parameter.typeLink.type))return!1;return!0};j.prototype.sourceIsSubtypeOfTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};j.prototype.signatureGroupIsSubtypeOfTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};j.prototype.signatureIsSubtypeOfTarget=
function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};j.prototype.sourceIsAssignableToTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!0,this.assignableCache,c)};j.prototype.signatureGroupIsAssignableToTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!0,this.assignableCache,c)};j.prototype.signatureIsAssignableToTarget=function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!0,this.assignableCache,c)};j.prototype.sourceIsRelatableToTarget=
function(b,d,c,f,e){if(b==d||!b||!d)return!0;var g=b.typeID<<16|d.typeID;if(void 0!=f[g])return!0;if(c){if(b==this.anyType||d==this.anyType)return!0}else if(d==this.anyType)return!0;if(b==this.undefinedType||b==this.nullType&&d!=this.undefinedType&&d!=this.voidType||d==this.numberType&&b.typeFlags&a.TypeFlags.IsEnum||b==this.numberType&&d.typeFlags&a.TypeFlags.IsEnum)return!0;if(b.typeFlags&a.TypeFlags.IsEnum||d.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||d.isArray()){if(!b.isArray()||!d.isArray())return!1;
f[g]=!1;e=this.sourceIsRelatableToTarget(b.elementType,d.elementType,c,f,e);f[g]=e?!0:void 0;return e}if(b.primitiveTypeClass!=d.primitiveTypeClass)if(d.primitiveTypeClass==a.Primitive.None)if(b==this.numberType&&this.typeFlow.numberInterfaceType)b=this.typeFlow.numberInterfaceType;else if(b==this.stringType&&this.typeFlow.stringInterfaceType)b=this.typeFlow.stringInterfaceType;else if(b==this.booleanType&&this.typeFlow.booleanInterfaceType)b=this.typeFlow.booleanInterfaceType;else return!1;else return!1;
f[g]=!1;if(b.hasBase(d))return f[g]=!0;if(this.typeFlow.objectInterfaceType&&d==this.typeFlow.objectInterfaceType||this.typeFlow.functionInterfaceType&&(b.call||b.construct)&&d==this.typeFlow.functionInterfaceType)return!0;if(d.isClass()||d.isClassInstance())return f[g]=void 0,!1;if(d.memberScope&&b.memberScope)for(var j=d.memberScope.getAllValueSymbolNames(!0),m=null,k=null,u=null,s=k=null,p=0;p<j.length;p++)if(m=d.memberScope.find(j[p],!1,!1),k=b.memberScope.find(j[p],!1,!1),!(m.kind()==a.SymbolKind.Variable&&
m.variable.typeLink.ast&&m.variable.typeLink.ast.nodeType==a.NodeType.Name&&"IArguments"==m.variable.typeLink.ast.text)){m.isInferenceSymbol()&&(s=m,s.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(m.declAST));u=m.getType();if(!k&&(this.typeFlow.objectInterfaceType&&(k=this.typeFlow.objectInterfaceType.memberScope.find(j[p],!1,!1)),!k)){if(this.typeFlow.functionInterfaceType&&(u.call||u.construct))k=this.typeFlow.functionInterfaceType.memberScope.find(j[p],!1,!1);if(!k)if(m.flags&
a.SymbolFlags.Optional)continue;else return f[g]=void 0,e&&(e.flags|=a.TypeRelationshipFlags.RequiredPropertyIsMissing,e.addMessageToFront("Type '"+b.getTypeName()+"' is missing property '"+j[p]+"' from type '"+d.getTypeName()+"'")),!1}k.isInferenceSymbol()&&(s=k,s.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(k.declAST));k=k.getType();if((!u||!(k&&void 0!=f[k.typeID<<16|u.typeID]))&&!this.sourceIsRelatableToTarget(k,u,c,f,e))return f[g]=void 0,e&&(e.flags|=a.TypeRelationshipFlags.IncompatiblePropertyTypes,
e.addMessageToFront("Types of property '"+m.name+"' of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible")),!1}return(b.call||d.call)&&!this.signatureGroupIsRelatableToTarget(b.call,d.call,c,f,e)?(e&&(b.call&&d.call?e.addMessageToFront("Call signatures of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible"):(c=d.call?d.getTypeName():b.getTypeName(),b=!d.call?d.getTypeName():b.getTypeName(),e.setMessage("Type '"+c+"' requires a call signature, but Type '"+b+
"' lacks one")),e.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),f[g]=void 0,!1):(b.construct||d.construct)&&!this.signatureGroupIsRelatableToTarget(b.construct,d.construct,c,f,e)?(e&&(b.construct&&d.construct?e.addMessageToFront("Construct signatures of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible"):(c=d.construct?d.getTypeName():b.getTypeName(),b=!d.construct?d.getTypeName():b.getTypeName(),e.setMessage("Type '"+c+"' requires a construct signature, but Type '"+
b+"' lacks one")),e.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),f[g]=void 0,!1):d.index&&!this.signatureGroupIsRelatableToTarget(!b.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:b.index,!d.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:d.index,c,f,e)?(e&&(e.addMessageToFront("Index signatures of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible"),e.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),
f[g]=void 0,!1):f[g]=!0};j.prototype.signatureGroupIsRelatableToTarget=function(a,b,c,f,e){if(a==b)return!0;if(!a||!b)return!1;for(var d=null,g=null,j=!1,k=0;k<b.signatures.length;k++){for(var d=b.signatures[k],u=0;u<a.signatures.length;u++)if(g=a.signatures[u],this.signatureIsRelatableToTarget(g,d,c,f,e)){j=!0;break}if(j)j=!1;else return!1}return!0};j.prototype.signatureIsRelatableToTarget=function(b,d,c,f,e){if(!b.parameters||!d.parameters)return!1;var g=d.hasVariableArgList?d.nonOptionalParameterCount-
1:d.nonOptionalParameterCount,j=b.hasVariableArgList?b.nonOptionalParameterCount-1:b.nonOptionalParameterCount;if(j>g&&!d.hasVariableArgList)return e&&(e.flags|=a.TypeRelationshipFlags.SourceSignatureHasTooManyParameters,e.addMessageToFront("Call signature expects "+g+" or fewer parameters")),!1;var m=b.returnType.type,k=d.returnType.type;if(k!=this.voidType&&!this.sourceIsRelatableToTarget(m,k,c,f,e))return e&&(e.flags|=a.TypeRelationshipFlags.IncompatibleReturnTypes),!1;for(var m=j<g&&b.hasVariableArgList?
g:j,u=k=null,s=0,p=0;s<m;s++,p++)if(!b.hasVariableArgList||s<j?k=b.parameters[s].parameter.typeLink.type:s==j&&(k=b.parameters[s].parameter.typeLink.type,k.elementType&&(k=k.elementType)),p<d.parameters.length&&p<g?u=d.parameters[p].parameter.typeLink.type:d.hasVariableArgList&&p==g&&(u=d.parameters[p].parameter.typeLink.type,u.elementType&&(u=u.elementType)),!this.sourceIsRelatableToTarget(k,u,c,f,e)&&!this.sourceIsRelatableToTarget(u,k,c,f,e))return e&&(e.flags|=a.TypeRelationshipFlags.IncompatibleParameterTypes),
!1;return!0};a.TypeChecker=j})(TypeScript||(TypeScript={}));
(function(a){function d(c,b){if(c){var f=c.members.length;null==b&&(b=[]);for(var e=0;e<f;e++){var d=c.members[e];d.nodeType==a.NodeType.Call&&(d=d.target);var h=new a.TypeLink;h.ast=d;b[b.length]=h}}return b}function j(a,c){a.extendsTypeLinks=d(c.extendsList,a.extendsTypeLinks);a.implementsTypeLinks=d(c.implementsList,a.implementsTypeLinks)}function b(c){var b=new a.Signature;b.returnType=new a.TypeLink;b.returnType.type=c.instanceType;b.parameters=[];c.construct=new a.SignatureGroup;c.construct.addSignature(b)}
function g(a,c){var b=c.scope.find(a,!1,!0);null==b&&c.previous&&(b=g(a,c.previous));return b}function k(c,b){var f=null;switch(c.nodeType){case a.NodeType.Name:var e=c.text,f=function(){return b.members?b.members.lookup(e):g(e,b.topLevelScope)},f=a.isQuoted(e)?b.tcContext.checker.findSymbolForDynamicModule(e,b.tcContext.script.locationInfo.filename,f):f(e);break;case a.NodeType.Dot:var d=k(c.operand1,b);d&&d.getType()&&(f=k(c.operand2,b))}if(f&&(d=f.getType()))if(d=d.members)b.members=d.publicMembers;
return f}function i(c,b,f){var b=f.scopeChain,e=null,e=null,d=a.hasFlag(c.varFlags,a.VarFlags.Exported),h=k(c.alias,{topLevelScope:b,members:null,tcContext:f}),g=f.scopeChain.container==f.checker.gloMod;h&&(h=h.getType())&&(e=h);e=new a.TypeSymbol(c.id.text,c.minChar,f.checker.locationInfo.unitIndex,e);e.aliasLink=c;f.scopeChain.moduleDecl&&(e.declModule=f.scopeChain.moduleDecl);e.declAST=c;c.id.sym=e;b.scope.enter(b.container,c,e,f.checker.errorReporter,d||g,!0,!1);b.scope.enter(b.container,c,e,
f.checker.errorReporter,d||g,!1,!1);return!0}function h(c,b,f){var e=f.scopeChain,d=a.hasFlag(c.modFlags,a.ModuleFlags.Ambient),b=a.hasFlag(c.modFlags,a.ModuleFlags.IsEnum),h=f.scopeChain.container==f.checker.gloMod,g=a.hasFlag(c.modFlags,a.ModuleFlags.Exported),i=c.name.text;a.isQuoted(i);var j=e.scope.findLocal(i,!1,!1),l=null,k=null;null==j||j.kind()!=a.SymbolKind.Type?(null==k&&(k=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),j=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),k=new a.ModuleType(k,j),b&&(k.typeFlags|=a.TypeFlags.IsEnum),k.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),k.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),k.setHasImplementation()),l=new a.TypeSymbol(i,c.minChar,f.checker.locationInfo.unitIndex,k),f.scopeChain.moduleDecl&&(l.declModule=f.scopeChain.moduleDecl),l.declAST=c,l.prettyName=c.prettyName,e.scope.enter(e.container,
c,l,f.checker.errorReporter,g||h,!0,d),e.scope.enter(e.container,c,l,f.checker.errorReporter,g||h,!1,d),k.symbol=l):(j&&(j.declAST&&j.declAST.nodeType!=a.NodeType.Module)&&f.checker.errorReporter.simpleError(c,"Conflicting symbol name for module '"+i+"'"),l=j,k=l.type.getAllEnclosedTypes().publicMembers,k=null==k?new a.StringHashTable:k,k=new a.ScopedMembers(new a.DualStringHashTable(k,new a.StringHashTable)),j=l.type.getAllAmbientEnclosedTypes().publicMembers,j=null==j?new a.StringHashTable:j,j=
new a.ScopedMembers(new a.DualStringHashTable(j,new a.StringHashTable)),e=l.type.members.publicMembers,e=null==e?new a.StringHashTable:e,e=new a.ScopedMembers(new a.DualStringHashTable(e,new a.StringHashTable)),d=l.type.ambientMembers.publicMembers,d=null==d?new a.StringHashTable:d,d=new a.ScopedMembers(new a.DualStringHashTable(d,new a.StringHashTable)),k=new a.ModuleType(k,j),b&&(k.typeFlags|=a.TypeFlags.IsEnum),k.members=e,k.ambientMembers=d,k.setHasImplementation(),k.symbol=l,l.addLocation(c.minChar),
l.expansions.push(k));f.scopeChain.moduleDecl&&f.scopeChain.moduleDecl.recordNonInterface();g&&(l.flags|=a.SymbolFlags.Exported);if(f.scopeChain.moduleDecl||f.scopeChain.container==f.checker.gloMod)l.flags|=a.SymbolFlags.ModuleMember;c.mod=k;a.pushTypeCollectionScope(l,k.members,k.ambientMembers,k.enclosedTypes,k.ambientEnclosedTypes,f,null,null,c);return!0}function c(c,f,e){var d=e.scopeChain,h,g=null,f=c.name.text,i=a.hasFlag(c.varFlags,a.VarFlags.Ambient),l=a.hasFlag(c.varFlags,a.VarFlags.Exported),
k=e.scopeChain.container==e.checker.gloMod;h=!1;g=d.scope.findLocal(f,!1,!0);if(!g){var n=d.scope.findLocal(f,!1,!1);n&&(n.isType()&&n.declAST&&n.declAST.nodeType==a.NodeType.FuncDecl&&n.declAST.isSignature())&&(g=n,h=!0,l&&(g.flags|=a.SymbolFlags.Exported),i&&(g.flags|=a.SymbolFlags.Ambient),e.scopeChain.scope.enter(e.scopeChain.container,c,g,e.checker.errorReporter,l||k,!0,i))}g&&(!h&&g.declAST!=c&&!g.declAST.isOverload)&&(g=null);if(null==g){n=d.scope.findLocal(f,!1,!1);d=new a.Type;d.setHasImplementation();
h=new a.Type;h.setHasImplementation();d.instanceType=h;d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));var g=d,C=new a.ValueLocation;C.typeLink=new a.TypeLink;C.typeLink.ast=c;C.typeLink.type=g.instanceType;var x=new a.FieldSymbol("prototype",c.minChar,e.checker.locationInfo.unitIndex,!0,C);x.flags|=a.SymbolFlags.Property|a.SymbolFlags.BuiltIn;
C.symbol=x;x.declAST=c;g.members.addPublicMember("prototype",x);h.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));h.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));g=new a.TypeSymbol(f,c.minChar,e.checker.locationInfo.unitIndex,d);g.declAST=c;g.instanceType=h;d.symbol=g;h.symbol=g;e.scopeChain.moduleDecl&&(e.scopeChain.moduleDecl.recordNonInterface(),g.declModule=e.scopeChain.moduleDecl,
g.flags|=a.SymbolFlags.ModuleMember);l&&(g.flags|=a.SymbolFlags.Exported);i&&(g.flags|=a.SymbolFlags.Ambient);c.type=d;e.scopeChain.scope.enter(e.scopeChain.container,c,g,e.checker.errorReporter,l||k,!0,i);null==n&&e.scopeChain.scope.enter(e.scopeChain.container,c,g,e.checker.errorReporter,l||k,!1,i)}else d=g.type,null==d.instanceType&&(d.instanceType=new a.Type,d.instanceType.setHasImplementation(),d.instanceType.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),
d.instanceType.symbol=d.symbol,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable))),h=d.instanceType,c.type=d;c.constructorDecl||(g&&(g.declAST&&g.declAST.type&&g.declAST.type.call&&!g.declAST.isOverload)&&e.checker.errorReporter.duplicateIdentifier(g.declAST,g.name),b(c.type));d.typeFlags|=a.TypeFlags.IsClass;h.typeFlags|=a.TypeFlags.IsClass;
j(h,c);a.pushTypeCollectionScope(g,h.members,h.ambientMembers,null,null,e,h,d,null);return!0}function f(c,b,f){var b=f.scopeChain,e=null,d=null,h=a.hasFlag(c.varFlags,a.VarFlags.Exported),g=f.scopeChain.container==f.checker.gloMod,i=!0,i=!1,l=c.name.text,e=b.scope.findLocal(l,!1,!0);null==e?(d=new a.Type,e=new a.TypeSymbol(l,c.minChar,f.checker.locationInfo.unitIndex,d),d.symbol=e,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.ambientMembers=
new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),e.declAST=c,e.declModule=f.scopeChain.moduleDecl):(i=!0,d=e.type);d||(d=f.checker.anyType);c.type=d;j(d,c);h&&(e.flags|=a.SymbolFlags.Exported);f.scopeChain.moduleDecl&&(e.flags|=a.SymbolFlags.ModuleMember);i||f.scopeChain.scope.enter(f.scopeChain.container,c,e,f.checker.errorReporter,g||h,!0,!1);a.pushTypeCollectionScope(e,d.members,d.ambientMembers,null,null,f,d,null,null);return!0}function e(c,b,f){if(a.hasFlag(c.varFlags,
a.VarFlags.Public|a.VarFlags.Private)){var b=new a.ValueLocation,e=a.hasFlag(c.varFlags,a.VarFlags.Private),d=new a.FieldSymbol(c.id.text,c.minChar,f.checker.locationInfo.unitIndex,!a.hasFlag(c.varFlags,a.VarFlags.Readonly),b);d.transferVarFlags(c.varFlags);b.symbol=d;d.declAST=c;c.parameterPropertySym=d;f.scopeChain.scope.enter(f.scopeChain.container,c,d,f.checker.errorReporter,!e,!1,!1);b.typeLink=a.getTypeLink(c.typeExpr,f.checker,null==c.init);c.sym=d}return!1}function l(c,b,f){var e=f.scopeChain,
b=a.hasFlag(c.varFlags,a.VarFlags.Ambient),d=a.hasFlag(c.varFlags,a.VarFlags.Exported),h=f.scopeChain.container==f.checker.gloMod,g=a.hasFlag(c.varFlags,a.VarFlags.Property),i=a.hasFlag(c.varFlags,a.VarFlags.Static),j=a.hasFlag(c.varFlags,a.VarFlags.Private),l=a.hasFlag(c.id.flags,a.ASTFlags.OptionalName);f.scopeChain.moduleDecl&&f.scopeChain.moduleDecl.recordNonInterface();if(g||d||f.scopeChain.container==f.checker.gloMod||f.scopeChain.moduleDecl){if(b&&(e=e.scope.findLocal(c.id.text,!1,!1)))return c.sym=
e,!1;if(null==c.id)return f.checker.errorReporter.simpleError(c,"Expected variable identifier at this location"),!1;var e=new a.ValueLocation,k=new a.FieldSymbol(c.id.text,c.minChar,f.checker.locationInfo.unitIndex,(c.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,e);k.transferVarFlags(c.varFlags);l&&(k.flags|=a.SymbolFlags.Optional);e.symbol=k;k.declAST=c;if(f.scopeChain.moduleDecl||f.scopeChain.container==f.checker.gloMod)k.flags|=a.SymbolFlags.ModuleMember,k.declModule=f.scopeChain.moduleDecl;
a.hasFlag(c.varFlags,a.VarFlags.Property)&&i&&f.scopeChain.classType?(f.scopeChain.classType.members.publicMembers.add(c.id.text,k)||f.checker.errorReporter.duplicateIdentifier(c,k.name),k.container=f.scopeChain.classType.symbol):f.scopeChain.scope.enter(f.scopeChain.container,c,k,f.checker.errorReporter,!j&&(g||d||h||i),!1,b);a.hasFlag(c.varFlags,a.VarFlags.Exported)&&(k.flags|=a.SymbolFlags.Exported);e.typeLink=a.getTypeLink(c.typeExpr,f.checker,null==c.init);c.sym=k}return!1}function n(c,b,f){var e=
f.scopeChain;f.scopeChain.moduleDecl&&f.scopeChain.moduleDecl.recordNonInterface();var b=null,d=c.getNameText(),h=a.hasFlag(c.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported),g=a.hasFlag(c.fncFlags,a.FncFlags.Static);a.hasFlag(c.fncFlags,a.FncFlags.Private);var i=c.isConstructMember()||c.isConstructor,j=(c.isMethod()&&g||c.isAccessor())&&f.scopeChain.classType?f.scopeChain.classType.symbol:f.scopeChain.container,l=f.scopeChain.scope,k=c.name&&a.hasFlag(c.name.flags,a.ASTFlags.OptionalName),
n=!1,D=!1;i&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)&&(j=j.container,l=e.previous.scope);c.unitIndex=f.checker.locationInfo.unitIndex;if(!c.isConstructor&&j&&j.declAST&&j.declAST.nodeType==a.NodeType.FuncDecl&&j.declAST.isConstructor&&!c.isMethod())return n;if(a.hasFlag(c.fncFlags,a.FncFlags.Signature)){e=f.scopeChain.thisType;d&&"__missing"!=d&&(g?b=j.type.members.allMembers.lookup(d):(b=l.findLocal(d,!1,!1),null==b&&(b=l.findLocal(d,!1,!0))),b&&(D=!0,!c.isSignature()&&a.hasFlag(c.fncFlags,
a.FncFlags.Ambient)!=a.hasFlag(b.flags,a.SymbolFlags.Ambient)&&(b=null)));if(null==b){if(b=c.isSpecialFn()?f.checker.createFunctionSignature(c,j,l,j,!1).declAST.type.symbol:f.checker.createFunctionSignature(c,j,l,null,!D).declAST.type.symbol,null==b.declAST||!c.isSpecialFn())b.declAST=c}else b.kind()==a.SymbolKind.Type?b=f.checker.createFunctionSignature(c,j,l,b,!1).declAST.type.symbol:f.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+"' already declared as a property");c.type=
c.isSpecialFn()&&!g?e?e:b.type:b.type}else{d&&(g?b=j.type.members.allMembers.lookup(d):(c.isConstructor&&f.scopeChain.previous&&(b=f.scopeChain.previous.scope.findLocal(d,!1,!1)),null==b&&(b=l.findLocal(d,!1,!1))),b&&(D=!0,!i&&(b.declAST.nodeType==a.NodeType.FuncDecl&&!b.declAST.isAccessor()&&!b.declAST.isSignature())&&(b=null,D=!1)));b&&(!b.isAccessor()&&b.type&&b.type.construct&&b.type.construct.signatures!=[]&&(null==b.type.construct.signatures[0].declAST||!a.hasFlag(b.type.construct.signatures[0].declAST.fncFlags,
a.FncFlags.Ambient))&&!c.isConstructor)&&f.checker.errorReporter.simpleError(c,"Functions may not have class overloads");b&&(b.kind()!=a.SymbolKind.Type&&c.isMethod()&&!c.isAccessor()&&!c.isConstructor)&&(f.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+"' already declared as a property"),b.type=f.checker.anyType);f.checker.createFunctionSignature(c,j,l,b,!D);if((!b||b.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||b&&b.isAccessor())c.accessorSymbol=f.checker.createAccessorSymbol(c,
b,j.type,c.isMethod()&&g,!0,l,j);c.type.symbol.declAST=c;c.isConstructor&&(n=!0)}h&&(c.type.call&&(c.type.symbol.flags|=a.SymbolFlags.Exported),b&&(!b.isAccessor()&&b.type.call)&&(b.flags|=a.SymbolFlags.Exported));f.scopeChain.moduleDecl&&!c.isSpecialFn()&&(c.type.symbol.flags|=a.SymbolFlags.ModuleMember,c.type.symbol.declModule=f.scopeChain.moduleDecl);b&&k&&(b.flags|=a.SymbolFlags.Optional);return n}a.Continuation=function(a){this.normalBlock=a;this.exceptionBlock=-1};a.createNewConstructGroupForType=
b;a.cloneParentConstructGroupForChildType=function(c,f){c.construct=new a.SignatureGroup;var e=null;f.construct||b(f);for(var d=0;d<f.construct.signatures.length;d++)e=new a.Signature,e.parameters=f.construct.signatures[d].parameters,e.nonOptionalParameterCount=f.construct.signatures[d].nonOptionalParameterCount,e.typeCheckStatus=f.construct.signatures[d].typeCheckStatus,e.declAST=f.construct.signatures[d].declAST,e.returnType=new a.TypeLink,e.returnType.type=c.instanceType,c.construct.addSignature(e)};
a.globalId="__GLO";a.preCollectImportTypes=i;a.preCollectModuleTypes=h;a.preCollectClassTypes=c;a.preCollectInterfaceTypes=f;a.preCollectArgDeclTypes=e;a.preCollectVarDeclTypes=l;a.preCollectFuncDeclTypes=n;a.preCollectTypes=function(b,d,g){var j=g.state,k=!1;b.nodeType==a.NodeType.Script?(j.script=b,k=!0):b.nodeType==a.NodeType.List?k=!0:b.nodeType==a.NodeType.Import?k=i(b,d,j):b.nodeType==a.NodeType.With?k=!1:b.nodeType==a.NodeType.Module?k=h(b,d,j):b.nodeType==a.NodeType.Class?k=c(b,d,j):b.nodeType==
a.NodeType.Block?k=!0:b.nodeType==a.NodeType.Interface?k=f(b,d,j):b.nodeType==a.NodeType.ArgDecl?k=e(b,d,j):b.nodeType==a.NodeType.VarDecl?k=l(b,d,j):b.nodeType==a.NodeType.FuncDecl?k=n(b,d,j):b.isStatementOrExpression()&&j.scopeChain.moduleDecl&&j.scopeChain.moduleDecl.recordNonInterface();g.options.goChildren=k;return b};a.postCollectTypes=function(c,b,f){b=f.state;c.nodeType==a.NodeType.Module?a.popTypeCollectionScope(b):c.nodeType==a.NodeType.Class?a.popTypeCollectionScope(b):c.nodeType==a.NodeType.Interface&&
a.popTypeCollectionScope(b);return c}})(TypeScript||(TypeScript={}));
(function(a){var d;d=function(a,b,e){this.container=a;this.previous=b;this.scope=e};a.ScopeChain=d;var j=function(a){this.bb=a;this.defsBySymbol=[];this.useIndexBySymbol=[]};j.prototype.updateTop=function(){for(var a=new g(this.top.bitCount),b=0,e=this.bb.successors.length;b<e;b++){var d=this.bb.successors[b];d.useDef&&a.union(d.useDef.top)}a.difference(this.kill);a.union(this.gen);b=a.notEq(this.top);this.top=a;return b};j.prototype.initialize=function(c){var b=this,e=function(a,c){if(c.isLocalSym(a)){var e=
c.getSymbolIndex(a);b.useIndexBySymbol[e]=[];b.defsBySymbol[e]=!0}},d=new a.AstWalkOptions;d.reverseSiblings=!0;a.getAstWalkerFactory().walk(this.bb.content,function(c,d,h){var g=h.state;null==c&&(c=null);if(c.nodeType==a.NodeType.VarDecl)d=c,(d.init||a.hasFlag(d.varFlags,a.VarFlags.AutoInit))&&e(d.sym,g);else if(c.nodeType==a.NodeType.Name){if(d)if(d.nodeType==a.NodeType.Asg){if(d.operand1==c)return c}else if(d.nodeType==a.NodeType.VarDecl&&d.id==c)return c;h=c.sym;d=c;if(g.isLocalSym(h)){h=g.getSymbolIndex(h);
void 0==b.useIndexBySymbol[h]&&(b.useIndexBySymbol[h]=[]);var i=b.useIndexBySymbol[h],d=g.getUseIndex(d);g.addUse(h,d);i.push(d)}}else c.nodeType>=a.NodeType.Asg&&c.nodeType<=a.NodeType.LastAsg?(d=c,d.operand1&&d.operand1.nodeType==a.NodeType.Name&&(d=d.operand1,e(d.sym,g))):c.nodeType==a.NodeType.FuncDecl&&(h.options.goChildren=!1);return c},null,d,c)};j.prototype.initializeGen=function(a){var b=this.useIndexBySymbol.length;this.gen=new g(a.uses.length);for(a=0;a<b;a++){var e=this.useIndexBySymbol[a];
if(void 0!=e&&0<e.length)for(var d=0,h=e.length;d<h;d++)this.gen.set(e[d],!0)}this.top=this.gen};j.prototype.initializeKill=function(a){this.kill=new g(this.gen.bitCount);for(var b=0,e=this.defsBySymbol.length;b<e;b++)if(this.defsBySymbol[b]){var d=a.useIndexBySymbol[b];if(d)for(var h=0,i=d.length;h<i;h++)this.kill.set(d[h],!0)}};a.BBUseDefInfo=j;var b=function(){this.useIndexBySymbol=[];this.uses=[];this.symbols=[];this.symbolMap=new a.StringHashTable;this.symbolCount=0};b.prototype.getSymbolIndex=
function(a){var b=a.name,e=this.symbolMap.lookup(b);null==e&&(e=this.symbolCount++,this.symbols[e]=a,this.symbolMap.add(b,e));return e};b.prototype.addUse=function(a,b){var e=this.useIndexBySymbol[a];void 0==e&&(e=[],this.useIndexBySymbol[a]=e);e[e.length]=b};b.prototype.getUseIndex=function(a){this.uses[this.uses.length]=a;return this.uses.length-1};b.prototype.isLocalSym=function(c){return c&&c.container==this.func&&c.kind()==a.SymbolKind.Variable};b.prototype.killSymbol=function(a,b){for(var e=
this.symbolMap.lookup(a.name),e=this.useIndexBySymbol[e],d=0,h=e.length;d<h;d++)b.set(e[d],!0)};a.UseDefContext=b;var g,k=function(a){this.bitCount=a;this.firstBits=0;this.restOfBits=null;if(this.bitCount>k.packBits){this.restOfBits=[];for(var a=Math.floor(this.bitCount/k.packBits),b=0;b<a;b++)this.restOfBits[b]=0}};k.packBits=30;k.prototype.set=function(a,b){if(a<k.packBits)this.firstBits=b?this.firstBits|1<<a:this.firstBits&~(1<<a);else{var e=Math.floor(a/k.packBits)-1,d=a%k.packBits;this.restOfBits[e]=
b?this.restOfBits[e]|1<<d:this.restOfBits[e]&~(1<<d)}};k.prototype.map=function(a){var b;for(b=0;b<k.packBits;b++){if(b==this.bitCount)return;0!=(1<<b&this.firstBits)&&a(b)}if(this.restOfBits){var e,d=k.packBits;b=0;for(e=this.restOfBits.length;b<e;b++)for(var h=this.restOfBits[b],g=0;g<k.packBits;g++)if(0!=(1<<g&h)&&a(d),d++,d==this.bitCount)return}};k.prototype.union=function(a){this.firstBits|=a.firstBits;if(this.restOfBits)for(var b=0,e=this.restOfBits.length;b<e;b++)this.restOfBits[b]|=a.restOfBits[b]};
k.prototype.intersection=function(a){this.firstBits&=a.firstBits;if(this.restOfBits)for(var b=0,e=this.restOfBits.length;b<e;b++)this.restOfBits[b]&=a.restOfBits[b]};k.prototype.notEq=function(a){if(this.firstBits!=a.firstBits)return!0;if(this.restOfBits)for(var b=0,e=this.restOfBits.length;b<e;b++)if(this.restOfBits[b]!=a.restOfBits[b])return!0;return!1};k.prototype.difference=function(a){this.firstBits&=~a.firstBits;if(this.restOfBits)for(var b=0,e=this.restOfBits.length;b<e;b++)this.restOfBits[b]&=
~a.restOfBits[b]};g=k;a.BitVector=g;var i=function(){this.predecessors=[];this.index=-1;this.markValue=0;this.successors=[];this.useDef=null;this.content=new a.ASTList};i.prototype.marked=function(a){return this.markValue>a};i.prototype.mark=function(){this.markValue++};i.prototype.addSuccessor=function(a){this.successors[this.successors.length]=a;a.predecessors[a.predecessors.length]=this};a.BasicBlock=i;i=function(a,b){this.current=a;this.exit=b;this.unreachable=this.entry=null;this.noContinuation=
!1;this.statementStack=[];this.currentSwitch=[];this.markBase=0;this.linearBBs=[];this.entry=this.current};i.prototype.walk=function(a,b){return this.walker.walk(a,b)};i.prototype.pushSwitch=function(a){this.currentSwitch.push(a)};i.prototype.popSwitch=function(){return this.currentSwitch.pop()};i.prototype.reportUnreachable=function(c){if(this.unreachable&&0<this.unreachable.length)for(var b=this.unreachable.length,e=0;e<b;e++){var d=this.unreachable[e];d.nodeType!=a.NodeType.EndCode&&c.simpleError(d,
"unreachable code")}};i.prototype.printAST=function(c,b){var e=new a.PrintContext(b,null);e.increaseIndent();a.getAstWalkerFactory().walk(c,a.prePrintAST,a.postPrintAST,null,e);e.decreaseIndent()};i.prototype.printBlockContent=function(a,b){for(var e=a.content,d=0,h=e.members.length;d<h;d++)this.printAST(e.members[d],b)};i.prototype.bfs=function(a,b,e,d){var h=this.markBase++,g=[];for(g[g.length]=this.entry;0<g.length;){var i=g.pop();if(!i.marked(h)){i.mark();a&&a(i);var j=i.successors.length;if(0<
j){e&&e();for(j-=1;0<=j;j--){var k=i.successors[j];k.marked(this.markBase)||(b&&b(i,k),g[g.length]=k)}d&&d()}}}};i.prototype.useDef=function(a,f){var e=this,d=new b;d.func=f;this.bfs(function(a){a.useDef=new j(a);a.useDef.initialize(d);e.linearBBs[e.linearBBs.length]=a},null,null,null);var h,g;h=0;for(g=this.linearBBs.length;h<g;h++)this.linearBBs[h].useDef.initializeGen(d),this.linearBBs[h].useDef.initializeKill(d);for(var i=!0;i;){i=!1;for(h=0;h<g;h++)i=this.linearBBs[h].useDef.updateTop()||i}this.entry.useDef.top.map(function(b){b=
d.uses[b];a.simpleError(b,"use of variable '"+b.text+"' that is not definitely assigned")})};i.prototype.print=function(a){var b=this,e=0;this.bfs(function(d){0>d.index&&(d.index=e++);d==b.exit?a.WriteLine("Exit block with index "+d.index):(a.WriteLine("Basic block with index "+d.index),b.printBlockContent(d,a))},function(b,f){0>f.index&&(f.index=e++);a.Write(f.index+" ")},function(){a.Write("  Branches to ")},function(){a.WriteLine("")});if(null!=this.unreachable)for(var d=0,h=this.unreachable.length;d<
h;d++)a.WriteLine("Unreachable basic block ..."),this.printAST(this.unreachable[d],a)};i.prototype.pushStatement=function(a,b,e){this.statementStack.push({stmt:a,continueBB:b,breakBB:e})};i.prototype.popStatement=function(){return this.statementStack.pop()};i.prototype.returnStmt=function(){this.current.addSuccessor(this.exit);this.setUnreachable()};i.prototype.setUnreachable=function(){this.current=null;this.noContinuation=!0};i.prototype.addUnreachable=function(a){null===this.unreachable&&(this.unreachable=
[]);this.unreachable[this.unreachable.length]=a};i.prototype.unconditionalBranch=function(a,b){for(var e=null,d=0,h=this.statementStack.length;d<h;d++){var g=this.statementStack[d];if(g.stmt==a){e=b?g.continueBB:g.breakBB;break}}e&&this.current.addSuccessor(e);this.setUnreachable()};i.prototype.addContent=function(a){this.current&&this.current.content.append(a)};a.ControlFlowContext=i;var h=function(){this.cacheSize=16;this.rdCache=[];for(var a=this.nextUp=0;a<this.cacheSize;a++)this.rdCache[a]={actuals:[],
exactCandidates:[],conversionCandidates:[],id:a}};h.prototype.getResolutionData=function(){var a=null;this.nextUp<this.cacheSize&&(a=this.rdCache[this.nextUp]);null==a&&(this.cacheSize++,a={actuals:[],exactCandidates:[],conversionCandidates:[],id:this.cacheSize},this.rdCache[this.cacheSize]=a);this.nextUp++;return a};h.prototype.returnResolutionData=function(a){a.actuals.length=0;a.exactCandidates.length=0;a.conversionCandidates.length=0;this.nextUp=a.id};a.ResolutionDataCache=h;i=function(a,b,e,
d){this.logger=a;this.initScope=b;this.parser=e;this.checker=d;this.thisClassNode=this.thisFnc=null;this.enclosingFncIsMethod=!1;this.currentScript=this.booleanInterfaceType=this.numberInterfaceType=this.functionInterfaceType=this.objectInterfaceType=this.stringInterfaceType=this.arrayInterfaceType=null;this.inArrayElementTypeCheck=this.inTypeRefTypeCheck=this.inImportTypeCheck=!1;this.resolutionDataCache=new h;this.nestingLevel=0;this.inSuperCall=this.inBoundPropTypeCheck=!1;this.checker.typeFlow=
this;this.globalScope=this.scope=this.initScope;this.doubleType=this.checker.numberType;this.booleanType=this.checker.booleanType;this.stringType=this.checker.stringType;this.regexType=this.anyType=this.checker.anyType;this.nullType=this.checker.nullType;this.voidType=this.checker.voidType;this.arrayAnyType=this.checker.makeArrayType(this.anyType)};i.prototype.initLibs=function(){var c=this.globalScope.find("Array",!1,!0);c&&c.kind()==a.SymbolKind.Type&&(this.arrayInterfaceType=c.type);if((c=this.globalScope.find("String",
!1,!0))&&c.kind()==a.SymbolKind.Type)this.stringInterfaceType=c.type;if((c=this.globalScope.find("Object",!1,!0))&&c.kind()==a.SymbolKind.Type)this.objectInterfaceType=c.type;if((c=this.globalScope.find("Function",!1,!0))&&c.kind()==a.SymbolKind.Type)this.functionInterfaceType=c.type;if((c=this.globalScope.find("Number",!1,!0))&&c.kind()==a.SymbolKind.Type)this.numberInterfaceType=c.type;if((c=this.globalScope.find("Boolean",!1,!0))&&c.kind()==a.SymbolKind.Type)this.booleanInterfaceType=c.type;if((c=
this.globalScope.find("RegExp",!1,!0))&&c.kind()==a.SymbolKind.Type)this.regexType=c.type};i.prototype.cast=function(a,b){return this.castWithCoercion(a,b,!0,!1)};i.prototype.castWithCoercion=function(c,b,e,d){var h=new a.TypeComparisonInfo;this.checker.sourceIsAssignableToTarget(c.type,b,h)||d&&this.checker.sourceIsAssignableToTarget(b,c.type,h)?e&&(c.type=null==b?this.anyType:b.isClass()?b.instanceType:b):this.checker.errorReporter.incompatibleTypes(c,c.type,b,null,this.scope,h);return c};i.prototype.inScopeTypeCheck=
function(c,b){var e=this.scope;this.scope=b;for(var d=this.thisFnc,h=this.thisType,g=this.thisClassNode,i=this.checker.currentModDecl,j=this.enclosingFncIsMethod,k=this.scope.container,p=null;k;){if(k.kind()==a.SymbolKind.Type){var q=k,t=q.type;t.call&&null==p&&(this.enclosingFncIsMethod=q.isMethod,p=k.declAST);if(t.isClass()){this.thisType=t.instanceType;q.declAST&&q.declAST.nodeType==a.NodeType.Class&&(this.thisClassNode=q.declAST);break}if(t.isModuleType()){this.checker.currentModDecl=q.declAST;
break}}k=k.container}this.thisFnc=p;k=this.typeCheck(c);this.thisFnc=d;this.thisType=h;this.thisClassNode=g;this.checker.currentModDecl=i;this.enclosingFncIsMethod=j;this.scope=e;return k};i.prototype.typeCheck=function(a){return a?a.typeCheck(this):null};i.prototype.inScopeTypeCheckDecl=function(c){c.nodeType==a.NodeType.VarDecl||c.nodeType==a.NodeType.ArgDecl?this.inScopeTypeCheckBoundDecl(c):c.nodeType==a.NodeType.FuncDecl&&c.isAccessor()&&this.typeCheckFunction(c)};i.prototype.inScopeTypeCheckBoundDecl=
function(c){var b=c.sym,e=this.thisFnc,d=this.thisType,h=this.enclosingFncIsMethod,g=this.checker.locationInfo;if(b&&b.container){var i=a.hasFlag(c.varFlags,a.VarFlags.ClassConstructorProperty)?b.container.getType().constructorScope:b.container.instanceScope();a.hasFlag(c.varFlags,a.VarFlags.Property)&&b.container.declAST.nodeType==a.NodeType.FuncDecl&&(this.thisFnc=b.container.declAST);if(i){var j=this.scope;this.scope=i;i=b.container;for(this.checker.locationInfo=this.checker.units&&0<=b.unitIndex&&
b.unitIndex<this.checker.units.length?this.checker.units[b.unitIndex]:a.unknownLocationInfo;i;){if(i.kind()==a.SymbolKind.Type){var b=i,k=b.type;k.call&&(this.enclosingFncIsMethod=b.isMethod);if(k.isClass()){this.thisType=k.instanceType;break}}i=i.container}this.typeCheckBoundDecl(c);this.scope=j}}this.thisFnc=e;this.thisType=d;this.checker.locationInfo=g;this.enclosingFncIsMethod=h};i.prototype.resolveBoundDecl=function(a){a.typeExpr?((null==a.typeExpr.type||a.typeExpr.type&&a.typeExpr.type==this.anyType&&
this.scope||null==a.typeExpr.type.symbol||!this.checker.typeStatusIsFinished(a.typeExpr.type.symbol.typeCheckStatus))&&this.typeCheck(a.typeExpr),a.type=a.typeExpr.type,a.sym&&a.sym.setType(a.type)):null==a.init&&(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(a,"type implicitly set to 'any'"),a.type=this.anyType,a.sym&&(a.sym.isType()?a.sym.isMethod?this.checker.errorReporter.simpleError(a,"Cannot bind method group to variable.  (Did you mean to use 'declare function' instead of 'declare var'?)"):
this.checker.errorReporter.simpleError(a,"Cannot bind type to variable"):a.sym.setType(a.type)))};i.prototype.typeCheckBoundDecl=function(c){var b=this,e=c.sym;if(null==e)c.init?(c.init=this.typeCheck(c.init),c.type=this.checker.widenType(c.init.type)):(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),c.type=this.anyType);else if(e.typeCheckStatus==a.TypeCheckStatus.Started)this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,
"type implicitly set to 'any'"),c.type=this.anyType,e.setType(this.anyType);else if(e.typeCheckStatus==a.TypeCheckStatus.NotStarted){e.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(e);var d=!1;null==c.type&&c.typeExpr&&(this.resolveBoundDecl(c),d=!0,c.type=c.typeExpr.type,e.typeCheckStatus=this.checker.getTypeCheckFinishedStatus());if(c.init){a.hasFlag(c.varFlags,a.VarFlags.Ambient)&&this.checker.errorReporter.simpleError(c,"Ambient variable can not have an initializer");var h=
a.hasFlag(c.varFlags,a.VarFlags.LocalStatic),g=this.scope,d=!c.init.isParenthesized;h&&(this.scope=c.sym.container.getType().memberScope);c.varFlags&a.VarFlags.Property&&(this.inBoundPropTypeCheck=!0);this.checker.typeCheckWithContextualType(c.type,this.checker.inProvisionalTypecheckMode(),d,c.init);this.inBoundPropTypeCheck&&(this.inBoundPropTypeCheck=!1);this.scope=g;c.type?(h=!1,g=null,c.init.type&&(g=c.init.type.containedScope,h=!0,c.init.type==this.voidType&&this.checker.errorReporter.simpleError(c,
"Cannot assign type 'void' to variable '"+c.id.text+"'")),c.init=this.castWithCoercion(c.init,c.type,d&&!this.checker.inProvisionalTypecheckMode(),!1),h&&null==c.init.type.containedScope&&(c.init.type.containedScope=g)):(c.type=this.checker.widenType(c.init.type),c.type==this.voidType&&(this.checker.errorReporter.simpleError(c,"Cannot assign type 'void' to variable '"+c.id.text+"'"),c.type=this.anyType));e.setType(c.type)}else d||this.resolveBoundDecl(c);e.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()}else this.checker.typeStatusIsFinished(e.typeCheckStatus)&&
e.declAST!=c&&c.init&&(c.init=this.typeCheck(c.init),c.type=e.getType(),c.init=this.cast(c.init,c.type));c.id&&c.sym&&(c.id.sym=c.sym);c.sym&&c.sym.container&&this.checkTypePrivacy(c.sym.getType(),c.sym,function(a){return b.varPrivacyErrorReporter(c,a)});return c};i.prototype.varPrivacyErrorReporter=function(c,b){a.hasFlag(c.varFlags,a.VarFlags.Public)?c.sym.container.declAST.nodeType==a.NodeType.Interface?this.checker.errorReporter.simpleError(c,"property '"+c.sym.name+"' of exported interface has or is using private type'"+
b+"'"):this.checker.errorReporter.simpleError(c,"public member '"+c.sym.name+"' of exported class has or is using private type'"+b+"'"):this.checker.errorReporter.simpleError(c,"exported variable '"+c.sym.name+"' has or is using private type'"+b+"'")};i.prototype.typeCheckSuper=function(a){this.thisType&&this.enclosingFncIsMethod&&!this.thisFnc.isStatic()&&this.thisType.baseClass()?a.type=this.thisType.baseClass():(a.type=this.anyType,this.checker.errorReporter.invalidSuperReference(a));return a};
i.prototype.typeCheckThis=function(c){var b=!1;if(null==this.thisFnc)this.thisType?this.thisClassNode&&this.thisClassNode.nty==a.NodeType.Class?(b=!0,c.type=this.anyType):c.type=this.thisType:(this.checker.currentModDecl&&this.checker.errorReporter.simpleError(c,"'this' may not be referenced within module bodies"),c.type=this.anyType);else{if(this.thisClassNode&&(this.inBoundPropTypeCheck||this.inSuperCall&&a.hasFlag(this.thisClassNode.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor)))b=
!0;c.type=this.thisFnc.isMethod()||this.thisFnc.isConstructor||this.thisFnc.isTargetTypedAsMethod?this.thisType&&!(this.thisFnc.fncFlags&a.FncFlags.Static)?this.thisType:this.anyType:this.anyType}if(!this.enclosingFncIsMethod&&this.thisFnc&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction))if(this.thisFnc.boundToProperty){var e=this.thisFnc.boundToProperty.sym.container;e.declAST.nodeType==a.NodeType.FuncDecl&&e.declAST.setHasSelfReference()}else{for(var d=e=this.thisFnc.enclosingFnc,
h=!1;e;){if(e.isMethod()||e.isConstructor||e.hasSelfReference()){e.setHasSelfReference();h=!0;break}e=e.enclosingFnc}!h&&d?d.setHasSelfReference():h||(this.thisClassNode?this.thisClassNode.varFlags|=a.VarFlags.MustCaptureThis:this.checker.currentModDecl?this.checker.currentModDecl.modFlags|=a.ModuleFlags.MustCaptureThis:this.checker.mustCaptureGlobalThis=!0);h&&this.thisType&&(c.type=this.thisType)}b&&this.checker.errorReporter.simpleError(c,"Keyword 'this' cannot be referenced in initializers in a class body, or in super constructor calls");
return c};i.prototype.setTypeFromSymbol=function(c,b){b.isVariable()?(b.isInferenceSymbol()&&(b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST),this.checker.styleSettings.innerScopeDeclEscape||b.declAST&&b.declAST.nodeType==a.NodeType.VarDecl&&this.nestingLevel<b.declAST.nestingLevel&&this.checker.errorReporter.styleError(c,"Illegal reference to a variable defined in more nested scope")),c.type=b.getType(),b.writeable()||(c.flags&=~a.ASTFlags.Writeable)):
b.isType()?(c.type=b.getType(),c.flags&=~a.ASTFlags.Writeable):(c.type=this.anyType,this.checker.errorReporter.symbolDoesNotReferToAValue(c,b.name))};i.prototype.typeCheckName=function(c){var b=this;if(this.checker.inWith)c.type=this.anyType;else{var e=this.inTypeRefTypeCheck,d=c.text,h=a.isQuoted(c.text),g=this.scope.find(d,!1,e);null==g&&h&&(g=this.checker.findSymbolForDynamicModule(d,this.currentScript.locationInfo.filename,function(a){return b.scope.find(a,!1,e)}));if(g){if(a.optimizeModuleCodeGen&&
g&&g.isType()&&(d=g.getType())&&g.aliasLink&&g.onlyReferencedAsTypeRef)if((d=d.symbol.declAST)&&a.hasFlag(d.modFlags,a.ModuleFlags.IsDynamic))g.onlyReferencedAsTypeRef=this.inTypeRefTypeCheck;g.declAST&&(g.declAST.nodeType==a.NodeType.FuncDecl&&!g.declAST.returnTypeAnnotation&&g.declAST.signature.typeCheckStatus==a.TypeCheckStatus.Started)&&(g.declAST.type.symbol.flags|=a.SymbolFlags.RecursivelyReferenced,g.declAST.signature.returnType.type=this.anyType);this.setTypeFromSymbol(c,g);c.sym=g;this.thisFnc&&
this.thisFnc.type&&g.container!=this.thisFnc.type.symbol&&(this.thisFnc.freeVariables[this.thisFnc.freeVariables.length]=g)}else c.isMissing()||this.checker.errorReporter.unresolvedSymbol(c,c.text),c.type=this.anyType}return c};i.prototype.typeCheckScript=function(a){this.checker.locationInfo=a.locationInfo;this.scope=this.checker.globalScope;a.topLevelMod||this.addLocalsFromScope(this.scope,this.checker.gloMod,a.vars,this.checker.globals,!0);this.currentScript=a;a.bod=this.typeCheck(a.bod);this.currentScript=
null;return a};i.prototype.typeCheckBitNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.doubleType;return a};i.prototype.typeCheckUnaryNumberOperator=function(a){a.operand=this.typeCheck(a.operand);a.type=this.doubleType;return a};i.prototype.typeCheckLogNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.booleanType;return a};i.prototype.astIsWriteable=function(c){return a.hasFlag(c.flags,a.ASTFlags.Writeable)};i.prototype.typeCheckIncOrDec=function(c){var b=c;this.astIsWriteable(b)?
(b=this.typeCheckUnaryNumberOperator(c),b.operand.type!=this.checker.numberType&&(b.operand.type!=this.checker.anyType&&!(b.operand.type.typeFlags&a.TypeFlags.IsEnum))&&this.checker.errorReporter.simpleError(c,"'++' and '--' may only be applied to operands of type 'number' or 'any'")):(this.checker.errorReporter.valueCannotBeModified(b),b.type=this.doubleType);return b};i.prototype.typeCheckBitwiseOperator=function(c,b){var e=null;c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);
var d=c.operand1.type,h=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);this.checker.styleSettings.bitwise&&this.checker.errorReporter.styleError(c,"use of "+a.nodeTypeTable[c.nodeType]);if(this.checker.sourceIsSubtypeOfTarget(d,this.doubleType)&&this.checker.sourceIsSubtypeOfTarget(h,this.doubleType))e=this.doubleType;else if(d==this.booleanType&&h==this.booleanType)e=this.booleanType;else if(d==this.anyType){if(h==this.anyType||h==this.doubleType||
h==this.booleanType)e=this.anyType}else if(h==this.anyType&&(d==this.anyType||d==this.doubleType||d==this.booleanType))e=this.anyType;null==e&&(e=this.anyType,this.checker.errorReporter.incompatibleTypes(c,d,h,c.printLabel(),this.scope));c.type=e;return c};i.prototype.typeCheckArithmeticOperator=function(c,b){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);var e=c.operand1.type,d=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);
this.checker.styleSettings.bitwise&&(c.nodeType==a.NodeType.And||c.nodeType==a.NodeType.Or||c.nodeType==a.NodeType.AsgAnd||c.nodeType==a.NodeType.AsgOr)&&this.checker.errorReporter.styleError(c,"use of "+a.nodeTypeTable[c.nodeType]);if(null==e||null==d)return this.checker.errorReporter.simpleError(c,"Could not typecheck arithmetic operation.  Possible recursive typecheck error?"),c.type=this.anyType,c;var h=c.nodeType;this.checker.isNullOrUndefinedType(e)&&(e=d);this.checker.isNullOrUndefinedType(d)&&
(d=e);e=this.checker.widenType(e);d=this.checker.widenType(d);h==a.NodeType.Add||h==a.NodeType.AsgAdd?e==this.checker.stringType||d==this.checker.stringType?c.type=this.checker.stringType:e==this.checker.numberType&&d==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(e,this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(d,this.checker.numberType)?c.type=this.checker.numberType:e==this.checker.anyType||d==this.checker.anyType?c.type=this.checker.anyType:
(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,e,d,c.printLabel(),this.scope)):e==this.checker.numberType&&d==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(e,this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(d,this.checker.numberType)?c.type=this.checker.numberType:e==this.checker.anyType||d==this.checker.anyType?c.type=this.checker.numberType:(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,e,d,c.printLabel(),
this.scope));return c};i.prototype.typeCheckDotOperator=function(a){a.operand1=this.typeCheck(a.operand1);var b=a.operand1.type,e=null;if(b){if(b==this.anyType)return a.type=this.anyType,a;if(b==this.stringType)if(this.stringInterfaceType)e=this.stringInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.doubleType)if(this.numberInterfaceType)e=this.numberInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.booleanType)if(this.booleanInterfaceType)e=this.booleanInterfaceType.memberScope;
else return a.type=this.anyType,a;else if((b.call||b.construct)&&null==b.members)if(this.functionInterfaceType)e=this.functionInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b.elementType)if(this.arrayInterfaceType)e=b.elementType.getArrayBase(this.arrayInterfaceType,this.checker).memberScope;else return a.type=this.anyType,a;else e=b.memberScope}if(null==e)this.checker.errorReporter.expectedClassOrInterface(a),a.type=this.anyType;else{var d=a.operand2,h=e.find(d.text,!(this.thisClassNode&&
a.operand1.type==this.thisClassNode.type.instanceType||this.inTypeRefTypeCheck),this.inTypeRefTypeCheck);if(!h&&(this.objectInterfaceType&&b)&&(b.isReferenceType()&&(h=this.objectInterfaceType.memberScope.find(d.text,!1,this.inTypeRefTypeCheck)),!h&&this.functionInterfaceType&&(b.call||b.construct)))h=this.functionInterfaceType.memberScope.find(d.text,!1,this.inTypeRefTypeCheck);!h||!h.visible(e,this.checker)?(a.type=this.anyType,null==h?this.checker.errorReporter.simpleError(d,"The property '"+d.text+
"' does not exist on value of type '"+b.getScopedTypeName(this.scope)+"'"):this.inTypeRefTypeCheck||this.checker.errorReporter.simpleError(a,"The property '"+d.text+" on type '"+b.getScopedTypeName(this.scope)+"' is not visible")):(h.isVariable()&&h.isInferenceSymbol()&&(b=h,b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST)),d.sym=h,a.type=h.getType())}null==a.type&&(a.type=this.anyType);return a};i.prototype.typeCheckBooleanOperator=function(a){a.operand1=
this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,e=a.operand2.type;!this.checker.sourceIsAssignableToTarget(b,e)&&!this.checker.sourceIsAssignableToTarget(e,b)&&this.checker.errorReporter.incompatibleTypes(a,b,e,a.printLabel(),this.scope);a.type=this.booleanType;return a};i.prototype.typeCheckAsgOperator=function(a){var b=!a.operand2.isParenthesized;a.operand1=this.typeCheck(a.operand1);this.checker.typeCheckWithContextualType(a.operand1.type,this.checker.inProvisionalTypecheckMode(),
b,a.operand2);var e=a.operand1.type,d=a.operand2.type;this.astIsWriteable(a.operand1)||this.checker.errorReporter.valueCannotBeModified(a);var h=!1,g=null;a.operand2.type&&(g=a.operand2.type.containedScope,h=!0);a.operand2=this.castWithCoercion(a.operand2,e,b&&!this.checker.inProvisionalTypecheckMode(),!1);h&&null==a.operand2.type.containedScope&&(a.operand2.type.containedScope=g);a.type=d;return a};i.prototype.typeCheckIndex=function(c){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);
this.checker.styleSettings.literalSubscript||c.operand2.nodeType==a.NodeType.QString&&this.checker.errorReporter.styleError(c,"use literal subscript ('.') notation instead)");var b=c.operand1.type,e=c.operand2.type;b.elementType?e==this.checker.anyType||e==this.checker.numberType||a.hasFlag(e.typeFlags,a.TypeFlags.IsEnum)?c.type=b.elementType:(e!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,"Illegal property access"),c.type=this.checker.anyType):b.index?e==this.checker.anyType||
!(b.index.flags&a.SignatureFlags.IsStringIndexer||b.index.flags&a.SignatureFlags.IsNumberIndexer)||b.index.flags&a.SignatureFlags.IsStringIndexer&&e==this.checker.stringType||b.index.flags&a.SignatureFlags.IsNumberIndexer&&(e==this.checker.numberType||a.hasFlag(e.typeFlags,a.TypeFlags.IsEnum))?(b=this.resolveOverload(c,b.index),c.type=b?b.returnType.type:this.checker.anyType):(e!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,"Illegal property access"),c.type=this.checker.anyType):
((!(b==this.checker.anyType||b==this.checker.stringType||b==this.checker.numberType||b==this.checker.booleanType||b.isReferenceType())||!(e==this.checker.anyType||e==this.checker.stringType||e==this.checker.numberType||a.hasFlag(e.typeFlags,a.TypeFlags.IsEnum)))&&this.checker.errorReporter.simpleError(c,"Illegal property access"),c.type=this.checker.anyType);return c};i.prototype.typeCheckInOperator=function(a){a.operand1=this.cast(this.typeCheck(a.operand1),this.stringType);a.operand2=this.typeCheck(a.operand2);
(!(a.operand1.type==this.checker.anyType||a.operand1.type==this.checker.stringType)||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.objectInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The in operator requires the left operand to be of type Any or the String primitive type, and the right operand to be of type Any or an object type");a.type=this.booleanType;return a};i.prototype.typeCheckShift=function(a,b){a.operand1=this.cast(this.typeCheck(a.operand1),
this.doubleType);a.operand2=this.cast(this.typeCheck(a.operand2),this.doubleType);b&&!this.astIsWriteable(a.operand1)&&this.checker.errorReporter.valueCannotBeModified(a);a.type=this.doubleType;return a};i.prototype.typeCheckQMark=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.operand3=this.typeCheck(a.operand3);var b=a.operand2.type,e=a.operand3.type;b==e?a.type=b:this.checker.sourceIsSubtypeOfTarget(b,e)?a.type=e:this.checker.sourceIsSubtypeOfTarget(e,
b)?a.type=b:(a.type=this.anyType,this.checker.errorReporter.incompatibleTypes(a,b,e,a.printLabel(),this.scope));return a};i.prototype.addFormals=function(a,b,e){for(var d=b.parameters.length,h=0;h<d;h++){var g=b.parameters[h];g.container=a;e.add(g.name,g)}};i.prototype.addLocalsFromScope=function(b,f,e,d,h){for(var g=e.members.length,i=!1,j=0;j<g;j++){var k=e.members[j];if(null==k.sym||k.sym.kind()!=a.SymbolKind.Field){var p=null;if(null==(p=d.lookup(k.id.text))){p=new a.ValueLocation;p.typeLink=
new a.TypeLink;var q=null;a.hasFlag(k.varFlags,a.VarFlags.Static)?(k.varFlags|=a.VarFlags.LocalStatic,q=new a.FieldSymbol(k.id.text,k.minChar,this.checker.locationInfo.unitIndex,!0,p)):q=new a.VariableSymbol(k.id.text,k.minChar,this.checker.locationInfo.unitIndex,p);q.transferVarFlags(k.varFlags);p.symbol=q;q.declAST=k;p.typeLink.ast=k.typeExpr;this.checker.resolveTypeLink(b,p.typeLink,!1);null==k.type&&null==k.init&&(k.type=this.anyType);p.typeLink.type=k.type;p.symbol.container=f;k.sym=p.symbol;
d.add(k.id.text,q);"arguments"==k.id.text&&(i=!0)}else k.type=p.getType(),k.sym=p}}!h&&!i&&(f=new a.ValueLocation,f.typeLink=new a.TypeLink,e=new a.VariableSymbol("arguments",e.minChar,this.checker.locationInfo.unitIndex,f),f.typeLink.ast=new a.Identifier("IArguments"),this.checker.resolveTypeLink(b,f.typeLink,!1),d.add("arguments",e))};i.prototype.addConstructorLocalArgs=function(b,f,e,d){if(f)for(var h=f.members.length,g=0;g<h;g++){var i=f.members[g];if(null==i.sym||d||i.sym.kind()!=a.SymbolKind.Field){var j=
null;if(null==(j=e.lookup(i.id.text))){this.resolveBoundDecl(i);j=new a.ValueLocation;j.typeLink=new a.TypeLink;var k=new a.ParameterSymbol(i.id.text,i.minChar,this.checker.locationInfo.unitIndex,j);k.declAST=i;j.symbol=k;j.typeLink.type=i.type;j.symbol.container=b;i.sym=j.symbol;e.add(i.id.text,k)}else i.type=j.getType(),i.sym=j}}};i.prototype.checkInitSelf=function(a){if(!a.isMethod())for(var b=a.freeVariables,e=0,d=b.length;e<d;e++)if(b[e].isInstanceProperty())return!0;a=a.scopes;b=a.members.length;
for(e=0;e<b;e++)if(this.checkInitSelf(a.members[e]))return!0;return!1};i.prototype.checkPromoteFreeVars=function(b,f){for(var e=b.freeVariables,d=0,h=e.length;d<h;d++){var g=e[d];!g.isInstanceProperty()&&g.container==f&&(a.instanceFilter.reset(),this.scope.search(a.instanceFilter,g.name,!1,!1)&&this.checker.errorReporter.simpleError(b,"Constructor-local variable shadows class property '"+g.name+"'. To access the class property, use 'self."+g.name+"'"),this.checker.errorReporter.simpleError(b,"Constructor-local variables may not be accessed from instance method bodies. Consider changing local variable '"+
g.name+"' to a class property"))}};i.prototype.allReturnsAreVoid=function(b){var f=!0;null==b.signature.returnType.type&&a.getAstWalkerFactory().walk(b.bod,function(b,c,d){c=!0;switch(b.nodeType){case a.NodeType.FuncDecl:c=!1;break;case a.NodeType.Return:b.returnExpression&&(c=f=!1)}d.options.goChildren=c;d.options.goNextSibling=c;return b});return f};i.prototype.classConstructorHasSuperCall=function(b){var f=!1;a.getAstWalkerFactory().walk(b.bod,function(b,c,d){c=!0;switch(b.nodeType){case a.NodeType.FuncDecl:c=
!1;break;case a.NodeType.Call:b.target.nodeType==a.NodeType.Super&&(c=!1,f=!0)}d.options.goChildren=c;return b});return f};i.prototype.baseListPrivacyErrorReporter=function(b,f,e,d,h){this.checker.errorReporter.simpleError(b.members[f],"exported "+(e.declAST.nodeType==a.NodeType.Interface?"interface":"class")+" '"+e.name+"' "+(d?"extends":"implements")+" private "+(b.members[f].type.symbol.declAST.nodeType==a.NodeType.Interface?"interface":"class")+" '"+h+"'")};i.prototype.typeCheckBaseListPrivacy=
function(a,b,e){var d=this;if(a)for(var h=a.members.length,g=0;g<h;g++)a.members[g].type!=this.checker.anyType&&this.checkSymbolPrivacy(a.members[g].type.symbol,b,function(h){return d.baseListPrivacyErrorReporter(a,g,b,e,h)})};i.prototype.checkSymbolPrivacy=function(b,f,e){if(!b.isExternallyVisible(this.checker)){var d=f.getInterfaceDeclFromSymbol(this.checker);if(!d||a.hasFlag(d.varFlags,a.VarFlags.Exported)){var d=f,h=f.getVarDeclFromSymbol();if(h){if(a.hasFlag(h.varFlags,a.VarFlags.Private))return;
a.hasFlag(h.varFlags,a.VarFlags.Public)&&(d=f.container)}d.isExternallyVisible(this.checker)&&e(b.name)}}};i.prototype.checkTypePrivacy=function(b,f,e){var d=this;if(b.primitiveTypeClass==a.Primitive.None){if(b.isArray())return this.checkTypePrivacy(b.elementType,f,e);if(b.symbol&&b.symbol.name&&"_anonymous"!=b.symbol.name&&(null==b.call&&null==b.construct&&null==b.index||b.members&&!b.isClass()))return this.checkSymbolPrivacy(b.symbol,f,e);b.members&&b.members.allMembers.map(function(b,c){a.hasFlag(c.flags,
a.SymbolFlags.BuiltIn)||d.checkTypePrivacy(c.getType(),f,e)},null);this.checkSignatureGroupPrivacy(b.call,f,e);this.checkSignatureGroupPrivacy(b.construct,f,e);this.checkSignatureGroupPrivacy(b.index,f,e)}};i.prototype.checkSignatureGroupPrivacy=function(a,b,e){if(a)for(var d=a.signatures.length,h=0;h<a.signatures.length;h++){var g=a.signatures[h];if(!(1<d&&g==a.definitionSignature)){g.returnType&&this.checkTypePrivacy(g.returnType.type,b,e);for(var i=g.parameters.length,j=0;j<i;j++)this.checkTypePrivacy(g.parameters[j].getType(),
b,e)}}};i.prototype.functionArgumentPrivacyErrorReporter=function(b,f,e,d){var h=b.isAccessor()&&a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor),g=b.isAccessor()&&a.hasFlag(b.fncFlags,a.FncFlags.SetAccessor),i=a.hasFlag(b.fncFlags,a.FncFlags.Public);null==b.type.symbol.getInterfaceDeclFromSymbol(this.checker)?b.isConstructor?this.checker.errorReporter.simpleError(b.args.members[f],"exported class's constructor parameter '"+e.name+"' has or is using private type'"+d+"'"):g?this.checker.errorReporter.simpleError(b.args.members[f],
(i?"public":"exported")+" setter parameter '"+e.name+"' has or is using private type'"+d+"'"):h||this.checker.errorReporter.simpleError(b.args.members[f],(i?"public":"exported")+" function parameter '"+e.name+"' has or is using private type'"+d+"'"):b.isConstructMember()?this.checker.errorReporter.simpleError(b.args.members[f],"exported interface's constructor parameter '"+e.name+"' has or is using private type'"+d+"'"):b.isCallMember()?this.checker.errorReporter.simpleError(b.args.members[f],"exported interface's call parameter '"+
e.name+"' has or is using private type'"+d+"'"):b.isIndexerMember()||this.checker.errorReporter.simpleError(b.args.members[f],"exported interface's function parameter '"+e.name+"' has or is using private type'"+d+"'")};i.prototype.returnTypePrivacyError=function(b,f,e){var d=f.isAccessor()&&a.hasFlag(f.fncFlags,a.FncFlags.GetAccessor),h=f.isAccessor()&&a.hasFlag(f.fncFlags,a.FncFlags.SetAccessor),g=a.hasFlag(f.fncFlags,a.FncFlags.Public);null==f.type.symbol.getInterfaceDeclFromSymbol(this.checker)?
d?this.checker.errorReporter.simpleError(b,(g?"public":"exported")+" getter return type has or is using private type '"+e+"'"):h||this.checker.errorReporter.simpleError(b,(g?"public":"exported")+" function return type has or is using private type '"+e+"'"):f.isConstructMember()?this.checker.errorReporter.simpleError(b,"exported interface's constructor return type has or is using private type '"+e+"'"):f.isCallMember()?this.checker.errorReporter.simpleError(b,"exported interface's call return type has or is using private type '"+
e+"'"):f.isIndexerMember()?this.checker.errorReporter.simpleError(b,"exported interface's indexer return type has or is using private type '"+e+"'"):this.checker.errorReporter.simpleError(b,"exported interface's function return type has or is using private type '"+e+"'")};i.prototype.functionReturnTypePrivacyErrorReporter=function(a,b,e){var d=!1;null!=a.returnTypeAnnotation&&a.returnTypeAnnotation.type==b.returnType.type&&this.returnTypePrivacyError(a.returnTypeAnnotation,a,e);for(var h=0;h<a.returnStatementsWithExpressions.length;h++)a.returnStatementsWithExpressions[h].type==
b.returnType.type?this.returnTypePrivacyError(a.returnStatementsWithExpressions[h],a,e):d=!0;d&&this.returnTypePrivacyError(a,a,e)};i.prototype.typeCheckFunction=function(b){var f=this;this.nestingLevel=0;var e=b.type,d=e.symbol,h=b.signature;if(this.checker.typeStatusIsFinished(h.typeCheckStatus))return b;if(h.typeCheckStatus==a.TypeCheckStatus.Started)return!b.returnTypeAnnotation&&b.bod&&!b.isSignature()&&!b.isConstructor&&this.allReturnsAreVoid(b)?h.returnType.type=this.voidType:null==b.returnTypeAnnotation&&
(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(b,"type implicitly set to 'any'"),h.returnType.type=this.anyType,d.flags|=a.SymbolFlags.RecursivelyReferenced),b;h.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(h);var g=this.scope,i=this.thisFnc,j=this.enclosingFncIsMethod,k=this.thisClassNode;this.enclosingFncIsMethod=b.isMethod()||b.isConstructor;this.thisFnc=b;var p=b.type.symbol,q=this.thisType,t=this.checker.locationInfo,r=null,v=!1,w=null,
C=null,x=b.isAccessor()&&a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor),D=b.isAccessor()&&a.hasFlag(b.fncFlags,a.FncFlags.SetAccessor),G=(x||D)&&b.accessorSymbol?b.accessorSymbol.getType():null,x=this.checker.currentModDecl;if(b.isConstructor&&!b.isOverload){if(null==e.instanceType)return this.checker.errorReporter.simpleError(b,"Malformed function body (is this a class named the same as an existing interface?)"),b;var F=this.scope=e.instanceType.constructorScope,r=F.valueMembers.allMembers}else if(b.isSpecialFn()&&
!(b.fncFlags&a.FncFlags.Signature)||b.isOverload)r=b.symbols,!a.hasFlag(b.fncFlags,a.FncFlags.Static)&&e.containedScope&&(this.scope=e.containedScope);else if(b.bod&&(this.scope=e.containedScope),(F=this.scope)&&F.valueMembers)r=F.valueMembers.allMembers;if(b.isConstructor&&b.bod&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)){var z=a.hasFlag(b.classDecl.type.instanceType.typeFlags,a.TypeFlags.HasBaseType),I=!z||a.hasFlag(b.classDecl.type.instanceType.typeFlags,a.TypeFlags.HasBaseTypeOfObject),B=a.hasFlag(b.classDecl.varFlags,
a.VarFlags.ClassSuperMustBeFirstCallInConstructor);I&&this.classConstructorHasSuperCall(b)?this.checker.errorReporter.simpleError(b,"Calls to 'super' constructor are not allowed in classes that either inherit directly from 'Object' or have no base class"):z&&(B?(!b.bod||!b.bod.members.length||!(b.bod.members[0].nodeType==a.NodeType.Call&&b.bod.members[0].target.nodeType==a.NodeType.Super))&&this.checker.errorReporter.simpleError(b,"If a derived class contains initialized properties or constructor parameter properties, the first statement in the constructor body must be a call to the super constructor"):
this.classConstructorHasSuperCall(b)||this.checker.errorReporter.simpleError(b,"Constructors for derived classes must contain a call to the class's 'super' constructor"))}b.isMethod()&&b.type.enclosingType&&(z=null,b.type.enclosingType.symbol.declAST.nodeType==a.NodeType.FuncDecl?z=b.type.enclosingType.symbol.declAST.classDecl:b.type.enclosingType.symbol.declAST.nodeType==a.NodeType.Class&&(z=b.type.enclosingType.symbol.declAST),z&&(this.thisClassNode=z));if(e.enclosingType){if((z=e.symbol.container)&&
z.isType()&&z.getType().isClass())z=z.container;z&&(z.declAST&&z.declAST.nodeType==a.NodeType.Module)&&(this.checker.currentModDecl=z.declAST)}0<b.unitIndex&&(this.checker.locationInfo=this.checker.units&&b.unitIndex<this.checker.units.length?this.checker.units[b.unitIndex]:a.unknownLocationInfo);this.thisType=e.enclosingType?e.enclosingType:q;z=h.parameters.length;if(!b.isConstructor&&b.bod&&!b.isSignature()){F=I=this.scope;if(!b.isMethod()&&null==b.returnTypeAnnotation&&(g&&b.name&&!b.name.isMissing()&&
(B=g.findAmbient(b.name.text,!1,!1))&&(B.declAST&&B.declAST.type)&&this.checker.setContextualType(B.declAST.type,!1),this.checker.hasTargetType())){var B=this.checker.getTargetTypeContext(),E=B.contextualType;this.checker.canContextuallyTypeFunction(E,b,!0)?(B.targetSig=(E.construct?E.construct:E.call).signatures[0],w=B.targetSig.parameters,C=B.targetSig.returnType.type,B.targetSig.declAST&&(B.targetSig.declAST.isConstructor?b.isTargetTypedAsMethod=!0:B.targetSig.declAST.isMethod()&&(b.isTargetTypedAsMethod=
!0)),d.type=B.contextualType,v=!0):E&&b.isAccessor()?(G=E,B.targetAccessorType=G):this.checker.killCurrentContextualType()}F=F.valueMembers;this.scope=new a.SymbolScopeBuilder(F,null,null,null,g,p);for(var A=0;A<z;A++){var H=h.parameters[A],E=H.declAST;this.checker.hasTargetType()&&w&&(this.checker.getTargetTypeContext().targetSig.hasVariableArgList||A<w.length)?(B=this.checker.getTargetTypeContext(),E.type=B.targetSig.hasVariableArgList&&A>=w.length-1?w[w.length-1].getType().elementType:w[A].getType(),
E.sym.setType(E.type),E.sym.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()):this.typeCheck(E);D&&G&&(E=this.cast(E,G));H.container=p;this.checkTypePrivacy(H.getType(),p,function(a){return f.functionArgumentPrivacyErrorReporter(b,A,H,a)});F.publicMembers.add(H.name,H)}this.scope=I}else{this.typeCheck(b.args);for(A=0;A<z;A++)h.parameters[A].parameter.typeLink.type=b.args.members[A].type,this.checkTypePrivacy(h.parameters[A].getType(),p,function(a){return f.functionArgumentPrivacyErrorReporter(b,
A,h.parameters[A],a)}),b.args.members[A].parameterPropertySym&&b.args.members[A].parameterPropertySym.setType(b.args.members[A].type);b.fncFlags&a.FncFlags.IndexerMember&&(!z||1<z?this.checker.errorReporter.simpleError(b,"Index signatures may take one and only one parameter"):b.args.members[0].type==this.checker.numberType?e.index.flags|=a.SignatureFlags.IsNumberIndexer:b.args.members[0].type==this.checker.stringType?e.index.flags|=a.SignatureFlags.IsStringIndexer:this.checker.errorReporter.simpleError(b.args.members[0],
"Index signatures may only take 'string' or 'number' as their parameter"))}if(b.bod&&!b.isSignature()&&(b.isConstructor?(this.addConstructorLocalArgs(b.type.symbol,b.args,r,a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)),this.thisClassNode&&this.thisClassNode.extendsList&&(w=this.scope,r=new a.ScopedMembers(r),this.scope=new a.FilteredSymbolScopeBuilder(r,g,b.type.symbol,function(b){return b.kind()==a.SymbolKind.Parameter}),this.typeCheckBaseCalls(this.thisClassNode.extendsList),this.scope=w)):this.addFormals(p,
h,r),r=this.checker.currentModDecl,b.type&&(b.type.symbol&&!b.isMethod()&&b.type.symbol.declModule)&&(this.checker.currentModDecl=b.type.symbol.declModule),v&&this.checker.setContextualType(null,this.checker.inProvisionalTypecheckMode()),this.typeCheck(b.bod),v&&this.checker.unsetContextualType(),this.checker.currentModDecl=r,this.checker.checkControlFlow&&(v=b.buildControlFlow(),this.checker.printControlFlowGraph&&v.print(this.checker.errorReporter.outfile),v.reportUnreachable(this.checker.errorReporter),
this.checker.checkControlFlowUseDef&&v.useDef(this.checker.errorReporter,b.type.symbol)),b.isConstructor)){v=b.scopes;r=v.members.length;for(w=0;w<r;w++)D=v.members[w],D.isSignature()||a.hasFlag(D.fncFlags,a.FncFlags.Method)&&!a.hasFlag(D.fncFlags,a.FncFlags.Static)&&this.checkPromoteFreeVars(D,b.type.symbol)}this.scope=g;this.thisFnc=i;this.thisClassNode=k;this.enclosingFncIsMethod=j;this.thisType=q;this.checker.locationInfo=t;this.checker.currentModDecl=x;h.typeCheckStatus=this.checker.getTypeCheckFinishedStatus();
b.returnTypeAnnotation?(this.checkForVoidConstructor(b.returnTypeAnnotation.type,b.returnTypeAnnotation),null==h.returnType.type&&this.checker.resolveTypeLink(this.scope,h.returnType,!1)):C&&(h.returnType.type=C);if(!(d.flags&a.SymbolFlags.RecursivelyReferenced)&&0<b.returnStatementsWithExpressions.length)if(d=b.returnStatementsWithExpressions[0].type,d=this.checker.findBestCommonType(d,null,{getLength:function(){return b.returnStatementsWithExpressions.length},setTypeAtIndex:function(a,f){b.returnStatementsWithExpressions[a].type=
f},getTypeAtIndex:function(a){return b.returnStatementsWithExpressions[a].type}}))h.returnType.type=this.checker.widenType(d);else{for(d=0;d<b.returnStatementsWithExpressions.length;d++)this.checker.errorReporter.simpleError(b.returnStatementsWithExpressions[d],"Incompatible return type");h.returnType.type=this.anyType}null==h.returnType.type?a.hasFlag(b.fncFlags,a.FncFlags.HasReturnExpression)?(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(b,"type implicitly set to 'any'"),
h.returnType.type=this.anyType):h.returnType.type=this.voidType:h.returnType.type==this.nullType||h.returnType.type==this.checker.undefinedType?h.returnType.type=this.anyType:h.returnType.type!=this.voidType&&(h.returnType.type!=this.checker.undefinedType&&h.returnType.type!=this.anyType)&&(!b.isSignature()&&(!b.isConstructor&&!a.hasFlag(b.fncFlags,a.FncFlags.HasReturnExpression)&&!a.hasFlag(b.fncFlags,a.FncFlags.IsFatArrowFunction))&&(0<b.bod.members.length&&b.bod.members[0].nodeType==a.NodeType.Throw||
this.checker.errorReporter.simpleError(b,"Function declared a non-void return type, but has no return expression")),this.checkTypePrivacy(h.returnType.type,p,function(a){return f.functionReturnTypePrivacyErrorReporter(b,h,a)}));b.accessorSymbol&&(G=b.accessorSymbol.getType(),a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)&&!a.hasFlag(b.fncFlags,a.FncFlags.HasReturnExpression)&&this.checker.errorReporter.simpleError(b,"Getters must return a value"),G?(a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)&&G!=
h.returnType.type||0<b.args.members.length&&G!=b.args.members[0].type)&&this.checker.errorReporter.simpleError(b,"Getter and setter types do not agree"):a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?b.accessorSymbol.setType(h.returnType.type):1!=b.args.members.length?this.checker.errorReporter.simpleError(b,"Setters may have one and only one argument"):b.accessorSymbol.setType(b.args.members[0].type));this.typeCheckOverloadSignatures(e,b);return b};i.prototype.typeCheckBases=function(b){var f=!1,e=
b.extendsList;if(e){var d=e.length;0<d&&(b.typeFlags|=a.TypeFlags.HasBaseType);for(var h=0;h<d;h++){var g=e[h];g.symbol&&("Object"==g.symbol.name&&g.symbol.container==this.checker.gloMod)&&(b.typeFlags|=a.TypeFlags.HasBaseTypeOfObject);if(g.isClassInstance())this.currentScript&&(this.currentScript.requiresInherits=!0),b.isClassInstance()?f&&this.checker.errorReporter.simpleErrorFromSym(g.symbol,"Class may not follow interface as base type"):this.checker.errorReporter.simpleErrorFromSym(g.symbol,"Interface base type must be interface");
else if(g.isModuleType())this.checker.errorReporter.simpleErrorFromSym(g.symbol,"Types may not be derived from module types");else if(g.members)f||(f=!0);else{b.isClassInstance()?this.checker.errorReporter.simpleErrorFromSym(g.symbol,"Base type must be interface or class"):this.checker.errorReporter.simpleErrorFromSym(g.symbol,"Interface base type must be interface");break}}}};i.prototype.checkMembersImplementInterfaces=function(b){b=b.getInstanceType();if(b.implementsList)for(var f=b.implementsList.length,
e=0;e<f;e++){var d=b.implementsList[e],h=new a.TypeComparisonInfo;this.checker.sourceIsSubtypeOfTarget(b,d,h)||(d="Class '"+b.getTypeName()+"' declares interface '"+d.getTypeName()+"' but does not implement it",h.message?this.checker.errorReporter.simpleErrorFromSym(b.symbol,d+": "+h.message):this.checker.errorReporter.simpleErrorFromSym(b.symbol,d))}};i.prototype.typeCheckBaseCalls=function(b){if(null!=b)for(var f=b.members.length,e=0;e<f;e++){var d=b.members[e];d.nodeType==a.NodeType.Call&&this.typeCheckNew(d)}};
i.prototype.assertUniqueNamesInBaseTypes=function(b,f,e,d){var h=this;if(f&&(f.members&&f.members.publicMembers.map(function(a,g){var i=b.lookup(g.name);i?d&&h.checker.errorReporter.simpleError(e,"duplicate member name in bases for "+e.name.text+": "+f.symbol.name+" and "+i.container.name+" both contain member with name "+g.name):b.add(g.name,g)},null),f.extendsList))for(var g=f.extendsList.length,i=0;i<g;i++)f.extendsList[i].symbol.flags&a.SymbolFlags.RecursivelyReferenced||this.assertUniqueNamesInBaseTypes(b,
f.extendsList[i],e,d)};i.prototype.checkBaseTypeMemberInheritance=function(b,f){var e=this,d=b.getInstanceType();if(null!=d.extendsList){var h=d.extendsList.length;if(0<h){var g=new a.StringHashTable;if(d.isClassInstance())for(var i=0;i<h;i++)this.assertUniqueNamesInBaseTypes(g,d.extendsList[i],f,0<i);d.members&&d.members.publicMembers.map(function(b,c){for(var g=0;g<h;g++){var i=d.extendsList[g];if(null==i.memberScope)e.checker.errorReporter.simpleError(f,"Base type '"+i.symbol.name+"' lacks an implementation.");
else if(i=i.memberScope.find(c.name,!1,!1)){var j=c.getType(),k=i.getType();e.checker.sourceIsSubtypeOfTarget(j,k)?c.kind()==a.SymbolKind.Type&&i.kind()==a.SymbolKind.Field&&e.checker.errorReporter.simpleErrorFromSym(c,"Cannot override field '"+c.name+"' with method"):e.checker.errorReporter.simpleErrorFromSym(c,"Type of overridden member '"+c.name+"' is not subtype of original member defined by type '"+i.container.name+"'")}}},null)}}};i.prototype.typeCheckClass=function(b){var f=b.type.symbol;if(f.typeCheckStatus==
a.TypeCheckStatus.Finished||f.typeCheckStatus==a.TypeCheckStatus.Started)return b;f.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(f);var e=this.scope,d=this.inBoundPropTypeCheck;this.inBoundPropTypeCheck=!1;var h=this.thisClassNode;this.thisClassNode=b;var g=b.type;this.typeCheckBases(g.instanceType);this.typeCheckBaseListPrivacy(b.extendsList,f,!0);this.typeCheckBaseListPrivacy(b.implementsList,f,!1);var i=this.thisType;this.thisType=g.instanceType;this.scope=g.instanceType.containedScope;
b.constructorDecl&&(this.scope=g.instanceType.constructorScope,this.addConstructorLocalArgs(b.constructorDecl.type.symbol,b.constructorDecl.args,this.scope.valueMembers.allMembers,!0));this.typeCheck(b.members);f.typeCheckStatus=a.TypeCheckStatus.Finished;this.checkBaseTypeMemberInheritance(g,b);this.checkMembersImplementInterfaces(g);this.typeCheckOverloadSignatures(g,b);this.typeCheckOverloadSignatures(g.instanceType,b);b.constructorDecl||b.baseClass&&(b.baseClass.members.length&&b.baseClass.members[0].type&&
b.baseClass.members[0].type.symbol.type.isClass())&&a.cloneParentConstructGroupForChildType(b.type,b.baseClass.members[0].type.symbol.type);this.inBoundPropTypeCheck=d;this.thisType=i;this.thisClassNode=h;this.scope=e;return b};i.prototype.typeCheckOverloadSignatures=function(a,b){a.call&&a.call.typeCheck(this.checker,b,null!=a.construct);a.construct&&a.construct.typeCheck(this.checker,b,!1);a.index&&a.index.typeCheck(this.checker,b,!1)};i.prototype.typeCheckInterface=function(a){this.typeCheckBases(a.type);
this.typeCheckBaseListPrivacy(a.extendsList,a.type.symbol,!0);this.typeCheck(a.members);this.checkBaseTypeMemberInheritance(a.type,a);if(a.extendsList)for(var b=0;b<a.extendsList.members.length;b++)a.extendsList.members[b].type.call&&(a.type.call?a.type.call.signatures=a.type.call.signatures.concat(a.extendsList.members[b].type.call.signatures):a.type.call=a.extendsList.members[b].type.call),a.extendsList.members[b].type.construct&&(a.type.construct?a.type.construct.signatures=a.type.construct.signatures.concat(a.extendsList.members[b].type.construct.signatures):
a.type.construct=a.extendsList.members[b].type.construct),a.extendsList.members[b].type.index&&(a.type.index?a.type.index.signatures=a.type.index.signatures.concat(a.extendsList.members[b].type.index.signatures):a.type.index=a.extendsList.members[b].type.index);return a};i.prototype.typeCheckImportDecl=function(b){var f=b.alias.type,e=null,d=this.inImportTypeCheck;this.inImportTypeCheck=!0;this.typeCheck(b.alias);f=b.alias.type;null==f&&(this.checker.errorReporter.simpleError(b.alias,"Could not resolve module alias '"+
b.id.text+"'"),f=this.checker.anyType,b.id.sym.type=f);b.id.type=f;e=f.symbol;f.isModuleType()?(e.type=f,this.checker.currentModDecl&&this.checker.currentModDecl.mod&&this.checker.currentModDecl.mod.importedModules.push(b),b.id.sym.type=f,f.symbol&&f.symbol.declAST&&(f.symbol.declAST.modFlags&=~a.ModuleFlags.ShouldEmitModuleDecl)):this.checker.errorReporter.simpleError(b.alias,"A module cannot be aliased to a non-module type");this.inImportTypeCheck=d;return b};i.prototype.typeCheckModule=function(b){if(!b.mod)return b;
this.currentScript&&(this.currentScript.requiresGlobal=!0);var f=b.mod,e=null,d=this.inBoundPropTypeCheck,h=this.scope,g=this.thisType,i=this.checker.currentModDecl;this.checker.currentModDecl=b;this.inBoundPropTypeCheck=!1;!this.inImportTypeCheck&&(i&&a.hasFlag(b.modFlags,a.ModuleFlags.IsDynamic)&&!a.hasFlag(b.modFlags,a.ModuleFlags.Ambient))&&this.checker.errorReporter.simpleError(b,"Dynamic modules may not be nested within other modules");this.thisType=null;this.scope=f.containedScope;this.typeCheck(b.members);
e=f.symbol;this.checker.currentModDecl=i;this.thisType=g;this.scope=h;this.inBoundPropTypeCheck=d;b.type=f;e&&(e.typeCheckStatus=a.TypeCheckStatus.Finished);return b};i.prototype.typeCheckFor=function(a){a.init=this.typeCheck(a.init);this.nestingLevel++;a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.incr=this.typeCheck(a.incr);this.nestingLevel--;a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"for statement");a.type=this.voidType;return a};i.prototype.typeCheckWith=
function(a){this.checker.errorsOnWith&&this.checker.errorReporter.simpleError(a.expr,"All symbols within a 'with' block will be typed as 'any'");a.expr=this.typeCheck(a.expr);this.checker.inWith=!0;a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"with statement");this.checker.inWith=!1;return a};i.prototype.typeCheckForIn=function(b){b.obj=this.typeCheck(b.obj);b.lval=this.cast(this.typeCheck(b.lval),this.checker.stringType);if(b.lval.nodeType==a.NodeType.VarDecl){var f=b.lval;
f.typeExpr&&this.checker.errorReporter.simpleError(f,"Variable declarations for for/in expressions may not contain a type annotation");f.sym&&f.sym.setType(this.checker.stringType)}b.body=this.typeCheck(b.body);this.typeCheckCompoundStmtBlock(b.body,"for in statement");return b};i.prototype.typeCheckWhile=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"while statement");a.type=this.voidType;return a};i.prototype.typeCheckDoWhile=
function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"do while statement");a.type=this.voidType;return a};i.prototype.typeCheckCondExpr=function(b){this.checker.styleSettings.assignmentInCond&&null!==b&&(b.nodeType>=a.NodeType.Asg&&b.nodeType<=a.NodeType.LastAsg)&&this.checker.errorReporter.simpleError(b,"top-level assignment statement in conditional expression")};i.prototype.typeCheckCompoundStmtBlock=function(b,
f){this.checker.styleSettings.blockInCompoundStmt&&b&&b.nodeType!=a.NodeType.Block&&this.checker.errorReporter.styleError(b,f+" requires a block")};i.prototype.typeCheckIf=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.thenBod=this.typeCheck(a.thenBod);a.elseBod=this.typeCheck(a.elseBod);this.typeCheckCompoundStmtBlock(a.thenBod,"if statement");this.typeCheckCompoundStmtBlock(a.elseBod,"if statement");a.type=this.voidType;return a};i.prototype.typeFromAccessorFuncDecl=
function(b){return!b.isAccessor()?null:a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?b.type.call.signatures[0].returnType.type:b.type.call.signatures[0].parameters[0].getType()};i.prototype.typeCheckObjectLit=function(b){var f=new a.Type;f.symbol=new a.TypeSymbol(this.checker.anon,b.minChar,this.checker.locationInfo.unitIndex,f);f.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));f.memberScope=new a.SymbolTableScope(f.members,null,null,null,null);var e=
new a.SymbolAggregateScope(f.symbol);e.addParentScope(f.memberScope);e.addParentScope(this.scope);f.containedScope=e;var e=b.operand,d=this.thisType,h=!1,g=null;this.checker.hasTargetType()&&((g=this.checker.getTargetTypeContext().contextualType)&&g.symbol&&!this.checker.typeStatusIsFinished(g.symbol.typeCheckStatus)&&g.symbol.declAST&&this.typeCheck(g.symbol.declAST),h=!0);if(e)for(var i=0,j=e.members.length;i<j;i++){var k=e.members[i],p=k.operand1,q,t=null,r=null;if(p.nodeType==a.NodeType.Name)q=
p.text;else if(p.nodeType==a.NodeType.QString)q=p.text,q=q.substring(1,q.length-1);else{this.checker.errorReporter.simpleError(b,"malformed object literal");f=this.anyType;break}h&&g.memberScope&&(t=g.memberScope.find(q,!1,!1));if(k.operand2.nodeType==a.NodeType.FuncDecl&&k.operand2.isAccessor()){var r=k.operand2,v=f.members.publicMembers.lookup(q),v=this.checker.createAccessorSymbol(r,v,f,!0,!1,f.memberScope,null),r=r.accessorSymbol=v;p.nodeType==a.NodeType.Name&&(p.sym=v)}this.checker.typeCheckWithContextualType(h&&
t?t.getType():null,!1,h,k.operand2);if(h&&t){if(k.operand2.type==this.anyType||this.checker.sourceIsAssignableToTarget(k.operand2.type,t.getType())||k.operand2.nodeType==a.NodeType.FuncDecl&&k.operand2.isAccessor()&&this.typeFromAccessorFuncDecl(k.operand2)==t.getType())k.operand1.type=t.getType()}else k.operand2.type=k.operand2.type==this.checker.undefinedType?this.anyType:k.operand2.type;null==r&&(k=k.operand2.type,t=new a.ValueLocation,r=new a.FieldSymbol(q,p.minChar,this.checker.locationInfo.unitIndex,
!0,t),r.flags|=a.SymbolFlags.Property,t.symbol=r,r.typeCheckStatus=this.checker.getTypeCheckFinishedStatus(),t.typeLink=new a.TypeLink,t.typeLink.type=k,f.members.publicMembers.add(q,r));r.isObjectLitField=!0}this.thisType=d;b.type=f;g&&(b.targetType=g)};i.prototype.typeCheckArrayLit=function(b){var f=b.operand,e=this.anyType,d=null,h=new a.TypeComparisonInfo;h.onlyCaptureFirstError=!0;if(this.checker.hasTargetType()){var g=this.checker.getTargetTypeContext().contextualType;g.elementType&&(d=g.elementType)}if(f&&
(g=this.inArrayElementTypeCheck,this.inArrayElementTypeCheck=!0,this.checker.typeCheckWithContextualType(d,this.checker.inProvisionalTypecheckMode(),null!=d,f),this.inArrayElementTypeCheck=g,e=f.members[0].type,e=this.checker.findBestCommonType(e,d,{getLength:function(){return f.members.length},setTypeAtIndex:function(a,b){f.members[a].type=b},getTypeAtIndex:function(a){return f.members[a].type}},h),e==this.checker.undefinedType||!g&&e==this.nullType))e=this.anyType;e?d&&this.checker.sourceIsAssignableToTarget(e,
d)&&(e=d):(h.message?this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression: "+h.message):this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression"),e=this.anyType);b.type=this.checker.makeArrayType(e)};i.prototype.checkForVoidConstructor=function(a,b){if(a&&a.construct&&0<a.construct.signatures.length)for(var e=0;e<a.construct.signatures.length;e++)if(a.construct.signatures[e].returnType.type==this.checker.voidType){this.checker.errorReporter.simpleError(b,
"Constructors may not have a return type of 'void'");break}};i.prototype.typeCheckReturn=function(b){if(this.thisFnc){var f=null;if(this.checker.hasTargetType()){var e=this.checker.getTargetTypeContext().targetAccessorType;if(e)f=e;else if((e=this.checker.getTargetTypeContext().targetSig)&&e.returnType.type!=this.voidType)f=e.returnType.type}b.returnExpression?(this.thisFnc.fncFlags|=a.FncFlags.HasReturnExpression,null==f&&(this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type&&
this.thisFnc.returnTypeAnnotation.type!=this.voidType)&&(f=this.thisFnc.returnTypeAnnotation.type),this.checker.typeCheckWithContextualType(f,this.checker.inProvisionalTypecheckMode(),null!=f,b.returnExpression),(e=this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type?this.thisFnc.returnTypeAnnotation.type:f)?e==this.voidType&&b.returnExpression.type!=this.voidType?(this.checker.errorReporter.simpleError(b,"Return with value expression in void function"),b.type=b.returnExpression.type):
(b.returnExpression=this.cast(b.returnExpression,e),b.type=e):(f&&(b.returnExpression.type!=this.voidType?b.returnExpression=this.cast(b.returnExpression,f):b.returnExpression.type=f),b.type=b.returnExpression.type),this.thisFnc.returnStatementsWithExpressions[this.thisFnc.returnStatementsWithExpressions.length]=b):b.type=null==f?this.checker.voidType:f}return b};i.prototype.typeCheckInstOf=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);(!(a.operand1.type==
this.checker.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand1.type,this.objectInterfaceType))||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.functionInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The instanceof operator requires the left operand to be of type Any or an object type, and the right operand to be of type Any or a subtype of the Function interface type");a.type=this.booleanType;return a};i.prototype.typeCheckCommaOperator=
function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};i.prototype.typeCheckLogOr=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,e=a.operand2.type;a.type=b==this.checker.anyType||e==this.checker.anyType?this.checker.anyType:b==this.checker.booleanType?e==this.checker.booleanType?this.checker.booleanType:this.checker.anyType:b==this.checker.numberType?e==this.checker.numberType?
this.checker.numberType:this.checker.anyType:b==this.checker.stringType?e==this.checker.stringType?this.checker.stringType:this.checker.anyType:this.checker.sourceIsSubtypeOfTarget(b,e)?e:this.checker.sourceIsSubtypeOfTarget(e,b)?b:this.checker.anyType;return a};i.prototype.typeCheckLogAnd=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};i.prototype.tryAddCandidates=function(a,b,e,d,h){var g=a.nonOptionalParameterCount,i=a.parameters.length,
j=g,k=!1;if(b.length>=g&&(a.hasVariableArgList||b.length<=i))j=a.hasVariableArgList?a.parameters.length:b.length,k=!0;g=null;if(k||a.hasVariableArgList){a.hasVariableArgList&&(j-=1,g=a.parameters[j].parameter.typeLink.type,g=g.elementType,k=b.length>=j);for(var i=b.length,p=k,q=0;q<i;q++){var t;t=q<j?a.parameters[q].parameter.typeLink.type:g;var r=b[q];if(!t||!r||!this.checker.typesAreIdentical(t,r))p=!1;this.checker.sourceIsAssignableToTarget(r,t,h)||(k=!1);if(!p&&!k)break}p?e[e.length]=a:k&&0==
e.length&&(d[d.length]=a)}};i.prototype.resolveOverload=function(b,f){var e=this.resolutionDataCache.getResolutionData(),d=e.actuals,h=e.exactCandidates,g=e.conversionCandidates,i=null,j=1<f.signatures.length,k=new a.TypeComparisonInfo,p=null,q=null;if(b.nodeType==a.NodeType.Call||b.nodeType==a.NodeType.New){if(p=b.args,q=b.target,b.args)for(var t=b.args.members.length,r=0;r<t;r++)d[r]=b.args.members[r].type}else b.nodeType==a.NodeType.Index&&(q=b.operand1,p=new a.ASTList,p.members[0]=b.operand2,
d[0]=b.operand2.type);r=0;for(t=f.signatures.length;r<t;r++){var v=f.signatures[r];if(!j||v!=f.definitionSignature||this.checker.canCallDefinitionSignature)!v.returnType.type&&(v.declAST&&v.typeCheckStatus!=a.TypeCheckStatus.Finished)&&this.typeCheckFunction(v.declAST),this.tryAddCandidates(v,d,h,g,k)}if(0==h.length)h=this.checker.getApplicableSignatures(g,p,k),0<h.length?(p=this.checker.findMostApplicableSignature(h,p),p.ambiguous&&this.checker.errorReporter.simpleError(q,"Ambiguous call expression - could not choose overload"),
i=p.sig):k.message?this.checker.errorReporter.simpleError(q,"Supplied parameters do not match any signature of call target:\n\t"+k.message):this.checker.errorReporter.simpleError(q,"Supplied parameters do not match any signature of call target");else if(1<h.length){i=[];for(r=0;r<h.length;r++)i[r]={signature:h[r],hadProvisionalErrors:!1};p=this.checker.findMostApplicableSignature(i,p);p.ambiguous&&this.checker.errorReporter.simpleError(q,"Ambiguous call expression - could not choose overload");i=
p.sig}else i=h[0];this.resolutionDataCache.returnResolutionData(e);return i};i.prototype.typeCheckNew=function(a){a.target=this.typeCheck(a.target);var b=a.target;b.type.construct||b.type.call?this.preTypeCheckCallArgs(a.args):a.args=this.typeCheck(a.args);b.type==this.anyType?(a.type=this.anyType,a.args=this.typeCheck(a.args)):b.type.construct?(b=this.resolveOverload(a,b.type.construct),null==b?a.type=this.anyType:(a.type=b.returnType.type==this.voidType?this.anyType:b.returnType.type,a.signature=
b)):b.type.call?(b=this.resolveOverload(a,b.type.call),null==b?a.type=this.anyType:b.returnType.type==this.voidType||b.returnType.type==this.anyType?(a.type=this.anyType,a.signature=b):this.checker.errorReporter.simpleError(a.target,"new expression only valid on constructors")):b.type.elementType?a.type=b.type:(this.checker.errorReporter.invalidCall(a,a.nodeType,this.scope),a.type=this.anyType);this.postTypeCheckCallArgs(a);return a};i.prototype.preTypeCheckCallArgs=function(b){if(b)for(var f=0;f<
b.members.length;f++)switch(b.members[f].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:continue;default:this.typeCheck(b.members[f])}};i.prototype.postTypeCheckCallArgs=function(b){var f=!1,e=0;if(b.target&&b.target.type&&b.signature&&b.args){var d=b.signature;if(d&&b.args.members.length>=d.nonOptionalParameterCount)for(var f=!0,h=null,g=b.args.members.length<d.parameters.length?b.args.members.length:d.parameters.length,e=0;e<g;e++){if((h=d.parameters[e].getType())&&
d.hasVariableArgList&&e>=d.nonOptionalParameterCount-1)h=h.elementType;switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.checker.typeCheckWithContextualType(h,this.checker.inProvisionalTypecheckMode(),!d.parameters[e].declAST.isParenthesized,b.args.members[e])}}}if(!f&&b.args){this.checker.killCurrentContextualType();for(e=0;e<b.args.members.length;e++)switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.typeCheck(b.args.members[e])}}};
i.prototype.typeCheckCall=function(b){this.checker.styleSettings.newMustBeUsed&&b.nodeType==a.NodeType.New?a.hasFlag(b.flags,a.ASTFlags.IsStatement)&&this.checker.errorReporter.styleError(b,"use of new expression as a statement"):!this.checker.styleSettings.evalOK&&b.nodeType==a.NodeType.Call&&b.target.nodeType==a.NodeType.Name&&"eval"==b.target.text&&this.checker.errorReporter.styleError(b,"eval not permitted");b.target.nodeType==a.NodeType.FuncDecl&&(b.target.isInlineCallLiteral=!0);var f=this.inSuperCall;
b.target.nodeType==a.NodeType.Super&&(this.inSuperCall=!0);b.target=this.typeCheck(b.target);this.preTypeCheckCallArgs(b.args);var e=b.target;null==e.type||e.type==this.anyType||this.functionInterfaceType&&e.type==this.functionInterfaceType?b.type=this.anyType:(e=e.type,e.call?(e=this.resolveOverload(b,e.call),null==e?b.type=this.anyType:(b.type=e.returnType.type,b.signature=e)):b.target.nodeType==a.NodeType.Super&&this.thisFnc&&this.thisFnc.isConstructor&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.ClassMethod)?
(e=e.symbol.type.construct?this.resolveOverload(b,e.symbol.type.construct):null,null==e?b.type=this.anyType:(b.flags|=a.ASTFlags.ClassBaseConstructorCall,b.type=e.returnType.type,b.signature=e)):(b.type=this.anyType,this.checker.errorReporter.invalidCall(b,b.nodeType,this.scope)));this.postTypeCheckCallArgs(b);this.inSuperCall=f;return b};i.prototype.assignScopes=function(b){this.checker.locationInfo=b.locationInfo;var f=new d(this.checker.gloMod,null,this.globalScope),f=new a.AssignScopeContext(f,
this,[this.checker.currentModDecl]);a.getAstWalkerFactory().walk(b,a.preAssignScopes,a.postAssignScopes,null,f)};i.prototype.findMemberScope=function(b,f){var e=b.getScope(),d=b.pos-b.getScriptFragmentPosition(),h=b.getScriptFragment(),d=new a.MemberScopeContext(this,d,f);d.scope=e;if(h.nodeType==a.NodeType.Name)return h.type.getMemberScope(this);a.getAstWalkerFactory().walk(h,a.preFindMemberScope,null,null,d);d.ast&&(b.enclosingClassDecl&&d.ast.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=
!1);return d.type?d.type.getMemberScope(this):null};i.prototype.findMemberScopeAt=function(b){return this.findMemberScope(b,a.ASTFlags.DotLHS)};i.prototype.findMemberScopeAtFullAst=function(b){var f=a.ASTFlags.DotLHS,e=b.pos,d=null,h=function(b,c,h){a.isValidAstNode(b)&&(a.hasFlag(b.flags,f)&&(b.minChar<e&&e<=b.limChar)&&(d=b),h.options.goChildren=b.minChar<=e&&e<=b.limChar);return b};a.getAstWalkerFactory().walk(b.script,function(b,c,h){if(a.isValidAstNode(b)){if(a.hasFlag(b.flags,f)&&(e==b.limChar||
e-1==b.limChar))d=b,h.options.stopWalk();h.options.goChildren=b.minChar<=e&&e<=b.limChar}return b});null==d&&a.getAstWalkerFactory().walk(b.script,h);d&&(b.enclosingClassDecl&&d.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=!1);return d&&d.type?d.type.getMemberScope(this):null};a.TypeFlow=i})(TypeScript||(TypeScript={}));
(function(a){var d=a.Primitive||(a.Primitive={});d._map=[];d.None=0;d.Void=1;d.Double=2;d.String=4;d.Boolean=8;d.Any=16;d.Null=32;d.Undefined=64;var j=a.Primitive,b=function(){this.suffix=this.prefix=""};b.prototype.isString=function(){return!1};b.prototype.isArray=function(){return!1};b.prototype.toString=function(){return b.memberNameToString(this)};b.memberNameToString=function(a){var c=a.prefix;if(a.isString())c+=a.text;else for(var d=0;d<a.entries.length;d++)c+=b.memberNameToString(a.entries[d]),
c+=a.delim;return c+=a.suffix};b.create=function(a,b,c){if("string"==typeof a)return new g(a);var d=new k;b&&(d.prefix=b);c&&(d.suffix=c);d.entries.push(a);return d};a.MemberName=b;var g,d=function(a){b.call(this);this.text=a};__extends(d,b);d.prototype.isString=function(){return!0};g=d;a.MemberNameString=g;var k,d=function(){b.apply(this,arguments);this.delim="";this.entries=[]};__extends(d,b);d.prototype.isArray=function(){return!0};d.prototype.add=function(a){this.entries.push(a)};d.prototype.addAll=
function(a){for(var b=0;b<a.length;b++)this.entries.push(a[b])};k=d;a.MemberNameArray=k;var i=-1,h=function(){this.typeID=i++;this.index=this.call=this.construct=null;this.passTypeCreated=a.CompilerDiagnostics.analysisPass;this.primitiveTypeClass=j.None;this.typeFlags=a.TypeFlags.None};h.prototype.baseClass=function(){return this.extendsList&&0<this.extendsList.length?this.extendsList[0]:null};h.prototype.getArrayBase=function(a,b){return this.arrayCache.specialize(a,b)};h.prototype.isClass=function(){return null!=
this.instanceType};h.prototype.isArray=function(){return null!=this.elementType};h.prototype.isClassInstance=function(){return this.symbol&&!this.elementType&&this.symbol.type.isClass()};h.prototype.getInstanceType=function(){return this.isClass()?this.instanceType:this};h.prototype.hasImplementation=function(){return a.hasFlag(this.typeFlags,a.TypeFlags.HasImplementation)};h.prototype.setHasImplementation=function(){this.typeFlags|=a.TypeFlags.HasImplementation};h.prototype.isDouble=function(){return a.hasFlag(this.primitiveTypeClass,
j.Double)};h.prototype.isString=function(){return a.hasFlag(this.primitiveTypeClass,j.String)};h.prototype.isBoolean=function(){return a.hasFlag(this.primitiveTypeClass,j.Boolean)};h.prototype.isNull=function(){return a.hasFlag(this.primitiveTypeClass,j.Null)};h.prototype.getTypeName=function(){return this.getMemberTypeName("",!0,!1,null)};h.prototype.getScopedTypeName=function(a){return this.getMemberTypeName("",!0,!1,a)};h.prototype.getScopedTypeNameEx=function(a){return this.getMemberTypeNameEx("",
!0,!1,a)};h.prototype.callCount=function(){var a=0;this.call&&(a+=this.call.signatures.length);this.construct&&(a+=this.construct.signatures.length);this.index&&(a+=this.index.signatures.length);return a};h.prototype.getMemberTypeName=function(a,b,c,d){return this.getMemberTypeNameEx(a,b,c,d).toString()};h.prototype.getMemberTypeNameEx=function(c,d,h,g){if(this.elementType)return b.create(this.elementType.getMemberTypeNameEx(c,!1,!0,g),"","[]");if(this.symbol&&this.symbol.name&&"_anonymous"!=this.symbol.name&&
(null==this.call&&null==this.construct&&null==this.index||a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName)||this.members&&!this.isClass()))return d=this.symbol.scopeRelativeName(g),b.create("null"==d?"any":d);if(this.members||this.call||this.construct){if(a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName))return b.create("this");this.typeFlags|=a.TypeFlags.BuildingName;var i=new k,j=h||null!=this.index,u=h=0;this.members&&this.members.allMembers.map(function(c,d){if(!a.hasFlag(d.flags,a.SymbolFlags.BuiltIn)){var e=
d.getTypeName(g);2<=e.length&&"; "==e.substring(e.length-2)&&(e=e.substring(0,e.length-2));i.add(b.create(e));u++;j=!0}},null);var s,p=0,q=!j&&1==this.callCount()&&d;q||(i.delim="; ");if(this.call){c=this.call.toStrings(c,q,g);s=0;for(p=c.length;s<p;s++)i.add(b.create(c[s])),h++}if(this.construct){c=this.construct.toStrings("new",q,g);s=0;for(p=c.length;s<p;s++)i.add(b.create(c[s])),h++}if(this.index){c=this.index.toStrings("",q,g);s=0;for(p=c.length;s<p;s++)i.add(b.create(c[s])),h++}if(j||1<h&&d)i.prefix=
"{ ",i.suffix="}";this.typeFlags&=~a.TypeFlags.BuildingName;return 0==h&&0==u?b.create("{}"):i}return b.create("{}")};h.prototype.checkDecl=function(a){(this.isClassInstance()||this.isClass())&&this.symbol.declAST&&a.typeFlow.inScopeTypeCheckDecl(this.symbol.declAST)};h.prototype.getMemberScope=function(a){return this==a.anyType?null:this.isDouble()?a.numberInterfaceType?a.numberInterfaceType.memberScope:null:this.isBoolean()?a.booleanInterfaceType?a.booleanInterfaceType.memberScope:null:this==a.stringType?
a.stringInterfaceType?a.stringInterfaceType.memberScope:null:this.elementType?a.arrayInterfaceType?this.elementType.getArrayBase(a.arrayInterfaceType,a.checker).memberScope:null:this.memberScope};h.prototype.isReferenceType=function(){return this.members||this.extendsList||this.construct||this.call||this.index||this.elementType};h.prototype.specializeType=function(b,c,d,g){if(b==this)return c;var i=this;g?this.isReferenceType()&&(i=new h,this.members&&(i.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),this.members.publicMembers.map(function(a,h){var g=h.specializeType(b,c,d);i.members.addPublicMember(g.name,g)},null),this.members.privateMembers.map(function(a,h){var g=h.specializeType(b,c,d);i.members.addPrivateMember(g.name,g)},null)),this.ambientMembers&&(i.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),this.ambientMembers.publicMembers.map(function(a,h){var g=h.specializeType(b,c,d);i.ambientMembers.addPublicMember(g.name,
g)},null),this.ambientMembers.privateMembers.map(function(a,h){var g=h.specializeType(b,c,d);i.ambientMembers.addPrivateMember(g.name,g)},null)),i.containedScope=d.scopeOf(i),i.memberScope=i.containedScope):this.elementType?this.elementType==b?i=d.makeArrayType(c):this.elementType.elementType==b&&(i=d.makeArrayType(d.makeArrayType(c))):this.call&&(i=new h,i.call=this.call.specializeType(b,c,d));return i};h.prototype.hasBase=function(a){if(a==this)return!0;if(this.extendsList)for(var b=0,c=this.extendsList.length;b<
c;b++)if(this.extendsList[b].hasBase(a))return!0;return!1};h.prototype.mergeOrdered=function(a,b,c){if(this==b.anyType||a==b.anyType)return b.anyType;if(this==a||a==b.nullType&&this!=b.nullType)return this;if(this==b.nullType&&a!=b.nullType)return a;if(a==b.voidType&&this!=b.voidType)return this;if(this==b.voidType&&a!=b.voidType)return a;if(a==b.undefinedType&&this!=b.undefinedType)return this;if(this==b.undefinedType&&a!=b.undefinedType)return a;if(this.elementType&&a.elementType){if(this.elementType==
a.elementType)return this;a=this.elementType.mergeOrdered(a.elementType,b,c);return null==a?b.makeArrayType(b.anyType):b.makeArrayType(a)}return b.sourceIsSubtypeOfTarget(this,a,c)?a:b.sourceIsSubtypeOfTarget(a,this,c)?this:null};h.prototype.isModuleType=function(){return!1};h.prototype.hasMembers=function(){return null!=this.members};h.prototype.getAllEnclosedTypes=function(){return null};h.prototype.getAllAmbientEnclosedTypes=function(){return null};h.prototype.getPublicEnclosedTypes=function(){return null};
h.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.Type=h;d=function(a,b){h.call(this);this.enclosedTypes=a;this.ambientEnclosedTypes=b;this.importedModules=[]};__extends(d,h);d.prototype.isModuleType=function(){return!0};d.prototype.hasMembers=function(){return null!=this.members||null!=this.enclosedTypes};d.prototype.getAllEnclosedTypes=function(){return this.enclosedTypes};d.prototype.getAllAmbientEnclosedTypes=function(){return this.ambientEnclosedTypes};d.prototype.getPublicEnclosedTypes=
function(){return null};d.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.ModuleType=d;var c;c=function(){this.ast=this.type=null};a.TypeLink=c;a.getTypeLink=function(a,b,d){var h=new c;h.ast=a;h.type=null==a&&d?b.anyType:null;return h}})(TypeScript||(TypeScript={}));
(function(a){function d(a){return a.replace('"',"").replace("'","").replace("'","").replace('"',"")}function j(a){return'"'+a+'"'}function b(a){return a.replace(/\\/g,"/")}function g(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)?a.substring(0,a.length-6):4<a.length&&".str"==a.substring(a.length-4,a.length)?a.substring(0,a.length-4):5<a.length&&".d.ts"==a.substring(a.length-5,a.length)?a.substring(0,a.length-5):3<a.length&&".ts"==a.substring(a.length-3,a.length)||3<a.length&&".js"==
a.substring(a.length-3,a.length)?a.substring(0,a.length-3):a}function k(a){return 4<a.length&&".str"==a.substring(a.length-4,a.length)}function i(a){return 3<a.length&&".ts"==a.substring(a.length-3,a.length)}function h(a){return g(d(a))+".d.str"}function c(a){return g(d(a))+".d.ts"}function f(a){return""==a?a:-1!=a.indexOf("/")?e(a):""}function e(a){a=b(a);a=a.split("/");return a.slice(0,a.length-1).join("/")+"/"}function l(a){for(var a=b(a),c="/"===a.charAt(0),a=a.split("/"),d=0;d<a.length;d++){if("."===
a[d]||""===a[d])a.splice(d,1),d--;0<d&&(".."===a[d]&&".."!==a[d-1])&&(a.splice(d-1,2),d-=2)}return(c?"/":"")+a.join("/")}a.stripQuotes=d;a.isQuoted=function(a){return-1!=a.indexOf('"')||-1!=a.indexOf("'")||-1!=a.indexOf("'")||-1!=a.indexOf('"')};a.quoteStr=j;a.swapQuotes=function(a){-1!=a.indexOf('"')?(a=a.replace('"',"'"),a=a.replace('"',"'")):(a=a.replace("'",'"'),a=a.replace("'",'"'));return a};a.switchToForwardSlashes=b;a.trimModName=g;a.getDeclareFilePath=function(a){return k(a)?h(a):(i(a),c(a))};
a.isSTRFile=k;a.isTSFile=i;a.isDSTRFile=function(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)};a.isDTSFile=function(a){return 5<a.length&&".d.ts"==a.substring(a.length-5,a.length)};a.getPrettyName=function(a,c,e){"undefined"===typeof c&&(c=!0);"undefined"===typeof e&&(e=!1);e=(e?b(a):g(d(a))).split("/");return e.length?c?j(e[e.length-1]):e[e.length-1]:a};a.quoteBaseName=function(a){var b=g(d(a)),c=f(b);if(""==c)return a;a=b.split(c);return j(a[1<a.length?1:0])};a.changePathToSTR=
function(a){return g(d(a))+".str"};a.changePathToDSTR=h;a.changePathToTS=function(a){return g(d(a))+".ts"};a.changePathToDTS=c;a.isRelative=function(a){return"."==a.charAt(0)};a.isRooted=function(a){return"\\"==a.charAt(0)||"/"==a.charAt(0)||-1!=a.indexOf(":\\")||-1!=a.indexOf(":/")};a.getRootFilePath=f;a.filePath=e;a.normalizeURL=function(a){var b=/^(https?:\/\/[\-\w\.]+(:\d+)?\/)(.*)$/i.exec(a);return b?b[1]+l(b[3]):l(a)};a.pathNormalizeRegExp=/\//g;a.normalizePath=l;a.normalizeImportPath=function(a){return l(a)}})(TypeScript||
(TypeScript={}));
(function(a){var d=function(a,d){this.path=a;this.content=d;this.referencedFiles=null};d.prototype.getText=function(a,d){return this.content.substring(a,d)};d.prototype.getLength=function(){return this.content.length};a.SourceUnit=d;a.CompilationEnvironment=function(a,d){this.compilationSettings=a;this.ioHost=d;this.residentCode=[];this.code=[]};var j=function(a){this.environment=a;this.visited={}};j.prototype.resolveCode=function(b,g,j,i){var h={content:"",path:b},c=this.environment.ioHost,f=a.isRelative(b),
e=f?!1:a.isRooted(b),l=f?c.resolvePath(g+"/"+b):e||!g||j?b:g+"/"+b;!a.isSTRFile(l)&&!a.isTSFile(l)&&(l+=".ts");var l=a.switchToForwardSlashes(a.stripQuotes(l)),n=this.environment.compilationSettings.useCaseSensitiveFileResolution?l:l.toLocaleUpperCase();if(!this.visited[n]){if(f||e||!j)try{a.CompilerDiagnostics.debugPrint("   Reading code from "+l);try{h.content=c.readFile(l)}catch(m){try{a.isSTRFile(l)?l=a.changePathToTS(l):a.isTSFile(l)&&(l=a.changePathToSTR(l)),a.CompilerDiagnostics.debugPrint("   Reading code from "+
l),h.content=c.readFile(l)}catch(y){l=a.changePathToDSTR(l);a.CompilerDiagnostics.debugPrint("   Reading code from "+l);try{h.content=c.readFile(l)}catch(u){l=a.changePathToDTS(l),a.CompilerDiagnostics.debugPrint("   Reading code from "+l),h.content=c.readFile(l)}}}a.CompilerDiagnostics.debugPrint("   Found code at "+l);h.path=l;this.visited[n]=!0}catch(s){a.CompilerDiagnostics.debugPrint("   Did not find code for "+b)}else h=c.findFile(g,l),h||(a.isSTRFile(l)?l=a.changePathToTS(l):a.isTSFile(l)&&
(l=a.changePathToSTR(l)),h=c.findFile(g,l)),h||(l=a.changePathToDTS(l),h=c.findFile(g,l),h||(l=a.changePathToDSTR(l),h=c.findFile(g,l))),h?(h.path=a.switchToForwardSlashes(a.stripQuotes(h.path)),a.CompilerDiagnostics.debugPrint(b+" resolved to: "+h.path),h.content=h.content,this.visited[n]=!0):a.CompilerDiagnostics.debugPrint("Could not find "+b);if(h&&h.content){g=c.dirName(h.path);h=new d(h.path,h.content);j=a.preProcessFile(h,this.environment.compilationSettings);h.referencedFiles=j.referencedFiles;
for(f=0;f<j.referencedFiles.length;f++)e=j.referencedFiles[f],l=a.isRooted(e.path)?e.path:g+"/"+e.path,l=c.resolvePath(l),b==l?i.postResolutionError(l,"File contains reference to itself",null):this.resolveCode(e.path,g,!1,i);for(f=0;f<j.importedFiles.length;f++)this.resolveCode(j.importedFiles[f].path,g,!0,i);i.postResolution(h.path,h)}}};a.CodeResolver=j})(TypeScript||(TypeScript={}));
(function(a){function d(a,b){var c=/^(\/\/\/\s*<style\s+)(([a-zA-Z])+=('|").+('|"))\s*\/>/igm.exec(a);if(c&&(c=/^([a-zA-Z]+=['"]on['|"])/igm.exec(c[2])))for(var d=0;d<c.length;d++){var e=c[d].split("=");switch(e[0]){case "blockInCompoundStmt":b.blockInCompoundStmt='"on"'==e[1];break;case "eqeqeq":b.eqeqeq='"on"'==e[1];break;case "forin":b.forin='"on"'==e[1];break;case "emptyBlocks":b.emptyBlocks='"on"'==e[1];break;case "newMustBeUsed":b.newMustBeUsed='"on"'==e[1];break;case "requireSemi":b.requireSemi=
'"on"'==e[1];break;case "assignmentInCond":b.assignmentInCond='"on"'==e[1];break;case "eqnull":b.eqnull='"on"'==e[1];break;case "evalOK":b.evalOK='"on"'==e[1];break;case "innerScopeDeclEscape":b.innerScopeDeclEscape='"on"'==e[1];break;case "funcInLoop":b.funcInLoop='"on"'==e[1];break;case "reDeclareLocal":b.reDeclareLocal='"on"'==e[1];break;case "literalSubscript":b.literalSubscript='"on"'==e[1];break;case "implicitAny":b.implicitAny='"on"'==e[1]}}}function j(b,h,c){"undefined"===typeof h&&(h=new g);
"undefined"===typeof c&&(c=!0);var f=new a.Scanner;f.resetComments();f.setSourceText(b,a.LexMode.File);for(var e=f.scan(),j=[],k=null,j=[],b=[],m=[],y=!1;e.tokenId!=a.TokenID.EOF;){if(c&&e.tokenId==a.TokenID.IMPORT&&(e=f.scan(),e.tokenId==a.TokenID.ID||a.convertTokToID(e,!1)))e=f.scan(),e.tokenId==a.TokenID.Asg&&(e=f.scan(),e.tokenId==a.TokenID.MODULE&&(e=f.scan(),e.tokenId==a.TokenID.LParen&&(e=f.scan(),e.tokenId==a.TokenID.QString&&(k={minChar:f.startPos,limChar:f.pos,path:a.stripQuotes(a.switchToForwardSlashes(e.getText())),
isResident:!1},m.push(k)))));e.tokenId==a.TokenID.LCurly&&j.push(e);e.tokenId==a.TokenID.RCurly&&j.pop();e=f.scan()}j=f.getComments();for(c=0;c<j.length;c++)if(k=j[c],!k.isBlock){var f=k.getText(),u=/^(\/\/\/\s*<reference\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(f);u?(f=a.normalizePath(u[3]),e=a.normalizePath(f),(u=7<=u.length&&"true"==u[6])&&a.CompilerDiagnostics.debugPrint(f+" is resident"),f={minChar:0,limChar:0,path:a.switchToForwardSlashes(e),isResident:u}):f=null;f&&(f.minChar=
k.startPos,f.limChar=f.minChar+k.value.length,b.push(f));h&&(d(k.getText(),h.styleSettings),(k=/^(\/\/\/\s*<reference\s+no-default-lib=)('|")(.+?)\2\s*\/>/igm.exec(k.getText()))&&(y="true"==k[3]))}return{settings:h,referencedFiles:b,importedFiles:m,isLibFile:y}}var b=function(){this.forin=this.eqeqeq=this.blockInCompoundStmt=this.bitwise=!1;this.emptyBlocks=!0;this.eqnull=this.assignmentInCond=this.requireSemi=this.newMustBeUsed=!1;this.literalSubscript=this.reDeclareLocal=this.funcInLoop=this.innerScopeDeclEscape=
this.evalOK=!0;this.implicitAny=!1};b.prototype.setOption=function(a,b){return void 0!==this[a]?(this[a]=b,!0):!1};b.prototype.parseOptions=function(a){for(var a=a.split(";"),b=0,c=a.length;b<c;b++){var d=a[b],e=!0,g=d.lastIndexOf(":");if(0<=g){var j=d.substring(g+1),d=d.substring(0,g);"off"==j&&(e=!1)}if(!this.setOption(d,e))return!1}return!0};a.StyleSettings=b;var g,k=function(){this.styleSettings=new b;this.parseOnly=this.minWhitespace=this.propagateConstants=!1;this.outputMany=!0;this.exec=this.watch=
this.emitComments=this.errorRecovery=!1;this.resolve=!0;this.controlFlowUseDef=this.printControlFlow=this.controlFlow=!1;this.preprocess=this.errorOnWith=!0;this.inferPropertiesFromThisAssignment=this.canCallDefinitionSignature=!1;this.useDefaultLib=!0;this.codeGenTarget=a.CodeGenTarget.ES3;this.moduleGenTarget=a.ModuleGenTarget.Synchronous;this.errorFileName=this.outputFileName="";this.useCaseSensitiveFileResolution=this.generateDeclarationFiles=this.mapSourceFiles=!1};k.prototype.setStyleOptions=
function(a){this.styleSettings.parseOptions(a)};k.prototype.outputOne=function(a){this.outputFileName=a;this.outputMany=!1};g=k;a.CompilationSettings=g;a.getAdditionalDependencyPath=function(a){return(a=/^(\/\/\/\s*<amd-dependency\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(a))?a[3]:null};a.getStyleSettings=d;a.getReferencedFiles=function(a){return j(a,null,!1).referencedFiles};a.preProcessFile=j})(TypeScript||(TypeScript={}));
(function(a){var d=function(d){this.logger=d;this.astLogger=new a.AstLogger(this.logger)};d.prototype.getEnclosingScopeContextIfSingleScopeEdit=function(d,b,g,k){this.logger.log('checkEditsInsideSingleScope("'+b+'")');if(null===k)throw Error("editRange should be valid");if(k.isUnknown())return this.logger.log("  Bailing out because edit range is unknown"),null;b=a.findEnclosingScopeAt(this.logger,d,g,k.minChar,!1);d=a.findEnclosingScopeAt(this.logger,d,g,k.limChar,!1);return null==b||null==d?(this.logger.log("  Bailing out because containing scopes cannot be determined"),
null):b.scopeStartAST!==d.scopeStartAST?(this.logger.log("  Bailing out because edit overlaps 2 disctint scopes"),null):0>=b.scopeStartAST.limChar-b.scopeStartAST.minChar+k.delta?(this.logger.log("  Bailing out because scope has been entirely removed from new source text"),null):b};d.prototype.attemptIncrementalUpdateUnit=function(d,b,g,k){this.logger.log('attemptIncrementalUpdateUnit("'+b+'")');if(null===k)throw Error("editRange should be valid");var i=this.getEnclosingScopeContextIfSingleScopeEdit(d,
b,g,k);if(null===i)return null;b=i.scopeStartAST.limChar-i.scopeStartAST.minChar+k.delta;if(b>=g.getLength()/2)return this.logger.log("  Bailing out because range of scope to reparse ("+b+" characters) is greater than half the size of the source text"),null;var h=[],g=a.quickParse(this.logger,i.scopeStartAST,g,i.scopeStartAST.minChar,i.scopeStartAST.minChar+b,function(b,c,d,g){h.push(new a.ErrorEntry(g,b,b+c,d))});if(g.endLexState!=a.LexState.Start)return this.logger.log("  Bailing out because scope contains unterminated comment"),
null;g=g.Script;if(0!==g.vars.members.length)return this.logger.log("  Bailing out because new source text defines variables"),null;if(1!==g.bod.members.length)return this.logger.log("  Bailing out because new source text defines more than one scope (or none)"),null;var i=i.scopeStartAST,c=g.bod.members[0];return i.nodeType!=c.nodeType?(this.logger.log("  Bailing out because new source text does not define the same scope type as the existing scope"),null):!i.leftCurlyCount||!i.rightCurlyCount?(this.logger.log("  Bailing out because sopce doesn't have left/right curly count"),
null):i.leftCurlyCount!==c.leftCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) left curly braces"),null):i.rightCurlyCount!==c.rightCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) right curly braces"),null):0!==c.minChar?(this.logger.log("  Bailing out because new function declaration does not start at position 0"),null):c.limChar!==b?(this.logger.log("  Bailing out because new function declaration does not end at the new end position"),
null):a.UpdateUnitResult.singleScopeEdits(d,g,i,c,k,h)};d.prototype.mergeTrees=function(d){var b=this;a.timeFunction(this.logger,"mergeTrees()",function(){var g=new a.ScriptEditRange(d.scope1.minChar,d.scope1.limChar,d.editRange.delta);b.applyDeltaPosition(d.script1,g.limChar,g.delta);b.applyDeltaPosition(d.script2,0,g.minChar);b.mergeLocationInfo(d.script1,d.script2,g);b.replaceAST(d.script1,d.scope1,d.scope2)})};d.prototype.replaceAST=function(d,b,g){var k=this;a.getAstWalkerFactory().walk(d,function(d,
h,c){if(d===b)return g.preComments=d.preComments,g.postComments=d.postComments,k.logger.log("replaced old AST node with new one in script AST"),c.options.stopWalk(),g;if(a.isValidAstNode(d)&&(d.limChar<b.minChar||d.minChar>b.limChar))c.options.goChildren=!1;return d})};d.prototype.mergeLocationInfo=function(a,b,d){a=a.locationInfo.lineMap;b=b.locationInfo.lineMap;this.logger.information()&&(this.logger.log("lineMap1 (before):"),this.astLogger.logLinemap(a),this.logger.log("lineMap2 (quick parse):"),
this.astLogger.logLinemap(b),this.logger.log("EditRange="+d));for(var k=2,i=2,h=a.length,c=b.length;k<h||i<c;)k<h?a[k]<=d.minChar?k++:a[k]>=d.limChar?(a[k]+=d.delta,k++):i<c?(a.splice(k,0,b[i]+d.minChar),k++,h++,i++):(a.splice(k,1),h--):(a.push(b[i]+d.minChar),i++);this.logger.information()&&(this.logger.log("lineMap1 (after merge):"),this.astLogger.logLinemap(a))};d.prototype.applyDeltaPosition=function(d,b,g){var k=function(a){-1!==a.minChar&&a.minChar>=b&&(a.minChar+=g);-1!==a.limChar&&a.limChar>=
b&&(a.limChar+=g)},i=function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)k(a[b])};a.getAstWalkerFactory().walk(d,function(a,c,d){-1!==a.limChar&&a.limChar<b&&(d.options.goChildren=!1);k(a);i(a.preComments);i(a.postComments);return a})};a.IncrementalParser=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(d,b){this.checker=d;this.emitOptions=b;this.declFile=null;this.indenter=new a.Indenter;this.declarationContainerStack=[];this.isDottedModuleName=[];this.singleDeclFile=this.ignoreCallbackAst=null};d.prototype.getAstDeclarationContainer=function(){return this.declarationContainerStack[this.declarationContainerStack.length-1]};d.prototype.emitDottedModuleName=function(){return 0==this.isDottedModuleName.length?!1:this.isDottedModuleName[this.isDottedModuleName.length-1]};
d.prototype.setDeclarationFile=function(a){this.declFile=a};d.prototype.emitDeclarations=function(d){a.AstWalkerWithDetailCallback.walk(d,this)};d.prototype.getIndentString=function(){return this.emitOptions.minWhitespace?"":this.indenter.getIndent()};d.prototype.emitIndent=function(){this.declFile.Write(this.getIndentString())};d.prototype.canEmitSignature=function(d,b){"undefined"===typeof b&&(b=!0);return(b?this.getAstDeclarationContainer().nodeType==a.NodeType.Module:this.declarationContainerStack[this.declarationContainerStack.length-
2].nodeType==a.NodeType.Module)&&!a.hasFlag(d,a.DeclFlags.Exported)?!1:!0};d.prototype.canEmitPrePostAstSignature=function(d,b,g){return this.ignoreCallbackAst?(a.CompilerDiagnostics.assert(this.ignoreCallbackAst!=b,"Ignore Callback AST mismatch"),this.ignoreCallbackAst=null,!1):g&&!this.canEmitSignature(d,g)?(this.ignoreCallbackAst=b,!1):!0};d.prototype.emitDeclFlags=function(d,b){this.emitIndent();var g="";a.hasFlag(d,a.DeclFlags.GetAccessor)?g="get ":a.hasFlag(d,a.DeclFlags.SetAccessor)&&(g="set ");
a.hasFlag(d,a.DeclFlags.Exported)&&this.declFile.Write("export ");a.hasFlag(d,a.DeclFlags.LocalStatic)||a.hasFlag(d,a.DeclFlags.Static)?this.declFile.Write("static "+g):a.hasFlag(d,a.DeclFlags.Private)?this.declFile.Write("private "+g):a.hasFlag(d,a.DeclFlags.Public)?this.declFile.Write("public "+g):""==g?this.declFile.Write(b+" "):this.declFile.Write(g)};d.prototype.canEmitTypeAnnotationSignature=function(d){"undefined"===typeof d&&(d=a.DeclFlags.None);return!a.hasFlag(d,a.DeclFlags.Private)};d.prototype.pushDeclarationContainer=
function(a){this.declarationContainerStack.push(a)};d.prototype.popDeclarationContainer=function(d){a.CompilerDiagnostics.assert(d!=this.getAstDeclarationContainer(),"Declaration container mismatch");this.declarationContainerStack.pop()};d.prototype.getTypeSignature=function(d){var b=null,g=this.getAstDeclarationContainer();switch(g.nodeType){case a.NodeType.Module:case a.NodeType.Interface:case a.NodeType.FuncDecl:g.type&&(b=g.type.containedScope);break;case a.NodeType.Script:g.bod&&(b=g.bod.enclosingScope);
break;case a.NodeType.Class:g.type&&(b=g.type.instanceType.containedScope);break;default:a.CompilerDiagnostics.debugPrint("Unknown containing scope")}return d.getScopedTypeName(b)};d.prototype.VarDeclCallback=function(d,b){if(d&&this.canEmitSignature(a.ToDeclFlags(b.varFlags))){this.getAstDeclarationContainer().nodeType!=a.NodeType.Interface?(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"var"),this.declFile.Write(b.id.text)):(this.emitIndent(),this.declFile.Write(b.id.text),a.hasFlag(b.id.flags,a.ASTFlags.OptionalName)&&
this.declFile.Write("?"));var g=null;b.typeExpr&&b.typeExpr.type?g=b.typeExpr.type:b.sym&&(g=b.sym.getType(),g==this.checker.anyType&&(g=null));g&&this.canEmitTypeAnnotationSignature(a.ToDeclFlags(b.varFlags))?(g=this.getTypeSignature(g),this.declFile.WriteLine(": "+g+";")):this.declFile.WriteLine(";")}return!1};d.prototype.emitArgDecl=function(d,b){this.declFile.Write(d.id.text);d.isOptionalArg()&&this.declFile.Write("?");(d.typeExpr||d.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.ToDeclFlags(b.fncFlags))&&
this.declFile.Write(": "+this.getTypeSignature(d.type))};d.prototype.FuncDeclCallback=function(d,b){if(!d)return!1;if(b.isAccessor())return this.emitPropertyAccessorSignature(b);var g=this.getAstDeclarationContainer().nodeType==a.NodeType.Interface;if(b.bod)if(b.isConstructor){if(b.type.construct&&1<b.type.construct.signatures.length)return!1}else{if(b.type.call&&1<b.type.call.signatures.length)return!1}else if(!g&&a.hasFlag(b.fncFlags,a.FncFlags.Private)&&b.type.call&&1<b.type.call.signatures.length){var k=
b.type.call.signatures,i=k[0].declAST;i.bod&&(i=k[1].declAST);if(i!=b)return!1}if(!this.canEmitSignature(a.ToDeclFlags(b.fncFlags)))return!1;b.isConstructor?(this.emitIndent(),this.declFile.Write("constructor ")):(k=b.getNameText(),g?(this.emitIndent(),b.isConstructMember()?this.declFile.Write("new"):!b.isCallMember()&&!b.isIndexerMember()&&(this.declFile.Write(k),a.hasFlag(b.name.flags,a.ASTFlags.OptionalName)&&this.declFile.Write("? "))):(this.emitDeclFlags(a.ToDeclFlags(b.fncFlags),"function"),
this.declFile.Write(k)));b.isIndexerMember()?this.declFile.Write("["):this.declFile.Write("(");if(b.args){g=b.args.members.length;b.variableArgList&&g--;for(k=0;k<g;k++)this.emitArgDecl(b.args.members[k],b),k<g-1&&this.declFile.Write(", ")}b.variableArgList&&(g=b.args.members[b.args.members.length-1],1<b.args.members.length?this.declFile.Write(", ..."):this.declFile.Write("..."),this.emitArgDecl(g,b));b.isIndexerMember()?this.declFile.Write("]"):this.declFile.Write(")");!b.isConstructor&&((b.returnTypeAnnotation||
b.signature.returnType.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.ToDeclFlags(b.fncFlags)))&&this.declFile.Write(": "+this.getTypeSignature(b.signature.returnType.type));b.hasStaticDeclarations()?this.declFile.WriteLine(" {"):this.declFile.WriteLine(";");return!1};d.prototype.emitBaseList=function(a,b){if(a&&0<a.members.length){this.declFile.Write(" "+b+" ");for(var d=a.members.length,k=0;k<d;k++){var i=this.getTypeSignature(a.members[k].type);0<k&&this.declFile.Write(", ");
this.declFile.Write(i)}}};d.prototype.emitPropertyAccessorSignature=function(d){var b=d.accessorSymbol;if(b.getter&&b.getter.declAST!=d)return!1;this.emitDeclFlags(a.ToDeclFlags(b.flags),"var");this.declFile.Write(d.name.text);d=b.getType();this.canEmitTypeAnnotationSignature(a.ToDeclFlags(b.flags))?this.declFile.WriteLine(" : "+this.getTypeSignature(d)+";"):this.declFile.WriteLine(";");return!1};d.prototype.emitClassMembersFromConstructorDefinition=function(d){if(d.args){var b=d.args.members.length;
d.variableArgList&&b--;for(var g=0;g<b;g++){var k=d.args.members[g];a.hasFlag(k.varFlags,a.VarFlags.Property)&&(this.emitDeclFlags(a.ToDeclFlags(k.varFlags),"var"),this.declFile.Write(k.id.text),k.typeExpr&&this.canEmitTypeAnnotationSignature(a.ToDeclFlags(k.varFlags))?(k=this.getTypeSignature(k.type),this.declFile.WriteLine(": "+k+";")):this.declFile.WriteLine(";"))}}};d.prototype.ClassCallback=function(d,b){if(!this.canEmitPrePostAstSignature(a.ToDeclFlags(b.varFlags),b,d))return!1;if(d){var g=
b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"class");this.declFile.Write(g);this.emitBaseList(b.baseClass,"extends");this.emitBaseList(b.implementsList,"implements");this.declFile.WriteLine(" {");this.pushDeclarationContainer(b);this.indenter.increaseIndent();b.constructorDecl&&this.emitClassMembersFromConstructorDefinition(b.constructorDecl)}else this.indenter.decreaseIndent(),this.popDeclarationContainer(b),this.emitIndent(),this.declFile.WriteLine("}");return!0};d.prototype.InterfaceCallback=
function(d,b){if(!this.canEmitPrePostAstSignature(a.ToDeclFlags(b.varFlags),b,d))return!1;if(d){var g=b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"interface");this.declFile.Write(g);this.emitBaseList(b.extendsList,"extends");this.declFile.WriteLine(" {");this.indenter.increaseIndent();this.pushDeclarationContainer(b)}else this.indenter.decreaseIndent(),this.popDeclarationContainer(b),this.emitIndent(),this.declFile.WriteLine("}");return!0};d.prototype.ImportCallback=function(d,b){d&&
this.canEmitSignature(a.ToDeclFlags(b.varFlags))&&(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"import"),this.declFile.Write(b.id.text+" = "),b.isDynamicImport?this.declFile.WriteLine("module ("+b.getAliasName()+");"):this.declFile.WriteLine(b.getAliasName()+";"));return!1};d.prototype.emitEnumSignature=function(d){if(!this.canEmitSignature(a.ToDeclFlags(d.modFlags)))return!1;this.emitDeclFlags(a.ToDeclFlags(d.modFlags),"enum");this.declFile.WriteLine(d.name.text+" {");this.indenter.increaseIndent();
for(var b=d.members.members.length,g=1;g<b;g++){var k=d.members.members[g];k.nodeType==a.NodeType.VarDecl?(this.emitIndent(),this.declFile.WriteLine(k.id.text+",")):a.CompilerDiagnostics.assert(k.nodeType!=a.NodeType.Asg,"We want to catch this")}this.indenter.decreaseIndent();this.emitIndent();this.declFile.WriteLine("}");return!1};d.prototype.ModuleCallback=function(d,b){if(a.hasFlag(b.modFlags,a.ModuleFlags.IsWholeFile)){if(a.hasFlag(b.modFlags,a.ModuleFlags.IsDynamic)&&!this.emitOptions.outputMany)if(d){this.singleDeclFile=
this.declFile;a.CompilerDiagnostics.assert(0==this.indenter.indentAmt,"Indent has to be 0 when outputing new file");var g=a.getDeclareFilePath(a.stripQuotes(b.name.sym.name));this.declFile=this.emitOptions.createFile(g)}else a.CompilerDiagnostics.assert(this.singleDeclFile!=this.declFile,"singleDeclFile cannot be null as we are going to revert back to it"),a.CompilerDiagnostics.assert(0==this.indenter.indentAmt,"Indent has to be 0 when outputing new file"),this.declFile.Close(),this.declFile=this.singleDeclFile;
return!0}if(b.isEnum())return d&&this.emitEnumSignature(b),!1;if(!this.canEmitPrePostAstSignature(a.ToDeclFlags(b.modFlags),b,d))return!1;d?(this.emitDottedModuleName()?this.declFile.Write("."):this.emitDeclFlags(a.ToDeclFlags(b.modFlags),"module"),this.declFile.Write(b.name.text),g=1==b.members.members.length&&b.members.members[0].nodeType==a.NodeType.Module&&!b.members.members[0].isEnum()&&a.hasFlag(b.members.members[0].modFlags,a.ModuleFlags.Exported),this.isDottedModuleName.push(g),this.pushDeclarationContainer(b),
g||(this.declFile.WriteLine(" {"),this.indenter.increaseIndent())):(this.emitDottedModuleName()||(this.indenter.decreaseIndent(),this.emitIndent(),this.declFile.WriteLine("}")),this.popDeclarationContainer(b),this.isDottedModuleName.pop());return!0};d.prototype.ScriptCallback=function(d,b){if(d){if(this.emitOptions.outputMany)for(var g=0;g<b.referencedFiles.length;g++){var k=a.getDeclareFilePath(b.referencedFiles[g].path);this.declFile.WriteLine('/// <reference path="'+k+'" />')}this.pushDeclarationContainer(b)}else this.popDeclarationContainer(b);
return!0};d.prototype.DefaultCallback=function(d,b){return!a.hasFlag(b.flags,a.ASTFlags.IsStatement)};a.DeclarationEmitter=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.UpdateUnitKind||(a.UpdateUnitKind={});d._map=[];d._map[0]="Unknown";d.Unknown=0;d._map[1]="NoEdits";d.NoEdits=1;d._map[2]="EditsInsideSingleScope";d.EditsInsideSingleScope=2;var j=a.UpdateUnitKind,b=function(a,b,d){this.minChar=a;this.limChar=b;this.delta=d};b.unknown=function(){return new b(-1,-1,-1)};b.prototype.isUnknown=function(){return-1===this.minChar&&-1===this.limChar&&-1===this.delta};b.prototype.containsPosition=function(a){return this.minChar<=a&&a<this.limChar||this.minChar<=
a&&a<this.limChar+this.delta};b.prototype.toString=function(){return"editRange(minChar="+this.minChar+", limChar="+this.limChar+", delta="+this.delta+")"};a.ScriptEditRange=b;var g=function(a,b,d,e){this.kind=a;this.unitIndex=b;this.script1=d;this.script2=e;this.editRange=this.scope2=this.scope1=null;this.parseErrors=[]};g.noEdits=function(a){return new g(j.NoEdits,a,null,null)};g.unknownEdits=function(a,b,d){a=new g(j.Unknown,a.locationInfo.unitIndex,a,b);a.parseErrors=d;return a};g.singleScopeEdits=
function(a,b,d,e,i,k){a=new g(j.EditsInsideSingleScope,a.locationInfo.unitIndex,a,b);a.scope1=d;a.scope2=e;a.editRange=i;a.parseErrors=k;return a};a.UpdateUnitResult=g;var k;k=function(a,b,d,e){this.unitIndex=a;this.minChar=b;this.limChar=d;this.message=e};a.ErrorEntry=k;a.defaultSettings=new a.CompilationSettings;d=function(b,c,d,e){"undefined"===typeof d&&(d=new a.NullLogger);"undefined"===typeof e&&(e=a.defaultSettings);this.outfile=b;this.errorOutput=c;this.logger=d;this.settings=e;this.parser=
new a.Parser;this.typeFlow=null;this.scripts=new a.ASTList;this.units=[];this.errorReporter=new a.ErrorReporter(this.outfile);this.persistentTypeState=new a.PersistentGlobalTypeState(this.errorReporter);this.errorReporter.parser=this.parser;this.initTypeChecker(this.errorOutput);this.parser.style_requireSemi=this.settings.styleSettings.requireSemi;this.parser.style_funcInLoop=this.settings.styleSettings.funcInLoop;this.parser.inferPropertiesFromThisAssignment=this.settings.inferPropertiesFromThisAssignment;
this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany};a.codeGenTarget=e.codeGenTarget};d.prototype.timeFunction=function(b,c){return a.timeFunction(this.logger,b,c)};d.prototype.initTypeChecker=function(){this.persistentTypeState.refreshPersistentState();this.typeChecker=new a.TypeChecker(this.persistentTypeState);
this.typeChecker.errorReporter=this.errorReporter;this.typeChecker.checkControlFlow=this.settings.controlFlow;this.typeChecker.checkControlFlowUseDef=this.settings.controlFlowUseDef;this.typeChecker.printControlFlowGraph=this.settings.printControlFlow;this.typeChecker.errorsOnWith=this.settings.errorOnWith;this.typeChecker.styleSettings=this.settings.styleSettings;this.typeChecker.canCallDefinitionSignature=this.settings.canCallDefinitionSignature;this.errorReporter.checker=this.typeChecker;this.setErrorOutput(this.errorOutput)};
d.prototype.setErrorOutput=function(a){this.errorOutput=a;this.errorReporter.setErrOut(a);this.parser.outfile=a};d.prototype.emitCommentsToOutput=function(){this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany}};d.prototype.setErrorCallback=function(a){this.parser.errorCallback=a};d.prototype.updateUnit=function(b,
c,d){return this.updateSourceUnit(new a.StringSourceText(b),c,d)};d.prototype.updateSourceUnit=function(a,b,d){var e=this;return this.timeFunction("updateSourceUnit("+b+")",function(){var g=e.partialUpdateUnit(a,b,d);return e.applyUpdateResult(g)})};d.prototype.applyUpdateResult=function(b){switch(b.kind){case j.NoEdits:return!1;case j.Unknown:this.scripts.members[b.unitIndex]=b.script2;this.units[b.unitIndex]=b.script2.locationInfo;for(var c=0,d=b.parseErrors.length;c<d;c++){var e=b.parseErrors[c];
this.parser.errorCallback&&this.parser.errorCallback(e.minChar,e.limChar-e.minChar,e.message,e.unitIndex)}return!0;case j.EditsInsideSingleScope:return(new a.IncrementalParser(this.logger)).mergeTrees(b),!0}};d.prototype.partialUpdateUnit=function(a,b,d){var e=this;return this.timeFunction("partialUpdateUnit("+b+")",function(){for(var i=0,j=e.units.length;i<j;i++)if(e.units[i].filename==b){if(e.scripts.members[i].isResident)return g.noEdits(i);d&&e.parser.setErrorRecovery(null,0,0);var m=[],y=function(a,
b,c,d){m.push(new k(d,a,a+b,c))};if(j=e.parser.errorCallback)e.parser.errorCallback=y;y=e.scripts.members[i];i=e.parser.parse(a,b,i);j&&(e.parser.errorCallback=j);return g.unknownEdits(y,i,m)}throw Error('Unknown file "'+b+'"');})};d.prototype.addUnit=function(b,c,d,e){"undefined"===typeof d&&(d=!1);"undefined"===typeof e&&(e=[]);return this.addSourceUnit(new a.StringSourceText(b),c,d,e)};d.prototype.addSourceUnit=function(b,c,d,e){"undefined"===typeof e&&(e=[]);var g=this;return this.timeFunction("addSourceUnit("+
c+", "+d+")",function(){var i=g.parser.parse(b,c,g.units.length,a.AllowedElements.Global);i.referencedFiles=e;i.isResident=d;g.persistentTypeState.setCollectionMode(d?a.TypeCheckCollectionMode.Resident:a.TypeCheckCollectionMode.Transient);g.units[g.units.length]=i.locationInfo;g.typeChecker.collectTypes(i);g.scripts.append(i);return i})};d.prototype.parseUnit=function(b,c){return this.parseSourceUnit(new a.StringSourceText(b),c)};d.prototype.parseSourceUnit=function(b,c){this.parser.setErrorRecovery(this.outfile,
-1,-1);var d=this.parser.parse(b,c,0),e=new a.PrintContext(this.outfile,this.parser);a.getAstWalkerFactory().walk(d,a.prePrintAST,a.postPrintAST,null,e)};d.prototype.typeCheck=function(){var b=this;return this.timeFunction("typeCheck()",function(){var c=new a.Binder(b.typeChecker);b.typeChecker.units=b.units;c.bind(b.typeChecker.globalScope,b.typeChecker.globals);c.bind(b.typeChecker.globalScope,b.typeChecker.ambientGlobals);c.bind(b.typeChecker.globalScope,b.typeChecker.globalTypes);c.bind(b.typeChecker.globalScope,
b.typeChecker.ambientGlobalTypes);b.typeFlow=new a.TypeFlow(b.logger,b.typeChecker.globalScope,b.parser,b.typeChecker);var c=0,d=null,e=b.scripts.members.length;b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Resident);for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.typeCheck(d),d.hasBeenTypeChecked=!0);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);
e=b.scripts.members.length;for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||b.typeFlow.typeCheck(d);return null})};d.prototype.cleanASTTypesForReTypeCheck=function(b){a.getAstWalkerFactory().walk(b,function(b){b.type=null;b.nodeType==a.NodeType.VarDecl?b.sym=null:b.nodeType==a.NodeType.ArgDecl?b.sym=null:b.nodeType==a.NodeType.Name?b.sym=null:b.nodeType==a.NodeType.FuncDecl?(b.signature=null,
b.freeVariables=[],b.symbols=null,b.accessorSymbol=null,b.scopeType=null):b.nodeType==a.NodeType.Module?b.mod=null:b.nodeType==a.NodeType.With?b.withSym=null:b.nodeType==a.NodeType.Catch&&(b.containedScope=null);return b})};d.prototype.cleanTypesForReTypeCheck=function(){var a=this;return this.timeFunction("cleanTypesForReTypeCheck()",function(){for(var b=0,d=a.scripts.members.length;b<d;b++){var e=a.scripts.members[b];e.isResident||(a.cleanASTTypesForReTypeCheck(e),a.typeChecker.collectTypes(e))}return null})};
d.prototype.attemptIncrementalTypeCheck=function(){return this.timeFunction("attemptIncrementalTypeCheck()",function(){return!1})};d.prototype.reTypeCheck=function(){var b=this;return this.timeFunction("reTypeCheck()",function(){a.CompilerDiagnostics.analysisPass++;b.initTypeChecker(b.errorOutput);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);b.cleanTypesForReTypeCheck();return b.typeCheck()})};d.prototype.emitDeclarationFile=function(b){if(this.settings.generateDeclarationFiles&&
!this.errorReporter.hasErrors){for(var c=new a.DeclarationEmitter(this.typeChecker,this.emitSettings),d=null,e=0,g=this.scripts.members.length;e<g;e++){var i=this.scripts.members[e];if(!i.isDeclareFile&&!(i.isResident||null==i.bod))this.emitSettings.outputMany?(d=a.getDeclareFilePath(this.units[e].filename),d=b(d),c.setDeclarationFile(d)):null==d&&(d=a.getDeclareFilePath(this.settings.outputFileName),d=b(d),c.setDeclarationFile(d)),c.emitDeclarations(i),this.emitSettings.outputMany&&d.Close()}!this.emitSettings.outputMany&&
d&&d.Close()}};d.prototype.emit=function(b){var c=null;this.emitSettings.createFile=b;for(var d=0,e=this.scripts.members.length;d<e;d++){var g=this.scripts.members[d];if(g.emitRequired()){var i=this.outfile;if(this.emitSettings.outputMany){var j=this.units[d].filename,c=j.split(".");c.pop();var k=c.join(".")+".js";this.emitSettings.path=k;i=b(k);c=new a.Emitter(this.typeChecker,i,this.emitSettings);this.settings.mapSourceFiles&&c.setSourceMappings(new a.SourceMapper(j,k,i,b(k+a.SourceMapper.MapFileExtension)))}else null==
c?(c=new a.Emitter(this.typeChecker,this.outfile,this.emitSettings),this.settings.mapSourceFiles&&c.setSourceMappings(new a.SourceMapper(g.locationInfo.filename,this.settings.outputFileName,this.outfile,b(this.settings.outputFileName+a.SourceMapper.MapFileExtension)))):this.settings.mapSourceFiles&&c.setSourceMappings(new a.SourceMapper(g.locationInfo.filename,c.sourceMapper.jsFileName,this.outfile,c.sourceMapper.sourceMapOut));this.typeChecker.locationInfo=g.locationInfo;c.emitJavascript(g,a.TokenID.Comma,
!1);this.emitSettings.outputMany&&(this.settings.mapSourceFiles&&c.emitSourceMappings(),i.Close())}}this.emitSettings.outputMany||this.settings.mapSourceFiles&&c.emitSourceMappings()};d.prototype.emitToOutfile=function(){var b=null;if(this.settings.mapSourceFiles)throw Error("Cannot generate source map");if(this.settings.generateDeclarationFiles)throw Error("Cannot generate declaration files");for(var c=0,d=this.scripts.members.length;c<d;c++){null==b&&(b=new a.Emitter(this.typeChecker,this.outfile,
this.emitSettings));var e=this.scripts.members[c];this.typeChecker.locationInfo=e.locationInfo;b.emitJavascript(e,a.TokenID.Comma,!1)}};a.TypeScriptCompiler=d;var i;i=function(a,b,d){this.name=a;this.type=b;this.sym=d};a.ScopeEntry=i;d=function(a){this.compiler=a};d.prototype.getScope=function(a){return a.enclosingObjectLit&&a.isMemberCompletion?a.getObjectLiteralScope():a.isMemberCompletion?a.useFullAst?this.compiler.typeFlow.findMemberScopeAtFullAst(a):this.compiler.typeFlow.findMemberScopeAt(a):
a.getScope()};d.prototype.getScopeEntries=function(b){var c=this.getScope(b);if(null==c)return[];for(var d=new a.StringHashTable,e=c.getAllSymbolNames(b.isMemberCompletion),g=0;g<e.length;g++){var i=e[g];i==a.globalId||("_Core"==i||"_element"==i)||d.add(i,"")}e=this.compiler.typeChecker.currentModDecl;this.compiler.typeChecker.currentModDecl=b.deepestModuleDecl;b=this.getTypeNamesForNames(b,d.getAllKeys(),c);this.compiler.typeChecker.currentModDecl=e;return b};d.prototype.getTypeNamesForNames=function(b,
c,d){for(var e=[],g=b.getScope(),j=0;j<c.length;j++){var k=c[j],y=b.publicsOnly&&b.isMemberCompletion,u=d.find(k,y,!1);null==u&&(u=d.find(k,y,!0));y=u&&u.flags&a.SymbolFlags.Private?u.container==d.container:!0;u?y&&(!a.isQuoted(u.name)&&!a.isRelative(u.name))&&(y=u.getType().getScopedTypeName(g),e.push(new i(k,y,u))):("true"==k||"false"==k)&&e.push(new i(k,"bool",this.compiler.typeChecker.booleanType.symbol))}return e};a.ScopeTraversal=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.CompilerDiagnostics||(a.CompilerDiagnostics={}),j=function(a){d.diagnosticWriter&&d.diagnosticWriter.Alert(a)};d.debug=!1;d.diagnosticWriter=null;d.analysisPass=0;d.Alert=j;d.debugPrint=function(a){d.debug&&j(a)};d.assert=function(a,b){d.debug&&(a||j(b))};var b=function(){};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=
function(){};a.NullLogger=b;b=function(a){this.logger=a;this._information=this.logger.information();this._debug=this.logger.debug();this._warning=this.logger.warning();this._error=this.logger.error();this._fatal=this.logger.fatal()};b.prototype.information=function(){return this._information};b.prototype.debug=function(){return this._debug};b.prototype.warning=function(){return this._warning};b.prototype.error=function(){return this._error};b.prototype.fatal=function(){return this._fatal};b.prototype.log=
function(a){this.logger.log(a)};a.LoggerAdapter=b;b=function(){this.logContents=[]};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=function(a){this.logContents.push(a)};a.BufferedLogger=b;a.timeFunction=function(a,b,d){var h=+new Date,d=d();a.log(b+" completed in "+(+new Date-h)+" msec");return d};a.stringToLiteral=function(a,b){var d=
"",h=function(b){switch(a.charCodeAt(b)){case 9:d+="\\t";break;case 10:d+="\\n";break;case 11:d+="\\v";break;case 12:d+="\\f";break;case 13:d+="\\r";break;case 34:d+='\\"';break;case 39:d+="\\'";break;case 92:d+="\\";break;default:d+=a.charAt(b)}};if(a.length>b){for(var c=b>>1,f=0;f<c;f++)h(f);d+="(...)";for(f=a.length-c;f<a.length;f++)h(f)}else{b=a.length;for(f=0;f<b;f++)h(f)}return d}})(TypeScript||(TypeScript={}));var TSCompiler;
(function(a){function d(a,b){"undefined"==typeof b&&(b=new i);var c=new TypeScript.TypeScriptCompiler(b.outStream);c.parser.errorRecovery=!0;c.setErrorCallback(b.getErrorCallback());for(var d=0;d<a.units.length;d++){var g=a.units[d];c.addUnit(g.data,g.name)}c.typeCheck();c.emit(!1,function(){return b.outStream});return b.outStream.data}function j(a,b,c){b||(b={units:[]});b.units.push({data:a,name:""});return d(b,c)}function b(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");
b.innerHTML=a;document.body.appendChild(b)}function g(a,c,d){"string"==typeof a&&(a=document.getElementById(a));if(!a||!a.tagName||"script"!=a.tagName.toLowerCase())throw Error("Invalid script block.");a=j(a.innerHTML,c,d);b(a)}function k(a,c,d,g,h){d||(d=function(){});"undefined"==typeof c&&(c=!0);if("undefined"==typeof h||null===h)h=new i;var k=new XMLHttpRequest;k.open("GET",a);k.onreadystatechange=function(){if(4==k.readyState)if(200==k.status){var a=j(k.responseText,g,h);c&&b(a);d({result:a,
compileInfo:h})}else d({error:!0})};k.send(null)}a.API_VERSION=0.1;var i,h=function(){this.errors=[];this.outStream=new c};h.prototype.addError=function(a,b,c,d){this.errors.push({start:a,len:b,msg:c,block:d})};h.prototype.getErrorCallback=function(){var a=this;return function(){a.addError.apply(a,arguments)}};h.prototype.getErrorCount=function(){return this.errors.length};i=h;a.CompileInfo=i;var c,h=function(){this.data=""};h.prototype.Write=function(a){this.data+=a};h.prototype.WriteLine=function(a){this.data+=
a+"\n"};h.prototype.Close=function(){};c=h;a.compile=d;a.compileStr=j;a.runStr=function(a,c,d){a=j(a,c,d);b(a);return a};a.insertScriptBlock=b;a.runScriptBlock=g;a.runAllScriptBlocks=function(a,b,c){if("undefined"==typeof a||null===a)a=["text/typescript","application/typescript"];var d=!0,h=null;if(document.querySelectorAll){for(var d=!1,h="",i=0,j=a.length;i<j;i++)h+='script[type="'+a[i]+'"]',i!=j-1&&(h+=",");h=document.querySelectorAll(h)}else h=document.getElementsByTagName("script");i=0;for(j=
h.length;i<j;i++){var s=h[i];if(d){for(var p=s.getAttribute("type").toLowerCase(),q=!1,t=0,r=a.length;t<r;t++)if(p==a[t]){q=!0;break}if(!q)continue}s.src?k(s.src):g(s,b,c)}};a.compileExtern=k})(TSCompiler||(TSCompiler={}));
