var TypeScript;
(function(a){a.hasFlag=function(a,k){return 0!=(a&k)};var d=a.ErrorRecoverySet||(a.ErrorRecoverySet={});d._map=[];d.None=0;d.Comma=1;d.SColon=2;d.Asg=4;d.BinOp=8;d.RBrack=16;d.RCurly=32;d.RParen=64;d.Dot=128;d.Colon=256;d.PrimType=512;d.AddOp=1024;d.LCurly=2048;d.PreOp=4096;d.RegExp=8192;d.LParen=16384;d.LBrack=32768;d.Scope=65536;d.In=131072;d.SCase=262144;d.Else=524288;d.Catch=1048576;d.Var=2097152;d.Stmt=4194304;d.While=8388608;d.ID=16777216;d.Prefix=33554432;d.Literal=67108864;d.RLit=134217728;
d.Func=268435456;d.EOF=536870912;d.TypeScriptS=1073741824;d.ExprStart=d.SColon|d.AddOp|d.LCurly|d.PreOp|d.RegExp|d.LParen|d.LBrack|d.ID|d.Prefix|d.RLit|d.Func|d.Literal;d.StmtStart=d.ExprStart|d.SColon|d.Var|d.Stmt|d.While|d.TypeScriptS;d.Postfix=d.Dot|d.LParen|d.LBrack;d=a.AllowedElements||(a.AllowedElements={});d._map=[];d.None=0;d.Statements=1;d.FunctionDecls=2;d.ModuleDecls=4;d.ClassDecls=8;d.InterfaceDecls=16;d.TypedFuncDecls=32;d.TypedDecls=64;d.TypedFuncSignatures=256;d.TypedSignatures=512;
d.AmbientDecls=1024;d.Properties=2048;d.Block=d.Statements|d.FunctionDecls|d.TypedFuncDecls|d.TypedDecls;d.Global=d.Statements|d.FunctionDecls|d.ModuleDecls|d.ClassDecls|d.InterfaceDecls|d.AmbientDecls;d.FunctionBody=d.Statements|d.FunctionDecls;d.ModuleMembers=d.TypedFuncDecls|d.FunctionDecls|d.ModuleDecls|d.ClassDecls|d.InterfaceDecls|d.TypedDecls|d.Statements|d.AmbientDecls;d.ClassMembers=d.TypedFuncDecls|d.FunctionDecls|d.Statements|d.TypedDecls|d.Properties;d.InterfaceMembers=d.TypedFuncSignatures|
d.TypedSignatures;d.QuickParse=d.Global|d.Properties;d=a.Modifiers||(a.Modifiers={});d._map=[];d.None=0;d.Private=1;d.Public=2;d.Readonly=4;d.Ambient=8;d.Exported=16;d.Getter=32;d.Setter=64;d.Static=128;d=a.ASTFlags||(a.ASTFlags={});d._map=[];d.None=0;d.ExplicitSemicolon=1;d.AutomaticSemicolon=2;d.Writeable=4;d.Error=8;d.DotLHSPartial=16;d.DotLHS=32;d.IsStatement=64;d.StrictMode=128;d.PossibleOptionalParameter=256;d.ClassBaseConstructorCall=512;d.OptionalName=1024;d=a.DeclFlags||(a.DeclFlags={});
d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d=a.ModuleFlags||(a.ModuleFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.IsEnum=256;d.ShouldEmitModuleDecl=512;d.IsWholeFile=1024;d.IsDynamic=2048;d=a.SymbolFlags||(a.SymbolFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=
32;d.GetAccessor=64;d.SetAccessor=128;d.Property=256;d.Readonly=512;d.ModuleMember=1024;d.InterfaceMember=2048;d.ClassMember=4096;d.BuiltIn=8192;d.TypeSetDuringScopeAssignment=16384;d.Constant=32768;d.Optional=65536;d.RecursivelyReferenced=131072;d.Bound=262144;d=a.VarFlags||(a.VarFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.AutoInit=256;d.Property=512;d.Readonly=1024;d.Class=2048;d.ClassProperty=4096;
d.ClassBodyProperty=8192;d.ClassConstructorProperty=16384;d.ClassSuperMustBeFirstCallInConstructor=32768;d.Constant=65536;d=a.FncFlags||(a.FncFlags={});d._map=[];d.None=0;d.Exported=1;d.Private=2;d.Public=4;d.Ambient=8;d.Static=16;d.LocalStatic=32;d.GetAccessor=64;d.SetAccessor=128;d.Definition=256;d.Signature=512;d.Method=1024;d.HasReturnExpression=2048;d.CallMember=4096;d.ConstructMember=8192;d.HasSelfReference=16384;d.IsFatArrowFunction=32768;d.IndexerMember=65536;d.IsFunctionExpression=131072;
d.ClassMethod=262144;d.ClassPropertyMethodExported=524288;d=a.SignatureFlags||(a.SignatureFlags={});d._map=[];d.None=0;d.IsIndexer=1;d.IsStringIndexer=2;d.IsNumberIndexer=4;a.ToDeclFlags=function(a){return a};d=a.TypeFlags||(a.TypeFlags={});d._map=[];d.None=0;d.HasImplementation=1;d.HasSelfReference=2;d.MergeResult=4;d.IsEnum=8;d.BuildingName=16;d.HasBaseType=32;d.HasBaseTypeOfObject=64;d.IsClass=128;d=a.TypeRelationshipFlags||(a.TypeRelationshipFlags={});d._map=[];d.SuccessfulComparison=0;d.SourceIsNullTargetIsVoidOrUndefined=
1;d.RequiredPropertyIsMissing=2;d.IncompatibleSignatures=4;d.SourceSignatureHasTooManyParameters=3;d.IncompatibleReturnTypes=16;d.IncompatiblePropertyTypes=32;d.IncompatibleParameterTypes=64;d=a.CodeGenTarget||(a.CodeGenTarget={});d._map=[];d.ES3=0;d.ES5=1;var d=a.CodeGenTarget,h=a.ModuleGenTarget||(a.ModuleGenTarget={});h._map=[];h.Synchronous=0;h.Asynchronous=1;h.Local=2;h=a.ModuleGenTarget;a.codeGenTarget=d.ES3;a.moduleGenTarget=h.Synchronous;a.optimizeModuleCodeGen=!0;a.flagsToString=function(a,
k){for(var g="",e=1;-2147483648>e;e<<=1)if(0!=(k&e))for(var l in a)if(a[l]==e){0<g.length&&(g+="|");g+=l;break}return g}})(TypeScript||(TypeScript={}));
(function(a){a=a.NodeType||(a.NodeType={});a._map=[];a._map[0]="None";a.None=0;a._map[1]="Empty";a.Empty=1;a._map[2]="EmptyExpr";a.EmptyExpr=2;a._map[3]="True";a.True=3;a._map[4]="False";a.False=4;a._map[5]="This";a.This=5;a._map[6]="Super";a.Super=6;a._map[7]="QString";a.QString=7;a._map[8]="Regex";a.Regex=8;a._map[9]="Null";a.Null=9;a._map[10]="ArrayLit";a.ArrayLit=10;a._map[11]="ObjectLit";a.ObjectLit=11;a._map[12]="Void";a.Void=12;a._map[13]="Comma";a.Comma=13;a._map[14]="Pos";a.Pos=14;a._map[15]=
"Neg";a.Neg=15;a._map[16]="Delete";a.Delete=16;a._map[17]="Await";a.Await=17;a._map[18]="In";a.In=18;a._map[19]="Dot";a.Dot=19;a._map[20]="From";a.From=20;a._map[21]="Is";a.Is=21;a._map[22]="InstOf";a.InstOf=22;a._map[23]="Typeof";a.Typeof=23;a._map[24]="NumberLit";a.NumberLit=24;a._map[25]="Name";a.Name=25;a._map[26]="TypeRef";a.TypeRef=26;a._map[27]="Index";a.Index=27;a._map[28]="Call";a.Call=28;a._map[29]="New";a.New=29;a._map[30]="Asg";a.Asg=30;a._map[31]="AsgAdd";a.AsgAdd=31;a._map[32]="AsgSub";
a.AsgSub=32;a._map[33]="AsgDiv";a.AsgDiv=33;a._map[34]="AsgMul";a.AsgMul=34;a._map[35]="AsgMod";a.AsgMod=35;a._map[36]="AsgAnd";a.AsgAnd=36;a._map[37]="AsgXor";a.AsgXor=37;a._map[38]="AsgOr";a.AsgOr=38;a._map[39]="AsgLsh";a.AsgLsh=39;a._map[40]="AsgRsh";a.AsgRsh=40;a._map[41]="AsgRs2";a.AsgRs2=41;a._map[42]="QMark";a.QMark=42;a._map[43]="LogOr";a.LogOr=43;a._map[44]="LogAnd";a.LogAnd=44;a._map[45]="Or";a.Or=45;a._map[46]="Xor";a.Xor=46;a._map[47]="And";a.And=47;a._map[48]="Eq";a.Eq=48;a._map[49]=
"Ne";a.Ne=49;a._map[50]="Eqv";a.Eqv=50;a._map[51]="NEqv";a.NEqv=51;a._map[52]="Lt";a.Lt=52;a._map[53]="Le";a.Le=53;a._map[54]="Gt";a.Gt=54;a._map[55]="Ge";a.Ge=55;a._map[56]="Add";a.Add=56;a._map[57]="Sub";a.Sub=57;a._map[58]="Mul";a.Mul=58;a._map[59]="Div";a.Div=59;a._map[60]="Mod";a.Mod=60;a._map[61]="Lsh";a.Lsh=61;a._map[62]="Rsh";a.Rsh=62;a._map[63]="Rs2";a.Rs2=63;a._map[64]="Not";a.Not=64;a._map[65]="LogNot";a.LogNot=65;a._map[66]="IncPre";a.IncPre=66;a._map[67]="DecPre";a.DecPre=67;a._map[68]=
"IncPost";a.IncPost=68;a._map[69]="DecPost";a.DecPost=69;a._map[70]="TypeAssertion";a.TypeAssertion=70;a._map[71]="FuncDecl";a.FuncDecl=71;a._map[72]="Member";a.Member=72;a._map[73]="VarDecl";a.VarDecl=73;a._map[74]="ArgDecl";a.ArgDecl=74;a._map[75]="Return";a.Return=75;a._map[76]="Break";a.Break=76;a._map[77]="Continue";a.Continue=77;a._map[78]="Throw";a.Throw=78;a._map[79]="For";a.For=79;a._map[80]="ForIn";a.ForIn=80;a._map[81]="If";a.If=81;a._map[82]="While";a.While=82;a._map[83]="DoWhile";a.DoWhile=
83;a._map[84]="Block";a.Block=84;a._map[85]="Case";a.Case=85;a._map[86]="Switch";a.Switch=86;a._map[87]="Try";a.Try=87;a._map[88]="TryCatch";a.TryCatch=88;a._map[89]="TryFinally";a.TryFinally=89;a._map[90]="Finally";a.Finally=90;a._map[91]="Catch";a.Catch=91;a._map[92]="List";a.List=92;a._map[93]="Script";a.Script=93;a._map[94]="Class";a.Class=94;a._map[95]="Interface";a.Interface=95;a._map[96]="Module";a.Module=96;a._map[97]="Import";a.Import=97;a._map[98]="With";a.With=98;a._map[99]="Label";a.Label=
99;a._map[100]="LabeledStatement";a.LabeledStatement=100;a._map[101]="EBStart";a.EBStart=101;a._map[102]="GotoEB";a.GotoEB=102;a._map[103]="EndCode";a.EndCode=103;a._map[104]="Error";a.Error=104;a._map[105]="Comment";a.Comment=105;a._map[106]="Debugger";a.Debugger=106;a.GeneralNode=a.FuncDecl;a.LastAsg=a.AsgRs2})(TypeScript||(TypeScript={}));
(function(a){var d;d=function(){this.constructor=this.isPrototypeOf=this.propertyIsEnumerable=this.hasOwnProperty=this.valueOf=this.toLocaleString=this.toString=this.prototype=void 0};a.BlockIntrinsics=d;var h=function(){this.itemCount=0;this.table=new d};h.prototype.getAllKeys=function(){var a=[],b;for(b in this.table)void 0!=this.table[b]&&(a[a.length]=b);return a};h.prototype.add=function(a,b){if(void 0!=this.table[a])return!1;this.table[a]=b;this.itemCount++;return!0};h.prototype.addOrUpdate=
function(a,b){if(void 0!=this.table[a])return this.table[a]=b,!1;this.table[a]=b;this.itemCount++;return!0};h.prototype.map=function(a,b){for(var e in this.table)void 0!=this.table[e]&&a(e,this.table[e],b)};h.prototype.every=function(a,b){for(var e in this.table)if(void 0!=this.table[e]&&!a(e,this.table[e],b))return!1;return!0};h.prototype.some=function(a,b){for(var e in this.table)if(void 0!=this.table[e]&&a(e,this.table[e],b))return!0;return!1};h.prototype.count=function(){return this.itemCount};
h.prototype.lookup=function(a){a=this.table[a];return void 0!=a?a:null};a.StringHashTable=h;h=function(a,b){this.primaryTable=a;this.secondaryTable=b;this.insertPrimary=!0};h.prototype.getAllKeys=function(){return this.primaryTable.getAllKeys().concat(this.secondaryTable.getAllKeys())};h.prototype.add=function(a,b){return this.insertPrimary?this.primaryTable.add(a,b):this.secondaryTable.add(a,b)};h.prototype.addOrUpdate=function(a,b){return this.insertPrimary?this.primaryTable.addOrUpdate(a,b):this.secondaryTable.addOrUpdate(a,
b)};h.prototype.map=function(a,b){this.primaryTable.map(a,b);this.secondaryTable.map(a,b)};h.prototype.every=function(a,b){return this.primaryTable.every(a,b)&&this.secondaryTable.every(a,b)};h.prototype.some=function(a,b){return this.primaryTable.some(a,b)||this.secondaryTable.some(a,b)};h.prototype.count=function(){return this.primaryTable.count()+this.secondaryTable.count()};h.prototype.lookup=function(a){var b=this.primaryTable.lookup(a);return void 0!=b?b:this.secondaryTable.lookup(a)};a.DualStringHashTable=
h;a.numberHashFn=function(a){a=a^61^a>>>16;a+=a<<3;a=668265261*(a^a>>>4);return a^=a>>>15};a.combineHashes=function(a,b){return b^(a>>5)+a};var b;b=function(a,b){this.key=a;this.data=b};a.HashEntry=b;h=function(a,b,e){this.size=a;this.hashFn=b;this.equalsFn=e;this.itemCount=0;this.table=[];for(a=0;a<this.size;a++)this.table[a]=null};h.prototype.add=function(a,g){var e,l=new b(a,g),c=this.hashFn(a),c=c%this.size;for(e=this.table[c];null!=e;e=e.next)if(this.equalsFn(a,e.key))return!1;l.next=this.table[c];
this.table[c]=l;this.itemCount++;return!0};h.prototype.remove=function(a){var b,e=this.hashFn(a),e=e%this.size,l=null,c=null;for(b=this.table[e];null!=b;b=b.next){if(this.equalsFn(a,b.key)){l=b.data;this.itemCount--;c?c.next=b.next:this.table[e]=b.next;break}c=b}return l};h.prototype.count=function(){return this.itemCount};h.prototype.lookup=function(a){var b;b=this.hashFn(a);b%=this.size;for(b=this.table[b];null!=b;b=b.next)if(this.equalsFn(a,b.key))return b.data;return null};a.HashTable=h})(TypeScript||
(TypeScript={}));var __extends=this.__extends||function(a,d){function h(){this.constructor=a}h.prototype=d.prototype;a.prototype=new h};
(function(a){var d=function(c){this.nodeType=c;this.type=null;this.flags=a.ASTFlags.Writeable;this.limChar=this.minChar=-1;this.passCreated=a.CompilerDiagnostics.analysisPass;this.postComments=this.preComments=null;this.isParenthesized=!1};d.prototype.isStatementOrExpression=function(){return!1};d.prototype.isCompoundStatement=function(){return!1};d.prototype.isLeaf=function(){return this.isStatementOrExpression()&&!this.isCompoundStatement()};d.prototype.typeCheck=function(c){switch(this.nodeType){case a.NodeType.Error:case a.NodeType.EmptyExpr:this.type=
c.anyType;break;case a.NodeType.This:return c.typeCheckThis(this);case a.NodeType.Null:this.type=c.nullType;break;case a.NodeType.False:case a.NodeType.True:this.type=c.booleanType;break;case a.NodeType.Super:return c.typeCheckSuper(this);case a.NodeType.EndCode:case a.NodeType.Empty:case a.NodeType.Void:this.type=c.voidType;break;default:throw Error("please implement in derived class");}return this};d.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
switch(this.nodeType){case a.NodeType.This:c.thisFnc&&a.hasFlag(c.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction)?c.writeToOutput("_this"):c.writeToOutput("this");break;case a.NodeType.Null:c.writeToOutput("null");break;case a.NodeType.False:c.writeToOutput("false");break;case a.NodeType.True:c.writeToOutput("true");break;case a.NodeType.Super:c.emitSuperReference();case a.NodeType.EndCode:break;case a.NodeType.Error:case a.NodeType.EmptyExpr:break;case a.NodeType.Empty:c.writeToOutput("; ");break;
case a.NodeType.Void:c.writeToOutput("void ");break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};d.prototype.print=function(c){c.startLine();var e={line:-1,col:-1},i={line:-1,col:-1};null!==c.parser&&(c.parser.getSourceLineCol(e,this.minChar),c.parser.getSourceLineCol(i,this.limChar),c.write("("+e.line+","+e.col+")--("+i.line+","+i.col+"): "));e=this.printLabel();a.hasFlag(this.flags,a.ASTFlags.Error)&&(e+=" (Error)");
c.writeLine(e)};d.prototype.printLabel=function(){return void 0!==a.nodeTypeTable[this.nodeType]?a.nodeTypeTable[this.nodeType]:a.NodeType._map[this.nodeType]};d.prototype.addToControlFlow=function(a){a.walker.options.goChildren=!1;a.addContent(this)};d.prototype.netFreeUses=function(){};d.prototype.treeViewLabel=function(){return a.NodeType._map[this.nodeType]};a.AST=d;var h=function(c,e){d.call(this,a.NodeType.Error);this.minChar=c;this.limChar=e};__extends(h,d);a.IncompleteAST=h;var b=function(){d.call(this,
a.NodeType.List);this.enclosingScope=null;this.members=[]};__extends(b,d);b.prototype.addToControlFlow=function(a){for(var c=this.members.length,e=0;e<c;e++)if(a.noContinuation){a.addUnreachable(this.members[e]);break}else this.members[e]=a.walk(this.members[e],this);a.walker.options.goChildren=!1};b.prototype.append=function(a){this.members[this.members.length]=a;return this};b.prototype.appendAll=function(c){if(c.nodeType==a.NodeType.List)for(var e=0,i=c.members.length;e<i;e++)this.append(c.members[e]);
else this.append(c);return this};b.prototype.emit=function(c,e,i,f){c.emitJavascriptList(this,null,a.TokenID.SColon,i,!1,!1,f)};b.prototype.typeCheck=function(a){var c=this.members.length;a.nestingLevel++;for(var e=0;e<c;e++)this.members[e]&&(this.members[e]=this.members[e].typeCheck(a));a.nestingLevel--;return this};a.ASTList=b;var k=function(c){d.call(this,a.NodeType.Name);this.text=c;this.sym=null;this.cloId=-1};__extends(k,d);k.prototype.isMissing=function(){return!1};k.prototype.isLeaf=function(){return!0};
k.prototype.treeViewLabel=function(){return"id: "+this.text};k.prototype.printLabel=function(){return this.text?"id: "+this.text:"name node"};k.prototype.typeCheck=function(a){return a.typeCheckName(this)};k.prototype.emit=function(a){a.emitJavascriptName(this,!0)};a.Identifier=k;h=function(){k.call(this,"__missing")};__extends(h,k);h.prototype.isMissing=function(){return!0};h.prototype.emit=function(){};a.MissingIdentifier=h;h=function(c){d.call(this,a.NodeType.Label);this.id=c};__extends(h,d);h.prototype.printLabel=
function(){return this.id.text+":"};h.prototype.typeCheck=function(a){this.type=a.voidType;return this};h.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput(this.id.text+":");a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.Label=h;h=function(a,c){d.call(this,a);this.operand=c;this.castTerm=this.targetType=null;this.nty=a};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.addToControlFlow=
function(c){d.prototype.addToControlFlow.call(this,c);this.nodeType==a.NodeType.Throw&&c.returnStmt()};h.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Not:return c.typeCheckBitNot(this);case a.NodeType.LogNot:return c.typeCheckLogNot(this);case a.NodeType.Pos:case a.NodeType.Neg:return c.typeCheckUnaryNumberOperator(this);case a.NodeType.IncPost:case a.NodeType.IncPre:case a.NodeType.DecPost:case a.NodeType.DecPre:return c.typeCheckIncOrDec(this);case a.NodeType.ArrayLit:c.typeCheckArrayLit(this);
break;case a.NodeType.ObjectLit:c.typeCheckObjectLit(this);break;case a.NodeType.Throw:this.operand=c.typeCheck(this.operand);this.type=c.voidType;break;case a.NodeType.Typeof:this.operand=c.typeCheck(this.operand);this.type=c.stringType;break;case a.NodeType.Delete:this.operand=c.typeCheck(this.operand);this.type=c.booleanType;break;case a.NodeType.TypeAssertion:this.castTerm=c.typeCheck(this.castTerm);c.checker.typeCheckWithContextualType(!this.operand.isParenthesized?this.castTerm.type:null,c.checker.inProvisionalTypecheckMode(),
!0,this.operand);c.castWithCoercion(this.operand,this.castTerm.type,!1,!0);this.type=this.castTerm.type;break;case a.NodeType.Void:this.operand=c.typeCheck(this.operand);this.type=c.checker.undefinedType;break;default:throw Error("please implement in derived class");}return this};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);switch(this.nty){case a.NodeType.IncPost:c.emitJavascript(this.operand,a.TokenID.Inc,!1);c.writeToOutput("++");break;case a.NodeType.LogNot:c.writeToOutput("!");
c.emitJavascript(this.operand,a.TokenID.Bang,!1);break;case a.NodeType.DecPost:c.emitJavascript(this.operand,a.TokenID.Dec,!1);c.writeToOutput("--");break;case a.NodeType.ObjectLit:c.emitObjectLiteral(this.operand);break;case a.NodeType.ArrayLit:c.emitArrayLiteral(this.operand);break;case a.NodeType.Not:c.writeToOutput("~");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Neg:c.writeToOutput("-");this.operand.nodeType==a.NodeType.Neg&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,
a.TokenID.Sub,!1);break;case a.NodeType.Pos:c.writeToOutput("+");this.operand.nodeType==a.NodeType.Pos&&(this.operand.isParenthesized=!0);c.emitJavascript(this.operand,a.TokenID.Add,!1);break;case a.NodeType.IncPre:c.writeToOutput("++");c.emitJavascript(this.operand,a.TokenID.Inc,!1);break;case a.NodeType.DecPre:c.writeToOutput("--");c.emitJavascript(this.operand,a.TokenID.Dec,!1);break;case a.NodeType.Throw:c.writeToOutput("throw ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);c.writeToOutput(";");
break;case a.NodeType.Typeof:c.writeToOutput("typeof ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Delete:c.writeToOutput("delete ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.Void:c.writeToOutput("void ");c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;case a.NodeType.TypeAssertion:c.emitJavascript(this.operand,a.TokenID.Tilde,!1);break;default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.UnaryExpression=h;h=function(a,c,e){d.call(this,a);this.target=c;this.args=e;this.signature=null;this.nty=a;this.minChar=this.target.minChar};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.typeCheck=function(c){return this.nty==a.NodeType.New?c.typeCheckNew(this):c.typeCheckCall(this)};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.New?c.emitNew(this.target,this.args):c.emitCall(this,
this.target,this.args);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.CallExpression=h;h=function(a,c,e){d.call(this,a);this.operand1=c;this.operand2=e;this.nty=a};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.typeCheck=function(c){switch(this.nty){case a.NodeType.Dot:return c.typeCheckDotOperator(this);case a.NodeType.Asg:return c.typeCheckAsgOperator(this);case a.NodeType.Add:case a.NodeType.Sub:case a.NodeType.Mul:case a.NodeType.Div:case a.NodeType.Mod:case a.NodeType.Or:case a.NodeType.And:return c.typeCheckArithmeticOperator(this,
!1);case a.NodeType.Xor:return c.typeCheckBitwiseOperator(this,!1);case a.NodeType.Ne:case a.NodeType.Eq:var e;c.checker.styleSettings.eqeqeq?(e=a.nodeTypeTable[this.nty],c.checker.errorReporter.styleError(this,"use of "+e)):c.checker.styleSettings.eqnull&&(e=a.nodeTypeTable[this.nty],null!==this.operand2&&this.operand2.nodeType==a.NodeType.Null&&c.checker.errorReporter.styleError(this,"use of "+e+" to compare with null"));case a.NodeType.Eqv:case a.NodeType.NEqv:case a.NodeType.Lt:case a.NodeType.Le:case a.NodeType.Ge:case a.NodeType.Gt:return c.typeCheckBooleanOperator(this);
case a.NodeType.Index:return c.typeCheckIndex(this);case a.NodeType.Member:this.type=c.voidType;break;case a.NodeType.LogOr:return c.typeCheckLogOr(this);case a.NodeType.LogAnd:return c.typeCheckLogAnd(this);case a.NodeType.AsgAdd:case a.NodeType.AsgSub:case a.NodeType.AsgMul:case a.NodeType.AsgDiv:case a.NodeType.AsgMod:case a.NodeType.AsgOr:case a.NodeType.AsgAnd:return c.typeCheckArithmeticOperator(this,!0);case a.NodeType.AsgXor:return c.typeCheckBitwiseOperator(this,!0);case a.NodeType.Lsh:case a.NodeType.Rsh:case a.NodeType.Rs2:return c.typeCheckShift(this,
!1);case a.NodeType.AsgLsh:case a.NodeType.AsgRsh:case a.NodeType.AsgRs2:return c.typeCheckShift(this,!0);case a.NodeType.Comma:return c.typeCheckCommaOperator(this);case a.NodeType.InstOf:return c.typeCheckInstOf(this);case a.NodeType.In:return c.typeCheckInOperator(this);case a.NodeType.From:c.checker.errorReporter.simpleError(this,"Illegal use of 'from' keyword in binary expression");break;default:throw Error("please implement in derived class");}return this};h.prototype.emit=function(c){var e=
a.nodeTypeToTokTable[this.nodeType];c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);if(void 0!=e)c.emitJavascript(this.operand1,e,!1),"instanceof"==a.tokenTable[e].text?c.writeToOutput(" instanceof "):"in"==a.tokenTable[e].text?c.writeToOutput(" in "):c.writeToOutputTrimmable(" "+a.tokenTable[e].text+" "),c.emitJavascript(this.operand2,e,!1);else switch(this.nty){case a.NodeType.Dot:c.tryEmitConstant(this)||(c.emitJavascript(this.operand1,a.TokenID.Dot,!1),c.writeToOutput("."),
c.emitJavascriptName(this.operand2,!1));break;case a.NodeType.Index:c.emitIndex(this.operand1,this.operand2);break;case a.NodeType.Member:this.operand2.nodeType==a.NodeType.FuncDecl&&this.operand2.isAccessor()?(a.hasFlag(this.operand2.fncFlags,a.FncFlags.GetAccessor)?c.writeToOutput("get "):c.writeToOutput("set "),c.emitJavascript(this.operand1,a.TokenID.Colon,!1)):(c.emitJavascript(this.operand1,a.TokenID.Colon,!1),c.writeToOutputTrimmable(": "));c.emitJavascript(this.operand2,a.TokenID.Comma,!1);
break;case a.NodeType.Comma:c.emitJavascript(this.operand1,a.TokenID.Comma,!1);c.emitState.inObjectLiteral?c.writeLineToOutput(", "):c.writeToOutput(",");c.emitJavascript(this.operand2,a.TokenID.Comma,!1);break;case a.NodeType.Is:throw Error("should be de-sugared during type check");default:throw Error("please implement in derived class");}c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.BinaryExpression=h;h=function(a,c,e,i){d.call(this,a);this.operand1=c;this.operand2=e;
this.operand3=i;this.nty=a};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.typeCheck=function(a){return a.typeCheckQMark(this)};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.operand1,a.TokenID.QMark,!1);c.writeToOutput(" ? ");c.emitJavascript(this.operand2,a.TokenID.QMark,!1);c.writeToOutput(" : ");c.emitJavascript(this.operand3,a.TokenID.QMark,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};a.TrinaryExpression=h;h=function(c){d.call(this,a.NodeType.NumberLit);this.value=c;this.isNegativeZero=!1};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.typeCheck=function(a){this.type=a.doubleType;return this};h.prototype.treeViewLabel=function(){return"num: "+this.value};h.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);this.isNegativeZero&&a.writeToOutput("-");a.writeToOutput(this.value.toString());a.recordSourceMappingEnd(this);
a.emitParensAndCommentsInPlace(this,!1)};h.prototype.printLabel=function(){return Math.floor(this.value)!=this.value?this.value.toFixed(2).toString():this.value.toString()};a.NumberLiteral=h;h=function(c){d.call(this,a.NodeType.Regex);this.regex=c};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.typeCheck=function(a){this.type=a.regexType;return this};h.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.regex.toString());
a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.RegexLiteral=h;h=function(c){d.call(this,a.NodeType.QString);this.text=c};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.emitStringLiteral(this.text);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){this.type=a.stringType;return this};h.prototype.treeViewLabel=
function(){return"st: "+this.text};h.prototype.printLabel=function(){return this.text};a.StringLiteral=h;h=function(c,e){d.call(this,a.NodeType.Import);this.id=c;this.alias=e;this.varFlags=a.VarFlags.None;this.isDynamicImport=!1};__extends(h,d);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.emit=function(c,e,i,f){f&&c.emitImportDecl(this);if(!this.isDynamicImport||this.id.sym&&!this.id.sym.onlyReferencedAsTypeRef)e=c.modAliasId,i=c.firstModAlias,c.recordSourceMappingStart(this),
c.emitParensAndCommentsInPlace(this,!0),c.writeToOutput("var "+this.id.text+" = "),c.modAliasId=this.id.text,c.firstModAlias=this.firstAliasedModToString(),c.emitJavascript(this.alias,a.TokenID.Tilde,!1,f),this.isDynamicImport||c.writeToOutput(";"),c.emitParensAndCommentsInPlace(this,!1),c.recordSourceMappingEnd(this),c.modAliasId=e,c.firstModAlias=i};h.prototype.typeCheck=function(a){return a.typeCheckImportDecl(this)};h.prototype.getAliasName=function(c){"undefined"===typeof c&&(c=this.alias);return c.nodeType==
a.NodeType.Name?c.text:this.getAliasName(c.operand1)+"."+this.getAliasName(c.operand2)};h.prototype.firstAliasedModToString=function(){return this.alias.nodeType==a.NodeType.Name?this.alias.text:this.alias.operand1.text};a.ImportDecl=h;var g=function(c,e,i){d.call(this,e);this.id=c;this.nestingLevel=i;this.typeExpr=this.init=null;this.varFlags=a.VarFlags.None;this.sym=null};__extends(g,d);g.prototype.isStatementOrExpression=function(){return!0};g.prototype.isPrivate=function(){return a.hasFlag(this.varFlags,
a.VarFlags.Private)};g.prototype.isPublic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Public)};g.prototype.isProperty=function(){return a.hasFlag(this.varFlags,a.VarFlags.Property)};g.prototype.typeCheck=function(a){return a.typeCheckBoundDecl(this)};g.prototype.printLabel=function(){return this.treeViewLabel()};a.BoundDecl=g;h=function(c,e){g.call(this,c,a.NodeType.VarDecl,e)};__extends(h,g);h.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};h.prototype.isExported=
function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};h.prototype.isStatic=function(){return a.hasFlag(this.varFlags,a.VarFlags.Static)};h.prototype.emit=function(a,c,e,i){a.emitJavascriptVarDecl(this,c,i)};h.prototype.treeViewLabel=function(){return"var "+this.id.text};a.VarDecl=h;h=function(c){g.call(this,c,a.NodeType.ArgDecl,0);this.isOptional=!1;this.parameterPropertySym=null};__extends(h,g);h.prototype.isOptionalArg=function(){return this.isOptional||this.init};h.prototype.treeViewLabel=
function(){return"arg: "+this.id.text};h.prototype.emit=function(a,c,e,i){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeToOutput(this.id.text);i&&a.emitArgDecl(this);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.ArgDecl=h;var e=0,l=function(c,e,i,f,l,b,k,g){d.call(this,g);this.name=c;this.bod=e;this.isConstructor=i;this.args=f;this.vars=l;this.scopes=b;this.statics=k;this.hint=null;this.fncFlags=a.FncFlags.None;this.returnTypeAnnotation=
null;this.variableArgList=!1;this.internalNameCache=this.jumpRefs=null;this.tmp1Declared=!1;this.enclosingFnc=null;this.freeVariables=[];this.unitIndex=-1;this.boundToProperty=this.classDecl=null;this.isOverload=!1;this.innerStaticFuncs=[];this.isInlineCallLiteral=this.isTargetTypedAsMethod=!1;this.accessorSymbol=null;this.rightCurlyCount=this.leftCurlyCount=0;this.returnStatementsWithExpressions=[];this.scopeType=null};__extends(l,d);l.prototype.internalName=function(){if(null==this.internalNameCache){var a=
this.getNameText();this.internalNameCache=a?"_internal_"+a:"_internal_"+e++}return this.internalNameCache};l.prototype.hasSelfReference=function(){return a.hasFlag(this.fncFlags,a.FncFlags.HasSelfReference)};l.prototype.setHasSelfReference=function(){this.fncFlags|=a.FncFlags.HasSelfReference};l.prototype.addCloRef=function(a,c){null==this.envids&&(this.envids=[]);this.envids[this.envids.length]=a;var e=this.enclosingFnc;if(c)for(;e&&e.type.symbol!=c.container;)e.addJumpRef(c),e=e.enclosingFnc;return this.envids.length-
1};l.prototype.addJumpRef=function(a){null==this.jumpRefs&&(this.jumpRefs=[]);var c=new k(a.name);this.jumpRefs[this.jumpRefs.length]=c;c.sym=a;c.cloId=this.addCloRef(c,null)};l.prototype.buildControlFlow=function(){var c=new a.BasicBlock,e=new a.BasicBlock,c=new a.ControlFlowContext(c,e),e=a.getAstWalkerFactory().getWalker(function(a,c,j){a.addToControlFlow(j.state);return a},null,null,c);c.walker=e;e.walk(this.bod,this);return c};l.prototype.typeCheck=function(a){return a.typeCheckFunction(this)};
l.prototype.emit=function(a,c,e,i){a.emitJavascriptFunction(this,i)};l.prototype.getNameText=function(){return this.name?this.name.text:this.hint};l.prototype.isMethod=function(){return(this.fncFlags&a.FncFlags.Method)!=a.FncFlags.None};l.prototype.isCallMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.CallMember)};l.prototype.isConstructMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.ConstructMember)};l.prototype.isIndexerMember=function(){return a.hasFlag(this.fncFlags,a.FncFlags.IndexerMember)};
l.prototype.isSpecialFn=function(){return this.isCallMember()||this.isIndexerMember()||this.isConstructMember()};l.prototype.isAnonymousFn=function(){return null===this.name};l.prototype.isAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)||a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};l.prototype.isGetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.GetAccessor)};l.prototype.isSetAccessor=function(){return a.hasFlag(this.fncFlags,a.FncFlags.SetAccessor)};l.prototype.isAmbient=
function(){return a.hasFlag(this.fncFlags,a.FncFlags.Ambient)};l.prototype.isExported=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Exported)};l.prototype.isPrivate=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Private)};l.prototype.isPublic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Public)};l.prototype.isStatic=function(){return a.hasFlag(this.fncFlags,a.FncFlags.Static)};l.prototype.treeViewLabel=function(){return null==this.name?"funcExpr":"func: "+this.name.text};l.prototype.ClearFlags=
function(){this.fncFlags=a.FncFlags.None};l.prototype.isSignature=function(){return(this.fncFlags&a.FncFlags.Signature)!=a.FncFlags.None};l.prototype.hasStaticDeclarations=function(){return!this.isConstructor&&(0<this.statics.members.length||0<this.innerStaticFuncs.length)};a.FuncDecl=l;h=function(a,c,e){this.filename=a;this.lineMap=c;this.unitIndex=e};a.LocationInfo=h;a.unknownLocationInfo=new h("unknown",null,-1);h=function(c,e){l.call(this,new k("script"),null,!1,null,c,e,null,a.NodeType.Script);
this.locationInfo=null;this.hasBeenTypeChecked=this.isDeclareFile=this.isResident=this.requiresInherits=this.requiresGlobal=!1;this.topLevelMod=null;this.rightCurlyCount=this.leftCurlyCount=0;this.vars=c;this.scopes=e};__extends(h,l);h.prototype.typeCheck=function(a){return a.typeCheckScript(this)};h.prototype.treeViewLabel=function(){return"Script"};h.prototype.emitRequired=function(){if(!this.isDeclareFile&&!this.isResident&&this.bod)for(var c=0,e=this.bod.members.length;c<e;c++){var i=this.bod.members[c];
if(i.nodeType==a.NodeType.Module){if(!a.hasFlag(i.modFlags,a.ModuleFlags.ShouldEmitModuleDecl|a.ModuleFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.Class){if(!a.hasFlag(i.varFlags,a.VarFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.VarDecl){if(!a.hasFlag(i.varFlags,a.VarFlags.Ambient))return!0}else if(i.nodeType==a.NodeType.FuncDecl){if(!i.isSignature())return!0}else if(i.nodeType!=a.NodeType.Interface&&i.nodeType!=a.NodeType.Empty)return!0}return!1};h.prototype.emit=function(c,e,
i,f){this.emitRequired()&&(c.emitParensAndCommentsInPlace(this,!0),c.recordSourceMappingStart(this),c.emitPrologue(this.requiresInherits),e=f?c.setDeclContainingAST(this):null,c.emitJavascriptList(this.bod,null,a.TokenID.SColon,!0,!1,!1,f),f&&c.setDeclContainingAST(e),c.recordSourceMappingEnd(this),c.emitParensAndCommentsInPlace(this,!1))};a.Script=h;var c=function(a,c,e){d.call(this,a);this.name=c;this.members=e;this.nty=a};__extends(c,d);a.Record=c;h=function(j,e,i,f){c.call(this,a.NodeType.Module,
j,e);this.modFlags=a.ModuleFlags.ShouldEmitModuleDecl;this.alias=null;this.rightCurlyCount=this.leftCurlyCount=0;this.amdDependencies=[];this.members=e;this.vars=i;this.name=j;this.scopes=f;this.prettyName=this.name.text};__extends(h,c);h.prototype.isExported=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Exported)};h.prototype.isAmbient=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.Ambient)};h.prototype.isEnum=function(){return a.hasFlag(this.modFlags,a.ModuleFlags.IsEnum)};h.prototype.recordNonInterface=
function(){this.modFlags&=~a.ModuleFlags.ShouldEmitModuleDecl};h.prototype.typeCheck=function(a){return a.typeCheckModule(this)};h.prototype.emit=function(c,e,i,f){a.hasFlag(this.modFlags,a.ModuleFlags.ShouldEmitModuleDecl)?f&&c.emitModuleSignature(this):(c.emitParensAndCommentsInPlace(this,!0),c.emitJavascriptModule(this,f),c.emitParensAndCommentsInPlace(this,!1))};a.ModuleDecl=h;var i=function(a,e,i,f,l){c.call(this,a,e,l);this.extendsList=i;this.implementsList=f;this.name=e;this.members=l};__extends(i,
c);a.NamedType=i;h=function(c,e,f,l){i.call(this,a.NodeType.Class,c,f,l,e);this.varFlags=a.VarFlags.None;this.rightCurlyCount=this.leftCurlyCount=0;this.knownMemberNames={};this.constructorDecl=null;this.constructorNestingLevel=0;this.allMemberDefinitions=new b;this.name=c;this.baseClass=f;this.implementsList=l;this.definitionMembers=e};__extends(h,i);h.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};h.prototype.isAmbient=function(){return a.hasFlag(this.varFlags,
a.VarFlags.Ambient)};h.prototype.typeCheck=function(a){return a.typeCheckClass(this)};h.prototype.emit=function(a,c,e,i){a.emitJavascriptClass(this,i)};a.ClassDecl=h;h=function(c,e,f,l,b,k){i.call(this,c,e,b,k,f);this.args=l;this.varFlags=a.VarFlags.None;this.isOverload=!1;this.rightCurlyCount=this.leftCurlyCount=0;this.nty=c;this.name=e;this.extendsList=b;this.implementsList=k;this.members=f};__extends(h,i);h.prototype.isExported=function(){return a.hasFlag(this.varFlags,a.VarFlags.Exported)};h.prototype.isAmbient=
function(){return a.hasFlag(this.varFlags,a.VarFlags.Ambient)};h.prototype.typeCheck=function(c){if(this.nty==a.NodeType.Interface)return c.typeCheckInterface(this);throw Error("please implement type check for node type"+this.nty);};h.prototype.emit=function(c,e,i,f){if(this.nty==a.NodeType.Interface)f&&c.emitInterfaceDeclaration(this);else throw Error("please implement emit for node type"+this.nty);};a.TypeDecl=h;var f=function(c){d.call(this,c);this.flags|=a.ASTFlags.IsStatement};__extends(f,d);
f.prototype.isLoop=function(){return!1};f.prototype.isCompoundStatement=function(){return this.isLoop()};f.prototype.typeCheck=function(a){this.type=a.voidType;return this};a.Statement=f;h=function(c,e){f.call(this,a.NodeType.LabeledStatement);this.labels=c;this.stmt=e};__extends(h,f);h.prototype.emit=function(a,c,e,i){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);if(this.labels)for(var f=this.labels.members.length,l=0;l<f;l++)this.labels.members[l].emit(a,c,e,i);this.stmt.emit(a,
c,!0,i);a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){a.typeCheck(this.labels);this.stmt=this.stmt.typeCheck(a);return this};h.prototype.addToControlFlow=function(c){var e=c.current,i=new a.BasicBlock;c.current=i;e.addSuccessor(i)};a.LabeledStatement=h;h=function(c,e){f.call(this,a.NodeType.Block);this.stmts=c;this.visible=e};__extends(h,f);h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);
this.visible&&(c.writeLineToOutput(" {"),c.increaseIndent());var e=c.setInObjectLiteral(!1);this.stmts&&c.emitJavascriptList(this.stmts,null,a.TokenID.SColon,!0,!1,!1);this.visible&&(c.decreaseIndent(),c.emitIndent(),c.writeToOutput("}"));c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.addToControlFlow=function(c){var e=new a.BasicBlock;c.pushStatement(this,c.current,e);this.stmts&&c.walk(this.stmts,this);c.walker.options.goChildren=!1;c.popStatement();
0<e.predecessors.length&&(c.current.addSuccessor(e),c.current=e)};h.prototype.typeCheck=function(a){a.checker.styleSettings.emptyBlocks||(null===this.stmts||0==this.stmts.members.length)&&a.checker.errorReporter.styleError(this,"empty block");a.typeCheck(this.stmts);return this};a.Block=h;h=function(a){f.call(this,a);this.resolvedTarget=this.target=null;this.nty=a};__extends(h,f);h.prototype.hasExplicitTarget=function(){return this.target};h.prototype.setResolvedTarget=function(c,e){if(e.isLoop())return this.resolvedTarget=
e,!0;if(this.nty===a.NodeType.Continue)return c.reportParseError("continue statement applies only to loops"),!1;if(e.nodeType==a.NodeType.Switch||this.hasExplicitTarget())return this.resolvedTarget=e,!0;c.reportParseError("break statement with no label can apply only to a loop or switch statement");return!1};h.prototype.addToControlFlow=function(c){f.prototype.addToControlFlow.call(this,c);c.unconditionalBranch(this.resolvedTarget,this.nty==a.NodeType.Continue)};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);this.nty==a.NodeType.Break?c.writeToOutput("break"):c.writeToOutput("continue");this.hasExplicitTarget()&&c.writeToOutput(" "+this.target);c.writeToOutput(";");c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};a.Jump=h;h=function(c){f.call(this,a.NodeType.While);this.cond=c;this.body=null};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isLoop=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("while(");c.emitJavascript(this.cond,a.TokenID.WHILE,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!1,!1);c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){return a.typeCheckWhile(this)};h.prototype.addToControlFlow=function(c){var e=c.current,i=new a.BasicBlock,f=new a.BasicBlock;e.addSuccessor(i);c.current=i;c.addContent(this.cond);
e=c.current;this.body&&(c.current=new a.BasicBlock,e.addSuccessor(c.current),c.pushStatement(this,i,f),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(i);c.current=f;e.addSuccessor(f);c.noContinuation=!1;c.walker.options.goChildren=!1};a.WhileStatement=h;h=function(){f.call(this,a.NodeType.DoWhile);this.cond=this.whileAST=this.body=null};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isLoop=function(){return!0};h.prototype.emit=
function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("do");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingStart(this.whileAST);c.writeToOutput("while");c.recordSourceMappingEnd(this.whileAST);c.writeToOutput("(");c.emitJavascript(this.cond,a.TokenID.RParen,!1);c.writeToOutput(")");c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){return a.typeCheckDoWhile(this)};
h.prototype.addToControlFlow=function(c){var e=c.current,i=new a.BasicBlock,f=new a.BasicBlock;e.addSuccessor(i);c.current=i;this.body&&(c.pushStatement(this,i,f),c.walk(this.body,this),c.popStatement());c.noContinuation?c.addUnreachable(this.cond):(e=c.current,e.addSuccessor(i),c.addContent(this.cond),c.current=f,e.addSuccessor(f));c.walker.options.goChildren=!1};a.DoWhileStatement=h;h=function(c){f.call(this,a.NodeType.If);this.cond=c;this.elseBod=null};__extends(h,f);h.prototype.isStatementOrExpression=
function(){return!0};h.prototype.isCompoundStatement=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("if(");c.emitJavascript(this.cond,a.TokenID.IF,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.thenBod,!0,!1);this.elseBod&&(c.writeToOutput(" else"),c.emitJavascriptStatements(this.elseBod,!0,!0));c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,
!1)};h.prototype.typeCheck=function(a){return a.typeCheckIf(this)};h.prototype.addToControlFlow=function(c){this.cond.addToControlFlow(c);var e=new a.BasicBlock,i=c.current;c.pushStatement(this,i,e);var f=!1;c.current=new a.BasicBlock;i.addSuccessor(c.current);c.walk(this.thenBod,this);c.noContinuation||(f=!0,c.current.addSuccessor(e));this.elseBod?(c.current=new a.BasicBlock,c.noContinuation=!1,i.addSuccessor(c.current),c.walk(this.elseBod,this),c.noContinuation?f&&(c.noContinuation=!1):(f=!0,c.current.addSuccessor(e))):
(i.addSuccessor(e),c.noContinuation=!1,f=!0);c.popStatement();0<e.predecessors.length&&(c.noContinuation=!1,f=!0);f&&(c.current=e);c.walker.options.goChildren=!1};a.IfStatement=h;h=function(){f.call(this,a.NodeType.Return);this.returnExpression=null};__extends(h,f);h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);this.returnExpression?(c.writeToOutput("return "),c.emitJavascript(this.returnExpression,a.TokenID.SColon,
!1)):c.writeToOutput("return;");c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.addToControlFlow=function(a){f.prototype.addToControlFlow.call(this,a);a.returnStmt()};h.prototype.typeCheck=function(a){return a.typeCheckReturn(this)};a.ReturnStatement=h;h=function(){d.call(this,a.NodeType.EndCode)};__extends(h,d);a.EndCode=h;h=function(c,e){f.call(this,a.NodeType.ForIn);this.lval=c;this.obj=e;this.lval&&this.lval.nodeType==a.NodeType.VarDecl&&
(this.lval.varFlags|=a.VarFlags.AutoInit)};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isLoop=function(){return!0};h.prototype.isFiltered=function(){if(this.body){var c=null;if(this.body.nodeType==a.NodeType.List){var e=this.body;1==e.members.length&&(c=e.members[0])}else c=this.body;if(null!==c&&(c.nodeType==a.NodeType.Block&&(e=c,null!==e.stmts&&1==e.stmts.members.length&&(c=e.stmts.members[0])),c.nodeType==a.NodeType.If&&(c=c.cond,c.nodeType==a.NodeType.Call&&
(e=c.target,e.nodeType==a.NodeType.Dot&&(e.operand1.nodeType==a.NodeType.Name&&(this.obj.nodeType==a.NodeType.Name&&e.operand1.text==this.obj.text)&&"hasOwnProperty"==e.operand2.text)&&(c=c.args,null!==c&&1==c.members.length&&(c=c.members[0],c.nodeType==a.NodeType.Name&&this.lval.nodeType==a.NodeType.Name&&this.lval.text==c.text))))))return!0}return!1};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("for(");
c.emitJavascript(this.lval,a.TokenID.FOR,!1);c.writeToOutput(" in ");c.emitJavascript(this.obj,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){a.checker.styleSettings.forin&&(this.isFiltered()||a.checker.errorReporter.styleError(this,"no hasOwnProperty filter"));return a.typeCheckForIn(this)};h.prototype.addToControlFlow=function(c){this.lval&&
c.addContent(this.lval);this.obj&&c.addContent(this.obj);var e=c.current,i=new a.BasicBlock,f=new a.BasicBlock;e.addSuccessor(i);c.current=i;this.body&&(c.pushStatement(this,i,f),c.walk(this.body,this),c.popStatement());c.noContinuation||c.current.addSuccessor(i);c.current=f;c.noContinuation=!1;e.addSuccessor(f);c.walker.options.goChildren=!1};a.ForInStatement=h;h=function(c){f.call(this,a.NodeType.For);this.init=c};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isLoop=
function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("for(");this.init&&(this.init.nodeType!=a.NodeType.List?c.emitJavascript(this.init,a.TokenID.FOR,!1):c.emitForVarList(this.init));c.writeToOutput("; ");c.emitJavascript(this.cond,a.TokenID.FOR,!1);c.writeToOutput("; ");c.emitJavascript(this.incr,a.TokenID.FOR,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.setInObjectLiteral(e);
c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){return a.typeCheckFor(this)};h.prototype.addToControlFlow=function(c){this.init&&c.addContent(this.init);var e=c.current,i=new a.BasicBlock,f=new a.BasicBlock;e.addSuccessor(i);c.current=i;var e=null,l=i,b=null;this.incr&&(l=b=new a.BasicBlock);this.cond&&(e=c.current,c.addContent(this.cond),c.current=new a.BasicBlock,e.addSuccessor(c.current));this.body&&(c.pushStatement(this,l,f),c.walk(this.body,
this),c.popStatement());this.incr&&(c.noContinuation?0==b.predecessors.length&&c.addUnreachable(this.incr):(c.current.addSuccessor(b),c.current=b,c.addContent(this.incr)));l=c.current;c.noContinuation||l.addSuccessor(i);e&&(e.addSuccessor(f),c.noContinuation=!1);0<f.predecessors.length&&(c.noContinuation=!1,c.current=f);c.walker.options.goChildren=!1};a.ForStatement=h;h=function(c){f.call(this,a.NodeType.With);this.expr=c;this.withSym=null};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};
h.prototype.isCompoundStatement=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("with (");this.expr&&c.emitJavascript(this.expr,a.TokenID.WITH,!1);c.writeToOutput(")");c.emitJavascriptStatements(this.body,!0,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){return a.typeCheckWith(this)};a.WithStatement=h;h=function(c){f.call(this,a.NodeType.Switch);
this.val=c;this.defaultCase=null};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isCompoundStatement=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);var e=c.setInObjectLiteral(!1);c.writeToOutput("switch(");c.emitJavascript(this.val,a.TokenID.ID,!1);c.writeLineToOutput(") {");c.increaseIndent();for(var i=this.caseList.members.length,f=0;f<i;f++)c.emitJavascript(this.caseList.members[f],
a.TokenID.CASE,!0),c.writeLineToOutput("");c.decreaseIndent();c.emitIndent();c.writeToOutput("}");c.setInObjectLiteral(e);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){var c=this.caseList.members.length;this.val=a.typeCheck(this.val);for(var e=0;e<c;e++)this.caseList.members[e]=a.typeCheck(this.caseList.members[e]);this.defaultCase=a.typeCheck(this.defaultCase);this.type=a.voidType;return this};h.prototype.addToControlFlow=function(c){var e=
c.current;c.addContent(this.val);var i=new a.BasicBlock,f=new a.BasicBlock;e.addSuccessor(i);c.pushSwitch(i);c.current=i;c.pushStatement(this,i,f);c.walk(this.caseList,this);c.popSwitch();c.popStatement();null==this.defaultCase&&e.addSuccessor(f);0<f.predecessors.length?(c.noContinuation=!1,c.current=f):c.noContinuation=!0;c.walker.options.goChildren=!1};a.SwitchStatement=h;h=function(){f.call(this,a.NodeType.Case);this.expr=null};__extends(h,f);h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);this.expr?(c.writeToOutput("case "),c.emitJavascript(this.expr,a.TokenID.ID,!1)):c.writeToOutput("default");c.writeToOutput(":");c.emitJavascriptStatements(this.body,!1,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){this.expr=a.typeCheck(this.expr);a.typeCheck(this.body);this.type=a.voidType;return this};h.prototype.addToControlFlow=function(c){var e=new a.BasicBlock,i=c.currentSwitch[c.currentSwitch.length-
1];if(this.expr){var f=new a.BasicBlock;c.current=f;i.addSuccessor(f);c.addContent(this.expr);f.addSuccessor(e)}else i.addSuccessor(e);c.current=e;this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};a.CaseStatement=h;h=function(c,e){d.call(this,a.NodeType.TypeRef);this.term=c;this.arrayCount=e};__extends(h,d);h.prototype.emit=function(){throw Error("should not emit a type ref");};h.prototype.typeCheck=function(c){var e=c.inTypeRefTypeCheck;c.inTypeRefTypeCheck=!0;
var i=a.getTypeLink(this,c.checker,!0);c.checker.resolveTypeLink(c.scope,i,!1);c.checkForVoidConstructor(i.type,this);this.type=i.type;this.term&&(this.term.type=this.type);c.inTypeRefTypeCheck=e;return this};a.TypeReference=h;h=function(c,e){f.call(this,a.NodeType.TryFinally);this.tryNode=c;this.finallyNode=e};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isCompoundStatement=function(){return!0};h.prototype.emit=function(c){c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,
a.TokenID.TRY,!1);c.emitJavascript(this.finallyNode,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this)};h.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.finallyNode=a.typeCheck(this.finallyNode);this.type=a.voidType;return this};h.prototype.addToControlFlow=function(c){var e=new a.BasicBlock;c.walk(this.tryNode,this);var i=new a.BasicBlock;c.current&&c.current.addSuccessor(i);c.current=i;c.pushStatement(this,null,e);c.walk(this.finallyNode,this);!c.noContinuation&&c.current&&
c.current.addSuccessor(e);0<e.predecessors.length?c.current=e:c.noContinuation=!0;c.popStatement();c.walker.options.goChildren=!1};a.TryFinally=h;h=function(c,e){f.call(this,a.NodeType.TryCatch);this.tryNode=c;this.catchNode=e};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.isCompoundStatement=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.emitJavascript(this.tryNode,a.TokenID.TRY,!1);
c.emitJavascript(this.catchNode,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.addToControlFlow=function(c){var e=c.current,i=new a.BasicBlock;e.addSuccessor(i);c.current=i;i=new a.BasicBlock;c.pushStatement(this,null,i);c.walk(this.tryNode,this);c.noContinuation||c.current&&c.current.addSuccessor(i);c.current=new a.BasicBlock;e.addSuccessor(c.current);c.walk(this.catchNode,this);c.popStatement();c.noContinuation||c.current&&c.current.addSuccessor(i);
c.current=i;c.walker.options.goChildren=!1};h.prototype.typeCheck=function(a){this.tryNode=a.typeCheck(this.tryNode);this.catchNode=a.typeCheck(this.catchNode);this.type=a.voidType;return this};a.TryCatch=h;h=function(c){f.call(this,a.NodeType.Try);this.body=c};__extends(h,f);h.prototype.isStatementOrExpression=function(){return!0};h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("try ");c.emitJavascript(this.body,a.TokenID.TRY,
!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};h.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,this);a.walker.options.goChildren=!1;a.noContinuation=!1};a.Try=h;h=function(c,e){f.call(this,a.NodeType.Catch);this.param=c;this.body=e;this.containedScope=null;this.param&&(this.param.varFlags|=a.VarFlags.AutoInit)};__extends(h,f);h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,
!0);c.recordSourceMappingStart(this);c.writeToOutput(" catch (");c.emitJavascript(this.param,a.TokenID.LParen,!1);c.writeToOutput(")");c.emitJavascript(this.body,a.TokenID.CATCH,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.addToControlFlow=function(c){if(this.param){c.addContent(this.param);var e=new a.BasicBlock;c.current.addSuccessor(e);c.current=e}this.body&&c.walk(this.body,this);c.noContinuation=!1;c.walker.options.goChildren=!1};h.prototype.typeCheck=
function(c){var e=c.scope;c.scope=this.containedScope;this.param=c.typeCheck(this.param);var i=new a.ValueLocation,f=new a.VariableSymbol(this.param.id.text,this.param.minChar,c.checker.locationInfo.unitIndex,i);i.symbol=f;i.typeLink=new a.TypeLink;i.typeLink.type=c.anyType;f=c.thisFnc;i.symbol.container=f&&f.type?f.type.symbol:null;this.param.sym=i.symbol;c.scope.enter(i.symbol.container,this.param,i.symbol,c.checker.errorReporter,!1,!1,!1);this.body=c.typeCheck(this.body);c.checker.inProvisionalTypecheckMode()&&
(c.scope.getTable().secondaryTable.table[i.symbol.name]=void 0);this.type=c.voidType;c.scope=e;return this};a.Catch=h;h=function(c){f.call(this,a.NodeType.Finally);this.body=c};__extends(h,f);h.prototype.emit=function(c){c.emitParensAndCommentsInPlace(this,!0);c.recordSourceMappingStart(this);c.writeToOutput("finally");c.emitJavascript(this.body,a.TokenID.FINALLY,!1);c.recordSourceMappingEnd(this);c.emitParensAndCommentsInPlace(this,!1)};h.prototype.addToControlFlow=function(a){this.body&&a.walk(this.body,
this);a.walker.options.goChildren=!1;a.noContinuation=!1};h.prototype.typeCheck=function(a){this.body=a.typeCheck(this.body);return this};a.Finally=h;h=function(c,e,i){d.call(this,a.NodeType.Comment);this.content=c;this.isBlockComment=e;this.endsLine=i;this.text=null};__extends(h,d);h.prototype.getText=function(){if(null==this.text)if(this.isBlockComment){this.text=this.content.split("\n");for(var a=0;a<this.text.length;a++)this.text[a]=this.text[a].replace(/^\s+|\s+$/g,"")}else this.text=[this.content.replace(/^\s+|\s+$/g,
"")];return this.text};a.Comment=h;h=function(){f.call(this,a.NodeType.Debugger)};__extends(h,f);h.prototype.emit=function(a){a.emitParensAndCommentsInPlace(this,!0);a.recordSourceMappingStart(this);a.writeLineToOutput("debugger;");a.recordSourceMappingEnd(this);a.emitParensAndCommentsInPlace(this,!1)};a.DebuggerStatement=h})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.goNextSibling=this.goChildren=!0;this.reverseSiblings=!1};d.prototype.stopWalk=function(a){"undefined"===typeof a&&(a=!0);this.goChildren=!a;this.goNextSibling=!a};a.AstWalkOptions=d;var h=function(a,e,f,l,b){this.childrenWalkers=a;this.pre=e;this.post=f;this.options=l;this.state=b};h.prototype.walk=function(a,e){var f=this.pre(a,e,this);void 0===f&&(f=a);if(this.options.goChildren){var l=this.options.goNextSibling;this.options.goNextSibling=!0;this.childrenWalkers[a.nodeType](a,
e,this);this.options.goNextSibling=l}else this.options.goChildren=!0;return this.post?(l=this.post(f,e,this),void 0===l&&(l=f),l):f};var b=function(){this.childrenWalkers=[];this.initChildrenWalkers()};b.prototype.walk=function(a,e,f,l,b){return this.getWalker(e,f,l,b).walk(a,null)};b.prototype.getWalker=function(a,e,f,l){return this.getSlowWalker(a,e,f,l)};b.prototype.getSlowWalker=function(a,e,f,l){f||(f=new d);return new h(this.childrenWalkers,a,e,f,l)};b.prototype.initChildrenWalkers=function(){this.childrenWalkers[a.NodeType.None]=
g.walkNone;this.childrenWalkers[a.NodeType.Empty]=g.walkNone;this.childrenWalkers[a.NodeType.EmptyExpr]=g.walkNone;this.childrenWalkers[a.NodeType.True]=g.walkNone;this.childrenWalkers[a.NodeType.False]=g.walkNone;this.childrenWalkers[a.NodeType.This]=g.walkNone;this.childrenWalkers[a.NodeType.Super]=g.walkNone;this.childrenWalkers[a.NodeType.QString]=g.walkNone;this.childrenWalkers[a.NodeType.Regex]=g.walkNone;this.childrenWalkers[a.NodeType.Null]=g.walkNone;this.childrenWalkers[a.NodeType.ArrayLit]=
g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.ObjectLit]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Void]=g.walkNone;this.childrenWalkers[a.NodeType.Comma]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Pos]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Neg]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Delete]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.Await]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.In]=
g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Dot]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.From]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Is]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.InstOf]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Typeof]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.NumberLit]=g.walkNone;this.childrenWalkers[a.NodeType.Name]=g.walkNone;this.childrenWalkers[a.NodeType.TypeRef]=
g.walkTypeReferenceChildren;this.childrenWalkers[a.NodeType.Index]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Call]=g.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.New]=g.walkCallExpressionChildren;this.childrenWalkers[a.NodeType.Asg]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAdd]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgSub]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgDiv]=g.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.AsgMul]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgMod]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgAnd]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgXor]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgOr]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgLsh]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRsh]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.AsgRs2]=
g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.QMark]=g.walkTrinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogOr]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.LogAnd]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Or]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Xor]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.And]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eq]=g.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Ne]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Eqv]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.NEqv]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lt]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Le]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Gt]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Ge]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Add]=
g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Sub]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mul]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Div]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Mod]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Lsh]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rsh]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.Rs2]=g.walkBinaryExpressionChildren;
this.childrenWalkers[a.NodeType.Not]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.LogNot]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPre]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPre]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.IncPost]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.DecPost]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.TypeAssertion]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.FuncDecl]=
g.walkFuncDeclChildren;this.childrenWalkers[a.NodeType.Member]=g.walkBinaryExpressionChildren;this.childrenWalkers[a.NodeType.VarDecl]=g.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.ArgDecl]=g.walkBoundDeclChildren;this.childrenWalkers[a.NodeType.Return]=g.walkReturnStatementChildren;this.childrenWalkers[a.NodeType.Break]=g.walkNone;this.childrenWalkers[a.NodeType.Continue]=g.walkNone;this.childrenWalkers[a.NodeType.Throw]=g.walkUnaryExpressionChildren;this.childrenWalkers[a.NodeType.For]=
g.walkForStatementChildren;this.childrenWalkers[a.NodeType.ForIn]=g.walkForInStatementChildren;this.childrenWalkers[a.NodeType.If]=g.walkIfStatementChildren;this.childrenWalkers[a.NodeType.While]=g.walkWhileStatementChildren;this.childrenWalkers[a.NodeType.DoWhile]=g.walkDoWhileStatementChildren;this.childrenWalkers[a.NodeType.Block]=g.walkBlockChildren;this.childrenWalkers[a.NodeType.Case]=g.walkCaseStatementChildren;this.childrenWalkers[a.NodeType.Switch]=g.walkSwitchStatementChildren;this.childrenWalkers[a.NodeType.Try]=
g.walkTryChildren;this.childrenWalkers[a.NodeType.TryCatch]=g.walkTryCatchChildren;this.childrenWalkers[a.NodeType.TryFinally]=g.walkTryFinallyChildren;this.childrenWalkers[a.NodeType.Finally]=g.walkFinallyChildren;this.childrenWalkers[a.NodeType.Catch]=g.walkCatchChildren;this.childrenWalkers[a.NodeType.List]=g.walkListChildren;this.childrenWalkers[a.NodeType.Script]=g.walkScriptChildren;this.childrenWalkers[a.NodeType.Class]=g.walkClassDeclChildren;this.childrenWalkers[a.NodeType.Interface]=g.walkTypeDeclChildren;
this.childrenWalkers[a.NodeType.Module]=g.walkModuleDeclChildren;this.childrenWalkers[a.NodeType.Import]=g.walkImportDeclChildren;this.childrenWalkers[a.NodeType.With]=g.walkWithStatementChildren;this.childrenWalkers[a.NodeType.Label]=g.walkLabelChildren;this.childrenWalkers[a.NodeType.LabeledStatement]=g.walkLabeledStatementChildren;this.childrenWalkers[a.NodeType.EBStart]=g.walkNone;this.childrenWalkers[a.NodeType.GotoEB]=g.walkNone;this.childrenWalkers[a.NodeType.EndCode]=g.walkNone;this.childrenWalkers[a.NodeType.Error]=
g.walkNone;this.childrenWalkers[a.NodeType.Comment]=g.walkNone;this.childrenWalkers[a.NodeType.Debugger]=g.walkNone;for(var c in a.NodeType._map)if(void 0===this.childrenWalkers[c])throw Error("initWalkers function is not up to date with enum content!");};a.AstWalkerFactory=b;var k;a.getAstWalkerFactory=function(){k||(k=new b);return k};var g,e=g||(g={}),l=function(a,e,f){a.name=f.walk(a.name,a);f.options.goNextSibling&&a.members&&(a.members=f.walk(a.members,a))};e.walkNone=function(){};e.walkListChildren=
function(a,e,f){e=a.members.length;if(f.options.reverseSiblings)for(var l=e-1;0<=l;l--)f.options.goNextSibling&&(a.members[l]=f.walk(a.members[l],a));else for(l=0;l<e;l++)f.options.goNextSibling&&(a.members[l]=f.walk(a.members[l],a))};e.walkUnaryExpressionChildren=function(a,e,f){a.castTerm&&(a.castTerm=f.walk(a.castTerm,a));a.operand&&(a.operand=f.walk(a.operand,a))};e.walkBinaryExpressionChildren=function(a,e,f){f.options.reverseSiblings?(a.operand2&&(a.operand2=f.walk(a.operand2,a)),a.operand1&&
f.options.goNextSibling&&(a.operand1=f.walk(a.operand1,a))):(a.operand1&&(a.operand1=f.walk(a.operand1,a)),a.operand2&&f.options.goNextSibling&&(a.operand2=f.walk(a.operand2,a)))};e.walkTypeReferenceChildren=function(a,e,f){a.term&&(a.term=f.walk(a.term,a))};e.walkCallExpressionChildren=function(a,e,f){f.options.reverseSiblings||(a.target=f.walk(a.target,a));a.args&&f.options.goNextSibling&&(a.args=f.walk(a.args,a));f.options.reverseSiblings&&f.options.goNextSibling&&(a.target=f.walk(a.target,a))};
e.walkTrinaryExpressionChildren=function(a,e,f){a.operand1&&(a.operand1=f.walk(a.operand1,a));a.operand2&&f.options.goNextSibling&&(a.operand2=f.walk(a.operand2,a));a.operand3&&f.options.goNextSibling&&(a.operand3=f.walk(a.operand3,a))};e.walkFuncDeclChildren=function(a,e,f){a.name&&(a.name=f.walk(a.name,a));a.args&&(0<a.args.members.length&&f.options.goNextSibling)&&(a.args=f.walk(a.args,a));a.returnTypeAnnotation&&f.options.goNextSibling&&(a.returnTypeAnnotation=f.walk(a.returnTypeAnnotation,a));
a.bod&&(0<a.bod.members.length&&f.options.goNextSibling)&&(a.bod=f.walk(a.bod,a))};e.walkBoundDeclChildren=function(a,e,f){a.id&&(a.id=f.walk(a.id,a));a.init&&(a.init=f.walk(a.init,a));a.typeExpr&&f.options.goNextSibling&&(a.typeExpr=f.walk(a.typeExpr,a))};e.walkReturnStatementChildren=function(a,e,f){a.returnExpression&&(a.returnExpression=f.walk(a.returnExpression,a))};e.walkForStatementChildren=function(a,e,f){a.init&&(a.init=f.walk(a.init,a));a.cond&&f.options.goNextSibling&&(a.cond=f.walk(a.cond,
a));a.incr&&f.options.goNextSibling&&(a.incr=f.walk(a.incr,a));a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkForInStatementChildren=function(a,e,f){a.lval=f.walk(a.lval,a);f.options.goNextSibling&&(a.obj=f.walk(a.obj,a));a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkIfStatementChildren=function(a,e,f){a.cond=f.walk(a.cond,a);a.thenBod&&f.options.goNextSibling&&(a.thenBod=f.walk(a.thenBod,a));a.elseBod&&f.options.goNextSibling&&(a.elseBod=f.walk(a.elseBod,a))};
e.walkWhileStatementChildren=function(a,e,f){a.cond=f.walk(a.cond,a);a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkDoWhileStatementChildren=function(a,e,f){a.cond=f.walk(a.cond,a);a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkBlockChildren=function(a,e,f){a.stmts&&(a.stmts=f.walk(a.stmts,a))};e.walkCaseStatementChildren=function(a,e,f){a.expr&&(a.expr=f.walk(a.expr,a));a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkSwitchStatementChildren=
function(a,e,f){a.val&&(a.val=f.walk(a.val,a));a.caseList&&f.options.goNextSibling&&(a.caseList=f.walk(a.caseList,a))};e.walkTryChildren=function(a,e,f){a.body&&(a.body=f.walk(a.body,a))};e.walkTryCatchChildren=function(a,e,f){a.tryNode&&(a.tryNode=f.walk(a.tryNode,a));a.catchNode&&f.options.goNextSibling&&(a.catchNode=f.walk(a.catchNode,a))};e.walkTryFinallyChildren=function(a,e,f){a.tryNode&&(a.tryNode=f.walk(a.tryNode,a));a.finallyNode&&f.options.goNextSibling&&(a.finallyNode=f.walk(a.finallyNode,
a))};e.walkFinallyChildren=function(a,e,f){a.body&&(a.body=f.walk(a.body,a))};e.walkCatchChildren=function(a,e,f){a.param&&(a.param=f.walk(a.param,a));a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkRecordChildren=l;e.walkNamedTypeChildren=function(a,e,f){l(a,e,f)};e.walkClassDeclChildren=function(a,e,f){l(a,e,f);f.options.goNextSibling&&a.baseClass&&(a.baseClass=f.walk(a.baseClass,a));f.options.goNextSibling&&a.implementsList&&(a.implementsList=f.walk(a.implementsList,a))};e.walkScriptChildren=
function(a,e,f){a.bod&&(a.bod=f.walk(a.bod,a))};e.walkTypeDeclChildren=function(a,e,f){l(a,e,f);f.options.goNextSibling&&a.extendsList&&(a.extendsList=f.walk(a.extendsList,a));f.options.goNextSibling&&a.implementsList&&(a.implementsList=f.walk(a.implementsList,a))};e.walkModuleDeclChildren=function(a,e,f){l(a,e,f);f.options.goNextSibling&&a.alias&&(a.alias=f.walk(a.alias,a))};e.walkImportDeclChildren=function(a,e,f){a.id&&(a.id=f.walk(a.id,a));a.alias&&(a.alias=f.walk(a.alias,a))};e.walkWithStatementChildren=
function(a,e,f){a.expr&&(a.expr=f.walk(a.expr,a));a.body&&f.options.goNextSibling&&(a.body=f.walk(a.body,a))};e.walkLabelChildren=function(){};e.walkLabeledStatementChildren=function(a,e,f){a.labels=f.walk(a.labels,a);f.options.goNextSibling&&(a.stmt=f.walk(a.stmt,a))}})(TypeScript||(TypeScript={}));
(function(a){function d(a){return null===a||0===a.length?null:a[a.length-1]}function h(a,e){return a>=e?a:e}function b(a){return null===a||-1===a.minChar||-1===a.limChar?!1:!0}a.lastOf=d;a.max=h;a.min=function(a,e){return a<=e?a:e};var k=function(){this.asts=[];this.top=-1};k.reverseIndexOf=function(a,e){return null===a||a.length<=e?null:a[a.length-e-1]};k.prototype.clone=function(){var a=new k;a.asts=this.asts.map(function(a){return a});a.top=this.top;return a};k.prototype.pop=function(){var a=this.ast();
for(this.up();this.asts.length>this.count();)this.asts.pop();return a};k.prototype.push=function(a){for(;this.asts.length>this.count();)this.asts.pop();this.top=this.asts.length;this.asts.push(a)};k.prototype.up=function(){if(-1>=this.top)throw Error("Invalid call to 'up'");this.top--};k.prototype.down=function(){if(this.top==this.ast.length-1)throw Error("Invalid call to 'down'");this.top++};k.prototype.nodeType=function(){return null==this.ast()?a.NodeType.None:this.ast().nodeType};k.prototype.ast=
function(){return k.reverseIndexOf(this.asts,this.asts.length-(this.top+1))};k.prototype.parent=function(){return k.reverseIndexOf(this.asts,this.asts.length-this.top)};k.prototype.count=function(){return this.top+1};k.prototype.get=function(a){return this.asts[a]};k.prototype.isNameOfClass=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Class&&this.parent().name===this.ast()};k.prototype.isNameOfInterface=function(){return null===
this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Interface&&this.parent().name===this.ast()};k.prototype.isNameOfArgument=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.ArgDecl&&this.parent().id===this.ast()};k.prototype.isNameOfVariable=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===
a.NodeType.VarDecl&&this.parent().id===this.ast()};k.prototype.isNameOfModule=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.Module&&this.parent().name===this.ast()};k.prototype.isNameOfFunction=function(){return null===this.ast()||null===this.parent()?!1:this.ast().nodeType===a.NodeType.Name&&this.parent().nodeType===a.NodeType.FuncDecl&&this.parent().name===this.ast()};k.prototype.isChildOfScript=function(){var c=
d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Script};k.prototype.isChildOfModule=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Module};k.prototype.isChildOfClass=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Class};k.prototype.isArgumentOfClassConstructor=function(){var c=d(this.asts);return 5<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-3].nodeType===a.NodeType.List&&this.asts[this.top-4].nodeType===a.NodeType.Class&&this.asts[this.top-2].isConstructor&&this.asts[this.top-2].args===this.asts[this.top-1]&&this.asts[this.top-
4].constructorDecl===this.asts[this.top-2]};k.prototype.isChildOfInterface=function(){var c=d(this.asts);return 3<=this.count()&&this.asts[this.top]===c&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].nodeType===a.NodeType.Interface};k.prototype.isTopLevelImplicitModule=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.Module&&a.hasFlag(this.asts[this.top].modFlags,a.ModuleFlags.IsWholeFile)};k.prototype.isBodyOfTopLevelImplicitModule=function(){return 2<=
this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]&&a.hasFlag(this.asts[this.top-1].modFlags,a.ModuleFlags.IsWholeFile)};k.prototype.isBodyOfScript=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Script&&this.asts[this.top-1].bod==this.asts[this.top-0]};k.prototype.isBodyOfSwitch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Switch&&
this.asts[this.top-1].caseList==this.asts[this.top-0]};k.prototype.isBodyOfModule=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Module&&this.asts[this.top-1].members==this.asts[this.top-0]};k.prototype.isBodyOfClass=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Class&&this.asts[this.top-1].members==this.asts[this.top-0]};k.prototype.isBodyOfFunction=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&
this.asts[this.top-1].bod==this.asts[this.top-0]};k.prototype.isBodyOfInterface=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Interface&&this.asts[this.top-1].members==this.asts[this.top-0]};k.prototype.isBodyOfBlock=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Block&&this.asts[this.top-1].stmts==this.asts[this.top-0]};k.prototype.isBodyOfFor=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.For&&this.asts[this.top-
1].body==this.asts[this.top-0]};k.prototype.isBodyOfCase=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Case&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfTry=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Try&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfCatch=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Catch&&this.asts[this.top-1].body==this.asts[this.top-
0]};k.prototype.isBodyOfDoWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.DoWhile&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfWhile=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.While&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfForIn=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ForIn&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfWith=
function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.With&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isBodyOfFinally=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Finally&&this.asts[this.top-1].body==this.asts[this.top-0]};k.prototype.isCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-
1]};k.prototype.isDefaultCaseOfSwitch=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.Switch&&this.asts[this.top-1].nodeType===a.NodeType.List&&this.asts[this.top-2].caseList==this.asts[this.top-1]&&this.asts[this.top-2].defaultCase==this.asts[this.top-0]};k.prototype.isListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-
0]};k.prototype.isBodyOfObjectLit=function(){return this.isListOfObjectLit()};k.prototype.isEmptyListOfObjectLit=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]&&0==this.asts[this.top-0].members.length};k.prototype.isMemberOfObjectLit=function(){return 3<=this.count()&&this.asts[this.top-2].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-1].nodeType===
a.NodeType.List&&this.asts[this.top-0].nodeType===a.NodeType.Member&&this.asts[this.top-2].operand==this.asts[this.top-1]};k.prototype.isNameOfMemberOfObjectLit=function(){return 4<=this.count()&&this.asts[this.top-3].nodeType===a.NodeType.ObjectLit&&this.asts[this.top-2].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-0].nodeType===a.NodeType.Name&&this.asts[this.top-3].operand==this.asts[this.top-2]};k.prototype.isListOfArrayLit=function(){return 2<=
this.count()&&this.asts[this.top-1].nodeType===a.NodeType.ArrayLit&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].operand==this.asts[this.top-0]};k.prototype.isTargetOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand1===this.asts[this.top-0]};k.prototype.isMemberOfMember=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.Member&&this.asts[this.top-1].operand2===this.asts[this.top-
0]};k.prototype.isItemOfList=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List};k.prototype.isThenOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].thenBod==this.asts[this.top-0]};k.prototype.isElseOfIf=function(){return 2<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.If&&this.asts[this.top-1].elseBod==this.asts[this.top-0]};k.prototype.isBodyOfDefaultCase=function(){return this.isBodyOfCase()};
k.prototype.isSingleStatementList=function(){return 1<=this.count()&&this.asts[this.top].nodeType===a.NodeType.List&&1===this.asts[this.top].members.length};k.prototype.isArgumentListOfFunction=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-1].args===this.asts[this.top-0]};k.prototype.isArgumentOfFunction=function(){return 3<=this.count()&&this.asts[this.top-1].nodeType===a.NodeType.List&&
this.asts[this.top-2].nodeType===a.NodeType.FuncDecl&&this.asts[this.top-2].args===this.asts[this.top-1]};k.prototype.isArgumentListOfCall=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.Call&&this.asts[this.top-1].args===this.asts[this.top-0]};k.prototype.isArgumentListOfNew=function(){return 2<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.List&&this.asts[this.top-1].nodeType===a.NodeType.New&&this.asts[this.top-
1].args===this.asts[this.top-0]};k.prototype.isSynthesizedBlock=function(){return 1<=this.count()&&this.asts[this.top-0].nodeType===a.NodeType.Block&&!1===this.asts[this.top-0].visible};a.AstPath=k;a.isValidAstNode=b;var g;g=function(){this.path=new a.AstPath};a.AstPathContext=g;var e=a.GetAstPathOptions||(a.GetAstPathOptions={});e._map=[];e.Default=0;e.EdgeInclusive=1;e.DontPruneSearchBasedOnPosition=2;var l=a.GetAstPathOptions;a.getAstPathToPosition=function(c,e,f){"undefined"===typeof f&&(f=l.Default);
var j=function(a){if(a&&0<a.length)for(var c=0;c<a.length;c++){var f=a[c].minChar,l=a[c].limChar;a[c].isBlockComment||l++;e>=f&&e<l&&k.path.push(a[c])}},k=new g;a.getAstWalkerFactory().walk(c,function(m,g,d){if(b(m)){var h=a.hasFlag(f,l.EdgeInclusive)||m.nodeType===a.NodeType.Name||e===c.limChar,g=m.minChar,h=m.limChar+(h?1:0);if(e>=g&&e<h){var q=k.path.ast();(null==q||m.minChar>=q.minChar&&m.limChar<=q.limChar)&&k.path.push(m)}e<h&&j(m.preComments);e>=g&&j(m.postComments);a.hasFlag(f,l.DontPruneSearchBasedOnPosition)||
(d.options.goChildren=g<=e&&e<=h)}return m},null,null,k);return k.path};a.getTokenizationOffset=function(c,e){var f=0;a.getAstWalkerFactory().walk(c,function(c,l,b){if(a.isValidAstNode(c)&&(c.minChar<=e&&(f=h(f,c.minChar)),c.minChar>e||c.limChar<f))b.options.goChildren=!1;return c});return f};a.walkAST=function(c,e){var f=new k;a.getAstWalkerFactory().walk(c,function(a,c,f){c=f.state;c.push(a);e(c,f);return a},function(a,c,e){e.state.pop();return a},null,f)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.logger=a};d.prototype.logScript=function(d){var b=this;this.logLinemap(d.locationInfo.lineMap);var k=[];a.getAstWalkerFactory().walk(d,function(a){k.push(a);var e=2*(k.length-1);b.logComments(d,a.preComments,e);b.logNode(d,a,e);b.logComments(d,a.postComments,e);return a},function(a){k.pop();return a})};d.prototype.logNode=function(a,b,k){k=this.addPadding("",k,"| ",!0);k=k.concat("+ "+b.treeViewLabel());k=this.addPadding(k,70," ",!1);k+=this.addLineColumn(a,b.minChar);
k=this.addPadding(k,80," ",!1);k=k+"=> "+this.addLineColumn(a,b.limChar);k=this.addPadding(k,102," ",!1);k=k.concat("["+this.addPadding(b.minChar.toString(),1," ",!0)+", "+this.addPadding(b.limChar.toString(),1," ",!0)+"]");k=this.addPadding(k,115," ",!1);k=k.concat("sym="+b.sym);k=this.addPadding(k,135," ",!1);k=k.concat("type="+(null===b.type?"null":b.type.getTypeName()));this.logger.log(k)};d.prototype.logComments=function(a,b,k){if(null!=b)for(var g=0;g<b.length;g++)this.logNode(a,b[g],k)};d.prototype.logLinemap=
function(a){for(var b="[",k=0;k<a.length;k++)0<k&&(b+=","),b+=a[k];this.logger.log("linemap: "+(b+"]"))};d.prototype.addPadding=function(a,b,k,g){for(var e=g?"":a,l=a.length;l<b;l++)e+=k;return e+(g?a:"")};d.prototype.addLineColumn=function(d,b){var k={line:-1,col:-1};a.getSourceLineColFromMap(k,b,d.locationInfo.lineMap);-1!==k.col&&k.col++;return"("+k.line+", "+k.col+")"};a.AstLogger=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.checker=a};d.prototype.resolveBaseTypeLinks=function(a,b){var k=null;if(a)for(var k=[],g=0,e=a.length;g<e;g++){var l=a[g];this.checker.resolvingBases=!0;this.checker.resolveTypeLink(b,l,!0);this.checker.resolvingBases=!1;k[g]=l.type.isClass()?l.type.instanceType:l.type}return k};d.prototype.resolveBases=function(a,b){b.extendsList=this.resolveBaseTypeLinks(b.extendsTypeLinks,a);for(var k=0,g=b.extendsList.length,e=b.isClassInstance();k<g;k++){var l=b.extendsList[k].isClassInstance();
b.extendsList[k]!=this.checker.anyType&&(e?l||this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A export class may only extend other classes, "+b.extendsList[k].symbol.fullName()+" is an interface."):l&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"An interface may only extend other interfaces, "+b.extendsList[k].symbol.fullName()+" is a class."))}b.implementsList=this.resolveBaseTypeLinks(b.implementsTypeLinks,a);if(b.implementsList){k=0;for(g=b.implementsList.length;k<g;k++)l=b.implementsList[k],
l.isClassInstance()&&e&&this.checker.errorReporter.simpleErrorFromSym(b.symbol,"A class may only implement an interface; "+l.symbol.fullName()+" is a class.")}};d.prototype.resolveSignatureGroup=function(a,b,k){for(var g=!a.hasImplementation,e=0,l=a.signatures.length;e<l;e++){var c=a.signatures[e];k?c.returnType.type=k:this.checker.resolveTypeLink(b,c.returnType,g);for(var i=c.parameters.length,f=0;f<i;f++)this.bindSymbol(b,c.parameters[f]);c.hasVariableArgList&&(c=c.parameters[i-1],c.argsOffset=
i-1,c.getType().isArray()||(this.checker.errorReporter.simpleErrorFromSym(c,"... parameter must have array type"),c.parameter.typeLink.type=this.checker.makeArrayType(c.parameter.typeLink.type)))}};d.prototype.bindType=function(d,b,k){k&&this.bindType(d,k,null);if(b.hasMembers()){var g=b.members,e=b.ambientMembers,l=b.getAllEnclosedTypes(),c=b.getAllAmbientEnclosedTypes(),i=new a.SymbolTableScope(g,e,l,c,b.symbol),f=new a.SymbolAggregateScope(b.symbol),j=this.checker.currentModDecl,v=this.checker.inBind;
f.addParentScope(i);f.addParentScope(d);b.isModuleType()&&(this.checker.currentModDecl=b.symbol.declAST,this.checker.inBind=!0);g&&this.bind(f,b.members.allMembers);l&&this.bind(f,l.allMembers);e&&this.bind(f,e.allMembers);c&&this.bind(f,c.allMembers);this.checker.currentModDecl=j;this.checker.inBind=v}b.extendsTypeLinks&&this.resolveBases(d,b);b.construct&&this.resolveSignatureGroup(b.construct,d,k);b.call&&this.resolveSignatureGroup(b.call,d,null);b.index&&this.resolveSignatureGroup(b.index,d,null);
b.elementType&&this.bindType(d,b.elementType,null)};d.prototype.bindSymbol=function(d,b){if(!b.bound){var k=this.checker.locationInfo;this.checker.units&&(0<=b.unitIndex&&b.unitIndex<this.checker.units.length)&&(this.checker.locationInfo=this.checker.units[b.unitIndex]);switch(b.kind()){case a.SymbolKind.Type:if(b.flags&a.SymbolFlags.Bound)break;b.flags|=a.SymbolFlags.Bound;if(b.aliasLink&&!b.type&&b.aliasLink.alias.nodeType==a.NodeType.Name){var g=this.checker.findSymbolForDynamicModule(b.aliasLink.alias.text,
this.checker.locationInfo.filename,function(a){return d.find(a,!1,!0)});g&&(b.type=g.getType())}if(b.type&&b.type!=this.checker.gloModType&&(this.bindType(d,b.type,b.instanceType),b.type.isModuleType()))for(g=0;g<b.expansions.length;g++)this.bindType(d,b.expansions[g],b.instanceType);break;case a.SymbolKind.Field:this.checker.resolveTypeLink(d,b.field.typeLink,!1);break;case a.SymbolKind.Parameter:this.checker.resolveTypeLink(d,b.parameter.typeLink,!0)}this.checker.locationInfo=k}b.bound=!0};d.prototype.bind=
function(a,b){b.map(function(b,g,e){e.bindSymbol(a,g)},this)};a.Binder=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(){};d.encodedValues="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";d.encode=function(a){if(64>a)return d.encodedValues.charAt(a);throw TypeError(a+": not a 64 based value");};d.decodeChar=function(a){if(1===a.length)return d.encodedValues.indexOf(a);throw TypeError('"'+a+'" must have length 1');};var h=function(){};h.encode=function(a){var a=0>a?(-a<<1)+1:a<<1,k="";do{var g=a&31,a=a>>5;0<a&&(g|=32);k+=d.encode(g)}while(0<a);return k};h.decode=function(a){for(var k=
0,g=!1,e=0,l=0;l<a.length;l++){var c=d.decodeChar(a[l]);0===l?(1===(c&1)&&(g=!0),k=c>>1&15):k|=(c&31)<<e;e+=0==l?4:5;if(32!==(c&32))return{value:g?-k:k,rest:a.substr(l+1)}}throw Error('Base64 value "'+a+'" finished with a continuation bit');};a.Base64VLQFormat=h})(TypeScript||(TypeScript={}));
(function(a){a.SourceMapping=function(){this.firstChild=this.parent=-1};var d=function(d,b,k,g){this.jsFile=k;this.sourceMapOut=g;this.sourceMappings=[];this.currentMapping=-1;this.jsFileName=a.getPrettyName(b,!1,!0);this.tsFileName=a.getPrettyName(d,!1,!0)};d.MapFileExtension=".map";d.CanEmitMapping=function(a,b){if(-1!==b.firstChild){var k=a[b.firstChild];if(k.emittedStartLine===b.emittedStartLine&&k.emittedStartColumn===b.emittedStartColumn)return!1}return!0};d.EmitSourceMapping=function(h){var b=
h[0];b.jsFile.WriteLine("//@ sourceMappingURL="+b.jsFileName+d.MapFileExtension);for(var k=b.sourceMapOut,g="",e=[],l=0,c=0,i=0,f=0,j=0,v=!1,m=0;m<h.length;m++)if(b=h[m],b.sourceMappings){var p=e.length;e.push(b.tsFileName);for(var u=b.sourceMappings,n=0,q=u.length;n<q;n++){var r=u[n];if(d.CanEmitMapping(u,r)){if(c!==r.emittedStartLine)for(;c<r.emittedStartLine;)l=0,g+=";",c++;else v&&(g+=",");g+=a.Base64VLQFormat.encode(r.emittedStartColumn-l);l=r.emittedStartColumn;g+=a.Base64VLQFormat.encode(p-
j);j=p;g+=a.Base64VLQFormat.encode(r.sourceStartLine-1-f);f=r.sourceStartLine-1;g+=a.Base64VLQFormat.encode(r.sourceStartColumn-i);i=r.sourceStartColumn;v=!0}}}""!=g&&(k.Write("{"),k.Write('"version":3,'),k.Write('"file":"'+b.jsFileName+'",'),k.Write('"sources":["'+e.join('","')+'"],'),k.Write('"names":[],'),k.Write('"mappings":"'+g),k.Write('"'),k.Write("}"));k.Close()};a.SourceMapper=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.EmitContainer||(a.EmitContainer={});d._map=[];d._map[0]="Prog";d.Prog=0;d._map[1]="Module";d.Module=1;d._map[2]="DynamicModule";d.DynamicModule=2;d._map[3]="Class";d.Class=3;d._map[4]="Constructor";d.Constructor=4;d._map[5]="Function";d.Function=5;d._map[6]="Args";d.Args=6;d._map[7]="Interface";d.Interface=7;var h=a.EmitContainer,b;b=function(){this.line=this.column=this.indentAmt=0;this.inObjectLiteral=this.pretty=!1;this.container=h.Prog};a.EmitState=b;d=function(a,g,e){this.checker=
a;this.outfile=g;this.emitOptions=e;this.prologueEmitted=!1;this.indentStep=4;this.thisFnc=this.thisClassNode=null;this.moduleDeclList=[];this.moduleName="";this.emitState=new b;this.indentStrings=[];this.ambientModule=!1;this.firstModAlias=this.modAliasId=null;this.allSourceMappers=[];this.sourceMapper=null;this.declDottedModuleName=!1;this.declIndentDelta=0;this.declContainingAST=this.declFile=null};d.prototype.canWriteDeclFile=function(){return null!=this.declFile};d.prototype.setSourceMappings=
function(a){this.allSourceMappers.push(a);this.sourceMapper=a};d.prototype.setDeclarationFile=function(a){this.declFile=a};d.prototype.increaseIndent=function(){this.emitState.indentAmt+=this.indentStep;this.declDottedModuleName&&this.addDeclIndentDelta()};d.prototype.decreaseIndent=function(){this.emitState.indentAmt-=this.indentStep};d.prototype.addDeclIndentDelta=function(){this.declIndentDelta+=this.indentStep};d.prototype.reduceDeclIndentDelta=function(){this.declIndentDelta-=this.indentStep};
d.prototype.writeToOutput=function(a){this.outfile.Write(a);this.emitState.column+=a.length};d.prototype.writeToOutputTrimmable=function(a){this.emitOptions.minWhitespace&&(a=a.replace(/[\s]*/g,""));this.writeToOutput(a)};d.prototype.writeLineToOutput=function(b){this.emitOptions.minWhitespace?(this.writeToOutput(b),b=b.charCodeAt(b.length-1),b==a.LexCodeSpace||(b==a.LexCodeSMC||b==a.LexCodeLBR)||this.writeToOutput(" ")):(this.outfile.WriteLine(b),this.emitState.column=0,this.emitState.line++)};d.prototype.setInObjectLiteral=
function(a){var b=this.emitState.inObjectLiteral;this.emitState.inObjectLiteral=a;return b};d.prototype.setContainer=function(a){var b=this.emitState.container;this.emitState.container=a;return b};d.prototype.setDeclContainingAST=function(a){var b=this.declContainingAST;this.declContainingAST=a;return b};d.prototype.getIndentString=function(a){"undefined"===typeof a&&(a=!1);if(this.emitOptions.minWhitespace)return"";var a=this.emitState.indentAmt-(a?this.declIndentDelta:0),b=this.indentStrings[a];
if(void 0===b){for(var b="",e=0;e<a;e++)b+=" ";this.indentStrings[a]=b}return b};d.prototype.emitIndent=function(){this.writeToOutput(this.getIndentString())};d.prototype.emitIndentToDeclFile=function(){this.declFile.Write(this.getIndentString(!0))};d.prototype.emitCommentInPlace=function(a){this.recordSourceMappingStart(a);var b=a.getText(),e=!1;if(a.isBlockComment){if(0==this.emitState.column&&this.emitIndent(),this.writeToOutput(b[0]),1<b.length||a.endsLine){this.writeLineToOutput("");for(e=1;e<
b.length;e++)this.emitIndent(),this.writeLineToOutput(b[e]);e=!0}}else 0==this.emitState.column&&this.emitIndent(),this.writeLineToOutput(b[0]),e=!0;e?this.emitIndent():this.writeToOutput(" ");this.recordSourceMappingEnd(a)};d.prototype.emitParensAndCommentsInPlace=function(a,b){var e=b?a.preComments:a.postComments;a.isParenthesized&&!b&&this.writeToOutput(")");if(this.emitOptions.emitComments&&e&&0!=e.length)for(var l=0;l<e.length;l++)this.emitCommentInPlace(e[l]);a.isParenthesized&&b&&this.writeToOutput("(")};
d.prototype.emitObjectLiteral=function(b){this.writeLineToOutput("{");this.increaseIndent();var g=this.setInObjectLiteral(!0);this.emitJavascriptList(b,",",a.TokenID.Comma,!0,!1,!1);this.setInObjectLiteral(g);this.decreaseIndent();this.emitIndent();this.writeToOutput("}")};d.prototype.emitArrayLiteral=function(b){this.writeToOutput("[");b&&(this.writeLineToOutput(""),this.increaseIndent(),this.emitJavascriptList(b,", ",a.TokenID.Comma,!0,!1,!1),this.decreaseIndent(),this.emitIndent());this.writeToOutput("]")};
d.prototype.emitNew=function(b,g){this.recordSourceMappingStart(b);this.writeToOutput("new ");b.nodeType==a.NodeType.TypeRef?this.writeToOutput("Array()"):(this.emitJavascript(b,a.TokenID.Tilde,!1),this.writeToOutput("("),this.emitJavascriptList(g,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")"));this.recordSourceMappingEnd(b)};d.prototype.tryEmitConstant=function(b){if(!this.emitOptions.propagateConstants)return!1;if((b=b.operand2)&&b.sym&&b.sym.isVariable()&&a.hasFlag(b.sym.flags,a.SymbolFlags.Constant)&&
b.sym.declAST){var g=b.sym.declAST;if(g.init&&g.init.nodeType==a.NodeType.NumberLit)return this.writeToOutput(g.init.value.toString()),b=" /* "+b.text,this.writeToOutput(b+" */ "),!0}return!1};d.prototype.emitCall=function(b,g,e){this.emitSuperCall(b)||(a.hasFlag(b.flags,a.ASTFlags.ClassBaseConstructorCall)?(this.decreaseIndent(),this.decreaseIndent(),g=new a.ASTList,g.members[0]=b,this.emitConstructorCalls(g,this.thisClassNode),this.increaseIndent(),this.increaseIndent()):(g.nodeType==a.NodeType.FuncDecl&&
!g.isParenthesized&&this.writeToOutput("("),this.emitJavascript(g,a.TokenID.LParen,!1),g.nodeType==a.NodeType.FuncDecl&&!g.isParenthesized&&this.writeToOutput(")"),this.writeToOutput("("),this.emitJavascriptList(e,", ",a.TokenID.Comma,!1,!1,!1),this.writeToOutput(")")))};d.prototype.defaultValue=function(a){return a==this.checker.anyType?"undefined":a==this.checker.numberType?"0":a==this.checker.stringType?'""':a==this.checker.booleanType?"false":"null"};d.prototype.emitConstructorCalls=function(b,
g){if(null!=b){var e=b.members.length;this.recordSourceMappingStart(g);for(var l=0;l<e;l++){var c=b.members[l],i=null,i=c.nodeType==a.NodeType.Call?c.target.type.symbol:c.type.symbol;i.declModule!=g.type.symbol.declModule&&i.fullName();if(c.nodeType==a.NodeType.Call){this.emitIndent();this.writeToOutput("_super.call(this");if((c=c.args)&&0<c.members.length)this.writeToOutput(", "),this.emitJavascriptList(c,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput(")")}else c.type&&c.type.isClassInstance()&&
(this.emitIndent(),this.writeToOutput(g.name.text+"._super.constructor"),this.writeToOutput(".call(this)"))}this.recordSourceMappingEnd(g)}};d.prototype.emitInnerFunction=function(b,g,e,l,c,i,f,j){"undefined"===typeof f&&(f=!1);"undefined"===typeof j&&(j=this.emitState.container);var d=b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&(a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseType)&&!a.hasFlag(this.thisClassNode.type.instanceType.typeFlags,a.TypeFlags.HasBaseTypeOfObject))&&
a.hasFlag(this.thisClassNode.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor);this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);(!b.isAccessor()||!b.accessorSymbol.isObjectLitField)&&this.writeToOutput("function ");g&&(g=b.getNameText())&&!b.isAccessor()&&this.writeToOutput(g);this.writeToOutput("(");f&&(f=this.emitFuncSignatureIdentifier(b,!1,j));var m=0,j=0,p,u=[];if(b.args){g=this.setContainer(h.Args);m=b.args.members.length;b.variableArgList&&m--;for(j=0;j<m;j++)p=
b.args.members[j],p.init&&u.push(p),this.emitJavascript(p,a.TokenID.LParen,!1,f),j<m-1&&(this.writeToOutput(", "),f&&this.declFile.Write(", "));this.setContainer(g)}this.writeLineToOutput(") {");g=null;f&&(this.emitFuncSignatureVariableArg(b),b.hasStaticDeclarations()&&(g=this.setDeclContainingAST(b)));this.increaseIndent();for(j=0;j<u.length;j++)p=u[j],this.emitIndent(),this.recordSourceMappingStart(p),this.writeToOutput("if (typeof "+p.id.text+' === "undefined") { '),this.recordSourceMappingStart(p.id),
this.writeToOutput(p.id.text),this.recordSourceMappingEnd(p.id),this.writeToOutput(" = "),this.emitJavascript(p.init,a.TokenID.LParen,!1),this.writeLineToOutput("; }"),this.recordSourceMappingEnd(p);if(b.isConstructor&&!d){if(b.args){m=b.args.members.length;for(j=0;j<m;j++)p=b.args.members[j],(p.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(p),this.recordSourceMappingStart(p.id),this.writeToOutput("this."+p.id.text),this.recordSourceMappingEnd(p.id),
this.writeToOutput(" = "),this.recordSourceMappingStart(p.id),this.writeToOutput(p.id.text),this.recordSourceMappingEnd(p.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(p))}a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)||this.emitConstructorCalls(l,i)}c&&(this.emitIndent(),this.writeLineToOutput("var _this = this;"));b.variableArgList&&(m=b.args.members.length,j=b.args.members[m-1],this.emitIndent(),this.recordSourceMappingStart(j),this.writeToOutput("var "),this.recordSourceMappingStart(j.id),
this.writeToOutput(j.id.text),this.recordSourceMappingEnd(j.id),this.writeLineToOutput(" = [];"),this.recordSourceMappingEnd(j),this.emitIndent(),this.writeLineToOutput("for (var _i = 0; _i < (arguments.length - "+(m-1)+"); _i++) {"),this.increaseIndent(),this.emitIndent(),this.writeLineToOutput(j.id.text+"[_i] = arguments[_i + "+(m-1)+"];"),this.decreaseIndent(),this.emitIndent(),this.writeLineToOutput("}"));if(b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&!d){l=this.thisClassNode.members.members.length;
for(j=0;j<l;j++)this.thisClassNode.members.members[j].nodeType==a.NodeType.VarDecl&&(c=this.thisClassNode.members.members[j],!a.hasFlag(c.varFlags,a.VarFlags.Static)&&c.init&&(this.emitIndent(),this.emitJavascriptVarDecl(c,a.TokenID.Tilde),this.writeLineToOutput("")))}this.emitBareJavascriptStatements(b.bod,d);this.decreaseIndent();this.emitIndent();this.writeToOutput("}");!e&&(!a.hasFlag(b.fncFlags,a.FncFlags.IsFunctionExpression)&&(a.hasFlag(b.fncFlags,a.FncFlags.Definition)||b.isConstructor))&&
this.writeLineToOutput("");if(b.hasStaticDeclarations()){this.writeLineToOutput("");this.emitIndent();d=b.getNameText();this.writeLineToOutput("(function ("+d+") {");this.increaseIndent();l=0;l=b.innerStaticFuncs.length;for(j=0;j<l;j++)c=b.innerStaticFuncs[j],c.isOverload?f&&this.emitFuncSignature(c):(this.emitIndent(),c.isAccessor()?this.emitPropertyAccessor(c,b.name.text,!1,f):(this.writeToOutput(d+"."+c.name.text+" = "),this.emitInnerFunction(c,c.name&&!c.name.isMissing(),!1,null,c.hasSelfReference(),
null,f)));if(b.statics){this.recordSourceMappingStart(b.statics);l=b.statics.members.length;for(j=0;j<l;j++)this.emitIndent(),this.writeToOutput(d),this.emitJavascript(b.statics.members[j],a.TokenID.Tilde,!1,f),this.writeLineToOutput("");this.recordSourceMappingEnd(b.statics)}this.decreaseIndent();this.emitIndent();this.writeLineToOutput("})("+(e&&this.thisClassNode?this.thisClassNode.name.text+".prototype.":"")+d+");");f&&(this.setDeclContainingAST(g),this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))}this.recordSourceMappingEnd(b);
this.emitParensAndCommentsInPlace(b,!1)};d.prototype.emitArgDecl=function(a){this.declFile.Write(a.id.text);a.isOptionalArg()&&this.declFile.Write("?");(a.typeExpr||a.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.type)&&this.declFile.Write(": "+this.getTypeSignature(a.type))};d.prototype.emitFuncSignatureIdentifier=function(b,g,e){"undefined"===typeof g&&(g=!1);"undefined"===typeof e&&(e=this.emitState.container);if(!g&&!b.isOverload)if(b.isConstructor){if(1<b.type.construct.signatures.length)return!1}else if(1<
b.type.call.signatures.length)return!1;if(!this.canEmitSignature(a.ToDeclFlags(b.fncFlags),e))return!1;b.isConstructor?(this.emitIndentToDeclFile(),this.declFile.Write("constructor ")):(e=b.getNameText(),g?(this.emitIndentToDeclFile(),b.isConstructMember()?this.declFile.Write("new"):!b.isCallMember()&&!b.isIndexerMember()&&(this.declFile.Write(e),a.hasFlag(b.name.flags,a.ASTFlags.OptionalName)&&this.declFile.Write("? "))):(this.emitDeclFlags(a.ToDeclFlags(b.fncFlags),"function"),this.declFile.Write(e)));
b.isIndexerMember()?this.declFile.Write("["):this.declFile.Write("(");return!0};d.prototype.emitFuncSignatureVariableArg=function(a){if(a.variableArgList){var b=a.args.members[a.args.members.length-1];1<a.args.members.length?this.declFile.Write(", ..."):this.declFile.Write("...");this.emitArgDecl(b)}a.isIndexerMember()?this.declFile.Write("]"):this.declFile.Write(")");!a.isConstructor&&((a.returnTypeAnnotation||a.signature.returnType.type!=this.checker.anyType)&&this.canEmitTypeAnnotationSignature(a.signature.returnType.type))&&
this.declFile.Write(": "+this.getTypeSignature(a.signature.returnType.type));a.hasStaticDeclarations()?this.declFile.WriteLine(" {"):this.declFile.WriteLine(";")};d.prototype.emitFuncSignature=function(a,b){"undefined"===typeof b&&(b=!1);if(this.emitFuncSignatureIdentifier(a,b)){if(a.args){var e=a.args.members.length;a.variableArgList&&e--;for(var l=0;l<e;l++)this.emitArgDecl(a.args.members[l]),l<e-1&&this.declFile.Write(", ")}this.emitFuncSignatureVariableArg(a)}};d.prototype.emitPropertyAccessorSignature=
function(b){var g=b.accessorSymbol;this.emitDeclFlags(a.ToDeclFlags(g.flags),"var");this.declFile.WriteLine(b.name.text+" : "+this.getTypeSignature(g.getType())+";")};d.prototype.emitDeclFlags=function(b,g){this.emitIndentToDeclFile();var e="";a.hasFlag(b,a.DeclFlags.GetAccessor)?e="get ":a.hasFlag(b,a.DeclFlags.SetAccessor)&&(e="set ");a.hasFlag(b,a.DeclFlags.Exported)&&this.declFile.Write("export ");a.hasFlag(b,a.DeclFlags.LocalStatic)||a.hasFlag(b,a.DeclFlags.Static)?this.declFile.Write("static "+
e):a.hasFlag(b,a.DeclFlags.Private)?this.declFile.Write("private "+e):a.hasFlag(b,a.DeclFlags.Public)?this.declFile.Write("public "+e):""==e?this.declFile.Write(g+" "):this.declFile.Write(e)};d.prototype.canEmitTypeAnnotationSignature=function(b,g){"undefined"===typeof g&&(g=a.DeclFlags.None);if(null==b)return!1;if(b.primitiveTypeClass==a.Primitive.None&&b.symbol&&void 0!=b.symbol.container&&b.symbol.container!=this.checker.gloMod){if(a.hasFlag(g,a.DeclFlags.Private))return!1;if(a.hasFlag(b.symbol.container.flags,
a.SymbolFlags.Exported))return!0;if(b.symbol.declAST)switch(b.symbol.declAST.nodeType){case a.NodeType.Module:if(!a.hasFlag(b.symbol.declAST.modFlags,a.ModuleFlags.Exported))return!1;break;case a.NodeType.Class:if(!a.hasFlag(b.symbol.declAST.varFlags,a.VarFlags.Exported))return!1;break;case a.NodeType.Interface:if(!a.hasFlag(b.symbol.declAST.varFlags,a.VarFlags.Exported))return!1;break;case a.NodeType.FuncDecl:if(!a.hasFlag(b.symbol.declAST.fncFlags,a.FncFlags.Exported))return!1;break;default:throw Error("Catch this unhandled type container");
}}return!0};d.prototype.getTypeSignature=function(b){var g=null;if(this.declContainingAST)switch(this.declContainingAST.nodeType){case a.NodeType.Module:case a.NodeType.Interface:case a.NodeType.FuncDecl:this.declContainingAST.type&&(g=this.declContainingAST.type.containedScope);break;case a.NodeType.Script:var e=this.declContainingAST;e.bod&&(g=e.bod.enclosingScope);break;case a.NodeType.Class:this.declContainingAST.type&&(g=this.declContainingAST.type.instanceType.containedScope);break;default:throw Error("Unknown containing scope");
}return b.getScopedTypeName(g)};d.prototype.canEmitSignature=function(b,g){"undefined"===typeof g&&(g=this.emitState.container);return g==h.Module&&!a.hasFlag(b,a.DeclFlags.Exported)?!1:!0};d.prototype.emitVarSignature=function(b,g){"undefined"===typeof g&&(g=!1);if(this.canEmitSignature(a.ToDeclFlags(b.varFlags))){g?(this.emitIndentToDeclFile(),this.declFile.Write(b.id.text),a.hasFlag(b.id.flags,a.ASTFlags.OptionalName)&&this.declFile.Write("?")):(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"var"),
this.declFile.Write(b.id.text));var e=null;b.typeExpr&&b.typeExpr.type?e=b.typeExpr.type:b.sym&&(e=b.sym.getType(),e==this.checker.anyType&&(e=null));this.canEmitTypeAnnotationSignature(e,a.ToDeclFlags(b.varFlags))?(e=this.getTypeSignature(e),this.declFile.WriteLine(": "+e+";")):this.declFile.WriteLine(";")}};d.prototype.emitBaseList=function(a,b){if(a&&0<a.members.length){this.declFile.Write(" "+b+" ");for(var e=a.members.length,l=0;l<e;l++){var c=this.getTypeSignature(a.members[l].type);0<l&&this.declFile.Write(", ");
this.declFile.Write(c)}}};d.prototype.emitClassSignatureIdentifierAndHeritage=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.varFlags)))return!1;var g=b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"class");this.declFile.Write(g);this.emitBaseList(b.baseClass,"extends");this.emitBaseList(b.implementsList,"implements");this.declFile.WriteLine(" {");return!0};d.prototype.emitClassSignatureClassBodyOfAmbientClass=function(b){for(var g=b.definitionMembers.members.length,e=0;e<g;e++){var l=
b.definitionMembers.members[e];if(l.nodeType==a.NodeType.FuncDecl)l.isAccessor()||this.emitFuncSignature(l);else if(l.nodeType==a.NodeType.VarDecl)this.emitVarSignature(l);else throw Error("We want to catch this");}};d.prototype.emitMembersFromConstructorDefinition=function(b){if(b.args){var g=b.args.members.length;b.variableArgList&&g--;for(var e=0;e<g;e++){var l=b.args.members[e];a.hasFlag(l.varFlags,a.VarFlags.Property)&&(this.emitDeclFlags(a.ToDeclFlags(l.varFlags),"var"),this.declFile.Write(l.id.text),
l.typeExpr&&this.declFile.Write(": "+this.getTypeSignature(l.type)),this.declFile.WriteLine(";"))}}};d.prototype.emitClassSignature=function(a){if(this.emitClassSignatureIdentifierAndHeritage(a)){var b=this.setDeclContainingAST(a);this.increaseIndent();this.emitClassSignatureClassBodyOfAmbientClass(a);this.decreaseIndent();this.setDeclContainingAST(b);this.emitIndentToDeclFile();this.declFile.WriteLine("}")}};d.prototype.emitImportDecl=function(b){this.canEmitSignature(a.ToDeclFlags(b.varFlags))&&
(this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"import"),this.declFile.Write(b.id.text+" = "),b.isDynamicImport?this.declFile.WriteLine("module ("+b.getAliasName()+");"):this.declFile.WriteLine(b.getAliasName()+";"))};d.prototype.emitModuleIdentification=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.modFlags)))return!1;this.declDottedModuleName?this.declFile.Write("."):this.emitDeclFlags(a.ToDeclFlags(b.modFlags),"module");this.declFile.Write(b.name.text);1==b.members.members.length&&b.members.members[0].nodeType==
a.NodeType.Module&&!b.members.members[0].isEnum()&&a.hasFlag(b.members.members[0].modFlags,a.ModuleFlags.Exported)?this.declDottedModuleName=!0:(this.declDottedModuleName=!1,this.declFile.WriteLine(" {"));return!0};d.prototype.emitModuleBodyOfAmbientModule=function(b){for(var g=b.members.members.length,e=0;e<g;e++){var l=b.members.members[e];switch(l.nodeType){case a.NodeType.VarDecl:this.emitVarSignature(l);break;case a.NodeType.FuncDecl:this.emitFuncSignature(l);break;case a.NodeType.Class:this.emitClassSignature(l);
break;case a.NodeType.Interface:this.emitInterfaceDeclaration(l);break;case a.NodeType.Module:this.emitModuleSignature(l);break;case a.NodeType.Import:this.emitImportDecl(l);break;case a.NodeType.Empty:break;default:throw Error("We want to catch this");}}};d.prototype.emitModuleSignature=function(a){if(a.isEnum())this.emitEnumSignature(a);else{var b=this.declIndentDelta,e=this.declDottedModuleName;if(this.emitModuleIdentification(a)){var l=this.setDeclContainingAST(a);this.increaseIndent();var c=
this.setContainer(h.Module);this.emitModuleBodyOfAmbientModule(a);this.setContainer(c);this.decreaseIndent();this.setDeclContainingAST(l);e||(this.declIndentDelta=b,this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))}}};d.prototype.emitEnumBodyOfAmbientEnum=function(b){for(var g=b.members.members.length,e=1;e<g;e++){var l=b.members.members[e];if(l.nodeType==a.NodeType.VarDecl)this.emitIndentToDeclFile(),this.declFile.WriteLine(l.id.text+",");else if(l.nodeType!=a.NodeType.Asg)throw Error("We want to catch this");
}};d.prototype.emitEnumSignature=function(b){if(!this.canEmitSignature(a.ToDeclFlags(b.modFlags)))return!1;this.emitDeclFlags(a.ToDeclFlags(b.modFlags),"enum");this.declFile.WriteLine(b.name.text+" {");this.increaseIndent();this.emitEnumBodyOfAmbientEnum(b);this.decreaseIndent();this.emitIndentToDeclFile();this.declFile.WriteLine("}");return!0};d.prototype.emitInterfaceBody=function(b){for(var g=0;g<b.members.length;g++){var e=b.members[g];switch(e.nodeType){case a.NodeType.FuncDecl:this.emitFuncSignature(e,
!0);break;case a.NodeType.VarDecl:this.emitVarSignature(e,!0);break;default:throw Error("Not allowed");}}};d.prototype.emitInterfaceDeclaration=function(b){if(this.canEmitSignature(a.ToDeclFlags(b.varFlags))){var g=this.setContainer(h.Interface),e=b.name.text;this.emitDeclFlags(a.ToDeclFlags(b.varFlags),"interface");this.declFile.Write(e);this.emitBaseList(b.extendsList,"extends");this.declFile.WriteLine(" {");this.increaseIndent();e=this.setDeclContainingAST(b);this.emitInterfaceBody(b.members);
this.setDeclContainingAST(e);this.decreaseIndent();this.emitIndentToDeclFile();this.declFile.WriteLine("}");this.setContainer(g)}};d.prototype.emitJavascriptModule=function(b,g){var e=b.name.text;a.isTSFile(e)?b.name.text=e.substring(0,e.length-3):a.isSTRFile(e)&&(b.name.text=e.substring(0,e.length-4));if(a.hasFlag(b.modFlags,a.ModuleFlags.Ambient))g&&this.emitModuleSignature(b);else{var l=a.hasFlag(b.modFlags,a.ModuleFlags.IsDynamic),c=this.declIndentDelta,i=this.declDottedModuleName,f=null,j=this.outfile;
g&&(l||(g=b.isEnum()?this.emitEnumSignature(b):this.emitModuleIdentification(b)),g&&(f=this.setDeclContainingAST(b)));var e=this.setContainer(h.Module),d=this.moduleName,m=a.hasFlag(b.modFlags,a.ModuleFlags.Exported);this.moduleDeclList[this.moduleDeclList.length]=b;this.moduleName=b.name.text;this.recordSourceMappingStart(b);if(l){var p=a.stripQuotes(a.trimModName(b.name.text))+".js";this.emitOptions.createFile&&(p!=this.emitOptions.path?this.outfile=this.emitOptions.createFile(p):this.emitOptions.outputMany||
this.checker.errorReporter.emitterError(b,"Module emit collides with emitted script: "+p));this.setContainer(h.DynamicModule);if(a.moduleGenTarget==a.ModuleGenTarget.Asynchronous){for(var p='["require", "exports"',u="require, exports",n=null,q=0;q<b.mod.importedModules.length;q++)n=b.mod.importedModules[q],n.id.sym&&!n.id.sym.onlyReferencedAsTypeRef&&(q<=b.mod.importedModules.length-1&&(p+=", ",u+=", "),u+="__"+n.id.text+"__",p+=n.firstAliasedModToString());for(q=0;q<b.amdDependencies.length;q++)p+=
', "'+b.amdDependencies[q]+'"';this.writeLineToOutput("define("+(p+"]")+", function("+u+") {")}}else m||(this.writeLineToOutput("var "+this.moduleName+";"),this.emitIndent()),this.writeLineToOutput("(function ("+this.moduleName+") {");if(!l||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)this.increaseIndent(),l&&this.addDeclIndentDelta();this.emitJavascriptList(b.members,null,a.TokenID.SColon,!0,!1,!1,g&&!b.isEnum());if(!l||a.moduleGenTarget==a.ModuleGenTarget.Asynchronous)this.decreaseIndent(),
l&&this.reduceDeclIndentDelta();this.emitIndent();l?(g&&this.setDeclContainingAST(f),a.moduleGenTarget==a.ModuleGenTarget.Asynchronous&&this.writeLineToOutput("})"),this.outfile!=j&&(this.outfile.Close(),this.outfile=j)):(g&&(this.setDeclContainingAST(f),!b.isEnum()&&!i&&(this.declIndentDelta=c,this.emitIndentToDeclFile(),this.declFile.WriteLine("}"))),l=null,b.type&&(b.type.symbol.container&&b.type.symbol.container.declAST)&&(l=b.type.symbol.container.declAST),l=l&&a.hasFlag(l.modFlags,a.ModuleFlags.IsDynamic),
e==h.Prog&&m?this.writeLineToOutput("})(this."+this.moduleName+" || (this."+this.moduleName+" = {}));"):m||e==h.Prog?(c=""!=d?(l?"exports":d)+".":d,this.writeLineToOutput("})("+c+this.moduleName+" || ("+c+this.moduleName+" = {}));")):!m&&e!=h.Prog?this.writeLineToOutput("})("+this.moduleName+" || ("+this.moduleName+" = {}));"):this.writeLineToOutput("})();"),e!=h.Prog&&(!l&&m)&&(this.emitIndent(),this.writeLineToOutput("var "+this.moduleName+" = "+d+"."+this.moduleName+";")));this.recordSourceMappingEnd(b);
this.setContainer(e);this.moduleName=d;this.moduleDeclList.length--}};d.prototype.emitIndex=function(b,g){var e=this.setInObjectLiteral(!1);this.emitJavascript(b,a.TokenID.Tilde,!1);this.writeToOutput("[");this.emitJavascriptList(g,", ",a.TokenID.Comma,!1,!1,!1);this.writeToOutput("]");this.setInObjectLiteral(e)};d.prototype.emitStringLiteral=function(a){this.writeToOutput(a)};d.prototype.emitJavascriptFunction=function(b,g){if(a.hasFlag(b.fncFlags,a.FncFlags.Signature)||b.isOverload)g&&this.emitFuncSignature(b);
else{var e,l=this.thisFnc;this.thisFnc=b;e=b.isConstructor?this.setContainer(h.Constructor):this.setContainer(h.Function);var c=null,i=!1,f=b.getNameText();if((this.emitState.inObjectLiteral||!b.isAccessor())&&(e!=h.Constructor||(b.fncFlags&a.FncFlags.Method)==a.FncFlags.None)){var j=this.setInObjectLiteral(!1);this.thisClassNode&&(c=this.thisClassNode.extendsList);i=b.hasSelfReference();this.recordSourceMappingStart(b);a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)&&
b.type.symbol.container==this.checker.gloMod&&!b.isConstructor?(this.writeToOutput("this."+f+" = "),this.emitInnerFunction(b,!1,!1,c,i,this.thisClassNode,g,e)):this.emitInnerFunction(b,b.name&&!b.name.isMissing(),!1,c,i,this.thisClassNode,g,e);this.recordSourceMappingEnd(b);this.setInObjectLiteral(j)}this.setContainer(e);this.thisFnc=l;if(a.hasFlag(b.fncFlags,a.FncFlags.Definition))if(a.hasFlag(b.fncFlags,a.FncFlags.Static))this.thisClassNode&&(b.isAccessor()?this.emitPropertyAccessor(b,this.thisClassNode.name.text,
!1,!1):(this.emitIndent(),this.recordSourceMappingStart(b),this.writeLineToOutput(this.thisClassNode.name.text+"."+f+" = "+f+";"),this.recordSourceMappingEnd(b)));else if((this.emitState.container==h.Module||this.emitState.container==h.DynamicModule)&&a.hasFlag(b.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported))this.emitIndent(),e=this.emitState.container==h.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeLineToOutput(e+"."+f+" = "+f+";"),this.recordSourceMappingEnd(b)}};
d.prototype.emitAmbientVarDecl=function(b){b.init&&(this.emitParensAndCommentsInPlace(b,!0),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(b.id.text),this.recordSourceMappingEnd(b.id),this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1),this.recordSourceMappingEnd(b),this.writeToOutput(";"),this.emitParensAndCommentsInPlace(b,!1))};d.prototype.emitForVarList=function(b){if(b){this.recordSourceMappingStart(b);for(var g=b.members.length,e=
0;e<g;e++)this.emitJavascriptVarDecl(b.members[e],0==e?a.TokenID.FOR:a.TokenID.LParen),e<g-1&&this.writeToOutput(", ");this.recordSourceMappingEnd(b)}};d.prototype.emitJavascriptVarDecl=function(b,g,e){"undefined"===typeof e&&(e=!1);if((b.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient)this.emitAmbientVarDecl(b);else{var l=b.sym,c=null!=b.init;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);if(l&&l.isMember()&&l.container&&l.container.kind()==a.SymbolKind.Type){var i=l.container.type;
i.isClass()&&!a.hasFlag(l.flags,a.SymbolFlags.ModuleMember)?this.emitState.container!=h.Args&&(a.hasFlag(l.flags,a.SymbolFlags.Static)?this.writeToOutput(l.container.name+"."):this.writeToOutput("this.")):i.hasImplementation()?!a.hasFlag(l.flags,a.SymbolFlags.Exported)&&(l.container==this.checker.gloMod||!a.hasFlag(l.flags,a.SymbolFlags.Property))?this.writeToOutput("var "):a.hasFlag(b.varFlags,a.VarFlags.LocalStatic)?this.writeToOutput("."):this.emitState.container==h.DynamicModule?this.writeToOutput("exports."):
this.writeToOutput(this.moduleName+"."):g!=a.TokenID.LParen&&(a.hasFlag(l.flags,a.SymbolFlags.Exported)&&l.container==this.checker.gloMod?this.writeToOutput("this."):this.writeToOutput("var "))}else g!=a.TokenID.LParen&&this.writeToOutput("var ");this.recordSourceMappingStart(b.id);this.writeToOutput(b.id.text);this.recordSourceMappingEnd(b.id);c?(this.writeToOutputTrimmable(" = "),this.emitJavascript(b.init,a.TokenID.Comma,!1)):l&&(l.isMember()&&this.emitState.container==h.Constructor)&&(this.writeToOutputTrimmable(" = "),
this.writeToOutput(this.defaultValue(b.type)));g!=a.TokenID.FOR&&g!=a.TokenID.LParen&&this.writeToOutputTrimmable(";");this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1)}e&&this.emitVarSignature(b)};d.prototype.declEnclosed=function(a){if(null==a)return!0;for(var b=0,e=this.moduleDeclList.length;b<e;b++)if(this.moduleDeclList[b]==a)return!0;return!1};d.prototype.emitJavascriptName=function(b,g){var e=b.sym;this.emitParensAndCommentsInPlace(b,!0);this.recordSourceMappingStart(b);
if(!b.isMissing()){if(g&&this.emitState.container!=h.Args&&e)if(e.container&&e.container.name!=a.globalId)if(a.hasFlag(e.flags,a.SymbolFlags.Static)&&a.hasFlag(e.flags,a.SymbolFlags.Property))e.declModule&&a.hasFlag(e.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):this.writeToOutput(e.container.name+".");else if(e.kind()==a.SymbolKind.Field)if(a.hasFlag(e.flags,a.SymbolFlags.ModuleMember)){if(e.container!=this.checker.gloMod&&(a.hasFlag(e.flags,a.SymbolFlags.Property)||
a.hasFlag(e.flags,a.SymbolFlags.Exported)))a.hasFlag(e.declModule.modFlags,a.ModuleFlags.IsDynamic)?this.writeToOutput("exports."):this.writeToOutput(e.container.name+".")}else e.isInstanceProperty()&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?this.writeToOutput("_this."):this.writeToOutput("this."));else e.kind()==a.SymbolKind.Type&&(e.isInstanceProperty()?e.type.call&&!a.hasFlag(e.flags,a.SymbolFlags.ModuleMember)&&(this.thisFnc&&!this.thisFnc.isMethod()&&!this.thisFnc.isConstructor?
this.writeToOutput("_this."):this.writeToOutput("this.")):(e.unitIndex!=this.checker.locationInfo.unitIndex||!this.declEnclosed(e.declModule))&&this.writeToOutput(e.container.name+"."));else e.container==this.checker.gloMod&&(a.hasFlag(e.flags,a.SymbolFlags.Exported)&&!a.hasFlag(e.flags,a.SymbolFlags.Ambient)&&(!e.isType()&&!e.isMember()||!e.declModule||!a.hasFlag(e.declModule.modFlags,a.ModuleFlags.Ambient))&&this.emitState.container==h.Prog&&e.declAST.nodeType!=a.NodeType.FuncDecl)&&this.writeToOutput("this.");
if(e&&e.declAST&&e.declAST.nodeType==a.NodeType.Module&&a.hasFlag(e.declAST.modFlags,a.ModuleFlags.IsDynamic)){var l=e.declAST;a.moduleGenTarget==a.ModuleGenTarget.Asynchronous?this.writeLineToOutput("__"+this.modAliasId+"__;"):(e=b.text,e=(l=l.mod.symbol.declAST&&a.hasFlag(l.mod.symbol.declAST.modFlags,a.ModuleFlags.Ambient))?e:this.firstModAlias?this.firstModAlias:a.quoteBaseName(e),e=l?e:!a.isRelative(a.stripQuotes(e))?a.quoteStr("./"+a.stripQuotes(e)):e,this.writeToOutput("require("+e+")"))}else this.writeToOutput(b.text)}this.recordSourceMappingEnd(b);
this.emitParensAndCommentsInPlace(b,!1)};d.prototype.emitJavascriptStatements=function(b,g){if(b)if(b.nodeType!=a.NodeType.Block){var e=b&&(b.nodeType!=a.NodeType.List||0<b.members.length);if(g||e)e=b.nodeType==a.NodeType.Block||b.nodeType==a.NodeType.List&&1==b.members.length&&b.members[0].nodeType==a.NodeType.Block,this.recordSourceMappingStart(b),e||(this.writeLineToOutput(" {"),this.increaseIndent()),this.emitJavascriptList(b,null,a.TokenID.SColon,!0,!1,!1),e||(this.writeLineToOutput(""),this.decreaseIndent(),
this.emitIndent(),this.writeToOutput("}")),this.recordSourceMappingEnd(b)}else this.emitJavascript(b,a.TokenID.SColon,!0);else g&&this.writeToOutput("{ }")};d.prototype.emitBareJavascriptStatements=function(b,g){b.nodeType!=a.NodeType.Block?b.nodeType==a.NodeType.List?2==b.members.length&&b.members[0].nodeType==a.NodeType.Block&&b.members[1].nodeType==a.NodeType.EndCode?(this.emitJavascript(b.members[0],a.TokenID.SColon,!0),this.writeLineToOutput("")):this.emitJavascriptList(b,null,a.TokenID.SColon,
!0,!1,g):this.emitJavascript(b,a.TokenID.SColon,!0):this.emitJavascript(b,a.TokenID.SColon,!0)};d.prototype.recordSourceMappingStart=function(b){if(this.sourceMapper&&b){var g={line:-1,col:-1},e=new a.SourceMapping(b);e.emittedStartColumn=this.emitState.column;e.emittedStartLine=this.emitState.line;a.getSourceLineColFromMap(g,b.minChar,this.checker.locationInfo.lineMap);e.sourceStartColumn=g.col;e.sourceStartLine=g.line;a.getSourceLineColFromMap(g,b.limChar,this.checker.locationInfo.lineMap);e.sourceEndColumn=
g.col;e.sourceEndLine=g.line;e.parent=this.sourceMapper.currentMapping;this.sourceMapper.currentMapping=this.sourceMapper.sourceMappings.length;this.sourceMapper.sourceMappings.push(e);0<=e.parent&&(b=this.sourceMapper.sourceMappings[e.parent],-1==b.firstChild&&(b.firstChild=this.sourceMapper.currentMapping))}};d.prototype.recordSourceMappingEnd=function(a){this.sourceMapper&&a&&(a=this.sourceMapper.sourceMappings[this.sourceMapper.currentMapping],a.emittedEndColumn=this.emitState.column,a.emittedEndLine=
this.emitState.line,this.sourceMapper.currentMapping=a.parent)};d.prototype.emitSourceMappings=function(){a.SourceMapper.EmitSourceMapping(this.allSourceMappers)};d.prototype.emitJavascriptList=function(b,g,e,l,c,i,f){if(null!=b)if(b.nodeType!=a.NodeType.List)this.emitJavascript(b,e,l,f);else if(0!=b.members.length){this.emitParensAndCommentsInPlace(b,!0);for(var j=b.members.length,d=0;d<j;d++){if(1==d&&i){var m=this.thisClassNode.constructorDecl;if(m&&m.args)for(var p=m.args.members.length,h=0;h<
p;h++){var n=m.args.members[h];(n.varFlags&a.VarFlags.Property)!=a.VarFlags.None&&(this.emitIndent(),this.recordSourceMappingStart(n),this.recordSourceMappingStart(n.id),this.writeToOutput("this."+n.id.text),this.recordSourceMappingEnd(n.id),this.writeToOutput(" = "),this.recordSourceMappingStart(n.id),this.writeToOutput(n.id.text),this.recordSourceMappingEnd(n.id),this.writeLineToOutput(";"),this.recordSourceMappingEnd(n))}m=this.thisClassNode.members.members.length;for(p=0;p<m;p++)this.thisClassNode.members.members[p].nodeType==
a.NodeType.VarDecl&&(h=this.thisClassNode.members.members[p],!a.hasFlag(h.varFlags,a.VarFlags.Static)&&h.init&&(this.emitIndent(),this.emitJavascriptVarDecl(h,a.TokenID.Tilde),this.writeLineToOutput("")))}m=b.members[d];p=m.nodeType==a.NodeType.FuncDecl&&a.hasFlag(m.fncFlags,a.FncFlags.Static)||m.nodeType==a.NodeType.VarDecl&&a.hasFlag(m.varFlags,a.VarFlags.Static);if(!(c?!p:p))this.emitJavascript(m,e,l,f),g&&d<j-1?l?this.writeLineToOutput(g):this.writeToOutput(g):l&&(m.nodeType!=a.NodeType.Interface&&
!(m.nodeType==a.NodeType.VarDecl&&(m.varFlags&a.VarFlags.Ambient)==a.VarFlags.Ambient&&null==m.init)&&m.nodeType!=a.NodeType.EndCode&&m.nodeType!=a.NodeType.FuncDecl)&&this.writeLineToOutput("")}this.emitParensAndCommentsInPlace(b,!1)}};d.prototype.emitJavascript=function(b,g,e,l){"undefined"===typeof l&&(l=!1);null!=b&&(e&&0<this.emitState.indentAmt&&b.nodeType!=a.NodeType.List&&b.nodeType!=a.NodeType.Block&&b.nodeType!=a.NodeType.Interface&&(!(b.nodeType==a.NodeType.VarDecl&&(b.varFlags&a.VarFlags.Ambient)==
a.VarFlags.Ambient&&null==b.init)&&b.nodeType!=a.NodeType.EndCode&&(b.nodeType!=a.NodeType.FuncDecl||this.emitState.container!=h.Constructor))&&this.emitIndent(),b.emit(this,g,e,l),g==a.TokenID.SColon&&b.nodeType<a.NodeType.GeneralNode&&this.writeToOutput(";"))};d.prototype.emitPropertyAccessor=function(a,b,e,l){if(!a.accessorSymbol.hasBeenEmitted){var c=a.accessorSymbol;this.emitIndent();this.recordSourceMappingStart(a);this.writeLineToOutput("Object.defineProperty("+b+(e?'.prototype, "':', "')+
a.name.text+'", {');this.increaseIndent();c.getter&&(b=c.getter.declAST,this.emitIndent(),this.writeToOutput("get: "),this.emitInnerFunction(b,!1,e,null,a.hasSelfReference(),null),this.writeLineToOutput(","));c.setter&&(b=c.setter.declAST,this.emitIndent(),this.writeToOutput("set: "),this.emitInnerFunction(b,!1,e,null,a.hasSelfReference(),null),this.writeLineToOutput(","));this.emitIndent();this.writeLineToOutput("enumerable: true,");this.emitIndent();this.writeLineToOutput("configurable: true");
this.decreaseIndent();this.emitIndent();this.writeLineToOutput("});");this.recordSourceMappingEnd(a);l&&this.emitPropertyAccessorSignature(a);c.hasBeenEmitted=!0}};d.prototype.emitPrototypeMember=function(b,g,e){b.nodeType==a.NodeType.FuncDecl?b.isAccessor()?this.emitPropertyAccessor(b,g,!0,e):(this.emitIndent(),this.recordSourceMappingStart(b),this.writeToOutput(g+".prototype."+b.getNameText()+" = "),this.emitInnerFunction(b,!1,!0,null,b.hasSelfReference(),null,e),this.recordSourceMappingEnd(b),
this.writeLineToOutput(";")):b.nodeType==a.NodeType.VarDecl&&(b.init&&(this.emitIndent(),this.recordSourceMappingStart(b),this.recordSourceMappingStart(b.id),this.writeToOutput(g+".prototype."+b.id.text),this.recordSourceMappingEnd(b.id),this.writeToOutput(" = "),this.emitJavascript(b.init,a.TokenID.Asg,!1),this.recordSourceMappingEnd(b),this.writeLineToOutput(";")),e&&this.emitVarSignature(b))};d.prototype.emitAddBaseMethods=function(b,g,e){if(g.members){var l=g.symbol,c=l.name;l.declModule!=e.type.symbol.declModule&&
(c=l.fullName());g.members.allMembers.map(function(e,i){i.kind()==a.SymbolKind.Type&&i.type.call&&(this.recordSourceMappingStart(i.declAST),this.writeLineToOutput(b+".prototype."+i.name+" = "+c+".prototype."+i.name+";"),this.recordSourceMappingEnd(i.declAST))},null)}if(g.extendsList)for(var l=0,i=g.extendsList.length;l<i;l++)this.emitAddBaseMethods(b,g.extendsList[l],e)};d.prototype.emitJavascriptClass=function(b,g){if(a.hasFlag(b.varFlags,a.VarFlags.Ambient))g&&this.emitClassSignature(b);else{var e=
this.thisClassNode,l=0;this.thisClassNode=b;var c=b.name.text;this.emitParensAndCommentsInPlace(b,!0);var i=null;g&&(g=this.emitClassSignatureIdentifierAndHeritage(b))&&(i=this.setDeclContainingAST(b));var f=this.setContainer(h.Class);this.recordSourceMappingStart(b);a.hasFlag(b.varFlags,a.VarFlags.Exported)&&b.type.symbol.container==this.checker.gloMod?this.writeToOutput("this."+c):this.writeToOutput("var "+c);var j=b.type.instanceType,d=j?j.baseClass():null,m=null,m=null;d?this.writeLineToOutput(" = (function (_super) {"):
this.writeLineToOutput(" = (function () {");this.increaseIndent();if(d){m=b.extendsList.members[0];m=m.nodeType==a.NodeType.Call?m.target:m;this.emitIndent();this.writeLineToOutput("__extends("+c+", _super);");var p=j.extendsList.length;if(1<p)for(l=1;l<p;l++)this.emitAddBaseMethods(c,j.extendsList[l],b)}this.emitIndent();if(b.constructorDecl)this.emitJavascript(b.constructorDecl,a.TokenID.LParen,!1,!1),g&&this.emitMembersFromConstructorDefinition(b.constructorDecl);else{p=0;this.recordSourceMappingStart(b);
this.increaseIndent();this.writeToOutput("function "+b.name.text+"() {");d&&(this.writeLineToOutput(""),this.emitIndent(),this.writeLineToOutput("_super.apply(this, arguments);"),p++);for(var u=this.thisClassNode.members.members,l=0;l<u.length;l++)u[l].nodeType==a.NodeType.VarDecl&&(j=u[l],!a.hasFlag(j.varFlags,a.VarFlags.Static)&&j.init&&(this.writeLineToOutput(""),this.emitIndent(),this.emitJavascriptVarDecl(j,a.TokenID.Tilde),p++));p?(this.writeLineToOutput(""),this.decreaseIndent(),this.emitIndent(),
this.writeLineToOutput("}")):(this.writeLineToOutput(" }"),this.decreaseIndent());this.recordSourceMappingEnd(b)}l=b.definitionMembers.members.length;for(p=0;p<l;p++)if(j=b.definitionMembers.members[p],j.nodeType==a.NodeType.FuncDecl)a.hasFlag(j.fncFlags,a.FncFlags.Method)&&!j.isSignature()?a.hasFlag(j.fncFlags,a.FncFlags.Static)?j.isAccessor()?this.emitPropertyAccessor(j,this.thisClassNode.name.text,!1,g):(this.emitIndent(),this.recordSourceMappingStart(j),this.writeToOutput(b.name.text+"."+j.name.text+
" = "),this.emitInnerFunction(j,j.name&&!j.name.isMissing(),!1,null,j.hasSelfReference(),null,g),this.recordSourceMappingEnd(j)):this.emitPrototypeMember(j,c,g):g&&this.emitFuncSignature(j);else if(j.nodeType==a.NodeType.VarDecl)a.hasFlag(j.varFlags,a.VarFlags.Static)?(this.emitIndent(),this.recordSourceMappingStart(j),this.writeToOutput(b.name.text+"."+j.id.text+" = "),j.init?(this.emitJavascript(j.init,a.TokenID.Asg,!1),this.writeLineToOutput(";")):this.writeLineToOutput(this.defaultValue(j.type)+
";"),g&&this.emitVarSignature(j),this.recordSourceMappingEnd(j)):g&&this.emitVarSignature(j);else throw Error("We want to catch this");this.emitIndent();this.recordSourceMappingStart(b);this.writeLineToOutput("return "+c+";");this.recordSourceMappingEnd(b);this.decreaseIndent();this.emitIndent();this.writeToOutput("})(");d&&this.emitJavascript(m,a.TokenID.Tilde,!1);this.writeToOutput(");");g&&(this.setDeclContainingAST(i),this.emitIndentToDeclFile(),this.declFile.WriteLine("}"));if((f==h.Module||
f==h.DynamicModule)&&a.hasFlag(b.varFlags,a.VarFlags.Exported))this.writeLineToOutput(""),this.emitIndent(),i=f==h.Module?this.moduleName:"exports",this.recordSourceMappingStart(b),this.writeToOutput(i+"."+c+" = "+c+";"),this.recordSourceMappingEnd(b);this.emitIndent();this.recordSourceMappingEnd(b);this.emitParensAndCommentsInPlace(b,!1);this.setContainer(f);this.thisClassNode=e}};d.prototype.emitPrologue=function(a){!this.prologueEmitted&&a&&(this.prologueEmitted=!0,this.writeLineToOutput("var __extends = this.__extends || function (d, b) {"),
this.writeLineToOutput("    function __() { this.constructor = d; }"),this.writeLineToOutput("    __.prototype = b.prototype;"),this.writeLineToOutput("    d.prototype = new __();"),this.writeLineToOutput("}"))};d.prototype.emitSuperReference=function(){this.writeToOutput("_super.prototype")};d.prototype.emitSuperCall=function(b){if(b.target.nodeType==a.NodeType.Dot){var g=b.target;if(g.operand1.nodeType==a.NodeType.Super)return this.emitJavascript(g,a.TokenID.LParen,!1),this.writeToOutput(".call(this"),
b.args&&0<b.args.members.length&&(this.writeToOutput(", "),this.emitJavascriptList(b.args,", ",a.TokenID.Comma,!1,!1,!1)),this.writeToOutput(")"),!0}return!1};a.Emitter=d})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.outfile=a;this.checker=this.parser=null;this.lineCol={line:0,col:0};this.emitAsComments=!0;this.pushToErrorSink=this.hasErrors=!1;this.errorSink=[]};d.prototype.getCapturedErrors=function(){return this.errorSink};d.prototype.freeCapturedErrors=function(){this.errorSink=[]};d.prototype.captureError=function(a){this.errorSink[this.errorSink.length]=a};d.prototype.setErrOut=function(a){this.outfile=a;this.emitAsComments=!1};d.prototype.emitPrefix=function(){this.emitAsComments&&
this.outfile.Write("// ");this.outfile.Write(this.checker.locationInfo.filename+"("+this.lineCol.line+","+this.lineCol.col+"): ")};d.prototype.writePrefix=function(a){a?this.setError(a):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};d.prototype.writePrefixFromSym=function(d){d&&this.checker.locationInfo.lineMap?a.getSourceLineColFromMap(this.lineCol,d.location,this.checker.locationInfo.lineMap):(this.lineCol.line=-1,this.lineCol.col=-1);this.emitPrefix()};d.prototype.setError=function(d){d&&
(d.flags|=a.ASTFlags.Error,this.checker.locationInfo.lineMap&&a.getSourceLineColFromMap(this.lineCol,d.minChar,this.checker.locationInfo.lineMap))};d.prototype.reportError=function(a,b){if(this.pushToErrorSink)this.captureError(b);else{this.hasErrors=!0;var d=a.limChar-a.minChar;this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.minChar,d,b,this.checker.locationInfo.unitIndex):(this.writePrefix(a),this.outfile.WriteLine(b))}};d.prototype.reportErrorFromSym=function(a,
b){this.pushToErrorSink?this.captureError(b):(this.hasErrors=!0,this.parser.errorRecovery&&this.parser.errorCallback?this.parser.errorCallback(a.location,1,b,this.checker.locationInfo.unitIndex):(this.writePrefixFromSym(a),this.outfile.WriteLine(b)))};d.prototype.emitterError=function(a,b){this.reportError(a,b);throw Error("EmitError");};d.prototype.duplicateIdentifier=function(a,b){this.reportError(a,"Duplicate identifier '"+b+"'")};d.prototype.showRef=function(a,b,d){var g={line:-1,col:-1};this.parser.getSourceLineCol(g,
d.location);this.reportError(a,"symbol "+b+" defined at ("+g.line+","+g.col+")")};d.prototype.unresolvedSymbol=function(a,b){this.reportError(a,"The name '"+b+"' does not exist in the current scope")};d.prototype.symbolDoesNotReferToAValue=function(a,b){this.reportError(a,"The name '"+b+"' does not refer to a value")};d.prototype.styleError=function(a,b){var d=this.pushToErrorSink;this.pushToErrorSink=!1;this.reportError(a,"STYLE: "+b);this.pushToErrorSink=d};d.prototype.simpleError=function(a,b){this.reportError(a,
b)};d.prototype.simpleErrorFromSym=function(a,b){this.reportErrorFromSym(a,b)};d.prototype.invalidSuperReference=function(a){this.simpleError(a,"Keyword 'super' can only be used inside a class instance method")};d.prototype.valueCannotBeModified=function(a){this.simpleError(a,"The left-hand side of an assignment expression must be a variable, property or indexer")};d.prototype.invalidCall=function(d,b,k){var g=d.target.type,k=g.getScopedTypeName(k);g.construct&&b==a.NodeType.Call?this.reportError(d,
"Value of type '"+k+"' is not callable.  Did you mean to include 'new'?"):this.reportError(d,"Value of type '"+k+"' is not "+(b==a.NodeType.Call?"callable":"newable"))};d.prototype.indexLHS=function(a,b){var d=a.operand1.type.getScopedTypeName(b),g=a.operand2.type.getScopedTypeName(b);this.simpleError(a,"Value of type '"+d+"' is not indexable by type '"+g+"'")};d.prototype.incompatibleTypes=function(a,b,d,g,e,l){b||(b=this.checker.anyType);d||(d=this.checker.anyType);l=l?l.message:"";g?this.reportError(a,
"Operator '"+g+"' cannot be applied to types '"+b.getScopedTypeName(e)+"' and '"+d.getScopedTypeName(e)+"'"+(l?": "+l:"")):this.reportError(a,"Cannot convert '"+b.getScopedTypeName(e)+"' to '"+d.getScopedTypeName(e)+"'"+(l?": "+l:""))};d.prototype.expectedClassOrInterface=function(a){this.simpleError(a,"Expected var, class, interface, or module")};d.prototype.unaryOperatorTypeError=function(a,b,d){this.reportError(a,"Operator '"+b+"' cannot be applied to type '"+d.getTypeName()+"'")};a.ErrorReporter=
d})(TypeScript||(TypeScript={}));
(function(a){var d=a.TypeContext||(a.TypeContext={});d._map=[];d.NoTypes=0;d.ArraySuffix=1;d.Primitive=2;d.Named=4;d.AllSimpleTypes=d.Primitive|d.Named;d.AllTypes=d.Primitive|d.Named|d.ArraySuffix;var h=a.TypeContext,d=a.ParseState||(a.ParseState={});d._map=[];d._map[0]="None";d.None=0;d._map[1]="StartScript";d.StartScript=1;d._map[2]="StartStmtList";d.StartStmtList=2;d._map[3]="StartStatement";d.StartStatement=3;d._map[4]="StartFncDecl";d.StartFncDecl=4;d._map[5]="FncDeclName";d.FncDeclName=5;d._map[6]=
"FncDeclArgs";d.FncDeclArgs=6;d._map[7]="FncDeclReturnType";d.FncDeclReturnType=7;d._map[8]="ForInit";d.ForInit=8;d._map[9]="ForInitAfterVar";d.ForInitAfterVar=9;d._map[10]="ForCondStart";d.ForCondStart=10;d._map[11]="EndStmtList";d.EndStmtList=11;d._map[12]="EndScript";d.EndScript=12;var b=a.ParseState,k;k=function(a,b){this.Script=a;this.endLexState=b};a.QuickParseResult=k;var g=function(){this.varLists=[];this.scopeLists=[];this.staticsLists=[];this.scanner=new a.Scanner;this.tok=null;this.inInterfaceDecl=
this.inStaticFnc=this.inFnc=this.needTerminator=!1;this.currentClassDecl=null;this.inFncDecl=!1;this.anonId=new a.Identifier("_anonymous");this.style_requireSemi=!1;this.style_funcInLoop=!0;this.errorRecovery=this.incremental=!1;this.outfile=void 0;this.errorCallback=null;this.state=b.StartStmtList;this.cursorColumn=this.cursorLine=-1;this.cursorState=b.None;this.errorMessage="";this.ambientClass=this.ambientModule=!1;this.topLevel=!0;this.currentUnitIndex=-1;this.prevIDTok=null;this.stmtStack=[];
this.strictMode=this.hasTopLevelImportOrExport=!1;this.nestingLevel=0;this.currentClassDefinition=this.prevExpr=null;this.parsingDeclareFile=this.parsingClassConstructorDefinition=!1;this.amdDependencies=[];this.inferPropertiesFromThisAssignment=!1;this.fname="";this.parseError=!1};g.prototype.resetStmtStack=function(){this.stmtStack=[]};g.prototype.inLoop=function(){for(var a=this.stmtStack.length-1;0<=a;a--)if(this.stmtStack[a].stmt.isLoop())return!0;return!1};g.prototype.pushStmt=function(a,b){this.stmtStack.push({stmt:a,
labels:b})};g.prototype.popStmt=function(){return this.stmtStack.pop()};g.prototype.resolveJumpTarget=function(e){for(var b=this.stmtStack.length-1;0<=b;b--){var c=this.stmtStack[b];if(e.target){if(c.labels&&0<c.labels.members.length)for(var i=0,f=c.labels.members.length;i<f;i++)if(c.labels.members[i].id.text==e.target){e.setResolvedTarget(this,c.stmt);return}}else{if(c.stmt.isLoop()){e.setResolvedTarget(this,c.stmt);return}if(c.stmt.nodeType==a.NodeType.Switch&&e.nodeType==a.NodeType.Break){e.setResolvedTarget(this,
c.stmt);return}}}e.target?this.reportParseError("could not find enclosing statement with label "+e.target):e.nodeType==a.NodeType.Break?this.reportParseError("break statement requires enclosing loop or switch"):this.reportParseError("continue statement requires enclosing loop")};g.prototype.setNonInteractive=function(){this.errorRecovery=!1};g.prototype.setErrorRecovery=function(a,l,c){this.outfile=a;this.cursorLine=l;this.cursorColumn=c;this.cursorState=b.None;this.errorRecovery=!0};g.prototype.posMatchesCursor=
function(a){var b={line:-1,col:-1};this.getSourceLineCol(b,a);return b.line==this.cursorLine&&b.col==this.cursorColumn};g.prototype.getSourceLineCol=function(e,b){a.getSourceLineColFromMap(e,b,this.scanner.lineMap)};g.prototype.createRef=function(e,b){var c=new a.Identifier(e);c.minChar=b;return c};g.prototype.reportParseStyleError=function(a){this.reportParseError("STYLE: "+a)};g.prototype.reportParseError=function(a,b,c){"undefined"===typeof b&&(b=this.scanner.startPos);"undefined"===typeof c&&
(c=this.scanner.pos);c=Math.max(1,c-b);if(this.errorCallback)this.errorCallback(b,c,a,this.currentUnitIndex);else if(this.errorRecovery)c={line:-1,col:-1},this.getSourceLineCol(c,b),this.outfile&&this.outfile.WriteLine("// "+this.fname+" ("+c.line+","+c.col+"): "+a);else throw new SyntaxError(this.fname+" ("+this.scanner.line+","+this.scanner.col+"): "+a);};g.prototype.chkNxtTok=function(a,b,c){this.tok=this.scanner.scan();this.chkCurTok(a,b,c)};g.prototype.skip=function(e){var e=e|a.ErrorRecoverySet.EOF,
b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId);void 0!=c&&(b=c.ers);for(var i=0;(b&e)==a.ErrorRecoverySet.None||this.tok.tokenId==a.TokenID.RCurly&&0<i;)this.tok.tokenId==a.TokenID.LCurly?i++:this.tok.tokenId==a.TokenID.RCurly&&i--,this.tok=this.scanner.scan(),b=a.ErrorRecoverySet.None,c=a.lookupToken(this.tok.tokenId),void 0!=c&&(b=c.ers)};g.prototype.chkCurTok=function(a,b,c){this.tok.tokenId!=a?(this.reportParseError(b),this.errorRecovery&&this.skip(c)):this.tok=this.scanner.scan()};
g.prototype.pushDeclLists=function(){this.staticsLists.push(new a.ASTList);this.varLists.push(new a.ASTList);this.scopeLists.push(new a.ASTList)};g.prototype.popDeclLists=function(){this.staticsLists.pop();this.varLists.pop();this.scopeLists.pop()};g.prototype.topVarList=function(){return this.varLists[this.varLists.length-1]};g.prototype.topScopeList=function(){return this.scopeLists[this.scopeLists.length-1]};g.prototype.topStaticsList=function(){return this.staticsLists[this.staticsLists.length-
1]};g.prototype.parseComment=function(e){if(e){var b=new a.Comment(e.value,e.isBlock,e.endsLine);b.minChar=e.startPos;b.limChar=e.startPos+e.value.length;!e.isBlock&&3<e.value.length&&"///"==e.value.substring(0,3)&&(e=a.getAdditionalDependencyPath(e.value))&&this.amdDependencies.push(e);return b}return null};g.prototype.parseCommentsInner=function(a){if(a){for(var b=[],c=0;c<a.length;c++)b.push(this.parseComment(a[c]));return b}return null};g.prototype.parseComments=function(){var a=this.scanner.getComments();
return this.parseCommentsInner(a)};g.prototype.parseCommentsForLine=function(a){a=this.scanner.getCommentsForLine(a);return this.parseCommentsInner(a)};g.prototype.combineComments=function(a,b){return null==a?b:null==b?a:a.concat(b)};g.prototype.parseEnumDecl=function(e){var b=this.scanner.leftCurlyCount,c=this.scanner.rightCurlyCount,i=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(i=new a.Identifier(this.tok.getText()),i.minChar=this.scanner.startPos,i.limChar=
this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("Enum declaration requires identifier"),this.errorRecovery&&(i=new a.MissingIdentifier,i.minChar=this.scanner.startPos,i.limChar=this.scanner.startPos,i.flags|=a.ASTFlags.Error));var f=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",e|a.ErrorRecoverySet.ID);this.pushDeclLists();var j=new a.ASTList;j.minChar=f;f=new a.VarDecl(new a.Identifier("_map"),0);f.varFlags|=a.VarFlags.Exported;f.varFlags|=a.VarFlags.Private;
f.varFlags|=a.VarFlags.Property|a.VarFlags.Public;f.init=new a.UnaryExpression(a.NodeType.ArrayLit,null);j.append(f);for(f=null;;){var d=this.scanner.startPos,m,g=null,k=null,n=null,q=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok))g=new a.Identifier(this.tok.getText()),g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos;else if(this.tok.tokenId==a.TokenID.RCurly)break;else this.reportParseError("Expected identifer of enum member"),this.errorRecovery&&(g=new a.MissingIdentifier,
g.minChar=this.scanner.startPos,g.limChar=this.scanner.startPos,g.flags|=a.ASTFlags.Error);m=this.scanner.pos;n=this.parseComments();this.tok=this.scanner.scan();q=this.parseComments();if(this.tok.tokenId==a.TokenID.Asg)this.tok=this.scanner.scan(),f=k=this.parseExpr(e,a.OperatorPrecedence.Cma,!0,h.NoTypes),m=k.limChar;else{var f=k=null==f?new a.NumberLiteral(0):new a.NumberLiteral(f.value+1),r=new a.BinaryExpression(a.NodeType.Asg,new a.BinaryExpression(a.NodeType.Index,new a.Identifier("_map"),
k),new a.StringLiteral('"'+g.text+'"'));j.append(r)}g=new a.VarDecl(g,this.nestingLevel);g.minChar=d;g.limChar=m;g.init=k;g.typeExpr=new a.TypeReference(this.createRef(i.text,-1),0);g.varFlags|=a.VarFlags.Readonly|a.VarFlags.Property;k.nodeType==a.NodeType.NumberLit&&(g.varFlags|=a.VarFlags.Constant);g.preComments=n;j.append(g);g.postComments=q;g.varFlags|=a.VarFlags.Exported;if(this.tok.tokenId==a.TokenID.Comma&&(this.tok=this.scanner.scan(),g.postComments=this.combineComments(g.postComments,this.parseCommentsForLine(this.scanner.prevLine)),
this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)))continue;break}this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);j.limChar=this.scanner.lastTokenLimChar();e=new a.ModuleDecl(i,j,this.topVarList(),this.topScopeList());e.modFlags|=a.ModuleFlags.IsEnum;this.popDeclLists();e.leftCurlyCount=this.scanner.leftCurlyCount-b;e.rightCurlyCount=this.scanner.rightCurlyCount-c;return e};g.prototype.parseDottedName=function(e){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)){var b=new a.Identifier(this.tok.getText());b.preComments=this.parseComments();e[e.length]=b;b.minChar=this.scanner.startPos;b.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Dot&&this.parseDottedName(e)}else this.reportParseError("need identifier after '.'")};g.prototype.isValidImportPath=function(e){e=a.stripQuotes(e);return!e||-1!=e.indexOf(":")||-1!=e.indexOf("\\")||"/"==e.charAt(0)?!1:!0};g.prototype.parseImportDecl=function(e,b){var c=null,
i=null,c=null,f=this.scanner.startPos,j=!1;this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?c=new a.Identifier(this.tok.getText()):(this.reportParseError("Expected identifer after 'import'"),c=new a.MissingIdentifier);c.minChar=this.scanner.startPos;c.limChar=this.scanner.pos;this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.Asg,"Expected =",e|a.ErrorRecoverySet.ID);var g=this.parseComments(),m;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode))if(this.tok.tokenId==a.TokenID.MODULE){if(m=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.QString||this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))this.tok.tokenId==a.TokenID.QString?(this.topLevel&&(this.hasTopLevelImportOrExport=!0),i=this.tok.getText(),this.isValidImportPath(i)||this.reportParseError("Invalid import path"),i=new a.Identifier(i),i.minChar=this.scanner.startPos,
i.limChar=this.scanner.pos,j=!0,this.tok=this.scanner.scan()):i=this.parseExpr(e|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,h.NoTypes),i.preComments=g;m=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.ID);i&&(i.postComments=this.parseComments());this.tok.tokenId==a.TokenID.SColon&&(m=this.scanner.pos,this.tok=this.scanner.scan())}}else i=this.parseExpr(e|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,h.NoTypes),m=this.scanner.pos;else this.reportParseError("Expected module name"),
i=new a.MissingIdentifier,i.minChar=this.scanner.startPos,i.limChar=this.scanner.startPos,i.flags|=a.ASTFlags.Error,m=i.limChar;c=new a.ImportDecl(c,i);c.isDynamicImport=j;a.hasFlag(b,a.Modifiers.Exported)&&(c.varFlags|=a.VarFlags.Exported);c.minChar=f;c.limChar=m;return c};g.prototype.parseModuleDecl=function(e,b){var c=this.scanner.leftCurlyCount,i=this.scanner.rightCurlyCount,f=this.ambientModule,j=this.topLevel;this.topLevel=!1;if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))this.ambientModule=
!0;this.tok=this.scanner.scan();var g=null,m=null;this.pushDeclLists();var d=this.parseComments(),h=this.scanner.startPos,k=!1;this.tok.tokenId==a.TokenID.ID||this.tok.tokenId==a.TokenID.QString||a.convertTokToID(this.tok,this.strictMode)?(g=this.tok.getText(),this.tok.tokenId==a.TokenID.QString&&(k=!0,this.ambientModule||this.reportParseError("Only ambient dynamic modules may have string literal names")),g=new a.Identifier(g),g.minChar=this.scanner.startPos,g.limChar=this.scanner.pos,this.tok=this.scanner.scan()):
this.tok.tokenId==a.TokenID.LCurly&&(this.reportParseError("Module name missing"),g=new a.Identifier(""),g.minChar=h,g.limChar=h);this.tok.tokenId==a.TokenID.Dot&&(m=[],this.parseDottedName(m));null==g&&(g=new a.MissingIdentifier);var q=new a.ASTList,r=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",e|a.ErrorRecoverySet.ID);this.parseStmtList(e|a.ErrorRecoverySet.RCurly,q,!0,!0,a.AllowedElements.ModuleMembers,b);q.minChar=r;q.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RCurly,
"Expected '}'",e);r=this.scanner.pos;if(m&&0<m.length){var s=m.length,t=m[s-1],t=new a.ModuleDecl(t,q,this.topVarList(),this.topScopeList());if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))t.modFlags|=a.ModuleFlags.Ambient;t.modFlags|=a.ModuleFlags.Exported;t.minChar=h;t.limChar=r;this.popDeclLists();for(s-=2;0<=s;s--){q=new a.ASTList;q.append(t);t=m[s];t=new a.ModuleDecl(t,q,new a.ASTList,new a.ASTList);q.minChar=t.minChar=h;q.limChar=t.limChar=r;if(this.parsingDeclareFile||a.hasFlag(b,
a.Modifiers.Ambient))t.modFlags|=a.ModuleFlags.Ambient;t.modFlags|=a.ModuleFlags.Exported}q=new a.ASTList;q.append(t);q.minChar=h;q.limChar=r;m=new a.ModuleDecl(g,q,new a.ASTList,new a.ASTList)}else m=new a.ModuleDecl(g,q,this.topVarList(),this.topScopeList()),this.popDeclLists();if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))m.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(b,a.Modifiers.Exported)&&(m.modFlags|=a.ModuleFlags.Exported);k&&(m.modFlags|=a.ModuleFlags.IsDynamic);m.preComments=
d;m.postComments=this.parseComments();this.ambientModule=f;this.topLevel=j;m.leftCurlyCount=this.scanner.leftCurlyCount-c;m.rightCurlyCount=this.scanner.rightCurlyCount-i;return m};g.prototype.parseTypeReferenceTail=function(e,b,c){c=new a.TypeReference(c,0);for(c.minChar=b;this.tok.tokenId==a.TokenID.LBrack;)this.tok=this.scanner.scan(),c.arrayCount++,this.chkCurTok(a.TokenID.RBrack,"Expected ']'",e|a.ErrorRecoverySet.LBrack);c.limChar=this.scanner.lastTokenLimChar();return c};g.prototype.parseNamedType=
function(e,b,c,i){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.Dot){this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)){var f=new a.Identifier(this.tok.getText());f.minChar=this.scanner.startPos;f.limChar=this.scanner.pos;var j=new a.BinaryExpression(a.NodeType.Dot,c,f);j.minChar=c.minChar;j.limChar=f.limChar;return this.parseNamedType(e,b,j,i)}this.reportParseError("need identifier after '.'");if(this.errorRecovery)return c.flags|=
a.ASTFlags.DotLHS,c.limChar=this.scanner.lastTokenLimChar(),c;f=new a.MissingIdentifier;f.minChar=this.scanner.pos;f.limChar=this.scanner.pos;j=new a.BinaryExpression(a.NodeType.Dot,c,f);j.flags|=a.ASTFlags.Error;j.minChar=c.minChar;j.limChar=f.limChar;return this.parseNamedType(e,b,j,i)}return i?this.parseTypeReferenceTail(e,b,c):c};g.prototype.parseTypeReference=function(e,b){var c=this.scanner.startPos,i=!1;switch(this.tok.tokenId){case a.TokenID.VOID:b||this.reportParseError("void not a valid type in this context");
case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:return i=new a.Identifier(a.tokenTable[this.tok.tokenId].text),i.minChar=c,i.limChar=this.scanner.pos,this.tok=this.scanner.scan(),this.parseTypeReferenceTail(e,c,i);case a.TokenID.ID:return i=this.createRef(this.tok.getText(),c),i.limChar=this.scanner.pos,this.parseNamedType(e,c,i,!0);case a.TokenID.LCurly:this.tok=this.scanner.scan();i=new a.ASTList;i.minChar=c;var f=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(e|
a.ErrorRecoverySet.RCurly,i);this.inInterfaceDecl=f;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);f=new a.TypeDecl(a.NodeType.Interface,this.anonId,i,null,null,null);f.minChar=c;f.limChar=i.limChar;return this.parseTypeReferenceTail(e,c,f);case a.TokenID.NEW:this.tok=this.scanner.scan(),this.tok.tokenId!=a.TokenID.LParen?this.reportParseError("Expected '('"):i=!0;case a.TokenID.LParen:var j=new a.ASTList,f=this.parseFormalParameterList(e|a.ErrorRecoverySet.RParen,j,!1,!0,!1,!1,!1,null);this.chkCurTok(a.TokenID.Arrow,
"Expected '=>'",e);var g=this.parseTypeReference(e,!0),j=new a.FuncDecl(null,null,!1,j,null,null,null,a.NodeType.FuncDecl);j.returnTypeAnnotation=g;j.variableArgList=f;j.fncFlags|=a.FncFlags.Signature;i&&(j.fncFlags|=a.FncFlags.ConstructMember,j.hint="_construct",j.classDecl=null);j.minChar=c;return this.parseTypeReferenceTail(e,c,j);default:return this.reportParseError("Expected type name"),c=new a.TypeReference(null,0),c.flags|=a.ASTFlags.Error,c.minChar=this.scanner.pos,c.limChar=this.scanner.pos,
c}};g.prototype.parseFunctionStatements=function(e,l,c,i,f,j,g,m,d){this.pushDeclLists();var k=this.stmtStack;this.resetStmtStack();var n=null,q=!1,r=!1;if(!m){var n=new a.ASTList,s=this.scanner.startPos;this.tok.tokenId==a.TokenID.Arrow&&(i&&this.reportParseError("'=>' may not be used for class methods"),q=!0,this.tok=this.scanner.scan());q&&this.tok.tokenId!=a.TokenID.LCurly?(j=this.parseExpr(e|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.Asg,!0,h.NoTypes),d=new a.ReturnStatement,d.returnExpression=
j,n.minChar=s,n.append(d)):(this.state=b.StartStmtList,this.chkCurTok(a.TokenID.LCurly,"Expected '{'",e|a.ErrorRecoverySet.StmtStart),i=this.inFnc,r=q,this.inFnc=!0,this.parseStmtList(e|a.ErrorRecoverySet.RCurly|a.ErrorRecoverySet.StmtStart,n,!0,!1,j,d),n.minChar=s,n.limChar=this.scanner.pos,this.inFnc=i,s=new a.EndCode,s.minChar=n.limChar,s.limChar=s.minChar,n.append(s))}l=new a.FuncDecl(l,n,c,f,this.topVarList(),this.topScopeList(),this.topStaticsList(),a.NodeType.FuncDecl);this.popDeclLists();
this.topScopeList().append(l);c=this.scanner.pos;m?this.chkCurTok(a.TokenID.SColon,"Expected ';'",e):!q||r?(this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e),r&&(l.fncFlags|=a.FncFlags.IsFatArrowFunction)):(l.fncFlags|=a.FncFlags.IsFatArrowFunction,this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan()));l.minChar=g;l.limChar=c;m||(l.fncFlags|=a.FncFlags.Definition);this.stmtStack=k;return l};g.prototype.transformAnonymousArgsIntoFormals=function(e,b){var c=this,i=function(b){if(b.nodeType==
a.NodeType.Comma)c.transformAnonymousArgsIntoFormals(e,b);else if(b.nodeType==a.NodeType.Name||b.nodeType==a.NodeType.Asg){var i=b.nodeType==a.NodeType.Asg?b.operand1:b,l=new a.ArgDecl(i);l.preComments=i.preComments;l.postComments=i.postComments;l.minChar=i.minChar;l.limChar=i.limChar;a.hasFlag(i.flags,a.ASTFlags.PossibleOptionalParameter)&&(l.isOptional=!0);b.nodeType==a.NodeType.Asg&&(l.init=b.operand2);e.append(l)}else c.reportParseError("Invalid lambda argument")};b&&(b.nodeType==a.NodeType.Comma?
(i(b.operand1),i(b.operand2)):i(b))};g.prototype.parseFormalParameterList=function(e,b,c,i,f,j,g,m){b.minChar=this.scanner.startPos;f?this.tok=this.scanner.scan():m||this.chkCurTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.RParen);var d=!1,k=!0,n=!1,q=!1,r=!1;m&&(this.transformAnonymousArgsIntoFormals(b,m),q=!0);for(;;){var s=!1,t=a.VarFlags.None,w=this.scanner.startPos;this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),
this.tok=this.scanner.scan(),t|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor));this.tok.tokenId==a.TokenID.PUBLIC?(t|=a.VarFlags.Public|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor)):this.tok.tokenId==a.TokenID.PRIVATE&&(t|=a.VarFlags.Private|a.VarFlags.Property,this.currentClassDefinition&&(this.currentClassDefinition.varFlags|=
a.VarFlags.ClassSuperMustBeFirstCallInConstructor));t!=a.VarFlags.None?(c||this.reportParseError("only constructor parameters can be properties"),this.tok=this.scanner.scan(),this.inferPropertiesFromThisAssignment&&this.tok.tokenId==a.TokenID.THIS&&(c||this.reportParseError("Instance property declarations using 'this' may only be used in class constructors"),this.tok=this.scanner.scan(),this.tok=this.scanner.scan())):this.tok.tokenId==a.TokenID.Ellipsis&&(d=!0,this.tok=this.scanner.scan());var A=
null;if(!q&&this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))A=new a.Identifier(this.tok.getText()),A.minChar=this.scanner.startPos,A.limChar=this.scanner.pos;if(q||A){var s=!0,C=null,x=null;q&&b.members.length?(x=b.members[b.members.length-1],x.isOptional&&(r=n=!0)):(x=new a.ArgDecl(A),j&&this.reportParseError("Property getters may not take any arguments"),g&&!k&&this.reportParseError("Property setters may only take one argument"),x.minChar=w,x.preComments=this.parseComments(),
this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(n=x.isOptional=!0,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),C=this.parseTypeReference(e,!1),m&&(r=!0));this.tok.tokenId==a.TokenID.Asg&&(i&&this.reportParseError("Arguments in signatures may not have default values"),n=!0,this.tok=this.scanner.scan(),x.init=this.parseExpr(a.ErrorRecoverySet.Comma|e,a.OperatorPrecedence.Cma,!1,h.NoTypes));n&&(!x.isOptionalArg()&&!d)&&this.reportParseError("Optional parameters may only be followed by other optional parameters");
d&&x.isOptionalArg()&&this.reportParseError("Varargs may not be optional or have default parameters");x.postComments=this.parseComments();x.typeExpr=C;x.limChar=this.scanner.lastTokenLimChar();x.varFlags|=t;q?q=!1:b.append(x)}k=!1;if(this.tok.tokenId==a.TokenID.Comma)s&&!d?this.tok=this.scanner.scan():(this.reportParseError("Unexpected ',' in argument list"),this.errorRecovery&&(this.tok=this.scanner.scan()));else break}f?this.chkCurTok(a.TokenID.RBrack,"Expected ']'",e|a.ErrorRecoverySet.LCurly|
a.ErrorRecoverySet.SColon):(!m||r)&&this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.LCurly|a.ErrorRecoverySet.SColon);b.limChar=this.scanner.lastTokenLimChar();return d};g.prototype.parseFncDecl=function(e,l,c,i,f,j,g,m,d,h){var k=this.scanner.leftCurlyCount,q=this.scanner.rightCurlyCount,r=this.parsingClassConstructorDefinition;this.parsingClassConstructorDefinition=!1;var s=null,t=this.scanner.startPos,w=this.scanner.pos,A=this.nestingLevel;this.nestingLevel=0;!this.style_funcInLoop&&
this.inLoop()&&this.reportParseStyleError("function declaration in loop");if(!i&&!g&&!j&&!h)if(this.tok=this.scanner.scan(),this.state=b.StartFncDecl,this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)){if(l)return this.reportParseError("Function declaration must include identifier"),this.nestingLevel=A,new a.IncompleteAST(t,this.scanner.pos)}else s=new a.Identifier(this.tok.getText()),s.minChar=this.scanner.startPos,s.limChar=this.scanner.pos,this.tok=this.scanner.scan();
else f&&(s=f);this.state=b.FncDeclName;var C=new a.ASTList,t=f=!1,x=a.hasFlag(d,a.Modifiers.Getter),D=a.hasFlag(d,a.Modifiers.Setter);if(this.tok.tokenId==a.TokenID.LParen||j&&this.tok.tokenId==a.TokenID.LBrack||h&&h.preProcessedLambdaArgs)f=this.parseFormalParameterList(e,C,!1,c,j,x,D,h?h.preProcessedLambdaArgs:null);this.state=b.FncDeclArgs;h=null;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),a.hasFlag(d,a.Modifiers.Setter)&&this.reportParseError("Property setters may not declare a return type"),
h=this.parseTypeReference(e,!0));j&&0==C.members.length&&this.reportParseError("Index signatures require a parameter type to be specified");this.state=b.FncDeclReturnType;if(l&&!this.parsingDeclareFile&&!m&&(!i||!this.ambientModule&&!this.ambientClass&&!this.inInterfaceDecl)&&this.tok.tokenId==a.TokenID.SColon)c=t=!0;l=this.inFncDecl;this.inFncDecl=!0;e=this.parseFunctionStatements(e|a.ErrorRecoverySet.RCurly,s,!1,i,C,a.AllowedElements.FunctionBody,w,c,a.Modifiers.None);this.inFncDecl=l;e.variableArgList=
f;e.isOverload=t;c||(e.fncFlags|=a.FncFlags.Definition);g&&(e.fncFlags|=a.FncFlags.Static);c&&(e.fncFlags|=a.FncFlags.Signature);j&&(e.fncFlags|=a.FncFlags.IndexerMember);e.returnTypeAnnotation=h;i&&(e.fncFlags|=a.FncFlags.Method,e.fncFlags|=a.FncFlags.ClassPropertyMethodExported);e.leftCurlyCount=this.scanner.leftCurlyCount-k;e.rightCurlyCount=this.scanner.rightCurlyCount-q;this.nestingLevel=A;this.parsingClassConstructorDefinition=r;return e};g.prototype.convertToTypeReference=function(e){var b;
switch(e.nodeType){case a.NodeType.TypeRef:return e;case a.NodeType.Name:return b=new a.TypeReference(e,0),b.minChar=e.minChar,b.limChar=e.limChar,b;case a.NodeType.Index:return(b=this.convertToTypeReference(e.operand1))?(b.arrayCount++,b.minChar=e.minChar,b.limChar=e.limChar,b):new a.AST(a.NodeType.Error)}return null};g.prototype.parseArgList=function(e){var b=new a.ASTList;b.minChar=this.scanner.startPos;this.tok=this.scanner.scan();if(this.tok.tokenId!==a.TokenID.RParen)for(;;){if(65535<b.members.length){this.reportParseError("max number of args exceeded");
break}var c=this.parseExpr(a.ErrorRecoverySet.Comma|e,a.OperatorPrecedence.Cma,!1,h.NoTypes);b.append(c);if(this.tok.tokenId!=a.TokenID.Comma)break;this.tok=this.scanner.scan()}b.limChar=this.scanner.pos;return b};g.prototype.parseBaseList=function(e,b,c,i,f){for(var j=!0,g=e;;){j&&(this.tok.tokenId==a.TokenID.IMPLEMENTS&&(i&&this.reportParseError("interfaces can not implement other types"),g=b),this.tok=this.scanner.scan(),j=!1);var m=null;if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)){var d=this.scanner.startPos,m=new a.Identifier(this.tok.getText());m.minChar=d;m.limChar=this.scanner.pos;m=this.parseNamedType(c|a.ErrorRecoverySet.LCurly,d,m,!1)}else this.reportParseError("Expected base name"),this.errorRecovery&&(m=new a.MissingIdentifier,m.minChar=this.scanner.pos,m.limChar=this.scanner.pos,m.flags|=a.ASTFlags.Error);this.tok.tokenId==a.TokenID.LParen&&(f&&this.reportParseError("Base classes may only be initialized via a 'super' call within the constructor body"),
d=this.parseArgList(c|a.ErrorRecoverySet.RParen),m=new a.CallExpression(a.NodeType.Call,m,d),this.tok=this.scanner.scan(),m.limChar=this.scanner.pos);g.append(m);!i&&(g==e&&1<e.members.length)&&this.reportParseError("A class may only extend one other class");if(this.tok.tokenId==a.TokenID.Comma)this.tok=this.scanner.scan();else if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)g=e,j=!0;else break}};g.prototype.parseClassDecl=function(e,b,c){var b=this.scanner.leftCurlyCount,
i=this.scanner.rightCurlyCount;(c&a.Modifiers.Readonly)!=a.Modifiers.None&&this.reportParseError("const modifier is implicit for class");if(this.parsingDeclareFile||this.ambientModule)c|=a.Modifiers.Ambient,c|=a.Modifiers.Exported;var f=this.ambientClass;this.ambientClass=this.parsingDeclareFile||(c&a.Modifiers.Ambient)!=a.Modifiers.None;this.tok=this.scanner.scan();var j=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(j=new a.Identifier(this.tok.getText()),j.minChar=
this.scanner.startPos,j.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("class missing name"),this.errorRecovery&&(j=new a.MissingIdentifier,j.minChar=this.scanner.pos,j.limChar=this.scanner.pos,j.flags|=a.ASTFlags.Error));var g=null,m=null;if(this.tok.tokenId==a.TokenID.EXTENDS||this.tok.tokenId==a.TokenID.IMPLEMENTS)g=new a.ASTList,m=new a.ASTList,this.parseBaseList(g,m,e,!1,!0);this.currentClassDefinition=j=new a.ClassDecl(j,new a.ASTList,g,m);this.parseClassElements(j,
e,c);if(this.ambientModule||this.parsingDeclareFile||a.hasFlag(c,a.Modifiers.Exported))j.varFlags|=a.VarFlags.Exported;if(this.ambientModule||a.hasFlag(c,a.Modifiers.Ambient))j.varFlags|=a.VarFlags.Ambient;j.varFlags|=a.VarFlags.Class;this.ambientClass=f;j.leftCurlyCount=this.scanner.leftCurlyCount-b;j.rightCurlyCount=this.scanner.rightCurlyCount-i;return j};g.prototype.parseClassElements=function(e,b,c){var i=c,f=!1,e=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",b);this.nestingLevel++;
for(var j=this.scanner.startPos,g=!1;!(this.tok.tokenId==a.TokenID.RCurly||this.tok.tokenId==a.TokenID.EOF);){var m=!0,d=a.Modifiers.Public|a.Modifiers.Private;this.tok.tokenId==a.TokenID.GET?(i&a.Modifiers.Getter&&this.reportParseError("Duplicate 'get' declaration in class body"),i&a.Modifiers.Setter&&this.reportParseError("Getter already marked as a setter"),i|=a.Modifiers.Getter):this.tok.tokenId==a.TokenID.SET?(i&a.Modifiers.Setter&&this.reportParseError("Duplicate 'set' declaration in class body"),
i&a.Modifiers.Getter&&this.reportParseError("Setter already marked as a getter"),i|=a.Modifiers.Setter):this.tok.tokenId==a.TokenID.PRIVATE?(i&d&&this.reportParseError("Multiple modifiers may not be applied to class members"),i|=a.Modifiers.Private):this.tok.tokenId==a.TokenID.PUBLIC?(i&d&&this.reportParseError("Multiple modifiers may not be applied to class members"),i|=a.Modifiers.Public):this.tok.tokenId==a.TokenID.STATIC?(i&a.Modifiers.Static&&this.reportParseError("Multiple modifiers may not be applied to class members"),
i|=a.Modifiers.Static):this.tok.tokenId==a.TokenID.CONSTRUCTOR?(i!=c&&this.reportParseError("Constructors may not have modifiers"),this.parseClassConstructorDeclaration(j,b,i),m=!1,f=!0):g||this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(f=g?i&a.Modifiers.Getter?"get":"set":this.tok.getText(),f=new a.Identifier(f),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,g?(i^=i&a.Modifiers.Getter?a.Modifiers.Getter:a.Modifiers.Setter,g=!1):this.tok=this.scanner.scan(),this.tok.tokenId==
a.TokenID.LParen?(this.parseClassMemberFunctionDeclaration(f,j,b,i),m=!1):((i&a.Modifiers.Getter||i&a.Modifiers.Setter)&&this.reportParseError("Property accessors must be functions"),f=this.parseClassMemberVariableDeclaration(f,j,!1,b,i),f.init&&f.init.nodeType==a.NodeType.FuncDecl?this.tok.tokenId==a.TokenID.RCurly&&(m=!1):f.init&&f.init.nodeType==a.NodeType.ObjectLit&&this.tok.tokenId!=a.TokenID.SColon?(m=!1,f.init.flags|=a.ASTFlags.AutomaticSemicolon):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Expected ';'"),
m=!1)),f=!0):this.tok.tokenId==a.TokenID.SUPER?this.reportParseError("Base class initializers must be the first statement in a class definition"):!g&&(i&a.Modifiers.Getter||i&a.Modifiers.Setter)&&this.tok.tokenId==a.TokenID.LParen||this.tok.tokenId==a.TokenID.Asg?(g=!0,m=!1):this.tok.tokenId!=a.TokenID.SColon&&(this.reportParseError("Unexpected '"+this.tok.getText()+"' in class definition"),f=!0);m&&(this.tok=this.scanner.scan());f&&(i=c,j=this.scanner.startPos,f=!1)}b=this.scanner.pos;this.tok.tokenId==
a.TokenID.RCurly&&(this.currentClassDefinition.definitionMembers.members.length||(this.currentClassDefinition.preComments=this.parseComments()),this.tok=this.scanner.scan());this.nestingLevel--;this.currentClassDefinition.members.minChar=e;this.currentClassDefinition.members.limChar=b;this.currentClassDefinition.limChar=b;this.currentClassDefinition=null};g.prototype.parseClassConstructorDeclaration=function(e,b,c){this.parsingClassConstructorDefinition=!0;var i=this.parsingDeclareFile||a.hasFlag(c,
a.Modifiers.Ambient),f=new a.ASTList,j=!1,g=this.parseComments();this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.LParen&&(j=this.parseFormalParameterList(b,f,!0,i,!1,!1,!1,null));var m=i||this.tok.tokenId==a.TokenID.SColon;if(m)for(var d=0;d<f.members.length;d++)a.hasFlag(f.members[d].varFlags,a.VarFlags.Property)&&this.reportParseError("Overload or ambient signatures may not specify parameter properties");m||(this.currentClassDefinition.constructorNestingLevel=this.nestingLevel+1);e=this.parseFunctionStatements(b|
a.ErrorRecoverySet.RCurly,this.currentClassDefinition.name,!0,!1,f,a.AllowedElements.ClassMembers,e,m,c);e.preComments=g;m&&!i&&(e.isOverload=!0);e.variableArgList=j;this.currentClassDecl=null;e.returnTypeAnnotation=this.convertToTypeReference(this.currentClassDefinition.name);e.classDecl=this.currentClassDefinition;i&&(e.fncFlags|=a.FncFlags.Ambient);m&&(e.fncFlags|=a.FncFlags.Signature);if(this.ambientModule||a.hasFlag(c,a.Modifiers.Exported))e.fncFlags|=a.FncFlags.Exported;this.currentClassDefinition.constructorDecl&&
!i&&(!this.currentClassDefinition.constructorDecl.isSignature()&&!e.isSignature())&&this.reportParseError("Duplicate constructor definition");if(i||!e.isSignature())this.currentClassDefinition.constructorDecl=e;e.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=e;this.parsingClassConstructorDefinition=!1;e.postComments=this.parseComments();return e};g.prototype.parseClassMemberVariableDeclaration=function(e,
b,c,i,f){var j=new a.VarDecl(e,this.nestingLevel);j.minChar=b;b=!1;j.preComments=this.parseComments();this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),j.typeExpr=this.parseTypeReference(i|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(this.parsingDeclareFile||a.hasFlag(f,a.Modifiers.Ambient))if(this.reportParseError("context does not permit variable initializer"),this.errorRecovery)return this.skip(i),j.flags|=a.ASTFlags.Error,j.limChar=
this.scanner.lastTokenLimChar(),j;this.tok=this.scanner.scan();j.init=this.parseExpr(a.ErrorRecoverySet.Comma|i,a.OperatorPrecedence.Cma,!0,h.NoTypes);j.limChar=j.init.limChar;this.currentClassDefinition.varFlags|=a.VarFlags.ClassSuperMustBeFirstCallInConstructor}else j.limChar=this.scanner.pos;f&a.Modifiers.Static&&(j.varFlags|=a.VarFlags.Static,b=!0);j.varFlags=(f&a.Modifiers.Private)!=a.Modifiers.None?j.varFlags|a.VarFlags.Private:j.varFlags|a.VarFlags.Public;j.varFlags|=a.VarFlags.Property;c&&
(j.varFlags|=a.VarFlags.ClassConstructorProperty);!c&&!b&&(j.varFlags|=a.VarFlags.ClassBodyProperty);this.currentClassDefinition.knownMemberNames[e.text]=!0;c||(this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=j);this.currentClassDefinition.allMemberDefinitions.members[this.currentClassDefinition.allMemberDefinitions.members.length]=j;j.postComments=this.parseComments();return j};g.prototype.parseClassMemberFunctionDeclaration=function(e,
b,c,i){var f=a.hasFlag(i,a.Modifiers.Getter)||a.hasFlag(i,a.Modifiers.Setter),j=a.hasFlag(i,a.Modifiers.Static),g=this.ambientModule||a.hasFlag(i,a.Modifiers.Ambient),c=c|a.ErrorRecoverySet.RParen,m=this.parseComments();f&&i&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient classes");c=this.parseFncDecl(c,!0,g,!0,e,!1,j,g,i,null);if(c.nodeType==a.NodeType.Error)return c;c.preComments=m;c.minChar=b;null!==c.bod&&(c.limChar=c.bod.limChar);c.fncFlags=i&a.Modifiers.Private?
c.fncFlags|a.FncFlags.Private:c.fncFlags|a.FncFlags.Public;j&&(c.fncFlags|=a.FncFlags.Static);f&&(a.hasFlag(i,a.Modifiers.Getter)?(c.fncFlags|=a.FncFlags.GetAccessor,c.hint="get"+c.name.text):(c.fncFlags|=a.FncFlags.SetAccessor,c.hint="set"+c.name.text),c.fncFlags|=a.FncFlags.IsFunctionExpression,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"));c.fncFlags|=a.FncFlags.ClassMethod;this.currentClassDefinition.knownMemberNames[e.text]=
!0;this.currentClassDefinition.definitionMembers.members[this.currentClassDefinition.definitionMembers.members.length]=c;c.postComments=this.parseComments();return c};g.prototype.parseInterfaceMember=function(e){var b=this.scanner.startPos,c=this.parsePropertyDecl(e,a.Modifiers.Public,!0,!1);c.nodeType==a.NodeType.VarDecl&&this.chkCurTok(a.TokenID.SColon,"Expected ';'",e);c&&(c.minChar=b);return c};g.prototype.parseInterfaceMembers=function(e,b){for(;;){switch(this.tok.tokenId){case a.TokenID.RCurly:case a.TokenID.EOF:b.limChar=
this.scanner.pos;return}var c=this.parseInterfaceMember(e|a.ErrorRecoverySet.TypeScriptS);c&&b.append(c)}};g.prototype.parseInterfaceDecl=function(e,b){var c=this.scanner.leftCurlyCount,i=this.scanner.rightCurlyCount;this.tok=this.scanner.scan();var f=null;this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)?(f=new a.Identifier(this.tok.getText()),f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,this.tok=this.scanner.scan()):(this.reportParseError("interface missing name"),
this.errorRecovery&&(f=new a.MissingIdentifier,f.minChar=this.scanner.pos,f.limChar=this.scanner.pos,f.flags|=a.ASTFlags.Error));var j=null;this.tok.tokenId==a.TokenID.EXTENDS&&(j=new a.ASTList,j.minChar=this.scanner.startPos,this.parseBaseList(j,null,e,!0,!1));var g=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",e|a.ErrorRecoverySet.TypeScriptS);var m=new a.ASTList;m.minChar=g;g=this.inInterfaceDecl;this.inInterfaceDecl=!0;this.parseInterfaceMembers(e|a.ErrorRecoverySet.RCurly,
m);this.inInterfaceDecl=g;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);f=new a.TypeDecl(a.NodeType.Interface,f,m,null,j,null);a.hasFlag(b,a.Modifiers.Private)&&(f.varFlags|=a.VarFlags.Private);a.hasFlag(b,a.Modifiers.Public)&&(f.varFlags|=a.VarFlags.Public);if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Exported))f.varFlags|=a.VarFlags.Exported;f.leftCurlyCount=this.scanner.leftCurlyCount-c;f.rightCurlyCount=this.scanner.rightCurlyCount-i;return f};g.prototype.makeVarDecl=function(e,b){var c=
new a.VarDecl(e,b),i=this.topVarList();i&&i.append(c);return c};g.prototype.parsePropertyDecl=function(e,b,c,i){var f=null,j=this.scanner.startPos,g=j,m=!1,d=!1,k=null!=this.prevIDTok,n=a.hasFlag(b,a.Modifiers.Getter)||a.hasFlag(b,a.Modifiers.Setter);if(this.parsingDeclareFile||this.ambientModule||a.hasFlag(b,a.Modifiers.Ambient))c=!0;if(this.tok.tokenId==a.TokenID.LParen&&!k)!c&&!i&&(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery&&(this.skip(e),f=new a.MissingIdentifier));
else if(this.tok.tokenId==a.TokenID.NEW)c&&(this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.LParen&&(m=!0)),m||(c||(this.tok=this.scanner.scan()),f=new a.Identifier("new"),f.minChar=this.scanner.pos-3,g=f.limChar=this.scanner.pos);else if(this.tok.tokenId==a.TokenID.LBrack&&c)d=!0,f=new a.Identifier("__item");else if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToIDName(this.tok)&&!k){if(this.reportParseError("Expected identifier in property declaration"),this.errorRecovery)return b=this.scanner.startPos,
i=this.scanner.pos,this.skip(e&~a.ErrorRecoverySet.Comma),this.scanner.pos==i&&(this.tok=this.scanner.scan()),e=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),e.flags|=a.ASTFlags.Error,e.minChar=b,e.limChar=this.scanner.lastTokenLimChar(),e}else k?(f=new a.Identifier(this.prevIDTok.getText()),f.minChar=this.scanner.lastTokenLimChar()-3,f.limChar=this.scanner.lastTokenLimChar(),g=f.limChar,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.getText()==f.text&&this.tok!=this.prevIDTok&&(this.tok=this.scanner.scan()),this.prevIDTok=null):(f=new a.Identifier(this.tok.getText()),f.minChar=this.scanner.startPos,g=f.limChar=this.scanner.pos,this.tok=this.scanner.scan());this.tok.tokenId==a.TokenID.QMark&&(this.inInterfaceDecl&&f?f.flags|=a.ASTFlags.OptionalName:this.reportParseError("Optional properties may only be declared on interface or object types"),this.tok=this.scanner.scan());if(this.tok.tokenId==a.TokenID.LParen||d&&this.tok.tokenId==
a.TokenID.LBrack){k=e|a.ErrorRecoverySet.RParen;d&&(k=e|a.ErrorRecoverySet.RBrack);e=this.parseFncDecl(k,!0,c,!this.inFncDecl,f,d,i,this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient),b,null);if(e.nodeType==a.NodeType.Error)return e;e.name&&(e.name.minChar=j,e.name.limChar=g);(b&a.Modifiers.Public)!=a.Modifiers.None&&(e.fncFlags|=a.FncFlags.Public);(b&a.Modifiers.Private)!=a.Modifiers.None&&(e.fncFlags|=a.FncFlags.Private);i&&(e.fncFlags|=a.FncFlags.Static);if(this.parsingDeclareFile||a.hasFlag(b,
a.Modifiers.Ambient))e.fncFlags|=a.FncFlags.Ambient;n&&(a.hasFlag(b,a.Modifiers.Getter)?(e.fncFlags|=a.FncFlags.GetAccessor,e.hint="get"+e.name.text):(e.fncFlags|=a.FncFlags.SetAccessor,e.hint="set"+e.name.text),e.fncFlags|=a.FncFlags.IsFunctionExpression,b&a.Modifiers.Ambient&&this.reportParseError("Property accessors may not be declared in ambient types"));null==f&&(m?(e.fncFlags|=a.FncFlags.ConstructMember,e.hint="_construct",e.classDecl=this.currentClassDecl):(e.hint="_call",e.fncFlags|=a.FncFlags.CallMember));
return e}f=new a.VarDecl(f,this.nestingLevel);f.minChar=j;this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),f.typeExpr=this.parseTypeReference(e|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1));if(this.tok.tokenId==a.TokenID.Asg){if(c&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(e),f.flags|=a.ASTFlags.Error,f.limChar=this.scanner.lastTokenLimChar(),f;this.tok=this.scanner.scan();f.init=this.parseExpr(a.ErrorRecoverySet.Comma|
e,a.OperatorPrecedence.Cma,!0,h.NoTypes);f.limChar=f.init.limChar;f.init.nodeType==a.NodeType.FuncDecl?(e=f.init,e.hint=f.id.text,e.boundToProperty=f):n&&this.reportParseError("Accessors may only be functions")}else f.limChar=this.scanner.pos;(b&a.Modifiers.Readonly)!=a.Modifiers.None&&(f.varFlags|=a.VarFlags.Readonly);i&&(f.varFlags|=a.VarFlags.Static);(b&a.Modifiers.Public)!=a.Modifiers.None&&(f.varFlags|=a.VarFlags.Public);(b&a.Modifiers.Private)!=a.Modifiers.None&&(f.varFlags|=a.VarFlags.Private);
f.varFlags|=a.VarFlags.Property;return f};g.prototype.parseVarDecl=function(e,b,c,i,f){var j=a.hasFlag(b,a.Modifiers.Readonly),g=this.scanner.startPos;this.tok=this.scanner.scan();for(var m=null,d=null,k=!1,n=this.parseComments();;){if(this.tok.tokenId!=a.TokenID.ID&&!a.convertTokToID(this.tok,this.strictMode)&&(this.reportParseError("Expected identifier in variable declaration"),this.errorRecovery))return m=new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),m.minChar=g,this.skip(e),m.flags|=
a.ASTFlags.Error,m.limChar=this.scanner.lastTokenLimChar(),m;m=this.tok.getText();this.strictMode&&"eval"==m&&this.reportParseError("can not name a variable eval in strict mode");m=this.makeVarDecl(new a.Identifier(m),this.nestingLevel);m.id.minChar=this.scanner.startPos;m.id.limChar=this.scanner.pos;m.preComments=n;f&&(m.varFlags|=a.VarFlags.Static);a.hasFlag(b,a.Modifiers.Readonly)&&(m.varFlags|=a.VarFlags.Readonly);if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Ambient))m.varFlags|=a.VarFlags.Ambient;
if(this.parsingDeclareFile||a.hasFlag(b,a.Modifiers.Exported))m.varFlags|=a.VarFlags.Exported;m.minChar=g;d&&d.append(m);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.Colon&&(this.tok=this.scanner.scan(),g=this.inFncDecl,this.inFncDecl=!1,m.typeExpr=this.parseTypeReference(e|a.ErrorRecoverySet.Asg|a.ErrorRecoverySet.Comma,!1),this.inFncDecl=g);if(this.tok.tokenId==a.TokenID.Asg){if(i&&(this.reportParseError("context does not permit variable initializer"),this.errorRecovery))return this.skip(e),
m.flags|=a.ASTFlags.Error,m;this.tok=this.scanner.scan();m.init=this.parseExpr(a.ErrorRecoverySet.Comma|e,a.OperatorPrecedence.Cma,c,h.NoTypes);m.limChar=m.init.limChar;m.init.nodeType==a.NodeType.FuncDecl&&(m.init.hint=m.id.text)}else j&&this.reportParseError("const declaration requires initializer"),m.limChar=this.scanner.pos;m.postComments=this.parseCommentsForLine(this.scanner.line);if(this.tok.tokenId!=a.TokenID.Comma)return d?(d.limChar=m.limChar,d):m;k||(d=new a.ASTList,d.minChar=m.minChar,
d.append(m),k=!0);this.tok=this.scanner.scan();g=this.scanner.startPos}};g.prototype.parseMemberList=function(e){var b=new a.ASTList;if(this.tok.tokenId==a.TokenID.RCurly)return b;for(var c=null,i=null,f=null,j=null,g=this.scanner.startPos,m=!1,d=!1,f=null,k=0,n=0;;){var q=!1;this.tok.tokenId==a.TokenID.GET||this.tok.tokenId==a.TokenID.SET?(m=this.tok.tokenId==a.TokenID.SET,f=this.tok,k=this.scanner.startPos,n=this.scanner.pos,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?
(c=m?"set":"get",c+=this.tok.getText(),i=new a.Identifier(this.tok.getText()),i.minChar=this.scanner.startPos,q=!0,a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater")):this.tok.tokenId!=a.TokenID.Colon?this.reportParseError("Expected identifier, string or number as accessor name"):(d=!0,i=new a.Identifier(f.getText()),i.minChar=k,i.limChar=n)):this.tok.tokenId==a.TokenID.ID||a.convertTokToIDName(this.tok)?(c=this.tok.getText(),
i=new a.Identifier(c),i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.QString?(c=this.tok.getText(),i=new a.StringLiteral(c),i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos):this.tok.tokenId==a.TokenID.NumberLit?(c=this.tok.value.toString(),i=new a.StringLiteral(c),i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos):(this.reportParseError("Expected identifier, string or number as member name"),this.errorRecovery&&(i=new a.MissingIdentifier,
i.minChar=this.scanner.startPos,i.flags|=a.ASTFlags.Error,this.skip(e|a.ErrorRecoverySet.Comma),i.limChar=this.scanner.lastTokenLimChar()));d?d=!1:this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.QMark&&(i.flags|=a.ASTFlags.OptionalName,this.tok=this.scanner.scan());if(q)j=new a.ASTList,this.parseFormalParameterList(e|a.ErrorRecoverySet.RParen,j,!1,!0,!1,!m,m,null),f=this.parseFunctionStatements(e|a.ErrorRecoverySet.RCurly,i,!1,!0,j,a.AllowedElements.FunctionDecls,this.scanner.startPos,!1,
a.Modifiers.None),m&&f.returnTypeAnnotation&&this.reportParseError("Property setters may not declare a return type"),f.fncFlags|=m?a.FncFlags.SetAccessor:a.FncFlags.GetAccessor,f.fncFlags|=a.FncFlags.IsFunctionExpression,f.hint=c,j=new a.BinaryExpression(a.NodeType.Member,i,f),j.minChar=i.minChar,f.nodeType==a.NodeType.FuncDecl&&(f.hint=c);else if(this.tok.tokenId==a.TokenID.Colon)this.tok=this.scanner.scan(),f=this.parseExpr(a.ErrorRecoverySet.Comma|e,a.OperatorPrecedence.Cma,!0,h.NoTypes),f.nodeType==
a.NodeType.TypeRef&&this.reportParseError("Expected 'new' on array declaration in member definition"),j=new a.BinaryExpression(a.NodeType.Member,i,f),j.minChar=i.minChar,f.nodeType==a.NodeType.FuncDecl&&(f.hint=c);else if(this.reportParseError("Expected ':' in member definition"),this.errorRecovery)return this.skip(e),b.flags|=a.ASTFlags.Error,b.minChar=g,b.limChar=this.scanner.lastTokenLimChar(),b;c=null;b.append(j);j.limChar=this.scanner.lastTokenLimChar();if(this.tok.tokenId!=a.TokenID.Comma)break;
else this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RCurly)break}j&&(b.limChar=j.limChar);b.minChar=g;return b};g.prototype.parseArrayList=function(e){var b=null;if(this.tok.tokenId==a.TokenID.RBrack)return b;b=new a.ASTList;b.minChar=this.scanner.startPos;for(var c;;){c=this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RBrack?new a.AST(a.NodeType.EmptyExpr):this.parseExpr(a.ErrorRecoverySet.Comma|e,a.OperatorPrecedence.Cma,!0,h.NoTypes);b.append(c);if(this.tok.tokenId!=
a.TokenID.Comma)break;this.tok=this.scanner.scan()}b.limChar=this.scanner.lastTokenLimChar();return b};g.prototype.parseArrayLiteral=function(e){var b=null;return b=new a.UnaryExpression(a.NodeType.ArrayLit,this.parseArrayList(e))};g.prototype.parseTerm=function(e,b,c,i){var f=null,j=!1,g=!1,m=this.scanner.startPos,d=this.scanner.pos,k=!1;switch(this.tok.tokenId){case a.TokenID.NUMBER:case a.TokenID.BOOL:case a.TokenID.ANY:case a.TokenID.STRING:j=new a.Identifier(a.tokenTable[this.tok.tokenId].text);
f=a.hasFlag(c,h.Primitive)?new a.TypeReference(j,0):j;j=!0;f.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.THIS:f=new a.AST(a.NodeType.This);f.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.SUPER:f=new a.AST(a.NodeType.Super);f.minChar=m;this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar();break;case a.TokenID.TRUE:f=new a.AST(a.NodeType.True);this.tok=this.scanner.scan();f.minChar=m;break;case a.TokenID.FALSE:f=
new a.AST(a.NodeType.False);this.tok=this.scanner.scan();f.minChar=m;break;case a.TokenID.NULL:f=new a.AST(a.NodeType.Null);this.tok=this.scanner.scan();f.minChar=m;break;case a.TokenID.NEW:m=this.scanner.pos;this.tok=this.scanner.scan();f=new a.CallExpression(a.NodeType.New,this.parseTerm(e,!1,h.AllSimpleTypes,i),null);f.minChar=m;d=this.scanner.lastTokenLimChar();g=!0;break;case a.TokenID.FUNCTION:m=this.scanner.pos,f=this.parseFncDecl(e,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,null),f.fncFlags|=
a.FncFlags.IsFunctionExpression,f.minChar=m,d=this.scanner.lastTokenLimChar(),f.limChar=d}if(null==f&&(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))j=this.tok.getText(),f=this.createRef(j,m),j=!0,f.minChar=m,this.tok=this.scanner.scan(),this.tok.tokenId==a.TokenID.QMark?f.flags|=a.ASTFlags.PossibleOptionalParameter:this.tok.tokenId==a.TokenID.Arrow&&(k=!0),d=this.scanner.lastTokenLimChar();i&&this.chkCurTok(a.TokenID.GT,"Expected '>'",e);if(null==f)switch(this.tok.tokenId){case a.TokenID.LParen:m=
this.scanner.pos;k=this.scanner.previousToken().tokenId;this.tok=this.scanner.scan();(k=k==a.TokenID.LParen||k==a.TokenID.Comma||k==a.TokenID.EQ||k==a.TokenID.Colon)&&this.tok.tokenId==a.TokenID.RParen?(k=!0,this.tok=this.scanner.scan()):(f=this.parseExpr(e|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes),d=this.scanner.lastTokenLimChar(),k=k&&(f.nodeType==a.NodeType.Name||f.nodeType==a.NodeType.Comma)&&(this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.QMark));f&&!k&&
(this.chkCurTok(a.TokenID.RParen,"Expected ')'",e),f.isParenthesized=!0);break;case a.TokenID.NumberLit:d=this.tok;this.tok=this.scanner.scan();f=new a.NumberLiteral(d.value);f.minChar=m;d=this.scanner.lastTokenLimChar();break;case a.TokenID.QString:f=new a.StringLiteral(this.tok.getText());this.tok=this.scanner.scan();f.minChar=m;d=this.scanner.lastTokenLimChar();break;case a.TokenID.Regex:f=new a.RegexLiteral(this.tok.regex);this.tok=this.scanner.scan();f.minChar=m;d=this.scanner.lastTokenLimChar();
break;case a.TokenID.LBrack:m=this.scanner.startPos;this.tok=this.scanner.scan();f=this.parseArrayLiteral(a.ErrorRecoverySet.RBrack|e);f.minChar=m;d=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,"Expected ']'",e);break;case a.TokenID.LCurly:m=this.scanner.startPos;this.tok=this.scanner.scan();i=this.parseMemberList(a.ErrorRecoverySet.RCurly|e);this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);f=new a.UnaryExpression(a.NodeType.ObjectLit,i);f.minChar=m;d=this.scanner.lastTokenLimChar();i.minChar=
m;i.limChar=d;break;case a.TokenID.LT:m=this.scanner.startPos;this.tok=this.scanner.scan();i=this.parseTypeReference(a.ErrorRecoverySet.BinOp,!1);this.chkCurTok(a.TokenID.GT,"Expected '>'",e);f=new a.UnaryExpression(a.NodeType.TypeAssertion,this.parseExpr(e,a.OperatorPrecedence.Uni,!1,h.NoTypes));f.castTerm=i;break;default:if(this.prevExpr&&a.hasFlag(this.prevExpr.flags,a.ASTFlags.PossibleOptionalParameter))k=!0,f=this.prevExpr;else if(this.reportParseError("Check format of expression term"),this.errorRecovery){f=
new a.MissingIdentifier;f.minChar=m;f.flags|=a.ASTFlags.Error;this.skip(e|a.ErrorRecoverySet.Postfix);if(this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))f.text=this.tok.getText(),this.tok=this.scanner.scan();d=this.scanner.lastTokenLimChar()}}k&&(this.tok.tokenId==a.TokenID.Arrow||this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Comma||this.tok.tokenId==a.TokenID.RParen?(f=this.parseFncDecl(e,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:f}),
f.fncFlags|=a.FncFlags.IsFunctionExpression,f.fncFlags|=a.FncFlags.IsFatArrowFunction,f.minChar=m,d=this.scanner.lastTokenLimChar(),f.limChar=d):f&&(f.isParenthesized=!0));j&&c!=h.NoTypes&&(c|=h.ArraySuffix);return(e=this.parsePostfixOperators(e,f,b,g,c,m,d))?(j&&e.nodeType==a.NodeType.Index&&null==e.operand2&&(e=this.convertToTypeReference(e)),e.minChar=m,e.limChar=a.max(e.limChar,this.scanner.lastTokenLimChar()),e):new a.AST(a.NodeType.Error)};g.prototype.parseExpr=function(e,b,c,i){var f=null,
j=a.lookupToken(this.tok.tokenId),g=!0,d=null,p=this.scanner.startPos,k=this.parseComments(),n=!1;if(void 0!=j&&j.unopNodeType!=a.NodeType.None)g=!1,this.tok=this.scanner.scan(),i=this.parseExpr(a.ErrorRecoverySet.BinOp|e,j.unopPrecedence,c,h.NoTypes),j.unopNodeType==a.NodeType.Pos&&i.nodeType==a.NodeType.NumberLit?f=i:j.unopNodeType==a.NodeType.Neg&&i.nodeType==a.NodeType.NumberLit?(i.value=-i.value,0==i.value&&(i.isNegativeZero=!0),f=i):(f=new a.UnaryExpression(j.unopNodeType,i),f.limChar=i.limChar),
f.minChar=p;else{f=this.parseTerm(a.ErrorRecoverySet.BinOp|a.ErrorRecoverySet.AddOp|e,!0,i,!1);if(f.nodeType==a.NodeType.Name)d=f.text;else if(f.nodeType==a.NodeType.Dot){j=!1;if(this.inferPropertiesFromThisAssignment&&((this.tok.tokenId==a.TokenID.Colon||this.tok.tokenId==a.TokenID.Asg)&&this.parsingClassConstructorDefinition&&this.nestingLevel==this.currentClassDefinition.constructorNestingLevel&&f.operand1.nodeType==a.NodeType.This)&&f.operand2.nodeType==a.NodeType.Name)i=f.operand2,this.currentClassDefinition.knownMemberNames[i.text]||
(f=this.parseClassMemberVariableDeclaration(i,f.minChar,!0,e,a.Modifiers.Public),j=!0);if(!j){for(j=f;j.nodeType==a.NodeType.Dot;)j=j.operand2;j.nodeType==a.NodeType.Name&&(d=j.text)}}if(!this.scanner.lastTokenHadNewline()&&(this.tok.tokenId==a.TokenID.Inc||this.tok.tokenId==a.TokenID.Dec))g=!1,j=f,f=new a.UnaryExpression(this.tok.tokenId==a.TokenID.Inc?a.NodeType.IncPost:a.NodeType.DecPost,j),f.limChar=this.scanner.pos,f.minChar=j.minChar,this.tok=this.scanner.scan()}for(;;){j=a.lookupToken(this.tok.tokenId);
if(void 0==j||j.binopNodeType==a.NodeType.None)break;if(!c&&j.binopNodeType==a.NodeType.In)break;if(j.binopPrecedence==a.OperatorPrecedence.Asg){if(j.binopPrecedence<b)break;g||this.reportParseError("illegal assignment")}else if(j.binopPrecedence<=b)break;this.tok=this.scanner.scan();g=!1;j.binopNodeType==a.NodeType.QMark?(this.prevExpr=f,j=this.parseExpr(e|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.Asg,c,h.NoTypes),this.prevExpr=null,j.nodeType==a.NodeType.FuncDecl&&a.hasFlag(j.fncFlags,a.FncFlags.IsFatArrowFunction)?
(f=j,n=!0):(this.chkCurTok(a.TokenID.Colon,"Expected :",e|a.ErrorRecoverySet.ExprStart),f=new a.TrinaryExpression(a.NodeType.QMark,f,j,this.parseExpr(e|a.ErrorRecoverySet.BinOp,a.OperatorPrecedence.Asg,c,h.NoTypes)))):(j=new a.BinaryExpression(j.binopNodeType,f,this.parseExpr(e|a.ErrorRecoverySet.BinOp,j.binopPrecedence,c,h.NoTypes)),j.operand2.nodeType==a.NodeType.FuncDecl&&(j.operand2.hint=d),j.minChar=f.minChar,j.limChar=this.scanner.lastTokenLimChar(),d=null,f=j)}g&&(f.flags|=a.ASTFlags.Writeable);
n||(f.minChar=p,f.limChar=a.max(f.limChar,this.scanner.lastTokenLimChar()),f.preComments=k,f.postComments=this.parseCommentsForLine(this.scanner.line));return f};g.prototype.parsePostfixOperators=function(e,b,c,i,f,j,g){b||(b=new a.AST(a.NodeType.EmptyExpr),b.isParenthesized=!0);b.minChar=j;for(b.limChar=g;;)switch(this.tok.tokenId){case a.TokenID.LParen:if(i)b.args=this.parseArgList(e),i=!1;else{if(!c)return b;b=new a.CallExpression(a.NodeType.Call,b,this.parseArgList(e));b.minChar=j}b.limChar=this.scanner.pos;
this.chkCurTok(a.TokenID.RParen,"Expected ')'",e);break;case a.TokenID.LBrack:this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.RBrack&&a.hasFlag(f,h.ArraySuffix)){this.tok=this.scanner.scan();b.nodeType==a.NodeType.TypeRef?b.arrayCount++:b=new a.BinaryExpression(a.NodeType.Index,b,null);b.limChar=this.scanner.pos;break}b=new a.BinaryExpression(a.NodeType.Index,b,this.parseExpr(e|a.ErrorRecoverySet.RBrack,a.OperatorPrecedence.No,!0,h.NoTypes));b.minChar=j;b.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RBrack,
"Expected ']'",e);break;case a.TokenID.Dot:g=null;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.ID||!this.scanner.lastTokenHadNewline()&&a.convertTokToIDName(this.tok))b.flags|=a.ASTFlags.DotLHS,g=this.createRef(this.tok.getText(),this.scanner.startPos),g.limChar=this.scanner.pos,this.tok=this.scanner.scan();else{this.reportParseError("Expected identifier following dot");if(this.errorRecovery)return this.skip(e),b.flags|=a.ASTFlags.Error|a.ASTFlags.DotLHS,b;g=new a.MissingIdentifier}b=
new a.BinaryExpression(a.NodeType.Dot,b,g);b.minChar=j;b.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.Arrow:b=this.parseFncDecl(e,!1,!1,!1,null,!1,!1,!1,a.Modifiers.None,{preProcessedLambdaArgs:b});b.fncFlags|=a.FncFlags.IsFunctionExpression;b.minChar=j;b.limChar=this.scanner.lastTokenLimChar();break;default:return b}};g.prototype.parseTry=function(b,l,c,i){var f=this.scanner.startPos,j=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{'"),
this.errorRecovery))return b.minChar=f,b.limChar=this.scanner.lastTokenLimChar(),b.flags|=a.ASTFlags.Error,b;b.body=this.parseStatement(l,c,i);b.minChar=f;b.limChar=b.body.limChar;b.preComments=j;b.postComments=this.parseComments();return b};g.prototype.parseCatch=function(b,l,c){var i=this.scanner.startPos,f=this.parseComments();this.tok=this.scanner.scan();this.chkCurTok(a.TokenID.LParen,"Expected '('",b|a.ErrorRecoverySet.ExprStart);if(this.tok.tokenId!=a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode))if(this.reportParseError("Expected identifier in catch header"),this.errorRecovery)return this.skip(b),i=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos,i.flags|=a.ASTFlags.Error,i;var j=new a.VarDecl(new a.Identifier(this.tok.getText()),this.nestingLevel);j.id.minChar=this.scanner.startPos;j.id.limChar=this.scanner.pos;j.minChar=j.id.minChar;j.limChar=j.id.limChar;this.tok=
this.scanner.scan();this.chkCurTok(a.TokenID.RParen,"Expected ')'",b|a.ErrorRecoverySet.StmtStart);if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start catch body"),this.errorRecovery))return this.skip(b),i=new a.Catch(new a.VarDecl(new a.MissingIdentifier,this.nestingLevel),new a.Statement(a.NodeType.Empty)),i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos,i.flags|=a.ASTFlags.Error,i;b=this.parseStatement(b,l,c);j=new a.Catch(j,b);j.minChar=i;j.limChar=b.limChar;
j.preComments=f;j.postComments=this.parseComments();return j};g.prototype.parseFinally=function(b,l,c){var i=this.scanner.startPos,f=this.parseComments();this.tok=this.scanner.scan();if(this.tok.tokenId!=a.TokenID.LCurly&&(this.reportParseError("Expected '{' to start body of finally statement"),this.errorRecovery))return this.skip(b),i=new a.Finally(new a.Statement(a.NodeType.Empty)),i.flags|=a.ASTFlags.Error,i.minChar=this.scanner.startPos,i.limChar=this.scanner.pos,i;b=this.parseStatement(b,l,c);
b=new a.Finally(b);b.minChar=i;b.limChar=b.body.limChar;b.preComments=f;b.postComments=this.parseComments();return b};g.prototype.parseTryCatchFinally=function(b,l,c,i){var f=new a.Try(null),j=this.scanner.startPos;this.pushStmt(f,i);this.parseTry(f,b|a.ErrorRecoverySet.Catch,l,c);this.popStmt();var g=i=null;this.tok.tokenId==a.TokenID.CATCH&&(g=this.parseCatch(b|a.ErrorRecoverySet.Catch,l,c),i=new a.TryCatch(f,g),i.minChar=f.minChar,i.limChar=g.limChar);if(this.tok.tokenId!=a.TokenID.FINALLY)return null==
i?(this.reportParseError("try with neither catch nor finally"),this.errorRecovery?(f=new a.TryFinally(f,new a.Finally(new a.AST(a.NodeType.Empty))),f.flags|=a.ASTFlags.Error,f.minChar=this.scanner.startPos,f.limChar=this.scanner.pos,f):new a.TryFinally(f,new a.Finally(new a.AST(a.NodeType.Empty)))):i;i&&(f=i);b=this.parseFinally(b,l,c);g=new a.TryFinally(f,b);g.minChar=j;g.limChar=b.limChar;return g};g.prototype.parseStatement=function(e,l,c){function i(){return a.hasFlag(p,a.Modifiers.Ambient)||
a.hasFlag(c,a.Modifiers.Ambient)}function f(){a.hasFlag(p,a.Modifiers.Exported)&&this.reportError("Statement may not be exported")}var j=null,g=null,d,p=a.Modifiers.None,k=this.scanner.startPos,n=!1,q=!1;d=null;var r=this.parseComments();for(this.state=b.StartStatement;;){switch(this.tok.tokenId){case a.TokenID.EOF:j=new a.AST(a.NodeType.Error);j.minChar=k;j.limChar=this.scanner.pos;break;case a.TokenID.FUNCTION:this.inStaticFnc&&this.reportParseError("Ambient static function delarations may only contain other ambient static function declarations");
if(this.parsingDeclareFile||i()||this.ambientModule){this.tok=this.scanner.scan();d=this.parsePropertyDecl(e|a.ErrorRecoverySet.SColon,p,!0,!1);if(d.nodeType==a.NodeType.VarDecl)this.reportParseError("function keyword can only introduce function declaration");else if(d.nodeType==a.NodeType.FuncDecl&&(d.fncFlags,a.FncFlags.IsFatArrowFunction))q=!0;j=d}else j=this.parseFncDecl(e,!0,!1,!1,null,!1,!1,i(),p,null),a.hasFlag(j.fncFlags,a.FncFlags.IsFatArrowFunction)&&(q=!0),this.ambientModule&&this.reportParseError("function declaration not permitted within ambient module"),
a.hasFlag(p,a.Modifiers.Exported)&&(j.fncFlags|=a.FncFlags.Exported);break;case a.TokenID.MODULE:(l&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):j=this.parseModuleDecl(e,p);break;case a.TokenID.IMPORT:(l&a.AllowedElements.ModuleDecls)==a.AllowedElements.None?(this.reportParseError("module not allowed in this context"),
this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):j=this.parseImportDecl(e,p);break;case a.TokenID.EXPORT:(l&a.AllowedElements.ModuleDecls)==a.AllowedElements.None&&(this.reportParseError("'export' statements are only allowed at the global and module levels"),this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar());this.topLevel&&(this.hasTopLevelImportOrExport=!0);p|=a.Modifiers.Exported;
this.tok=this.scanner.scan();break;case a.TokenID.PRIVATE:p|=a.Modifiers.Private;this.tok=this.scanner.scan();if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),k=this.scanner.pos,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=
this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),j=new a.Identifier(this.tok.getText()),j.minChar=this.scanner.startPos,j.limChar=this.scanner.pos,this.tok=this.scanner.scan(),j=this.parseClassMemberVariableDeclaration(j,k,this.parsingClassConstructorDefinition,e,p));else if(this.tok.tokenId!=a.TokenID.INTERFACE){if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<
a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))p|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,
this.strictMode)))p|=a.Modifiers.Setter,this.prevIDTok=null;d=this.parsePropertyDecl(e|a.ErrorRecoverySet.SColon,p,i(),!1);if(d.nodeType==a.NodeType.VarDecl||d.nodeType==a.NodeType.FuncDecl&&a.hasFlag(d.fncFlags,a.FncFlags.IsFatArrowFunction))q=!0;j=d}break;case a.TokenID.PUBLIC:if(this.parsingClassConstructorDefinition)this.inferPropertiesFromThisAssignment||this.reportParseError("Property declarations are not permitted within constructor bodies"),this.tok=this.scanner.scan(),k=this.scanner.pos,
p|=a.Modifiers.Public,this.inferPropertiesFromThisAssignment&&(this.tok.tokenId!=a.TokenID.THIS||(this.tok=this.scanner.scan()).tokenId!=a.TokenID.Dot)?(this.reportParseError("Expected 'this.' for property declaration"),this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):(this.tok=this.scanner.scan(),j=new a.Identifier(this.tok.getText()),j.minChar=this.scanner.startPos,j.limChar=this.scanner.pos,this.tok=this.scanner.scan(),j=this.parseClassMemberVariableDeclaration(j,
k,this.parsingClassConstructorDefinition,e,p));else if((l&a.AllowedElements.Properties)==a.AllowedElements.None)this.reportParseError("'property' statements are only allowed within classes"),this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar();else{p|=a.Modifiers.Public;this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))p|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))p|=a.Modifiers.Setter,this.prevIDTok=null;d=this.parsePropertyDecl(e|a.ErrorRecoverySet.SColon,
p,i(),!1);if(d.nodeType==a.NodeType.VarDecl||d.nodeType==a.NodeType.FuncDecl&&a.hasFlag(d.fncFlags,a.FncFlags.IsFatArrowFunction))q=!0;j=d}break;case a.TokenID.DECLARE:l&a.AllowedElements.AmbientDecls||this.reportParseError("Ambient declarations are only allowed at the top-level or module scopes");!this.parsingDeclareFile&&a.hasFlag(c,a.Modifiers.Ambient)&&this.reportParseError("Duplicate ambient declaration in this context. (Is the enclosing module or class already ambient?)");p|=a.Modifiers.Ambient;
this.tok=this.scanner.scan();break;case a.TokenID.CLASS:(l&a.AllowedElements.ClassDecls)==a.AllowedElements.None?(this.reportParseError("class not allowed in this context"),this.tok=this.scanner.scan(),j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):j=this.parseClassDecl(e,k,p);break;case a.TokenID.INTERFACE:(l&a.AllowedElements.InterfaceDecls)==a.AllowedElements.None?(this.reportParseError("interface not allowed in this context"),this.tok=this.scanner.scan(),
j=new a.AST(a.NodeType.Error),j.minChar=k,j.limChar=this.scanner.lastTokenLimChar()):j=this.parseInterfaceDecl(e,p);break;case a.TokenID.VAR:q=this.parseVarDecl(e|a.ErrorRecoverySet.StmtStart,p,!0,!1,!1);j=q.nodeType==a.NodeType.VarDecl?q:new a.Block(q,!1);q=!0;if(this.parsingDeclareFile||this.ambientModule&&j.nodeType==a.NodeType.VarDecl)j.varFlags|=a.VarFlags.Exported;break;case a.TokenID.STATIC:null==this.currentClassDecl&&this.reportParseError("Statics may only be class members");f();p|=a.Modifiers.Public;
this.tok=this.scanner.scan();if(this.tok.tokenId==a.TokenID.GET){if(this.prevIDTok=this.tok,this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode))p|=a.Modifiers.Getter,this.prevIDTok=null}else if(this.tok.tokenId==a.TokenID.SET&&(this.tok=this.scanner.scan(),a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("Property accessors are only available when targeting ES5 or greater"),
this.tok.tokenId==a.TokenID.ID||a.convertTokToID(this.tok,this.strictMode)))p|=a.Modifiers.Setter;i()&&(p|=a.Modifiers.Ambient);d=this.parsePropertyDecl(e|a.ErrorRecoverySet.SColon,p,this.parsingDeclareFile||(p&a.Modifiers.Ambient)!=a.Modifiers.None,!0);(j=this.topStaticsList())&&d.nodeType==a.NodeType.VarDecl&&j.append(d);if(d.nodeType==a.NodeType.VarDecl||d.nodeType==a.NodeType.FuncDecl&&a.hasFlag(d.fncFlags,a.FncFlags.IsFatArrowFunction))q=!0;j=d;break;case a.TokenID.FOR:f();p!=a.Modifiers.None&&
this.reportParseError("syntax error: for statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);this.state=b.ForInit;n=!0;switch(this.tok.tokenId){case a.TokenID.VAR:d=this.parseVarDecl(e|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,a.Modifiers.None,!1,!1,!1);break;case a.TokenID.SColon:d=null;this.state=b.ForCondStart;break;default:d=this.parseExpr(e|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.In,
a.OperatorPrecedence.No,!1,h.NoTypes)}this.state=b.ForInitAfterVar;this.tok.tokenId==a.TokenID.IN?null==d||!n?(this.reportParseError("malformed for statement"),this.errorRecovery&&(this.skip(e|a.ErrorRecoverySet.StmtStart),j=new a.AST(a.NodeType.Empty),j.flags|=a.ASTFlags.Error)):(this.tok=this.scanner.scan(),j=new a.ForInStatement(d,this.parseExpr(a.ErrorRecoverySet.RParen|e,a.OperatorPrecedence.Cma,!1,h.NoTypes)),j.limChar=this.scanner.pos,this.chkCurTok(a.TokenID.RParen,"Expected ')'",a.ErrorRecoverySet.StmtStart|
e),this.pushStmt(j,g),j.body=this.parseStatement(e,l,c),this.popStmt(),j.minChar=k):(d=new a.ForStatement(d),d.minChar=k,this.chkCurTok(a.TokenID.SColon,"Expected ';'",e),this.tok.tokenId==a.TokenID.SColon?d.cond=null:(d.cond=this.parseExpr(e|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes),this.tok.tokenId!=a.TokenID.SColon&&(this.skip(e|a.ErrorRecoverySet.StmtStart),j=d,j.flags|=a.ASTFlags.Error)),this.tok=this.scanner.scan(),d.incr=this.tok.tokenId==a.TokenID.RParen?
null:this.parseExpr(e|a.ErrorRecoverySet.SColon|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes),this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.LCurly),this.pushStmt(d,g),d.body=this.parseStatement(e,l,c),this.popStmt(),d.limChar=d.body.limChar,j=d);break;case a.TokenID.WITH:a.codeGenTarget<a.CodeGenTarget.ES5&&this.reportParseError("'with' statements are only available in ES5 codegen mode or better");this.strictMode&&this.reportParseError("'with' statements are not available in strict mode");
f();p!=a.Modifiers.None&&this.reportParseError("'with' statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.ExprStart|a.ErrorRecoverySet.Var);j=this.parseExpr(e|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,h.NoTypes);this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.LCurly);j=new a.WithStatement(j);j.body=this.parseStatement(e,l,c);j.minChar=k;j.limChar=j.body.limChar;break;case a.TokenID.SWITCH:f();
p!=a.Modifiers.None&&this.reportParseError("'switch' statement does not take modifiers");this.chkNxtTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.ExprStart);j=new a.SwitchStatement(this.parseExpr(e|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes));this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.LCurly);d=this.scanner.startPos;this.chkCurTok(a.TokenID.LCurly,"Expected '{'",e|a.ErrorRecoverySet.SCase);j.defaultCase=null;j.caseList=new a.ASTList;n=null;for(this.pushStmt(j,
g);;)if(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT){var s=this.tok.tokenId==a.TokenID.DEFAULT,n=new a.CaseStatement;n.minChar=this.scanner.startPos;this.tok=this.scanner.scan();s?j.defaultCase=n:n.expr=this.parseExpr(e|a.ErrorRecoverySet.Colon,a.OperatorPrecedence.No,!0,h.NoTypes);this.chkCurTok(a.TokenID.Colon,"Expected ':'",e|a.ErrorRecoverySet.StmtStart);n.body=new a.ASTList;this.parseStmtList(e|a.ErrorRecoverySet.RCurly,n.body,!1,!0,l,p);n.limChar=n.body.limChar;j.caseList.append(n)}else break;
j.caseList.minChar=d;j.caseList.limChar=this.scanner.pos;j.limChar=j.caseList.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);this.popStmt();break;case a.TokenID.WHILE:f();p!=a.Modifiers.None&&this.reportParseError("'while' statement does not take modifiers");k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",a.ErrorRecoverySet.ExprStart|e);j=new a.WhileStatement(this.parseExpr(e|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes));j.minChar=k;this.chkCurTok(a.TokenID.RParen,
"Expected ')'",e|a.ErrorRecoverySet.StmtStart);this.pushStmt(j,g);j.body=this.parseStatement(e,l,c);j.limChar=j.body.limChar;this.popStmt();break;case a.TokenID.DO:f();p!=a.Modifiers.None&&this.reportParseError("'do' statement does not take modifiers");k=this.scanner.startPos;this.tok=this.scanner.scan();j=new a.DoWhileStatement;j.minChar=k;this.pushStmt(j,g);j.body=this.parseStatement(e|a.ErrorRecoverySet.While,l,c);this.popStmt();j.whileAST=new a.Identifier("while");j.whileAST.minChar=this.scanner.startPos;
this.chkCurTok(a.TokenID.WHILE,"Expected 'while'",e|a.ErrorRecoverySet.LParen);j.whileAST.limChar=j.whileAST.minChar+5;this.chkCurTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.ExprStart);j.cond=this.parseExpr(e|a.ErrorRecoverySet.RParen,a.OperatorPrecedence.No,!0,h.NoTypes);j.limChar=this.scanner.pos;this.chkCurTok(a.TokenID.RParen,"Expected ')'",e);this.tok.tokenId==a.TokenID.SColon&&(this.tok=this.scanner.scan());break;case a.TokenID.IF:f();p!=a.Modifiers.None&&this.reportParseError("if statement does not take modifiers");
k=this.scanner.startPos;this.chkNxtTok(a.TokenID.LParen,"Expected '('",e|a.ErrorRecoverySet.ExprStart);j=new a.IfStatement(this.parseExpr(e|a.ErrorRecoverySet.LParen,a.OperatorPrecedence.No,!0,h.NoTypes));j.minChar=k;this.chkCurTok(a.TokenID.RParen,"Expected ')'",e|a.ErrorRecoverySet.StmtStart);this.pushStmt(j,g);j.thenBod=this.parseStatement(a.ErrorRecoverySet.Else|e,l,c);j.limChar=j.thenBod.limChar;this.tok.tokenId==a.TokenID.ELSE&&(this.tok=this.scanner.scan(),j.elseBod=this.parseStatement(e,l,
c),j.limChar=j.elseBod.limChar);this.popStmt();break;case a.TokenID.TRY:f();p!=a.Modifiers.None&&this.reportParseError("try statement does not take modifiers");k=this.scanner.startPos;j=this.parseTryCatchFinally(e,a.AllowedElements.FunctionBody,c,g);break;case a.TokenID.LCurly:f();p!=a.Modifiers.None&&this.reportParseError("block does not take modifiers");k=this.scanner.startPos;this.tok=this.scanner.scan();j=new a.Block(new a.ASTList,!0);this.pushStmt(j,g);this.parseStmtList(e|a.ErrorRecoverySet.RCurly,
j.stmts,!1,!1,a.AllowedElements.Block,p);this.popStmt();j.stmts.minChar=k;j.stmts.limChar=this.scanner.pos;j.minChar=j.stmts.minChar;j.limChar=j.stmts.limChar;this.chkCurTok(a.TokenID.RCurly,"Expected '}'",e);break;case a.TokenID.SColon:f();p!=a.Modifiers.None&&this.reportParseError("modifier can not appear here");j=new a.AST(a.NodeType.Empty);this.tok=this.scanner.scan();break;case a.TokenID.BREAK:case a.TokenID.CONTINUE:f();p!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before jump statement");
q=new a.Jump(this.tok.tokenId==a.TokenID.BREAK?a.NodeType.Break:a.NodeType.Continue);this.tok=this.scanner.scan();this.tok.tokenId==a.TokenID.ID&&!this.scanner.lastTokenHadNewline()&&(q.target=this.tok.getText(),this.tok=this.scanner.scan());this.resolveJumpTarget(q);j=q;q=!0;break;case a.TokenID.RETURN:f();p!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before return statement");this.inFnc||this.reportParseError("return statement outside of function body");k=this.scanner.startPos;
this.tok=this.scanner.scan();j=new a.ReturnStatement;j.minChar=k;this.tok.tokenId!=a.TokenID.SColon&&(this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline())&&(j.returnExpression=this.parseExpr(e|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,h.NoTypes));q=!0;j.limChar=this.scanner.lastTokenLimChar();break;case a.TokenID.THROW:f();p!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before a throw statement");k=this.scanner.startPos;this.tok=this.scanner.scan();
this.tok.tokenId!=a.TokenID.SColon&&this.tok.tokenId!=a.TokenID.RCurly&&!this.scanner.lastTokenHadNewline()?d=this.parseExpr(e|a.ErrorRecoverySet.SColon,a.OperatorPrecedence.No,!0,h.NoTypes):(this.reportParseError("throw with no target"),d=null);j=new a.UnaryExpression(a.NodeType.Throw,d);j.limChar=this.scanner.lastTokenLimChar();q=!0;break;case a.TokenID.ENUM:this.tok=this.scanner.scan();j=this.parseEnumDecl(e,p);j.minChar=k;j.limChar=this.scanner.lastTokenLimChar();if(this.parsingDeclareFile||a.hasFlag(p,
a.Modifiers.Ambient))j.modFlags|=a.ModuleFlags.Ambient;a.hasFlag(p,a.Modifiers.Exported)&&(j.modFlags|=a.ModuleFlags.Exported);break;case a.TokenID.DEBUGGER:f();p!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before debugger statement");k=this.scanner.startPos;this.tok=this.scanner.scan();j=new a.DebuggerStatement;j.minChar=k;q=!0;j.limChar=this.scanner.lastTokenLimChar();break;default:p!=a.Modifiers.None&&this.reportParseError("modifiers can not appear before an expression statement or label"),
k=this.scanner.startPos,n=this.scanner.pos,d=this.parseExpr(a.ErrorRecoverySet.Colon|a.ErrorRecoverySet.StmtStart|e,a.OperatorPrecedence.No,!0,h.NoTypes),this.scanner.pos==n?(this.tok=this.scanner.scan(),j=d):this.tok.tokenId==a.TokenID.Colon&&!this.scanner.lastTokenHadNewline()&&d&&d.nodeType==a.NodeType.Name?(null==g&&(g=new a.ASTList),g.append(new a.Label(d)),this.tok=this.scanner.scan()):(j=d,q=!0)}if(j)break}if(q)switch(this.tok.tokenId){case a.TokenID.SColon:this.tok=this.scanner.scan();j.flags|=
a.ASTFlags.ExplicitSemicolon;break;case a.TokenID.EOF:case a.TokenID.RCurly:j.flags|=a.ASTFlags.AutomaticSemicolon;this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon");break;default:this.scanner.lastTokenHadNewline()?(j.flags|=a.ASTFlags.AutomaticSemicolon,this.style_requireSemi&&this.reportParseStyleError("no automatic semicolon")):this.reportParseError("Expected ';'")}g&&(j=new a.LabeledStatement(g,j));j.minChar=k;j.limChar=a.max(j.limChar,this.scanner.lastTokenLimChar());
j.preComments=r;this.ambientModule&&!this.okAmbientModuleMember(j)&&this.reportParseError("statement not permitted within ambient module");j.flags|=a.ASTFlags.IsStatement;return j};g.prototype.okAmbientModuleMember=function(b){var l=b.nodeType;return l==a.NodeType.Class||l==a.NodeType.Import||l==a.NodeType.Interface||l==a.NodeType.Module||l==a.NodeType.Empty||l==a.NodeType.VarDecl&&(a.hasFlag(b.varFlags,a.VarFlags.Property)||a.hasFlag(b.varFlags,a.VarFlags.Exported))||l==a.NodeType.FuncDecl&&b.isMethod()};
g.prototype.parseStmtList=function(e,l,c,i,f,j){l.minChar=this.scanner.startPos;var d=this.scanner.pos,g=(f&a.AllowedElements.ModuleDecls)==a.AllowedElements.None,p=(f&a.AllowedElements.ClassDecls)==a.AllowedElements.None,e=e|a.ErrorRecoverySet.TypeScriptS|a.ErrorRecoverySet.RCurly;this.state=b.StartStmtList;var k=this.strictMode;for(this.nestingLevel++;;){if(this.tok.tokenId==a.TokenID.RCurly||i&&(this.tok.tokenId==a.TokenID.CASE||this.tok.tokenId==a.TokenID.DEFAULT)||g&&this.tok.tokenId==a.TokenID.EXPORT||
p&&this.tok.tokenId==a.TokenID.CLASS||this.tok.tokenId==a.TokenID.EOF){this.state=b.EndStmtList;l.limChar=d;0==l.members.length?l.preComments=this.parseComments():l.postComments=this.parseComments();this.strictMode=k;this.nestingLevel--;break}var h=this.parseStatement(e&~(a.ErrorRecoverySet.Else|a.ErrorRecoverySet.RParen|a.ErrorRecoverySet.Catch|a.ErrorRecoverySet.Colon),f,j);h&&(h.postComments=this.combineComments(h.postComments,this.parseCommentsForLine(this.scanner.prevLine)),l.append(h),d=h.limChar,
c&&(h.nodeType==a.NodeType.QString?"use strict"==h.text?(l.flags|=a.ASTFlags.StrictMode,this.strictMode=!0):c=!1:c=!1))}};g.prototype.quickParse=function(b,l,c){var i=a.moduleGenTarget;try{a.moduleGenTarget=a.ModuleGenTarget.Local;var f=this.parse(b,l,c,a.AllowedElements.QuickParse);return new k(f,this.scanner.lexState)}finally{a.moduleGenTarget=i}};g.prototype.parse=function(e,l,c,i){"undefined"===typeof i&&(i=a.AllowedElements.Global);this.ambientModule=!1;this.topLevel=!0;this.hasTopLevelImportOrExport=
this.parseError=!1;this.fname=l;this.currentUnitIndex=c;this.amdDependencies=[];this.scanner.resetComments();this.scanner.setSourceText(e,a.LexMode.File);var e=this.scanner.leftCurlyCount,f=this.scanner.rightCurlyCount,j=this.scanner.pos;this.tok=this.scanner.scan();this.pushDeclLists();var d=new a.ASTList;d.minChar=j;this.state=b.StartScript;this.parsingDeclareFile=a.isDSTRFile(l)||a.isDTSFile(l);this.parseStmtList(a.ErrorRecoverySet.EOF|a.ErrorRecoverySet.Func,d,!0,!1,i,a.Modifiers.None);this.tok.tokenId!=
a.TokenID.EOF&&this.reportParseError("Unexpected statement block terminator '"+a.tokenTable[this.tok.tokenId].text+"'");this.state=b.EndScript;d.limChar=this.scanner.pos;i=null;if(a.moduleGenTarget!=a.ModuleGenTarget.Local&&this.hasTopLevelImportOrExport){var g=a.switchToForwardSlashes(l),i=new a.Identifier(g),i=new a.ModuleDecl(i,d,this.topVarList(),this.topScopeList());i.modFlags|=a.ModuleFlags.IsDynamic;i.modFlags|=a.ModuleFlags.IsWholeFile;i.modFlags|=a.ModuleFlags.Exported;this.parsingDeclareFile&&
(i.modFlags|=a.ModuleFlags.Ambient);i.minChar=j;i.limChar=this.scanner.pos;i.prettyName=a.getPrettyName(g);i.amdDependencies=this.amdDependencies;d=new a.ASTList;d.minChar=i.minChar;d.limChar=i.limChar;d.append(i)}g=new a.Script(this.topVarList(),this.topScopeList());g.bod=d;this.popDeclLists();g.minChar=j;g.limChar=this.scanner.pos;g.locationInfo=new a.LocationInfo(l,this.scanner.lineMap,c);g.leftCurlyCount=this.scanner.leftCurlyCount-e;g.rightCurlyCount=this.scanner.rightCurlyCount-f;g.isDeclareFile=
this.parsingDeclareFile;g.topLevelMod=i;return g};a.Parser=g;a.quickParse=function(b,d,c,i,f,j){d=c.getText(i,f);b.log("Quick parse range ("+i+","+f+'): "'+a.stringToLiteral(d,100)+'"');b=new g;b.setErrorRecovery(null,-1,-1);b.errorCallback=j;j=new a.TypeDecl(a.NodeType.Class,null,null,null,null,null);b.currentClassDecl=j;return b.quickParse(new a.StringSourceText(d),"",0)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(a,b){this.outfile=a;this.parser=b;this.builder="";this.indent1="  ";this.indentStrings=[];this.indentAmt=0};d.prototype.increaseIndent=function(){this.indentAmt++};d.prototype.decreaseIndent=function(){this.indentAmt--};d.prototype.startLine=function(){0<this.builder.length&&a.CompilerDiagnostics.Alert(this.builder);var d=this.indentStrings[this.indentAmt];if(void 0===d){for(var d="",b=0;b<this.indentAmt;b++)d+=this.indent1;this.indentStrings[this.indentAmt]=d}this.builder+=
d};d.prototype.write=function(a){this.builder+=a};d.prototype.writeLine=function(a){this.builder+=a;this.outfile.WriteLine(this.builder);this.builder=""};a.PrintContext=d;a.prePrintAST=function(a,b,d){b=d.state;a.print(b);b.increaseIndent();return a};a.postPrintAST=function(a,b,d){d.state.decreaseIndent();return a}})(TypeScript||(TypeScript={}));
(function(a){function d(){a.initializeStaticTokens();l[a.LexCodeLPR]=a.staticTokens[a.TokenID.LParen];l[a.LexCodeRPR]=a.staticTokens[a.TokenID.RParen];l[a.LexCodeCMA]=a.staticTokens[a.TokenID.Comma];l[a.LexCodeSMC]=a.staticTokens[a.TokenID.SColon];l[a.LexCodeLBR]=a.staticTokens[a.TokenID.LBrack];l[a.LexCodeRBR]=a.staticTokens[a.TokenID.RBrack];l[a.LexCodeTIL]=a.staticTokens[a.TokenID.Tilde];l[a.LexCodeQUE]=a.staticTokens[a.TokenID.QMark];l[a.LexCodeLC]=a.staticTokens[a.TokenID.LCurly];l[a.LexCodeRC]=
a.staticTokens[a.TokenID.RCurly];l[a.LexCodeCOL]=a.staticTokens[a.TokenID.Colon];a.LexKeywordTable=new a.StringHashTable;for(var b in a.TokenID._map)b<=a.TokenID.LimKeyword&&a.LexKeywordTable.add(a.TokenID._map[b].toLowerCase(),b);for(b=0;128>b;b++)c[b]=h(b)?!0:!1}function h(c){return 97<=c&&122>=c||65<=c&&90>=c||c==a.LexCodeDollar||c==a.LexCodeUnderscore}function b(a){return 48<=a&&57>=a}function k(c,b,e){if(c.tokenId<=a.TokenID.LimKeyword)if(c=a.lookupToken(c.tokenId),void 0!=c){var i=a.Reservation.Javascript|
a.Reservation.JavascriptFuture;e&&(i|=a.Reservation.JavascriptFutureStrict);if(b||!a.hasFlag(c.reservation,i))return!0}else return!1;else return!1}function g(a,c){if(-1===c)return 0;for(var b=0,e=a.length-1;b<e;){var i=b+e>>1;c<a[i]?e=i-1:b=c<a[i+1]?e=i:i+1}return b}function e(a,c,b){var e=g(b,c);0<e&&(a.line=e,a.col=c-b[e])}a.LexEOF=-1;a.LexCodeNWL=10;a.LexCodeRET=13;a.LexCodeTAB=9;a.LexCodeVTAB=11;a.LexCode_e=101;a.LexCode_E=69;a.LexCode_x=120;a.LexCode_X=88;a.LexCode_a=97;a.LexCode_A=65;a.LexCode_f=
102;a.LexCode_F=70;a.LexCode_g=103;a.LexCode_m=109;a.LexCode_i=105;a.LexCode_0=48;a.LexCode_9=57;a.LexCode_8=56;a.LexCode_7=55;a.LexCodeBSL=92;a.LexCodeSHP=35;a.LexCodeBNG=33;a.LexCodeQUO=34;a.LexCodeAPO=39;a.LexCodePCT=37;a.LexCodeAMP=38;a.LexCodeLPR=40;a.LexCodeRPR=41;a.LexCodePLS=43;a.LexCodeMIN=45;a.LexCodeMUL=42;a.LexCodeSLH=47;a.LexCodeXOR=94;a.LexCodeCMA=44;a.LexCodeDOT=46;a.LexCodeLT=60;a.LexCodeEQ=61;a.LexCodeGT=62;a.LexCodeQUE=63;a.LexCodeLBR=91;a.LexCodeRBR=93;a.LexCodeUSC=95;a.LexCodeLC=
123;a.LexCodeRC=125;a.LexCodeBAR=124;a.LexCodeTIL=126;a.LexCodeCOL=58;a.LexCodeSMC=59;a.LexCodeUnderscore=95;a.LexCodeDollar=36;a.LexCodeSpace=32;a.LexKeywordTable=void 0;var l=Array(128),c=Array(128);a.LexInitialize=d;a.LexAdjustIndent=function(c,b){return c==a.LexCodeLBR||c==a.LexCodeLC||c==a.LexCodeLPR?b+1:c==a.LexCodeRBR||c==a.LexCodeRC||c==a.LexCodeRPR?b-1:b};a.LexIsIdentifierStartChar=h;a.LexIsDigit=b;a.LexIsIdentifierChar=function(a){return c[a]||b(a)};a.LexMatchingOpen=function(c){return c==
a.LexCodeRBR?a.LexCodeLBR:c==a.LexCodeRC?a.LexCodeLC:c==a.LexCodeRPR?a.LexCodeLPR:0};var i=a.NumberScanState||(a.NumberScanState={});i._map=[];i._map[0]="Start";i.Start=0;i._map[1]="InFraction";i.InFraction=1;i._map[2]="InExponent";i.InExponent=2;var f=a.NumberScanState,i=a.LexState||(a.LexState={});i._map=[];i._map[0]="Start";i.Start=0;i._map[1]="InMultilineComment";i.InMultilineComment=1;var j=a.LexState,i=a.LexMode||(a.LexMode={});i._map=[];i._map[0]="Line";i.Line=0;i._map[1]="File";i.File=1;var v=
a.LexMode,i=a.CommentStyle||(a.CommentStyle={});i._map=[];i._map[0]="Line";i.Line=0;i._map[1]="Block";i.Block=1;var m=function(a){this.text=a};m.prototype.getText=function(a,c){return this.text.substring(a,c)};m.prototype.getLength=function(){return this.text.length};a.StringSourceText=m;var p=function(a,c,b){this.segmentStart=a;this.segmentEnd=c;this.segment=b};p.prototype.charCodeAt=function(a){return this.segment.charCodeAt(a-this.segmentStart)};p.prototype.substring=function(a,c){return this.segment.substring(a-
this.segmentStart,c-this.segmentStart)};a.SourceTextSegment=p;var u=function(a,c){this.seg1=a;this.seg2=c};u.prototype.charCodeAt=function(a){return this.seg1.segmentStart<=a&&a<this.seg1.segmentEnd?this.seg1.segment.charCodeAt(a-this.seg1.segmentStart):this.seg2.segment.charCodeAt(a-this.seg2.segmentStart)};u.prototype.substring=function(a,c){return this.seg1.segmentStart<=a&&c<=this.seg1.segmentEnd?this.seg1.segment.substring(a-this.seg1.segmentStart,c-this.seg1.segmentStart):this.seg2.segment.substring(a-
this.seg2.segmentStart)+this.seg1.segment.substring(0,c-this.seg1.segmentStart)};a.AggerateSourceTextSegment=u;var n=function(a){this.sourceText=a;this.agg=new u(n.emptySegment,n.emptySegment);this.len=this.sourceText.getLength()};n.emptySegment=new p(0,0,"");n.prototype.max=function(a,c){return a>=c?a:c};n.prototype.min=function(a,c){return a<=c?a:c};n.prototype.fetchSegment=function(c,b){if(this.agg.seg1.segmentStart<=c&&b<=this.agg.seg1.segmentEnd)return this.agg.seg1;if(this.agg.seg2.segmentStart<=
c&&b<=this.agg.seg1.segmentEnd)return this.agg;var e=this.agg.seg1,i=e.segmentEnd,f=a.max(i+512,b),f=a.min(f,this.len),j=this.sourceText.getText(i,f),i=new p(i,f,j);this.agg.seg2=e;this.agg.seg1=i;return this.agg};n.prototype.charCodeAt=function(a){return this.fetchSegment(a,a+1).charCodeAt(a)};n.prototype.substring=function(a,c){return this.fetchSegment(a,c).substring(a,c)};a.ScannerTextStream=n;i=function(){this.prevToken=this.prevSavedToken=this.curSavedToken=this.prevToken=null;this.currentToken=
0;this.tokens=[];this.line=this.prevLine=1;this.col=0;this.lexState=j.Start;this.commentStack=[]};i.prototype.previousToken=function(){return this.prevToken};i.prototype.close=function(){this.currentToken=0};i.prototype.addToken=function(c,b){this.tokens[this.currentToken++]=new a.SavedToken(c,b.startPos,b.pos)};i.prototype.scan=function(){this.startLine=this.line;this.startPos=this.col;if(this.currentTokenIndex==this.currentTokens.length)if(this.line<this.lineMap.length)this.line++,this.currentTokenIndex=
this.col=0,this.currentTokens=this.tokensByLine[this.line];else return a.staticTokens[a.TokenID.EOF];if(this.currentTokenIndex<this.currentTokens.length){this.prevToken=this.curSavedToken.tok;this.prevSavedToken=this.curSavedToken;this.curSavedToken=this.currentTokens[this.currentTokenIndex++];var c=this.curSavedToken.tok;this.pos=this.curSavedToken.limChar;this.col+=this.curSavedToken.limChar-this.curSavedToken.minChar;this.startPos=this.curSavedToken.minChar;this.prevLine=this.line;return c}return a.staticTokens[a.TokenID.EOF]};
i.prototype.syncToTok=function(a){this.line=g(this.lineMap,a);this.currentTokenIndex=0;for(a-=this.lineMap[this.line];this.lexStateByLine[this.line]==j.InMultilineComment&&0<this.line;)this.line--,a=0;var c=this.lineMap.length-1;for(this.currentTokens=this.tokensByLine[this.line];0==this.currentTokens.length&&this.line<c;)this.line++,this.currentTokens=this.tokensByLine[this.line],a=0;if(this.line<=c){for(;this.currentTokenIndex<this.currentTokens.length&&a>this.currentTokens[this.currentTokenIndex].limChar;)this.currentTokenIndex++;
if(this.currentTokenIndex<this.currentTokens.length)return this.col=this.currentTokens[this.currentTokenIndex].minChar,this.col+this.lineMap[this.line]}return-1};i.prototype.lastTokenLimChar=function(){return null!==this.prevSavedToken?this.prevSavedToken.limChar:0};i.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};i.prototype.pushComment=function(a){this.commentStack.push(a)};i.prototype.getComments=function(){var a=this.commentStack;this.commentStack=[];return a};
i.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};i.prototype.resetComments=function(){this.commentStack=[]};i.prototype.setSourceText=function(){};a.SavedTokens=i;i=function(){this.line=this.prevLine=1;this.len=this.startPos=this.pos=this.col=0;this.lineMap=[];this.ch=a.LexEOF;this.lexState=j.Start;this.mode=v.File;this.scanComments=!0;this.interveningWhitespace=
!1;this.rightCurlyCount=this.leftCurlyCount=this.interveningWhitespacePos=0;this.commentStack=[];this.saveScan=null;this.prevTok=a.staticTokens[a.TokenID.EOF];this.startCol=this.col;this.startLine=this.line;this.lineMap[1]=0;a.LexKeywordTable||d()};i.prototype.previousToken=function(){return this.prevTok};i.prototype.setSourceText=function(a,c){this.mode=c;this.scanComments=this.mode===v.Line;this.startPos=this.interveningWhitespacePos=this.pos=0;this.line=1;this.startCol=this.col=0;this.startLine=
this.line;this.len=0;this.src=a.getText(0,a.getLength());this.len=this.src.length;this.lineMap=[];this.lineMap[1]=0;this.commentStack=[];this.rightCurlyCount=this.leftCurlyCount=0};i.prototype.setSaveScan=function(a){this.saveScan=a};i.prototype.setText=function(a,c){this.setSourceText(new m(a),c)};i.prototype.setScanComments=function(a){this.scanComments=a};i.prototype.getLexState=function(){return this.lexState};i.prototype.scanLine=function(c,b){this.lexState=b;var e=[];this.setText(c,v.Line);
for(var i=this.scan();i.tokenId!=a.TokenID.EOF;)e[e.length]=i,i=this.scan();return e};i.prototype.tokenStart=function(){this.startPos=this.pos;this.startLine=this.line;this.startCol=this.col;this.interveningWhitespace=!1};i.prototype.peekChar=function(){return this.pos<this.len?this.src.charCodeAt(this.pos):a.LexEOF};i.prototype.peekCharAt=function(c){return c<this.len?this.src.charCodeAt(c):a.LexEOF};i.prototype.IsHexDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_9||c>=a.LexCode_A&&c<=a.LexCode_F||
c>=a.LexCode_a&&c<=a.LexCode_f};i.prototype.IsOctalDigit=function(c){return c>=a.LexCode_0&&c<=a.LexCode_7||c>=a.LexCode_a&&c<=a.LexCode_f};i.prototype.scanHexDigits=function(){for(var c=!1;;)if(this.IsHexDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,this.pos))):null};i.prototype.scanOctalDigits=function(){for(var c=!1;;)if(this.IsOctalDigit(this.ch))this.nextChar(),c=!0;else return c?new a.NumberToken(parseInt(this.src.substring(this.startPos,
this.pos))):null};i.prototype.scanDecimalNumber=function(c){for(var e=!1,i=this.pos,j=this.col;;)if(b(this.ch))e=!0,this.nextChar();else if(this.ch==a.LexCodeDOT)if(c==f.Start)this.nextChar(),c=f.InFraction;else{if(e)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=j;return null}else if(this.ch==a.LexCode_e||this.ch==a.LexCode_E)if(c==f.Start)if(e)e=!1,this.nextChar(),c=f.InExponent;else return this.pos=i,this.col=j,null;else if(c==f.InFraction)this.nextChar(),
c=f.InExponent,e=!1;else{if(e)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=j;return null}else if(this.ch==a.LexCodePLS||this.ch==a.LexCodeMIN)if(c==f.InExponent){if(e)return this.pos=i,this.col=j,null;this.nextChar()}else{if(c==f.InFraction||e)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));this.pos=i;this.col=j;return null}else{if(e)return new a.NumberToken(parseFloat(this.src.substring(this.startPos,this.pos)));
this.pos=i;this.col=j;return null}};i.prototype.scanNumber=function(){if(this.peekChar()==a.LexCode_0)switch(this.peekCharAt(this.pos+1)){case a.LexCode_x:case a.LexCode_X:return this.advanceChar(2),this.scanHexDigits();case a.LexCode_8:case a.LexCode_9:case a.LexCodeDOT:return this.scanDecimalNumber(f.Start);default:return this.scanOctalDigits()}else return this.scanDecimalNumber(f.Start)};i.prototype.scanFraction=function(){return this.scanDecimalNumber(f.InFraction)};i.prototype.newLine=function(){this.col=
0;this.mode==v.File&&(this.line++,this.lineMap[this.line]=this.pos+1)};i.prototype.finishMultilineComment=function(){var c;for(this.lexState=j.InMultilineComment;this.pos<this.len;){if(this.ch==a.LexCodeMUL){if(c=this.peekCharAt(this.pos+1),c==a.LexCodeSLH)return this.advanceChar(2),this.mode==v.File&&this.tokenStart(),this.lexState=j.Start,!0}else if(this.ch==a.LexCodeNWL&&(this.newLine(),this.mode==v.Line)){this.nextChar();break}this.nextChar()}return!1};i.prototype.pushComment=function(a){this.commentStack.push(a)};
i.prototype.getComments=function(){var a=this.commentStack;this.commentStack=[];return a};i.prototype.getCommentsForLine=function(a){for(var c=null;0<this.commentStack.length&&this.commentStack[0].line==a;)c=null==c?[this.commentStack.shift()]:c.concat([this.commentStack.shift()]);return c};i.prototype.resetComments=function(){this.commentStack=[]};i.prototype.endsLine=function(c){return c==a.LexCodeNWL||c==a.LexCodeRET||8232==c||8233==c};i.prototype.finishSinglelineComment=function(){for(;this.pos<
this.len&&!this.endsLine(this.ch);)this.nextChar();this.mode==v.File&&this.tokenStart()};i.prototype.tokenText=function(){return this.src.substring(this.startPos,this.pos)};i.prototype.findClosingSLH=function(){for(var c=this.pos,b=this.src.charCodeAt(c),e=0,i=!1;!this.endsLine(b)&&c<this.len;){if(b==a.LexCodeSLH&&!i)return c;e=b;c++;i=i?!1:e==a.LexCodeBSL;b=this.src.charCodeAt(c)}return-1};i.prototype.speculateRegex=function(){if(void 0!=a.noRegexTable[this.prevTok.tokenId])return null;var c=this.pos,
b=this.col,e=this.findClosingSLH();if(0<e){var i=this.src.substring(c,e),f="";this.pos=e+1;this.ch=this.peekChar();for(f=this.pos;this.ch==a.LexCode_i||this.ch==a.LexCode_g||this.ch==a.LexCode_m;)this.nextChar();if(3<this.pos-f)return null;f=this.src.substring(f,this.pos);e=void 0;try{e=RegExp(i,f)}catch(j){}if(e)return this.col=b+(this.pos-this.startPos),new a.RegexToken(e)}this.pos=c;this.col=b;return null};i.prototype.lastTokenHadNewline=function(){return this.prevLine!=this.startLine};i.prototype.lastTokenLimChar=
function(){return this.interveningWhitespace?this.interveningWhitespacePos:this.startPos};i.prototype.advanceChar=function(a){this.pos+=a;this.col+=a;this.ch=this.peekChar()};i.prototype.nextChar=function(){this.pos++;this.col++;this.ch=this.peekChar()};i.prototype.scan=function(){if(this.lexState==j.InMultilineComment&&this.scanComments){this.ch=this.peekChar();var c=this.line;this.finishMultilineComment();if(this.startPos<this.pos){var b=this.src.substring(this.startPos,this.pos);this.tokenStart();
return new a.CommentToken(a.TokenID.Comment,b,!0,this.startPos,c,!0)}return a.staticTokens[a.TokenID.EOF]}this.prevLine=this.line;this.prevTok=this.innerScan();this.saveScan&&this.saveScan.addToken(this.prevTok,this);return this.prevTok};i.prototype.innerScan=function(){var e;this.tokenStart();for(this.ch=this.peekChar();this.pos<this.len;){if(c[this.ch]){do this.nextChar();while(c[this.ch]||b(this.ch));var i=this.src.substring(this.startPos,this.pos);return null!=(e=a.LexKeywordTable.lookup(i))?
a.staticTokens[e]:new a.StringToken(a.TokenID.ID,i)}if(this.ch==a.LexCodeSpace){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos);do this.nextChar();while(this.ch==a.LexCodeSpace);if(this.mode==v.Line)return e=this.src.substring(this.startPos,this.pos),new a.WhitespaceToken(a.TokenID.Whitespace,e);this.tokenStart();this.interveningWhitespace=!0}else if(this.ch==a.LexCodeSLH){this.nextChar();var f;if(this.ch==a.LexCodeSLH){this.interveningWhitespace||(this.interveningWhitespacePos=
this.pos-1);var i=this.pos-1,j=this.line;this.finishSinglelineComment();f=this.src.substring(i,this.pos);f=new a.CommentToken(a.TokenID.Comment,f,!1,i,j,!1);if(this.scanComments)return this.startPos=i,f;this.pushComment(f);this.interveningWhitespace=!0}else if(this.ch==a.LexCodeMUL){this.interveningWhitespace||(this.interveningWhitespacePos=this.pos-1);i=this.pos-1;j=this.line;this.nextChar();this.finishMultilineComment();f=this.src.substring(i,this.pos);var d=this.peekChar()==a.LexCodeNWL||this.peekChar()==
a.LexCodeRET;f=new a.CommentToken(a.TokenID.Comment,f,!0,i,j,d);if(this.scanComments)return this.startPos=i,f;this.pushComment(f);this.interveningWhitespace=!0}else return(e=this.speculateRegex())?e:this.peekCharAt(this.pos)==a.LexCodeEQ?(this.nextChar(),a.staticTokens[a.TokenID.AsgDiv]):a.staticTokens[a.TokenID.Div]}else{if(this.ch==a.LexCodeSMC)return this.nextChar(),a.staticTokens[a.TokenID.SColon];if(this.ch==a.LexCodeAPO||this.ch==a.LexCodeQUO){e=this.ch;i=0;f=!1;do i=this.ch,f=f?!1:i==a.LexCodeBSL,
this.nextChar();while(this.ch!=a.LexEOF&&(f||this.ch!=e));this.ch!=a.LexEOF&&this.nextChar();return new a.StringToken(a.TokenID.QString,this.src.substring(this.startPos,this.pos))}if(l[this.ch])return e=l[this.ch],e.tokenId==a.TokenID.LCurly?this.leftCurlyCount++:e.tokenId==a.TokenID.RCurly&&this.rightCurlyCount++,this.nextChar(),e;if(this.ch>=a.LexCode_0&&this.ch<=a.LexCode_9){if(e=this.scanNumber())return e;this.nextChar();return a.staticTokens[a.TokenID.Error]}switch(this.ch){case a.LexCodeTAB:case a.LexCodeVTAB:this.interveningWhitespace||
(this.interveningWhitespacePos=this.pos);if(this.mode==v.Line){do this.nextChar();while(this.ch==a.LexCodeSpace||9==this.ch);e=this.src.substring(this.startPos,this.pos);return new a.WhitespaceToken(a.TokenID.Whitespace,e)}this.interveningWhitespace=!0;case 255:case 254:case 239:case 187:case 191:case 8232:case 8233:case a.LexCodeNWL:case a.LexCodeRET:if(this.ch==a.LexCodeNWL&&(this.newLine(),this.mode==v.Line))return a.staticTokens[a.TokenID.EOF];this.interveningWhitespace||(this.interveningWhitespacePos=
this.pos);this.nextChar();this.tokenStart();this.interveningWhitespace=!0;break;case a.LexCodeDOT:if(this.peekCharAt(this.pos+1)==a.LexCodeDOT){if(this.peekCharAt(this.pos+2)==a.LexCodeDOT)return this.advanceChar(3),a.staticTokens[a.TokenID.Ellipsis];this.nextChar();return a.staticTokens[a.TokenID.Dot]}this.nextChar();return(e=this.scanFraction())?e:a.staticTokens[a.TokenID.Dot];case a.LexCodeEQ:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),
a.staticTokens[a.TokenID.Eqv];this.advanceChar(2);return a.staticTokens[a.TokenID.EQ]}if(this.peekCharAt(this.pos+1)==a.LexCodeGT)return this.advanceChar(2),a.staticTokens[a.TokenID.Arrow];this.nextChar();return a.staticTokens[a.TokenID.Asg];case a.LexCodeBNG:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.NEqv];this.advanceChar(2);return a.staticTokens[a.TokenID.NE]}this.nextChar();return a.staticTokens[a.TokenID.Bang];
case a.LexCodePLS:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAdd];if(this.peekCharAt(this.pos+1)==a.LexCodePLS)return this.advanceChar(2),a.staticTokens[a.TokenID.Inc];this.nextChar();return a.staticTokens[a.TokenID.Add];case a.LexCodeMIN:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgSub];if(this.peekCharAt(this.pos+1)==a.LexCodeMIN)return this.advanceChar(2),a.staticTokens[a.TokenID.Dec];
this.nextChar();return a.staticTokens[a.TokenID.Sub];case a.LexCodeMUL:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMul];this.nextChar();return a.staticTokens[a.TokenID.Mult];case a.LexCodePCT:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgMod];this.nextChar();return a.staticTokens[a.TokenID.Pct];case a.LexCodeLT:if(this.peekCharAt(this.pos+1)==a.LexCodeLT){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),
a.staticTokens[a.TokenID.AsgLsh];this.advanceChar(2);return a.staticTokens[a.TokenID.Lsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.LE];this.nextChar();return a.staticTokens[a.TokenID.LT];case a.LexCodeGT:if(this.peekCharAt(this.pos+1)==a.LexCodeGT){if(this.peekCharAt(this.pos+2)==a.LexCodeEQ)return this.advanceChar(3),a.staticTokens[a.TokenID.AsgRsh];if(this.peekCharAt(this.pos+2)==a.LexCodeGT){if(this.peekCharAt(this.pos+3)==a.LexCodeEQ)return this.advanceChar(4),
a.staticTokens[a.TokenID.AsgRs2];this.advanceChar(3);return a.staticTokens[a.TokenID.Rs2]}this.advanceChar(2);return a.staticTokens[a.TokenID.Rsh]}if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.GE];this.nextChar();return a.staticTokens[a.TokenID.GT];case a.LexCodeXOR:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgXor];this.nextChar();return a.staticTokens[a.TokenID.Xor];case a.LexCodeBAR:if(this.peekCharAt(this.pos+
1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgOr];if(this.peekCharAt(this.pos+1)==a.LexCodeBAR)return this.advanceChar(2),a.staticTokens[a.TokenID.LogOr];this.nextChar();return a.staticTokens[a.TokenID.Or];case a.LexCodeAMP:if(this.peekCharAt(this.pos+1)==a.LexCodeEQ)return this.advanceChar(2),a.staticTokens[a.TokenID.AsgAnd];if(this.peekCharAt(this.pos+1)==a.LexCodeAMP)return this.advanceChar(2),a.staticTokens[a.TokenID.LogAnd];this.nextChar();return a.staticTokens[a.TokenID.And];
default:return a.staticTokens[a.TokenID.EOF]}}}return a.staticTokens[a.TokenID.EOF]};a.Scanner=i;a.convertTokToIDName=function(a){return k(a,!0,!1)};a.convertTokToID=function(a,c){return k(a,!1,c)};a.getLineNumberFromPosition=g;a.getSourceLineColFromMap=e;a.getLineColumnFromPosition=function(a,c){var b={line:-1,col:-1};e(b,c,a.locationInfo.lineMap);0<=b.col&&b.col++;return b};a.getPositionFromLineColumn=function(a,c,b){return a.locationInfo.lineMap[c]+(b-1)}})(TypeScript||(TypeScript={}));
(function(a){function d(c,b,e,i,f){c=new a.ScopeChain(null,b.scopeChain,c);c.thisType=e;c.classType=i;c.fnc=f;b.scopeChain=c}function h(a){a.scopeChain=a.scopeChain.previous}function b(a,c){return null==a||!a.isInstanceProperty()?c:a}function k(a){return a.isInstanceProperty()}function g(c,b){var e=null,i=null;c.name&&c.mod&&(c.name.sym=c.mod.symbol);var f=c.mod;f&&(e=new a.SymbolTableScope(f.members,f.ambientMembers,f.enclosedTypes,f.ambientEnclosedTypes,f.symbol),f.memberScope=e,b.modDeclChain.push(c),
b.typeFlow.checker.currentModDecl=c,i=new a.SymbolAggregateScope(f.symbol),i.addParentScope(e),i.addParentScope(b.scopeChain.scope),d(i,b,null,null,null),f.containedScope=i,f.symbol&&b.typeFlow.addLocalsFromScope(f.containedScope,f.symbol,c.vars,f.members.privateMembers,!0))}function e(c,b){var e=null,i=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var f=c.type;if(f){e=b.typeFlow.checker.scopeOf(f);i=new a.SymbolAggregateScope(f.symbol);i.addParentScope(e);i.addParentScope(b.scopeChain.scope);f.containedScope=
i;f.memberScope=e;var j=f.instanceType,e=b.typeFlow.checker.scopeOf(j);j.memberScope=e;i=new a.SymbolAggregateScope(j.symbol);i.addParentScope(b.scopeChain.scope);d(i,b,j,f,null);j.containedScope=i}else c.type=b.typeFlow.anyType}function l(c,b){var e=null,i=null;c.name&&c.type&&(c.name.sym=c.type.symbol);var f=c.type,e=b.typeFlow.checker.scopeOf(f);f.memberScope=e;i=new a.SymbolAggregateScope(f.symbol);i.addParentScope(e);i.addParentScope(b.scopeChain.scope);d(i,b,null,null,null);f.containedScope=
i}function c(c,b){var e=c.type,i=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),f=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),e=new a.Type,j=new a.WithSymbol(c.minChar,b.typeFlow.checker.locationInfo.unitIndex,e);e.members=i;e.ambientMembers=f;e.symbol=j;e.setHasImplementation();c.type=e;i=new a.SymbolScopeBuilder(e.members,e.ambientMembers,null,null,b.scopeChain.scope,e.symbol);d(i,b,null,null,null);e.containedScope=
i}function i(c,b){var e=null,i=null;c.type&&(i=c.type.symbol);var f=a.hasFlag(c.fncFlags,a.FncFlags.Static),j=f&&null!=b.scopeChain.fnc?b.scopeChain.fnc.type.memberScope:b.scopeChain.scope;b.scopeChain.thisType&&(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))?(e=b.scopeChain.thisType,j=!(e.typeFlags&a.TypeFlags.IsClass)&&!a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?!c.isMethod()||f?e.constructorScope:e.containedScope:b.scopeChain.previous.scope.container&&b.scopeChain.previous.scope.container.declAST&&
b.scopeChain.previous.scope.container.declAST.nodeType==a.NodeType.FuncDecl&&b.scopeChain.previous.scope.container.declAST.isConstructor?e.constructorScope:f&&b.scopeChain.classType?b.scopeChain.classType.containedScope:e.containedScope,e=e.symbol):c.isConstructor&&b.scopeChain.thisType&&(e=b.scopeChain.thisType.symbol);if(null==c.type||a.hasFlag(c.type.symbol.flags,a.SymbolFlags.TypeSetDuringScopeAssignment)){b.scopeChain.fnc&&b.scopeChain.fnc.type&&(e=b.scopeChain.fnc.type.symbol);var l=null,g=
b.scopeChain.fnc,k=c.name?c.name.text:null,h=null;f?(null==g.type.members&&e.getType().memberScope&&(g.type.members=e.type.memberScope.valueMembers),l=b.scopeChain.fnc.type.memberScope,g.innerStaticFuncs[g.innerStaticFuncs.length]=c):l=!c.isConstructor&&e&&e.declAST&&e.declAST.nodeType==a.NodeType.FuncDecl&&e.declAST.isConstructor&&!c.isMethod()?b.scopeChain.thisType.constructorScope:b.scopeChain.scope;k&&("__missing"!=k&&!c.isAccessor())&&(h=l.findLocal(k,!1,!1));b.typeFlow.checker.createFunctionSignature(c,
e,l,h,null==h);if(!c.accessorSymbol&&c.fncFlags&a.FncFlags.ClassMethod&&e&&(!h||h.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||h&&h.isAccessor())c.accessorSymbol=b.typeFlow.checker.createAccessorSymbol(c,h,e.getType(),c.isMethod()&&f,!0,l,e);c.type.symbol.flags|=a.SymbolFlags.TypeSetDuringScopeAssignment}c.name&&c.type&&(c.name.sym=c.type.symbol);c.scopeType=c.type;if(!c.isOverload){var e=new a.StringHashTable,h=new a.ScopedMembers(new a.DualStringHashTable(e,new a.StringHashTable)),l=
new a.StringHashTable,k=new a.ScopedMembers(new a.DualStringHashTable(l,new a.StringHashTable)),l=new a.StringHashTable,g=new a.ScopedMembers(new a.DualStringHashTable(l,new a.StringHashTable)),A=new a.StringHashTable,A=new a.ScopedMembers(new a.DualStringHashTable(A,new a.StringHashTable));c.unitIndex=b.typeFlow.checker.locationInfo.unitIndex;i=new a.SymbolScopeBuilder(h,k,null,null,j,i);g=new a.SymbolScopeBuilder(g,A,null,null,j,null);c.isConstructor&&b.scopeChain.thisType&&(b.scopeChain.thisType.constructorScope=
i);c.symbols=e;if(!c.isSpecialFn()){h=c.type;j=c.signature;c.isConstructor||(h.containedScope=i,i.container=h.symbol,h.memberScope=g,g.container=h.symbol);c.enclosingFnc=b.scopeChain.fnc;h.enclosingType=f?b.scopeChain.classType:b.scopeChain.thisType;h=c.type.symbol;(c.fncFlags&a.FncFlags.Signature)==a.FncFlags.None&&c.vars&&(b.typeFlow.addLocalsFromScope(i,h,c.vars,e,!1),b.typeFlow.addLocalsFromScope(g,h,c.statics,l,!1));if(j.parameters){f=j.parameters.length;for(e=0;e<f;e++)b.typeFlow.checker.resolveTypeLink(i,
j.parameters[e].parameter.typeLink,!0)}b.typeFlow.checker.resolveTypeLink(i,j.returnType,c.isSignature())}if(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))f=c.isConstructor&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)?b.scopeChain.thisType:null,d(i,b,f,null,c)}}function f(c,b){if(c.param){var e=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),e=new a.SymbolScopeBuilder(e,null,null,null,b.scopeChain.scope,b.scopeChain.scope.container);c.containedScope=
e;d(e,b,b.scopeChain.thisType,b.scopeChain.classType,b.scopeChain.fnc)}}a.AssignScopeContext=function(a,c,b){this.scopeChain=a;this.typeFlow=c;this.modDeclChain=b};a.pushAssignScope=d;a.popAssignScope=h;a.instanceCompare=b;a.instanceFilterStop=k;var j=function(a,c){this.select=a;this.stop=c;this.result=null};j.prototype.reset=function(){this.result=null};j.prototype.update=function(a){return(this.result=this.select(this.result,a))?this.stop(this.result):!1};a.ScopeSearchFilter=j;a.instanceFilter=
new j(b,k);a.preAssignModuleScopes=g;a.preAssignClassScopes=e;a.preAssignInterfaceScopes=l;a.preAssignWithScopes=c;a.preAssignFuncDeclScopes=i;a.preAssignCatchScopes=f;a.preAssignScopes=function(b,j,d){var j=d.state,k=!0;b&&(b.nodeType==a.NodeType.List?b.enclosingScope=j.scopeChain.scope:b.nodeType==a.NodeType.Module?g(b,j):b.nodeType==a.NodeType.Class?e(b,j):b.nodeType==a.NodeType.Interface?l(b,j):b.nodeType==a.NodeType.With?c(b,j):b.nodeType==a.NodeType.FuncDecl?i(b,j):b.nodeType==a.NodeType.Catch?
f(b,j):b.nodeType==a.NodeType.TypeRef&&(k=!1));d.options.goChildren=k;return b};a.postAssignScopes=function(c,b,e){var b=e.state,i=!0;c&&(c.nodeType==a.NodeType.Module?(h(b),b.modDeclChain.pop(),1<=b.modDeclChain.length&&(b.typeFlow.checker.currentModDecl=b.modDeclChain[b.modDeclChain.length-1])):c.nodeType==a.NodeType.Class?h(b):c.nodeType==a.NodeType.Interface?h(b):c.nodeType==a.NodeType.With?h(b):c.nodeType==a.NodeType.FuncDecl?(!c.isConstructor||a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod))&&
!c.isOverload&&h(b):c.nodeType==a.NodeType.Catch?c.param&&h(b):i=!1);e.options.goChildren=i;return c}})(TypeScript||(TypeScript={}));
(function(a){function d(b,d,g){var d=g.state,e=b.minChar,l=b.limChar;b.nodeType==a.NodeType.Script&&d.pos>l&&(l=d.pos);if(e<=d.pos&&l>=d.pos){switch(b.nodeType){case a.NodeType.Script:d.scopeGetter=function(){return null===b.bod?null:b.bod.enclosingScope};d.scopeStartAST=b;break;case a.NodeType.Class:d.scopeGetter=function(){return null===b.type||null===b.type.instanceType.containedScope?null:b.type.instanceType.containedScope};d.scopeStartAST=b;d.enclosingClassDecl=b;break;case a.NodeType.ObjectLit:b.targetType&&
(d.scopeGetter=function(){return b.targetType.containedScope},d.objectLiteralScopeGetter=function(){return b.targetType.memberScope},d.enclosingObjectLit=b);break;case a.NodeType.Module:d.deepestModuleDecl=b;d.scopeGetter=function(){return null===b.type?null:b.type.containedScope};d.scopeStartAST=b;break;case a.NodeType.Interface:d.scopeGetter=function(){return null===b.type?null:b.type.containedScope};d.scopeStartAST=b;break;case a.NodeType.FuncDecl:d.skipNextFuncDeclForClass?d.skipNextFuncDeclForClass=
!1:(d.scopeGetter=function(){return b.isConstructor&&a.hasFlag(b.fncFlags,a.FncFlags.ClassMethod)&&b.type&&b.type.enclosingType?b.type.enclosingType.constructorScope:b.scopeType?b.scopeType.containedScope:b.type?b.type.containedScope:null},d.scopeStartAST=b)}g.options.goChildren=!0}else g.options.goChildren=!1;return b}a.TypeCollectionContext=function(a,d){this.scopeChain=a;this.checker=d;this.script=null};a.MemberScopeContext=function(b,d,g){this.flow=b;this.pos=d;this.matchFlag=g;this.ast=this.type=
null;this.options=new a.AstWalkOptions};var h=function(a,d,g,e,l){this.logger=a;this.script=d;this.text=g;this.pos=e;this.isMemberCompletion=l;this.scopeStartAST=this.objectLiteralScopeGetter=this.scopeGetter=null;this.skipNextFuncDeclForClass=!1;this.enclosingObjectLit=this.enclosingClassDecl=this.deepestModuleDecl=null;this.publicsOnly=!0;this.useFullAst=!1};h.prototype.getScope=function(){return this.scopeGetter()};h.prototype.getObjectLiteralScope=function(){return this.objectLiteralScopeGetter()};
h.prototype.getScopeAST=function(){return this.scopeStartAST};h.prototype.getScopePosition=function(){return this.scopeStartAST.minChar};h.prototype.getScriptFragmentStartAST=function(){return this.scopeStartAST};h.prototype.getScriptFragmentPosition=function(){return this.getScriptFragmentStartAST().minChar};h.prototype.getScriptFragment=function(){if(null==this.scriptFragment){var b=this.getScriptFragmentStartAST();this.scriptFragment=a.quickParse(this.logger,b,this.text,b.minChar,this.isMemberCompletion?
this.pos:this.pos+1,null).Script}return this.scriptFragment};a.EnclosingScopeContext=h;a.preFindMemberScope=function(b,d,g){d=g.state;if(a.hasFlag(b.flags,d.matchFlag)&&(0>d.pos||d.pos==b.limChar))d.ast=b,null==b.type&&0<=d.pos&&d.flow.inScopeTypeCheck(b,d.scope),d.type=b.type,d.options.stopWalk();return b};a.pushTypeCollectionScope=function(b,d,g,e,l,c,i,f,j){d=new a.SymbolScopeBuilder(d,g,e,l,null,b);b=new a.ScopeChain(b,c.scopeChain,d);b.thisType=i;b.classType=f;b.moduleDecl=j;c.scopeChain=b};
a.popTypeCollectionScope=function(a){a.scopeChain=a.scopeChain.previous};a.preFindEnclosingScope=d;a.findEnclosingScopeAt=function(b,k,g,e,l){b=new h(b,k,g,e,l);a.getAstWalkerFactory().walk(k,d,null,null,b);return null===b.scopeStartAST?null:b}})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.hasVariableArgList=!1;this.declAST=this.parameters=null;this.typeCheckStatus=a.TypeCheckStatus.NotStarted;this.nonOptionalParameterCount=0};d.prototype.specializeType=function(b,h,g){var e=new d;this.hasVariableArgList&&(e.hasVariableArgList=!0);e.returnType=new a.TypeLink;e.returnType.type=this.returnType.type?this.returnType.type.specializeType(b,h,g,!1):g.anyType;if(this.parameters){e.parameters=[];for(var l=0,c=this.parameters.length;l<c;l++){var i=this.parameters[l],
f=new a.ValueLocation,j=new a.ParameterSymbol(i.name,i.location,g.locationInfo.unitIndex,f);j.declAST=this.declAST;f.symbol=j;f.typeLink=new a.TypeLink;e.parameters[l]=j;(i=i.getType())?(f.typeLink.type=i.specializeType(b,h,g,!1),j.declAST.type=f.typeLink.type):f.typeLink.type=g.anyType}}e.nonOptionalParameterCount=this.nonOptionalParameterCount;e.declAST=this.declAST;return e};d.prototype.toString=function(){return this.toStringHelper(!1,!1,null)};d.prototype.toStringHelper=function(a,d,g){var e;
e=d?"[":"(";for(var l=this.parameters.length,c=0;c<l;c++)e+=this.parameters[c].name+(this.parameters[c].isOptional()?"?":"")+": ",e+=this.parameters[c].getType().getScopedTypeName(g),c<l-1&&(e+=",");e=a?d?e+"] => ":e+") => ":d?e+"]: ":e+"): ";return e=this.returnType.type?e+this.returnType.type.getScopedTypeName(g):e+"any"};a.Signature=d;var h=function(){this.signatures=[];this.hasImplementation=!0;this.definitionSignature=null;this.hasBeenTypechecked=!1;this.flags=a.SignatureFlags.None};h.prototype.addSignature=
function(b){null==this.signatures&&(this.signatures=[]);this.signatures[this.signatures.length]=b;b.declAST&&(!b.declAST.isOverload&&!b.declAST.isSignature()&&!a.hasFlag(b.declAST.fncFlags,a.FncFlags.Ambient)&&a.hasFlag(b.declAST.fncFlags,a.FncFlags.Definition))&&(this.definitionSignature=b)};h.prototype.toString=function(){return this.signatures.toString()};h.prototype.toStrings=function(b,d,g){var e=[],l=this.signatures.length;1<l&&(d=!1);for(var c=0;c<l;c++)1<l&&this.signatures[c]==this.definitionSignature||
(e[c]=this.flags&a.SignatureFlags.IsIndexer?this.signatures[c].toStringHelper(d,!0,g):b+this.signatures[c].toStringHelper(d,!1,g));return e};h.prototype.specializeType=function(a,d,g){var e=new h;if(this.signatures)for(var l=0,c=this.signatures.length;l<c;l++)e.addSignature(this.signatures[l].specializeType(a,d,g));return e};h.prototype.verifySignatures=function(b){var d=0;if(this.signatures&&0<(d=this.signatures.length))for(var g=0;g<d;g++){for(var e=g+1;e<d;e++)this.signatures[g].declAST&&(this.signatures[e].declAST&&
!a.hasFlag(this.signatures[g].declAST.fncFlags,a.FncFlags.Definition)&&!a.hasFlag(this.signatures[e].declAST.fncFlags,a.FncFlags.Definition)&&b.signaturesAreIdentical(this.signatures[g],this.signatures[e]))&&b.errorReporter.simpleError(this.signatures[g].declAST,this.signatures[g].declAST&&this.signatures[g].declAST.name?"Signature for '"+this.signatures[g].declAST.name.text+"' is duplicated":"Signature is duplicated");this.definitionSignature&&(b.signatureIsAssignableToTarget(this.definitionSignature,
this.signatures[g])||b.errorReporter.simpleError(this.signatures[g].declAST,"Overload signature is not compatible with function definition"))}};h.prototype.typeCheck=function(b,d,g){if(!this.hasBeenTypechecked&&(this.hasBeenTypechecked=!0,d=0,this.signatures&&0<(d=this.signatures.length))){for(var e=0;e<d;e++)!g&&(!this.definitionSignature&&this.signatures[e].declAST&&this.signatures[e].declAST.isOverload&&!a.hasFlag(this.signatures[e].declAST.fncFlags,a.FncFlags.Ambient))&&b.errorReporter.simpleError(this.signatures[e].declAST,
"Overload declaration lacks definition"),this.signatures[e].declAST&&(this.signatures[e].declAST.isConstructor&&this.signatures[e].declAST.classDecl&&this.signatures[e].declAST.classDecl.type.symbol.typeCheckStatus==a.TypeCheckStatus.NotStarted)&&b.typeFlow.typeCheck(this.signatures[e].declAST.classDecl),b.typeFlow.typeCheck(this.signatures[e].declAST);this.verifySignatures(b)}};a.SignatureGroup=h})(TypeScript||(TypeScript={}));
(function(a){function d(c,b){return c.declAST&&b&&b.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl?c.declAST.minChar<=b.declAST.minChar&&c.declAST.limChar>=b.declAST.limChar:!1}function h(a,c){for(;a.container;){if(a==c||d(a.container,c))return!0;a=a.container}return!1}var b=a.TypeCheckStatus||(a.TypeCheckStatus={});b._map=[];b._map[0]="NotStarted";b.NotStarted=0;b._map[1]="Started";b.Started=1;b._map[2]="Finished";b.Finished=2;var k=a.TypeCheckStatus;a.aLexicallyEnclosesB=d;a.aEnclosesB=h;var g=
function(c,b,e){this.name=c;this.location=b;this.unitIndex=e;this.bound=!1;this.flags=a.SymbolFlags.None;this.isObjectLitField=!1;this.declModule=this.declAST=null;this.passSymbolCreated=a.CompilerDiagnostics.analysisPass};g.prototype.instanceScope=function(){return null};g.prototype.isVariable=function(){return!1};g.prototype.isMember=function(){return!1};g.prototype.isInferenceSymbol=function(){return!1};g.prototype.isWith=function(){return!1};g.prototype.writeable=function(){return!1};g.prototype.isType=
function(){return!1};g.prototype.getType=function(){return null};g.prototype.isAccessor=function(){return!1};g.prototype.isInstanceProperty=function(){return a.hasFlag(this.flags,a.SymbolFlags.Property)&&!a.hasFlag(this.flags,a.SymbolFlags.ModuleMember)};g.prototype.getTypeName=function(){return this.toString()};g.prototype.getOptionalNameString=function(){return a.hasFlag(this.flags,a.SymbolFlags.Optional)?"?":""};g.prototype.pathToRoot=function(){for(var c=[],b=this;b&&b.name!=a.globalId;)c[c.length]=
b,b=b.container;return c};g.prototype.findCommonAncestorPath=function(a){if(null==this.container)return[];for(var c=this.container.pathToRoot(),a=a?a.pathToRoot():[],b=-1,e=0,i=c.length;e<i;e++){for(var f=c[e],d=0,l=a.length;d<l;d++)if(f==a[d]){b=e;break}if(0<=b)break}return 0<=b?c.slice(0,b):c};g.prototype.scopeRelativeName=function(a){if(null==a)return this.name;for(var a=this.findCommonAncestorPath(a.container),c="",b=0,e=a.length;b<e;b++)c=a[b].name+"."+c;return c+=this.name};g.prototype.fullName=
function(){for(var c=this.name,b=this.container;b&&b.name!=a.globalId;)c=b.name+"."+c,b=b.container;return c};g.prototype.visible=function(c,b){if(null==b||this.container==b.gloMod)return!0;if(a.hasFlag(this.flags,a.SymbolFlags.ModuleMember))return a.hasFlag(this.flags,a.SymbolFlags.Exported)?a.hasFlag(this.flags,a.SymbolFlags.Private)?h(this,c.container):!0:b&&b.currentModDecl==this.declModule||b.currentModDecl&&b.currentModDecl.mod&&b.currentModDecl.mod.symbol&&this.declModule&&this.declModule.mod&&
this.declModule.mod.symbol&&h(b.currentModDecl.mod.symbol,this.declModule.mod.symbol);var e=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl,i=e&&this.declAST.isMethod(),e=e&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Static),f=i&&a.hasFlag(this.declAST.fncFlags,a.FncFlags.Private),d=this.isType()&&this.aliasLink;return this.isMember()||i||e||d?a.hasFlag(this.flags,a.SymbolFlags.Private)||f?null==c.container&&this.container!=c.container?!1:null==this.container?!0:h(c.container,this.container):
!0:this.container?h(this,c.container):!0};g.prototype.addRef=function(a){this.refs||(this.refs=[]);this.refs[this.refs.length]=a};g.prototype.toString=function(){return this.name?this.name:"_anonymous"};g.prototype.print=function(a){a.Write(this.toString())};g.prototype.specializeType=function(){throw Error("please implement in derived class");};g.prototype.setType=function(){throw Error("please implement in derived class");};g.prototype.kind=function(){throw Error("please implement in derived class");
};a.Symbol=g;var e;e=function(){};a.ValueLocation=e;var l=function(a,c,b){g.call(this,a,c,b);this.typeCheckStatus=k.NotStarted};__extends(l,g);l.prototype.isInferenceSymbol=function(){return!0};l.prototype.transferVarFlags=function(c){a.hasFlag(c,a.VarFlags.Ambient)&&(this.flags|=a.SymbolFlags.Ambient);a.hasFlag(c,a.VarFlags.Constant)&&(this.flags|=a.SymbolFlags.Constant);a.hasFlag(c,a.VarFlags.Static)&&(this.flags|=a.SymbolFlags.Static);a.hasFlag(c,a.VarFlags.Property)&&(this.flags|=a.SymbolFlags.Property);
a.hasFlag(c,a.VarFlags.Private)&&(this.flags|=a.SymbolFlags.Private);a.hasFlag(c,a.VarFlags.Public)&&(this.flags|=a.SymbolFlags.Public);a.hasFlag(c,a.VarFlags.Readonly)&&(this.flags|=a.SymbolFlags.Readonly);a.hasFlag(c,a.VarFlags.Exported)&&(this.flags|=a.SymbolFlags.Exported)};a.InferenceSymbol=l;var c=function(c,b,e,i){l.call(this,c,b,e);this.type=i;this.expansions=[];this.isMethod=!1;this.aliasLink=null;this.onlyReferencedAsTypeRef=a.optimizeModuleCodeGen;this.prettyName=this.name};__extends(c,
l);c.prototype.addLocation=function(a){null==this.additionalLocations&&(this.additionalLocations=[]);this.additionalLocations[this.additionalLocations.length]=a};c.prototype.kind=function(){return a.SymbolKind.Type};c.prototype.isType=function(){return!0};c.prototype.getType=function(){return this.type};c.prototype.getTypeName=function(a){return this.type.getMemberTypeName(this.name?this.name+this.getOptionalNameString():"",!1,!1,a)};c.prototype.instanceScope=function(){return!(this.type.typeFlags&
a.TypeFlags.IsClass)&&this.type.isClass()?this.type.instanceType.constructorScope:this.type.containedScope};c.prototype.toString=function(){var a=this.type.getTypeName();this.name&&(a=this.name+":"+a);return a};c.prototype.isClass=function(){return null!=this.instanceType};c.prototype.isFunction=function(){return null!=this.declAST&&this.declAST.nodeType==a.NodeType.FuncDecl};c.prototype.specializeType=function(a,b,e){if(this.type==a)return b.symbol;a=this.type.specializeType(a,b,e,!1);return a!=
this.type?new c(this.name,0,-1,a):this};c.prototype.scopeRelativeName=function(c){if(null==c)return this.prettyName+this.getOptionalNameString();for(var c=this.findCommonAncestorPath(c.container),b="",e=0,i=c.length;e<i;e++)b=(c[e].kind()==a.SymbolKind.Type?c[e].prettyName:c[e].name)+"."+b;return b+=this.prettyName+this.getOptionalNameString()};a.TypeSymbol=c;b=function(a,b,e){c.call(this,"with",a,b,e)};__extends(b,c);b.prototype.isWith=function(){return!0};a.WithSymbol=b;var i=function(a,c,b,e,i){l.call(this,
a,c,b);this.canWrite=e;this.field=i;this.setter=this.getter=null;this.hasBeenEmitted=!1;this.name=a;this.location=c};__extends(i,l);i.prototype.kind=function(){return a.SymbolKind.Field};i.prototype.writeable=function(){return this.isAccessor()?null!=this.setter:this.canWrite};i.prototype.getType=function(){return this.field.typeLink.type};i.prototype.getTypeName=function(a){return this.name+this.getOptionalNameString()+": "+this.field.typeLink.type.getMemberTypeName("",!0,!1,a)};i.prototype.isMember=
function(){return!0};i.prototype.setType=function(a){this.field.typeLink.type=a};i.prototype.isAccessor=function(){return null!=this.getter||null!=this.setter};i.prototype.isVariable=function(){return!0};i.prototype.toString=function(){return this.name+this.getOptionalNameString()+":"+this.field.typeLink.type.getTypeName()};i.prototype.specializeType=function(c,b,f){c=this.field.typeLink.type.specializeType(c,b,f,!1);return c!=this.field.typeLink.type?(b=new e,f=new i(this.name,0,f.locationInfo.unitIndex,
this.canWrite,b),f.flags=this.flags,b.symbol=f,b.typeLink=new a.TypeLink,f.setType(c),f.typeCheckStatus=k.Finished,f):this};a.FieldSymbol=i;var f=function(a,c,b,e){l.call(this,a,c,b);this.parameter=e;this.argsOffset=-1;this.name=a;this.location=c};__extends(f,l);f.prototype.kind=function(){return a.SymbolKind.Parameter};f.prototype.writeable=function(){return!0};f.prototype.getType=function(){return this.parameter.typeLink.type};f.prototype.setType=function(a){this.parameter.typeLink.type=a};f.prototype.isVariable=
function(){return!0};f.prototype.isOptional=function(){return this.parameter&&this.parameter.symbol&&this.parameter.symbol.declAST?this.parameter.symbol.declAST.isOptional:!1};f.prototype.getTypeName=function(a){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getMemberTypeName("",!1,!1,a)};f.prototype.toString=function(){return this.name+(this.isOptional()?"?":"")+":"+this.getType().getTypeName()};f.prototype.specializeType=function(a,c,b){a=this.parameter.typeLink.type.specializeType(a,
c,b,!1);return this.parameter.typeLink.type!=a?(c=new e,b=new f(this.name,0,b.locationInfo.unitIndex,c),c.symbol=b,b.setType(a),b):this};a.ParameterSymbol=f;b=function(a,c,b,e){l.call(this,a,c,b);this.variable=e};__extends(b,l);b.prototype.kind=function(){return a.SymbolKind.Variable};b.prototype.writeable=function(){return!0};b.prototype.getType=function(){return this.variable.typeLink.type};b.prototype.getTypeName=function(a){return this.name+":"+this.getType().getMemberTypeName("",!1,!1,a)};b.prototype.setType=
function(a){this.variable.typeLink.type=a};b.prototype.isVariable=function(){return!0};a.VariableSymbol=b})(TypeScript||(TypeScript={}));
(function(a){var d=function(a){this.allMembers=this.dualMembers=a;this.publicMembers=this.dualMembers.primaryTable;this.privateMembers=this.dualMembers.secondaryTable};d.prototype.addPublicMember=function(a,b){return this.dualMembers.primaryTable.add(a,b)};d.prototype.addPrivateMember=function(a,b){return this.dualMembers.secondaryTable.add(a,b)};a.ScopedMembers=d;d=a.SymbolKind||(a.SymbolKind={});d._map=[];d._map[0]="None";d.None=0;d._map[1]="Type";d.Type=1;d._map[2]="Field";d.Field=2;d._map[3]=
"Parameter";d.Parameter=3;d._map[4]="Variable";d.Variable=4;var h=a.SymbolKind,b=function(a){this.container=a};b.prototype.printLabel=function(){return"base"};b.prototype.getAllSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllTypeSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.getAllValueSymbolNames=function(){return["please","implement","in","derived","classes"]};b.prototype.search=function(){return null};b.prototype.findLocal=
function(){return null};b.prototype.find=function(){return null};b.prototype.findImplementation=function(){return null};b.prototype.findAmbient=function(){return null};b.prototype.print=function(a){this.container?a.WriteLine(this.printLabel()+" scope with container: "+this.container.name+"..."):a.WriteLine(this.printLabel()+" scope...")};b.prototype.enter=function(){throw Error("please implement in derived class");};b.prototype.getTable=function(){throw Error("please implement in derived class");
};a.SymbolScope=b;d=function(a){this.container=a;this.parents=this.typeAmbientCache=this.typeImplCache=this.typeCache=this.valueAmbientCache=this.valueImplCache=this.valueCache=null;this.container=a};__extends(d,b);d.prototype.printLabel=function(){return"agg"};d.prototype.search=function(a,b,d,c){if(this.parents)for(var i=0;i<this.parents.length;i++){var f=this.parents[i].search(a,b,d,c);if(f&&a.update(f))return f}return a.result};d.prototype.getAllSymbolNames=function(a){var b=[];if(this.parents)for(var d=
0;d<this.parents.length;d++){var c=this.parents[d].getAllSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.getAllTypeSymbolNames=function(a){var b=[];if(this.parents)for(var d=0;d<this.parents.length;d++){var c=this.parents[d].getAllTypeSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.getAllValueSymbolNames=function(a){var b=[];if(this.parents)for(var d=0;d<this.parents.length;d++){var c=this.parents[d].getAllValueSymbolNames(a);c&&(b=b.concat(c))}return b};d.prototype.print=function(a){b.prototype.print.call(this,
a);if(this.parents)for(var e=0;e<this.parents.length;e++)this.parents[e].print(a)};d.prototype.findImplementation=function(b,e,d){var c=null,i=0,f=this.valueImplCache;d&&(f=this.typeImplCache);if(f&&null!=(c=f.lookup(b))&&(e?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(i=0;i<this.parents.length&&!(c=this.parents[i].findImplementation(b,e,d));i++);f&&(f=d?this.typeImplCache=
new a.StringHashTable:this.valueImplCache=new a.StringHashTable);f.add(b,c);return c};d.prototype.find=function(b,e,d){var c=null,i=0,f=this.valueCache;d&&(f=this.typeCache);if(f&&null!=(c=f.lookup(b))&&(e?!(a.hasFlag(c.flags,a.SymbolFlags.Private)||c.declAST&&c.declAST.nodeType==a.NodeType.FuncDecl&&a.hasFlag(c.declAST.fncFlags,a.FncFlags.Private)):1))return c;if(this.parents)for(i=0;i<this.parents.length&&!(c=this.parents[i].find(b,e,d));i++);null==f&&(f=d?this.typeCache=new a.StringHashTable:this.valueCache=
new a.StringHashTable);f.add(b,c);return c};d.prototype.findAmbient=function(b,e,d){var c=null,i=0,f=this.valueAmbientCache;d&&(f=this.typeAmbientCache);if(f&&null!=(c=f.lookup(b)))return c;if(this.parents)for(i=0;i<this.parents.length&&!(c=this.parents[i].findAmbient(b,e,d));i++);null==f&&(f=d?this.typeAmbientCache=new a.StringHashTable:this.valueAmbientCache=new a.StringHashTable);f.add(b,c);return c};d.prototype.addParentScope=function(a){null==this.parents&&(this.parents=[]);this.parents[this.parents.length]=
a};a.SymbolAggregateScope=d;d=function(a,b,d,c,i){this.container=i;this.valueMembers=a;this.ambientValueMembers=b;this.enclosedTypes=d;this.ambientEnclosedTypes=c;this.container=i};__extends(d,b);d.prototype.printLabel=function(){return"table"};d.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};d.prototype.getAllTypeSymbolNames=function(){var a=[];this.ambientEnclosedTypes&&(a=a.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));
this.enclosedTypes&&(a=a.concat(this.enclosedTypes.allMembers.getAllKeys()));return a};d.prototype.getAllValueSymbolNames=function(){var a=[];this.ambientValueMembers&&(a=a.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(a=a.concat(this.valueMembers.allMembers.getAllKeys()));return a};d.prototype.search=function(a,b,d,c){b=this.find(b,d,c);a.update(b);return a.result};d.prototype.find=function(a,b,d){var c=null,i=null;d?(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:
this.enclosedTypes.allMembers,i=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers):(c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,i=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers);return i&&(b=i.lookup(a))||c&&(b=c.lookup(a))?b:null};d.prototype.findAmbient=function(a,b,d){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:
this.ambientValueMembers.allMembers;d&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&(a=c.lookup(a))?a:null};d.prototype.print=function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+
b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null)};d.prototype.findImplementation=function(a,b,d){(a=this.find(a,b,d))&&(a.kind()==h.Type?a.type.hasImplementation()||(a=null):a.container&&a.container.kind()==h.Type&&(a.container.type.hasImplementation()||(a=null)));return a};d.prototype.getTable=function(){return this.valueMembers.publicMembers};a.SymbolTableScope=d;var k=function(a,b,d,c,i,f){this.container=f;this.valueMembers=a;this.ambientValueMembers=
b;this.enclosedTypes=d;this.ambientEnclosedTypes=c;this.parent=i;this.container=f};__extends(k,b);k.prototype.printLabel=function(){return"builder"};k.prototype.getAllSymbolNames=function(a){return this.getAllTypeSymbolNames(a).concat(this.getAllValueSymbolNames(a))};k.prototype.getAllTypeSymbolNames=function(a){var b=[];this.ambientEnclosedTypes&&(b=b.concat(this.ambientEnclosedTypes.allMembers.getAllKeys()));this.enclosedTypes&&(b=b.concat(this.enclosedTypes.allMembers.getAllKeys()));!a&&this.parent&&
(a=this.parent.getAllTypeSymbolNames(a))&&(b=b.concat(a));return b};k.prototype.getAllValueSymbolNames=function(a){var b=[];this.ambientValueMembers&&(b=b.concat(this.ambientValueMembers.allMembers.getAllKeys()));this.valueMembers&&(b=b.concat(this.valueMembers.allMembers.getAllKeys()));!a&&this.parent&&(a=this.parent.getAllValueSymbolNames(a))&&(b=b.concat(a));return b};k.prototype.search=function(a,b,d,c){var i=null,f=null==this.valueMembers?null:d?this.valueMembers.publicMembers:this.valueMembers.allMembers,
j=null==this.ambientValueMembers?null:d?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;c&&(f=null==this.enclosedTypes?null:d?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,j=null==this.ambientEnclosedTypes?null:d?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return j&&null!=(i=j.lookup(b))&&a.update(i)||f&&null!=(i=f.lookup(b))&&a.update(i)||this.parent&&(i=this.parent.search(a,b,d,c))&&a.update(i)?i:a.result};k.prototype.print=
function(a){b.prototype.print.call(this,a);this.ambientValueMembers&&this.ambientValueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.valueMembers&&this.valueMembers.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.ambientEnclosedTypes&&this.ambientEnclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.enclosedTypes&&this.enclosedTypes.allMembers.map(function(b){a.WriteLine("  "+b)},null);this.parent&&this.parent.print(a)};k.prototype.find=function(a,
b,d){var c=null==this.valueMembers?null:b?this.valueMembers.publicMembers:this.valueMembers.allMembers,i=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;d&&(c=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,i=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return i&&null!=i.lookup(a)||c&&null!=c.lookup(a)?null:this.parent?
this.parent.find(a,b,d):null};k.prototype.findAmbient=function(a,b,d){var c=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;d&&(c=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return c&&null!=c.lookup(a)?null:this.parent?this.parent.findAmbient(a,b,d):null};k.prototype.findLocal=function(a,b,d){var c=null,i=null==this.valueMembers?null:b?this.valueMembers.publicMembers:
this.valueMembers.allMembers,f=null==this.ambientValueMembers?null:b?this.ambientValueMembers.publicMembers:this.ambientValueMembers.allMembers;d&&(i=null==this.enclosedTypes?null:b?this.enclosedTypes.publicMembers:this.enclosedTypes.allMembers,f=null==this.ambientEnclosedTypes?null:b?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.allMembers);return i&&null!=(c=i.lookup(a))&&c||f&&null!=(c=f.lookup(a))&&c?c:null};k.prototype.enter=function(b,e,d,c,i,f,j){var h=null;(h=j?f?null==
this.ambientEnclosedTypes?null:i?this.ambientEnclosedTypes.publicMembers:this.ambientEnclosedTypes.privateMembers:null==this.ambientValueMembers?null:i?this.ambientValueMembers.publicMembers:this.ambientValueMembers.privateMembers:f?null==this.enclosedTypes?null:i?this.enclosedTypes.publicMembers:this.enclosedTypes.privateMembers:null==this.valueMembers?null:i?this.valueMembers.publicMembers:this.valueMembers.privateMembers)?h.add(d.name,d)||c.duplicateIdentifier(e,d.name):a.CompilerDiagnostics.Alert("YYYYY");
d.container=b};k.prototype.getTable=function(){return this.valueMembers.allMembers};a.SymbolScopeBuilder=k;d=function(a,b,d){this.container=b;this.scope=a;this.filter=d};__extends(d,b);d.prototype.print=function(a){this.scope.print(a)};d.prototype.find=function(a,b,d){this.filter.reset();return this.scope.search(this.filter,a,b,d)};d.prototype.findLocal=function(a,b,d){return this.scope.findLocal(a,b,d)};a.FilteredSymbolScope=d;d=function(a,b,d,c){k.call(this,a,null,null,null,b,d);this.filter=c};
__extends(d,k);d.prototype.findLocal=function(a,b,d){return(a=k.prototype.findLocal.call(this,a,b,d))&&!this.filter(a)?null:a};d.prototype.search=function(){throw Error("please implement");};d.prototype.find=function(a,b,d){var c=k.prototype.findLocal.call(this,a,b,d);return c&&!this.filter(c)?null:k.prototype.find.call(this,a,b,d)};a.FilteredSymbolScopeBuilder=d})(TypeScript||(TypeScript={}));
(function(a){function d(c,b,d,l,g,h,k,n){void 0!==c&&(a.tokenTable[c]=new e(c,b,d,l,g,h,k,n),l!=a.NodeType.None&&(a.nodeTypeTable[l]=k,a.nodeTypeToTokTable[l]=c),h!=a.NodeType.None&&(a.nodeTypeTable[h]=k))}function h(c){return a.tokenTable[c]}var b=a.TokenID||(a.TokenID={});b._map=[];b._map[0]="ANY";b.ANY=0;b._map[1]="BOOL";b.BOOL=1;b._map[2]="BREAK";b.BREAK=2;b._map[3]="CASE";b.CASE=3;b._map[4]="CATCH";b.CATCH=4;b._map[5]="CLASS";b.CLASS=5;b._map[6]="CONST";b.CONST=6;b._map[7]="CONTINUE";b.CONTINUE=
7;b._map[8]="DEBUGGER";b.DEBUGGER=8;b._map[9]="DEFAULT";b.DEFAULT=9;b._map[10]="DELETE";b.DELETE=10;b._map[11]="DO";b.DO=11;b._map[12]="ELSE";b.ELSE=12;b._map[13]="ENUM";b.ENUM=13;b._map[14]="EXPORT";b.EXPORT=14;b._map[15]="EXTENDS";b.EXTENDS=15;b._map[16]="DECLARE";b.DECLARE=16;b._map[17]="FALSE";b.FALSE=17;b._map[18]="FINALLY";b.FINALLY=18;b._map[19]="FOR";b.FOR=19;b._map[20]="FUNCTION";b.FUNCTION=20;b._map[21]="CONSTRUCTOR";b.CONSTRUCTOR=21;b._map[22]="GET";b.GET=22;b._map[23]="IF";b.IF=23;b._map[24]=
"IMPLEMENTS";b.IMPLEMENTS=24;b._map[25]="IMPORT";b.IMPORT=25;b._map[26]="IN";b.IN=26;b._map[27]="INSTANCEOF";b.INSTANCEOF=27;b._map[28]="INTERFACE";b.INTERFACE=28;b._map[29]="LET";b.LET=29;b._map[30]="MODULE";b.MODULE=30;b._map[31]="NEW";b.NEW=31;b._map[32]="NUMBER";b.NUMBER=32;b._map[33]="NULL";b.NULL=33;b._map[34]="PACKAGE";b.PACKAGE=34;b._map[35]="PRIVATE";b.PRIVATE=35;b._map[36]="PROTECTED";b.PROTECTED=36;b._map[37]="PUBLIC";b.PUBLIC=37;b._map[38]="RETURN";b.RETURN=38;b._map[39]="SET";b.SET=39;
b._map[40]="STATIC";b.STATIC=40;b._map[41]="STRING";b.STRING=41;b._map[42]="SUPER";b.SUPER=42;b._map[43]="SWITCH";b.SWITCH=43;b._map[44]="THIS";b.THIS=44;b._map[45]="THROW";b.THROW=45;b._map[46]="TRUE";b.TRUE=46;b._map[47]="TRY";b.TRY=47;b._map[48]="TYPEOF";b.TYPEOF=48;b._map[49]="VAR";b.VAR=49;b._map[50]="VOID";b.VOID=50;b._map[51]="WITH";b.WITH=51;b._map[52]="WHILE";b.WHILE=52;b._map[53]="YIELD";b.YIELD=53;b._map[54]="SColon";b.SColon=54;b._map[55]="LParen";b.LParen=55;b._map[56]="RParen";b.RParen=
56;b._map[57]="LBrack";b.LBrack=57;b._map[58]="RBrack";b.RBrack=58;b._map[59]="LCurly";b.LCurly=59;b._map[60]="RCurly";b.RCurly=60;b._map[61]="Comma";b.Comma=61;b._map[62]="Asg";b.Asg=62;b._map[63]="AsgAdd";b.AsgAdd=63;b._map[64]="AsgSub";b.AsgSub=64;b._map[65]="AsgMul";b.AsgMul=65;b._map[66]="AsgDiv";b.AsgDiv=66;b._map[67]="AsgMod";b.AsgMod=67;b._map[68]="AsgAnd";b.AsgAnd=68;b._map[69]="AsgXor";b.AsgXor=69;b._map[70]="AsgOr";b.AsgOr=70;b._map[71]="AsgLsh";b.AsgLsh=71;b._map[72]="AsgRsh";b.AsgRsh=
72;b._map[73]="AsgRs2";b.AsgRs2=73;b._map[74]="QMark";b.QMark=74;b._map[75]="Colon";b.Colon=75;b._map[76]="LogOr";b.LogOr=76;b._map[77]="LogAnd";b.LogAnd=77;b._map[78]="Or";b.Or=78;b._map[79]="Xor";b.Xor=79;b._map[80]="And";b.And=80;b._map[81]="EQ";b.EQ=81;b._map[82]="NE";b.NE=82;b._map[83]="Eqv";b.Eqv=83;b._map[84]="NEqv";b.NEqv=84;b._map[85]="LT";b.LT=85;b._map[86]="LE";b.LE=86;b._map[87]="GT";b.GT=87;b._map[88]="GE";b.GE=88;b._map[89]="Lsh";b.Lsh=89;b._map[90]="Rsh";b.Rsh=90;b._map[91]="Rs2";b.Rs2=
91;b._map[92]="Add";b.Add=92;b._map[93]="Sub";b.Sub=93;b._map[94]="Mult";b.Mult=94;b._map[95]="Div";b.Div=95;b._map[96]="Pct";b.Pct=96;b._map[97]="Tilde";b.Tilde=97;b._map[98]="Bang";b.Bang=98;b._map[99]="Inc";b.Inc=99;b._map[100]="Dec";b.Dec=100;b._map[101]="Dot";b.Dot=101;b._map[102]="Ellipsis";b.Ellipsis=102;b._map[103]="Error";b.Error=103;b._map[104]="EOF";b.EOF=104;b._map[105]="Arrow";b.Arrow=105;b._map[106]="ID";b.ID=106;b._map[107]="QString";b.QString=107;b._map[108]="Regex";b.Regex=108;b._map[109]=
"NumberLit";b.NumberLit=109;b._map[110]="Whitespace";b.Whitespace=110;b._map[111]="Comment";b.Comment=111;b._map[112]="Lim";b.Lim=112;b.LimFixed=b.Arrow;b.LimKeyword=b.YIELD;var k=a.TokenID;a.tokenTable=[];a.nodeTypeTable=[];a.nodeTypeToTokTable=[];a.noRegexTable=[];a.noRegexTable[k.ID]=!0;a.noRegexTable[k.QString]=!0;a.noRegexTable[k.NumberLit]=!0;a.noRegexTable[k.Regex]=!0;a.noRegexTable[k.THIS]=!0;a.noRegexTable[k.Inc]=!0;a.noRegexTable[k.Dec]=!0;a.noRegexTable[k.RParen]=!0;a.noRegexTable[k.RBrack]=
!0;a.noRegexTable[k.RCurly]=!0;a.noRegexTable[k.TRUE]=!0;a.noRegexTable[k.FALSE]=!0;b=a.OperatorPrecedence||(a.OperatorPrecedence={});b._map=[];b._map[0]="No";b.No=0;b._map[1]="Cma";b.Cma=1;b._map[2]="Asg";b.Asg=2;b._map[3]="Que";b.Que=3;b._map[4]="Lor";b.Lor=4;b._map[5]="Lan";b.Lan=5;b._map[6]="Bor";b.Bor=6;b._map[7]="Xor";b.Xor=7;b._map[8]="Ban";b.Ban=8;b._map[9]="Equ";b.Equ=9;b._map[10]="Cmp";b.Cmp=10;b._map[11]="Shf";b.Shf=11;b._map[12]="Add";b.Add=12;b._map[13]="Mul";b.Mul=13;b._map[14]="Uni";
b.Uni=14;b._map[15]="Lim";b.Lim=15;var b=a.OperatorPrecedence,g=a.Reservation||(a.Reservation={});g._map=[];g.None=0;g.Javascript=1;g.JavascriptFuture=2;g.TypeScript=4;g.JavascriptFutureStrict=8;g.TypeScriptAndJS=g.Javascript|g.TypeScript;g.TypeScriptAndJSFuture=g.JavascriptFuture|g.TypeScript;g.TypeScriptAndJSFutureStrict=g.JavascriptFutureStrict|g.TypeScript;var g=a.Reservation,e;e=function(a,c,b,e,d,l,g,h){this.tokenId=a;this.reservation=c;this.binopPrecedence=b;this.binopNodeType=e;this.unopPrecedence=
d;this.unopNodeType=l;this.text=g;this.ers=h};a.TokenInfo=e;d(k.ANY,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"any",a.ErrorRecoverySet.PrimType);d(k.BOOL,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"bool",a.ErrorRecoverySet.PrimType);d(k.BREAK,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"break",a.ErrorRecoverySet.Stmt);d(k.CASE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"case",a.ErrorRecoverySet.SCase);d(k.CATCH,g.TypeScriptAndJS,b.No,a.NodeType.None,
b.No,a.NodeType.None,"catch",a.ErrorRecoverySet.Catch);d(k.CLASS,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"class",a.ErrorRecoverySet.TypeScriptS);d(k.CONST,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"const",a.ErrorRecoverySet.Var);d(k.CONTINUE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"continue",a.ErrorRecoverySet.Stmt);d(k.DEBUGGER,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.Debugger,"debugger",a.ErrorRecoverySet.Stmt);
d(k.DEFAULT,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"default",a.ErrorRecoverySet.SCase);d(k.DELETE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Delete,"delete",a.ErrorRecoverySet.Prefix);d(k.DO,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"do",a.ErrorRecoverySet.Stmt);d(k.ELSE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"else",a.ErrorRecoverySet.Else);d(k.ENUM,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"enum",a.ErrorRecoverySet.TypeScriptS);
d(k.EXPORT,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"export",a.ErrorRecoverySet.TypeScriptS);d(k.EXTENDS,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"extends",a.ErrorRecoverySet.None);d(k.DECLARE,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"declare",a.ErrorRecoverySet.Stmt);d(k.FALSE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"false",a.ErrorRecoverySet.RLit);d(k.FINALLY,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"finally",a.ErrorRecoverySet.Catch);d(k.FOR,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"for",a.ErrorRecoverySet.Stmt);d(k.FUNCTION,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"function",a.ErrorRecoverySet.Func);d(k.CONSTRUCTOR,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"constructor",a.ErrorRecoverySet.Func);d(k.GET,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"get",a.ErrorRecoverySet.Func);d(k.SET,g.TypeScript,b.No,a.NodeType.None,
b.No,a.NodeType.None,"set",a.ErrorRecoverySet.Func);d(k.IF,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"if",a.ErrorRecoverySet.Stmt);d(k.IMPLEMENTS,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"implements",a.ErrorRecoverySet.None);d(k.IMPORT,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"import",a.ErrorRecoverySet.TypeScriptS);d(k.IN,g.TypeScriptAndJS,b.Cmp,a.NodeType.In,b.No,a.NodeType.None,"in",a.ErrorRecoverySet.None);d(k.INSTANCEOF,
g.TypeScriptAndJS,b.Cmp,a.NodeType.InstOf,b.No,a.NodeType.None,"instanceof",a.ErrorRecoverySet.BinOp);d(k.INTERFACE,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"interface",a.ErrorRecoverySet.TypeScriptS);d(k.LET,g.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"let",a.ErrorRecoverySet.None);d(k.MODULE,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"module",a.ErrorRecoverySet.TypeScriptS);d(k.NEW,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,
"new",a.ErrorRecoverySet.PreOp);d(k.NUMBER,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"number",a.ErrorRecoverySet.PrimType);d(k.NULL,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"null",a.ErrorRecoverySet.RLit);d(k.PACKAGE,g.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"package",a.ErrorRecoverySet.None);d(k.PRIVATE,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"private",a.ErrorRecoverySet.TypeScriptS);d(k.PROTECTED,g.JavascriptFutureStrict,
b.No,a.NodeType.None,b.No,a.NodeType.None,"protected",a.ErrorRecoverySet.None);d(k.PUBLIC,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"public",a.ErrorRecoverySet.TypeScriptS);d(k.RETURN,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"return",a.ErrorRecoverySet.Stmt);d(k.STATIC,g.TypeScriptAndJSFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"static",a.ErrorRecoverySet.None);d(k.STRING,g.TypeScript,b.No,a.NodeType.None,b.No,a.NodeType.None,"string",a.ErrorRecoverySet.PrimType);
d(k.SUPER,g.TypeScriptAndJSFuture,b.No,a.NodeType.None,b.No,a.NodeType.None,"super",a.ErrorRecoverySet.RLit);d(k.SWITCH,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"switch",a.ErrorRecoverySet.Stmt);d(k.THIS,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"this",a.ErrorRecoverySet.RLit);d(k.THROW,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"throw",a.ErrorRecoverySet.Stmt);d(k.TRUE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"true",a.ErrorRecoverySet.RLit);
d(k.TRY,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"try",a.ErrorRecoverySet.Stmt);d(k.TYPEOF,g.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Typeof,"typeof",a.ErrorRecoverySet.Prefix);d(k.VAR,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"var",a.ErrorRecoverySet.Var);d(k.VOID,g.TypeScriptAndJS,b.No,a.NodeType.None,b.Uni,a.NodeType.Void,"void",a.ErrorRecoverySet.Prefix);d(k.WITH,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.With,"with",a.ErrorRecoverySet.Stmt);
d(k.WHILE,g.TypeScriptAndJS,b.No,a.NodeType.None,b.No,a.NodeType.None,"while",a.ErrorRecoverySet.While);d(k.YIELD,g.JavascriptFutureStrict,b.No,a.NodeType.None,b.No,a.NodeType.None,"yield",a.ErrorRecoverySet.None);d(k.ID,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"identifier",a.ErrorRecoverySet.ID);d(k.NumberLit,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"numberLiteral",a.ErrorRecoverySet.Literal);d(k.Regex,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"regex",a.ErrorRecoverySet.RegExp);
d(k.QString,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"qstring",a.ErrorRecoverySet.Literal);d(k.SColon,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,";",a.ErrorRecoverySet.SColon);d(k.RParen,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,")",a.ErrorRecoverySet.RParen);d(k.RBrack,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"]",a.ErrorRecoverySet.RBrack);d(k.LCurly,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"{",a.ErrorRecoverySet.LCurly);d(k.RCurly,g.None,b.No,a.NodeType.None,
b.No,a.NodeType.None,"}",a.ErrorRecoverySet.RCurly);d(k.Ellipsis,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"...",a.ErrorRecoverySet.None);d(k.Comma,g.None,b.Cma,a.NodeType.Comma,b.No,a.NodeType.None,",",a.ErrorRecoverySet.Comma);d(k.Asg,g.None,b.Asg,a.NodeType.Asg,b.No,a.NodeType.None,"=",a.ErrorRecoverySet.Asg);d(k.AsgAdd,g.None,b.Asg,a.NodeType.AsgAdd,b.No,a.NodeType.None,"+=",a.ErrorRecoverySet.BinOp);d(k.AsgSub,g.None,b.Asg,a.NodeType.AsgSub,b.No,a.NodeType.None,"-=",a.ErrorRecoverySet.BinOp);
d(k.AsgMul,g.None,b.Asg,a.NodeType.AsgMul,b.No,a.NodeType.None,"*=",a.ErrorRecoverySet.BinOp);d(k.AsgDiv,g.None,b.Asg,a.NodeType.AsgDiv,b.No,a.NodeType.None,"/=",a.ErrorRecoverySet.BinOp);d(k.AsgMod,g.None,b.Asg,a.NodeType.AsgMod,b.No,a.NodeType.None,"%=",a.ErrorRecoverySet.BinOp);d(k.AsgAnd,g.None,b.Asg,a.NodeType.AsgAnd,b.No,a.NodeType.None,"&=",a.ErrorRecoverySet.BinOp);d(k.AsgXor,g.None,b.Asg,a.NodeType.AsgXor,b.No,a.NodeType.None,"^=",a.ErrorRecoverySet.BinOp);d(k.AsgOr,g.None,b.Asg,a.NodeType.AsgOr,
b.No,a.NodeType.None,"|=",a.ErrorRecoverySet.BinOp);d(k.AsgLsh,g.None,b.Asg,a.NodeType.AsgLsh,b.No,a.NodeType.None,"<<=",a.ErrorRecoverySet.BinOp);d(k.AsgRsh,g.None,b.Asg,a.NodeType.AsgRsh,b.No,a.NodeType.None,">>=",a.ErrorRecoverySet.BinOp);d(k.AsgRs2,g.None,b.Asg,a.NodeType.AsgRs2,b.No,a.NodeType.None,">>>=",a.ErrorRecoverySet.BinOp);d(k.QMark,g.None,b.Que,a.NodeType.QMark,b.No,a.NodeType.None,"?",a.ErrorRecoverySet.BinOp);d(k.Colon,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,":",a.ErrorRecoverySet.Colon);
d(k.LogOr,g.None,b.Lor,a.NodeType.LogOr,b.No,a.NodeType.None,"||",a.ErrorRecoverySet.BinOp);d(k.LogAnd,g.None,b.Lan,a.NodeType.LogAnd,b.No,a.NodeType.None,"&&",a.ErrorRecoverySet.BinOp);d(k.Or,g.None,b.Bor,a.NodeType.Or,b.No,a.NodeType.None,"|",a.ErrorRecoverySet.BinOp);d(k.Xor,g.None,b.Xor,a.NodeType.Xor,b.No,a.NodeType.None,"^",a.ErrorRecoverySet.BinOp);d(k.And,g.None,b.Ban,a.NodeType.And,b.No,a.NodeType.None,"&",a.ErrorRecoverySet.BinOp);d(k.EQ,g.None,b.Equ,a.NodeType.Eq,b.No,a.NodeType.None,"==",
a.ErrorRecoverySet.BinOp);d(k.NE,g.None,b.Equ,a.NodeType.Ne,b.No,a.NodeType.None,"!=",a.ErrorRecoverySet.BinOp);d(k.Eqv,g.None,b.Equ,a.NodeType.Eqv,b.No,a.NodeType.None,"===",a.ErrorRecoverySet.BinOp);d(k.NEqv,g.None,b.Equ,a.NodeType.NEqv,b.No,a.NodeType.None,"!==",a.ErrorRecoverySet.BinOp);d(k.LT,g.None,b.Cmp,a.NodeType.Lt,b.No,a.NodeType.None,"<",a.ErrorRecoverySet.BinOp);d(k.LE,g.None,b.Cmp,a.NodeType.Le,b.No,a.NodeType.None,"<=",a.ErrorRecoverySet.BinOp);d(k.GT,g.None,b.Cmp,a.NodeType.Gt,b.No,
a.NodeType.None,">",a.ErrorRecoverySet.BinOp);d(k.GE,g.None,b.Cmp,a.NodeType.Ge,b.No,a.NodeType.None,">=",a.ErrorRecoverySet.BinOp);d(k.Lsh,g.None,b.Shf,a.NodeType.Lsh,b.No,a.NodeType.None,"<<",a.ErrorRecoverySet.BinOp);d(k.Rsh,g.None,b.Shf,a.NodeType.Rsh,b.No,a.NodeType.None,">>",a.ErrorRecoverySet.BinOp);d(k.Rs2,g.None,b.Shf,a.NodeType.Rs2,b.No,a.NodeType.None,">>>",a.ErrorRecoverySet.BinOp);d(k.Add,g.None,b.Add,a.NodeType.Add,b.Uni,a.NodeType.Pos,"+",a.ErrorRecoverySet.AddOp);d(k.Sub,g.None,b.Add,
a.NodeType.Sub,b.Uni,a.NodeType.Neg,"-",a.ErrorRecoverySet.AddOp);d(k.Mult,g.None,b.Mul,a.NodeType.Mul,b.No,a.NodeType.None,"*",a.ErrorRecoverySet.BinOp);d(k.Div,g.None,b.Mul,a.NodeType.Div,b.No,a.NodeType.None,"/",a.ErrorRecoverySet.BinOp);d(k.Pct,g.None,b.Mul,a.NodeType.Mod,b.No,a.NodeType.None,"%",a.ErrorRecoverySet.BinOp);d(k.Tilde,g.None,b.No,a.NodeType.None,b.Uni,a.NodeType.Not,"~",a.ErrorRecoverySet.PreOp);d(k.Bang,g.None,b.No,a.NodeType.None,b.Uni,a.NodeType.LogNot,"!",a.ErrorRecoverySet.PreOp);
d(k.Inc,g.None,b.No,a.NodeType.None,b.Uni,a.NodeType.IncPre,"++",a.ErrorRecoverySet.PreOp);d(k.Dec,g.None,b.No,a.NodeType.None,b.Uni,a.NodeType.DecPre,"--",a.ErrorRecoverySet.PreOp);d(k.LParen,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"(",a.ErrorRecoverySet.LParen);d(k.LBrack,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"[",a.ErrorRecoverySet.LBrack);d(k.Dot,g.None,b.Uni,a.NodeType.None,b.No,a.NodeType.None,".",a.ErrorRecoverySet.Dot);d(k.EOF,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,
"<EOF>",a.ErrorRecoverySet.EOF);d(k.Arrow,g.None,b.No,a.NodeType.None,b.No,a.NodeType.None,"=>",a.ErrorRecoverySet.None);a.lookupToken=h;b=a.TokenClass||(a.TokenClass={});b._map=[];b._map[0]="Punctuation";b.Punctuation=0;b._map[1]="Keyword";b.Keyword=1;b._map[2]="Operator";b.Operator=2;b._map[3]="Comment";b.Comment=3;b._map[4]="Whitespace";b.Whitespace=4;b._map[5]="Identifier";b.Identifier=5;b._map[6]="Literal";b.Literal=6;var l=a.TokenClass;a.SavedToken=function(a,c,b){this.tok=a;this.minChar=c;
this.limChar=b};var c=function(a){this.tokenId=a};c.prototype.toString=function(){return"token: "+this.tokenId+" "+this.getText()+" ("+k._map[this.tokenId]+")"};c.prototype.print=function(a,c){c.WriteLine(this.toString()+",on line"+a)};c.prototype.getText=function(){return a.tokenTable[this.tokenId].text};c.prototype.classification=function(){if(this.tokenId<=k.LimKeyword)return l.Keyword;var c=h(this.tokenId);return void 0!=c&&(c.unopNodeType!=a.NodeType.None||c.binopNodeType!=a.NodeType.None)?l.Operator:
l.Punctuation};a.Token=c;b=function(a){this.tokenId=k.NumberLit;this.value=a};__extends(b,c);b.prototype.getText=function(){return this.value.toString()};b.prototype.classification=function(){return l.Literal};a.NumberToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return this.tokenId==k.ID?l.Identifier:l.Literal};a.StringToken=b;b=function(a,c){this.tokenId=a;this.value=c;this.tokenId=
a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return l.Whitespace};a.WhitespaceToken=b;b=function(a,c,b,e,d,l){this.tokenId=a;this.value=c;this.isBlock=b;this.startPos=e;this.line=d;this.endsLine=l;this.tokenID=a};__extends(b,c);b.prototype.getText=function(){return this.value};b.prototype.classification=function(){return l.Comment};a.CommentToken=b;b=function(a){this.tokenId=k.Regex;this.regex=a};__extends(b,c);b.prototype.getText=function(){return this.regex.toString()};
b.prototype.classification=function(){return l.Literal};a.RegexToken=b;a.staticTokens=[];a.initializeStaticTokens=function(){for(var b=0;b<=k.LimFixed;b++)a.staticTokens[b]=new c(b)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(){this.arrayBase=null};d.prototype.specialize=function(a,b){null==this.arrayBase&&(this.arrayBase=a.specializeType(b.wildElm.type,this.arrayType.elementType,b,!0));return this.arrayBase};a.ArrayCache=d;var h=function(){this.onlyCaptureFirstError=!1;this.flags=a.TypeRelationshipFlags.SuccessfulComparison;this.message=""};h.prototype.addMessageToFront=function(a){this.onlyCaptureFirstError?this.setMessage(a):this.message=this.message?a+":\n\t"+this.message:a};h.prototype.setMessage=
function(a){this.message=a};a.TypeComparisonInfo=h;h=a.TypeCheckCollectionMode||(a.TypeCheckCollectionMode={});h._map=[];h._map[0]="Resident";h.Resident=0;h._map[1]="Transient";h.Transient=1;var b=a.TypeCheckCollectionMode,h=function(e){this.errorReporter=e;this.importedGlobalsTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.importedGlobalsTypeTable=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));this.ambientGlobalTypes=
this.ambientGlobals=this.globalTypes=this.globals=null;this.residentGlobalValues=new a.StringHashTable;this.residentGlobalTypes=new a.StringHashTable;this.residentGlobalAmbientValues=new a.StringHashTable;this.residentGlobalAmbientTypes=new a.StringHashTable;this.residentTypeCheck=!0;this.wildElm=this.gloMod=this.mod=null;this.importedGlobals=new a.SymbolScopeBuilder(null,this.importedGlobalsTable,null,this.importedGlobalsTypeTable,null,null);this.dualGlobalValues=new a.DualStringHashTable(this.residentGlobalValues,
new a.StringHashTable);this.dualGlobalTypes=new a.DualStringHashTable(this.residentGlobalTypes,new a.StringHashTable);this.dualAmbientGlobalValues=new a.DualStringHashTable(this.residentGlobalAmbientValues,new a.StringHashTable);this.dualAmbientGlobalTypes=new a.DualStringHashTable(this.residentGlobalAmbientTypes,new a.StringHashTable);var e=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalValues,new a.StringHashTable)),d=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalValues,
new a.StringHashTable)),c=new a.ScopedMembers(new a.DualStringHashTable(this.dualGlobalTypes,new a.StringHashTable)),i=new a.ScopedMembers(new a.DualStringHashTable(this.dualAmbientGlobalTypes,new a.StringHashTable));this.globalScope=new a.SymbolScopeBuilder(e,d,c,i,this.importedGlobals,null);this.voidType=this.enterPrimitive(a.Primitive.Void,"void");this.booleanType=this.enterPrimitive(a.Primitive.Boolean,"bool");this.doubleType=this.enterPrimitive(a.Primitive.Double,"number");this.importedGlobals.ambientEnclosedTypes.addPublicMember("number",
this.doubleType.symbol);this.stringType=this.enterPrimitive(a.Primitive.String,"string");this.anyType=this.enterPrimitive(a.Primitive.Any,"any");this.nullType=this.enterPrimitive(a.Primitive.Null,"null");this.undefinedType=this.enterPrimitive(a.Primitive.Undefined,"undefined");this.setCollectionMode(b.Resident);this.wildElm=new a.TypeSymbol("_element",0,-1,new a.Type);this.importedGlobalsTypeTable.addPublicMember(this.wildElm.name,this.wildElm);this.mod=new a.ModuleType(c,i);this.mod.members=e;this.mod.ambientMembers=
d;this.mod.containedScope=this.globalScope;this.gloMod=new a.TypeSymbol(a.globalId,0,-1,this.mod);this.mod.members.addPublicMember(this.gloMod.name,this.gloMod);this.defineGlobalValue("undefined",this.undefinedType)};h.prototype.enterPrimitive=function(b,d){var c=new a.Type;c.primitiveTypeClass=b;var i=new a.TypeSymbol(d,0,-1,c);i.typeCheckStatus=a.TypeCheckStatus.Finished;c.symbol=i;this.importedGlobals.enter(null,null,i,this.errorReporter,!0,!0,!0);return c};h.prototype.setCollectionMode=function(a){this.residentTypeCheck=
this.dualGlobalValues.insertPrimary=this.dualGlobalTypes.insertPrimary=this.dualAmbientGlobalValues.insertPrimary=this.dualAmbientGlobalTypes.insertPrimary=a==b.Resident};h.prototype.refreshPersistentState=function(){this.globals=new a.StringHashTable;this.globalTypes=new a.StringHashTable;this.ambientGlobals=new a.StringHashTable;this.ambientGlobalTypes=new a.StringHashTable;this.dualGlobalValues.secondaryTable=this.globals;this.dualGlobalTypes.secondaryTable=this.globalTypes;this.dualAmbientGlobalValues.secondaryTable=
this.ambientGlobals;this.dualAmbientGlobalTypes.secondaryTable=this.ambientGlobalTypes};h.prototype.defineGlobalValue=function(b,d){var c=new a.ValueLocation;c.typeLink=new a.TypeLink;c=new a.VariableSymbol(b,0,-1,c);c.setType(d);c.typeCheckStatus=a.TypeCheckStatus.Finished;c.container=this.gloMod;this.importedGlobalsTable.addPublicMember(b,c)};a.PersistentGlobalTypeState=h;var k;k=function(a,b,c){this.contextualType=a;this.provisional=b;this.contextID=c;this.targetAccessorType=this.targetThis=this.targetSig=
null};a.ContextualTypeContext=k;var g=function(a){this.checker=a;this.contextStack=[];this.hadProvisionalErrors=!1};g.contextID=a.TypeCheckStatus.Finished+1;g.prototype.pushContextualType=function(a,b){this.contextStack.push(new k(a,b,g.contextID++));this.checker.errorReporter.pushToErrorSink=b};g.prototype.popContextualType=function(){var a=this.contextStack.pop();this.checker.errorReporter.pushToErrorSink=this.isProvisional();this.hadProvisionalErrors=this.hadProvisionalErrors||a.provisional&&this.checker.errorReporter.getCapturedErrors().length;
this.checker.errorReporter.freeCapturedErrors();return a};g.prototype.getContextualType=function(){return!this.contextStack.length?null:this.contextStack[this.contextStack.length-1]};g.prototype.getContextID=function(){return!this.contextStack.length?a.TypeCheckStatus.Finished:this.contextStack[this.contextStack.length-1].contextID};g.prototype.isProvisional=function(){return!this.contextStack.length?!1:this.contextStack[this.contextStack.length-1].provisional};a.ContextualTypingContextStack=g;h=
function(a){this.persistentState=a;this.errorReporter=null;this.checkControlFlowUseDef=this.printControlFlowGraph=this.checkControlFlow=!1;this.units=this.styleSettings=null;this.anon="_anonymous";this.currentModDecl=this.currentCompareB=this.currentCompareA=this.typeFlow=this.locationInfo=null;this.inWith=this.inBind=!1;this.errorsOnWith=!0;this.currentContextualTypeContext=null;this.canCallDefinitionSignature=this.resolvingBases=!1;this.assignableCache={};this.subtypeCache={};this.identicalCache=
{};this.provisionalStartedTypecheckObjects=[];this.voidType=this.persistentState.voidType;this.booleanType=this.persistentState.booleanType;this.numberType=this.persistentState.doubleType;this.stringType=this.persistentState.stringType;this.anyType=this.persistentState.anyType;this.nullType=this.persistentState.nullType;this.undefinedType=this.persistentState.undefinedType;this.globals=this.persistentState.dualGlobalValues;this.globalTypes=this.persistentState.dualGlobalTypes;this.ambientGlobals=
this.persistentState.dualAmbientGlobalValues;this.ambientGlobalTypes=this.persistentState.dualAmbientGlobalTypes;this.gloModType=this.persistentState.mod;this.gloMod=this.persistentState.gloMod;this.wildElm=this.persistentState.wildElm;this.globalScope=this.persistentState.globalScope;this.typingContextStack=new g(this)};h.prototype.setStyleOptions=function(a){this.styleSettings=a};h.prototype.setContextualType=function(a,b){this.typingContextStack.pushContextualType(a,b);this.currentContextualTypeContext=
this.typingContextStack.getContextualType()};h.prototype.unsetContextualType=function(){var a=this.typingContextStack.popContextualType();this.currentContextualTypeContext=this.typingContextStack.getContextualType();return a};h.prototype.hadProvisionalErrors=function(){return this.typingContextStack.hadProvisionalErrors};h.prototype.resetProvisionalErrors=function(){this.typingContextStack.getContextualType()||(this.typingContextStack.hadProvisionalErrors=!1)};h.prototype.typeCheckWithContextualType=
function(a,b,c,i){c&&this.setContextualType(a,this.typingContextStack.isProvisional()||b);this.typeFlow.typeCheck(i);c&&this.unsetContextualType()};h.prototype.resetTargetType=function(){this.currentContextualTypeContext=this.typingContextStack.getContextualType()};h.prototype.killTargetType=function(){this.currentContextualTypeContext=null;this.errorReporter.pushToErrorSink=!1};h.prototype.hasTargetType=function(){return this.currentContextualTypeContext&&this.currentContextualTypeContext.contextualType};
h.prototype.getTargetTypeContext=function(){return this.currentContextualTypeContext};h.prototype.inProvisionalTypecheckMode=function(){return this.typingContextStack.isProvisional()};h.prototype.getTypeCheckFinishedStatus=function(){return this.inProvisionalTypecheckMode()?this.typingContextStack.getContextID():a.TypeCheckStatus.Finished};h.prototype.typeStatusIsFinished=function(b){return b==a.TypeCheckStatus.Finished||this.inProvisionalTypecheckMode()&&b==this.typingContextStack.getContextID()};
h.prototype.addStartedPTO=function(a){this.inProvisionalTypecheckMode()&&(this.provisionalStartedTypecheckObjects[this.provisionalStartedTypecheckObjects.length]=a)};h.prototype.cleanStartedPTO=function(){for(var b=0;b<this.provisionalStartedTypecheckObjects.length;b++)this.provisionalStartedTypecheckObjects[b].typeCheckStatus=a.TypeCheckStatus.NotStarted;this.provisionalStartedTypecheckObjects=[]};h.prototype.collectTypes=function(b){b.nodeType==a.NodeType.Script&&(this.locationInfo=b.locationInfo);
var d=new a.ScopeChain(this.gloMod,null,this.globalScope),d=new a.TypeCollectionContext(d,this);a.getAstWalkerFactory().walk(b,a.preCollectTypes,a.postCollectTypes,null,d)};h.prototype.makeArrayType=function(b){null==b.arrayCache&&(b.arrayCache=new d,b.arrayCache.arrayType=new a.Type,b.arrayCache.arrayType.elementType=b,b.arrayCache.arrayType.symbol=b.symbol);return b.arrayCache.arrayType};h.prototype.getParameterList=function(b,d){var c=null,c=null,i=b.members.length,f=0,j=[];if(0<i)for(var c=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),c=new a.SymbolScopeBuilder(c,null,null,null,null,d),g=0;g<i;g++){var m=b.members[g],h=new a.ValueLocation,k=new a.ParameterSymbol(m.id.text,m.minChar,this.locationInfo.unitIndex,h);k.declAST=m;m.id.sym=k;m.sym=k;h.symbol=k;h.typeLink=a.getTypeLink(m.typeExpr,this,!1);c.enter(null,m,k,this.errorReporter,!0,!1,!1);j[j.length]=k;m.isOptionalArg()||f++}return{parameters:j,nonOptionalParameterCount:f}};h.prototype.createFunctionSignature=function(b,d,c,i,f){var j=a.hasFlag(b.fncFlags,
a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported)||d==this.gloMod,g=a.hasFlag(b.fncFlags,a.FncFlags.Static),m=a.hasFlag(b.fncFlags,a.FncFlags.Private),h=a.hasFlag(b.fncFlags,a.FncFlags.Definition),k=a.hasFlag(b.fncFlags,a.FncFlags.Ambient),n=b.isConstructMember()||b.isConstructor,q=d==this.gloMod,r=new a.Signature,s=b.fncFlags&a.FncFlags.IsFunctionExpression;b.returnTypeAnnotation||h?r.returnType=a.getTypeLink(b.returnTypeAnnotation,this,!1):(r.returnType=new a.TypeLink,r.returnType.type=
this.anyType);r.hasVariableArgList=b.variableArgList;h=this.getParameterList(b.args,d);r.parameters=h.parameters;r.nonOptionalParameterCount=h.nonOptionalParameterCount;b.signature=r;r.declAST=b;var t=i&&i.getType()&&!i.isAccessor()&&(b.isSignature()||k==a.hasFlag(i.flags,a.SymbolFlags.Ambient));t&&m!=a.hasFlag(i.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Public/Private visibility of overloads does not agree");h=t?i.getType():new a.Type;n?(null==h.construct&&(h.construct=new a.SignatureGroup),
h.construct.addSignature(r),h.construct.hasImplementation=!b.isSignature(),h.construct.hasImplementation&&h.setHasImplementation()):b.isIndexerMember()?(null==h.index&&(h.index=new a.SignatureGroup,h.index.flags|=a.SignatureFlags.IsIndexer),h.index.addSignature(r),h.index.hasImplementation=!b.isSignature(),h.index.hasImplementation&&h.setHasImplementation()):(null==h.call&&(h.call=new a.SignatureGroup),h.call.addSignature(r),h.call.hasImplementation=!b.isSignature(),h.call.hasImplementation&&h.setHasImplementation());
var w=h.instanceType;w&&!g&&(null==w.call?w.call=h.call:h.call&&w.call.signatures.concat(h.call.signatures));var w=null,A=!1;b.name&&!b.name.isMissing()?w=b.name.text:b.hint&&(w=b.hint,A=!0);null==h.symbol&&(h.symbol=new a.TypeSymbol(w?w:this.anon,b.minChar,this.locationInfo.unitIndex,h),t||(h.symbol.declAST=b));g&&(h.symbol.flags|=a.SymbolFlags.Static);k&&(h.symbol.flags|=a.SymbolFlags.Ambient);m&&(h.symbol.flags|=a.SymbolFlags.Private);h.symbol.isMethod=b.isMethod();h.symbol.isMethod&&(h.symbol.flags|=
a.SymbolFlags.Property);b.type=h;if(!n)if(w&&!s&&!b.isAccessor()&&!A)if(f)if(b.isMethod()&&g)d.type.members.publicMembers.add(w,h.symbol)||this.errorReporter.duplicateIdentifier(b,w),h.symbol.container=d;else{if(null==i||i.declAST&&!i.declAST.isOverload&&d.isType())c.enter(d,b,h.symbol,this.errorReporter,!m&&(j||g||q),!1,k)}else b.isSpecialFn()||(h.symbol.container=d);else b.isSpecialFn()||(h.symbol.container=d);if(t&&(b=i?i.getType():null,h!=b&&(null==h.construct?h.construct=b&&b.construct?b.construct:
new a.SignatureGroup:b&&b.construct&&h.construct.signatures.concat(b.construct.signatures),b))){null==h.call?h.call=b.call:b.call&&h.call.signatures.concat(b.call.signatures);if(!g&&(null==h.instanceType&&(h.instanceType=b.instanceType),w=h.instanceType))null==w.call?w.call=b.call:b.call&&w.call.signatures.concat(b.call.signatures);null==h.index?h.index=b.index:b.index&&h.index.signatures.concat(b.index.signatures)}return r};h.prototype.createAccessorSymbol=function(b,d,c,i,f,j,g){var m=null,h=b.signature,
k=b.name.text,n=a.hasFlag(b.fncFlags,a.FncFlags.Static),q=a.hasFlag(b.fncFlags,a.FncFlags.Private);null==d?(d=new a.ValueLocation,m=new a.FieldSymbol(k,b.minChar,this.locationInfo.unitIndex,!1,d),d.symbol=m,m.declAST=b,a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(m.getter&&this.errorReporter.simpleError(b,"Redeclaration of property getter"),m.getter=h.declAST.type.symbol):(m.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),m.setter=h.declAST.type.symbol),d.typeLink=a.getTypeLink(null,
this,!1),i?c?(c.members.publicMembers.add(k,m)||this.errorReporter.duplicateIdentifier(b,m.name),m.container=c.symbol):this.errorReporter.simpleError(b,"Accessor property may not be added in this context"):j.enter(g,b,m,this.errorReporter,!q||n,!1,!1),f&&(m.flags|=a.SymbolFlags.Property),n&&(m.flags|=a.SymbolFlags.Static),m.flags=q?m.flags|a.SymbolFlags.Private:m.flags|a.SymbolFlags.Public):(m=d,q!=a.hasFlag(m.flags,a.SymbolFlags.Private)&&this.errorReporter.simpleError(b,"Getter and setter accessors do not agree in visibility"),
a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?(m.getter&&this.errorReporter.simpleError(b,"Redeclaration of property getter"),m.getter=b.type.symbol):(m.setter&&this.errorReporter.simpleError(b,"Redeclaration of property setter"),m.setter=b.type.symbol));return m};h.prototype.addBases=function(b,d,c){b.addParentScope(new a.SymbolTableScope(d.members,d.ambientMembers,d.getAllEnclosedTypes(),d.getAllAmbientEnclosedTypes(),d.symbol));var i=0,f;if(d.extendsList)for(var j=d.extendsList.length;i<j;i++){f=
d.extendsList[i];if(c.baseId==f.typeID){this.errorReporter.reportErrorFromSym(f.symbol,"Type '"+c.base+"' is recursively referenced as a base class of itself");f.symbol.flags|=a.SymbolFlags.RecursivelyReferenced;break}this.addBases(b,f,c)}};h.prototype.scopeOf=function(b){var d=new a.SymbolAggregateScope(b.symbol);this.addBases(d,b,{base:b.symbol&&b.symbol.name?b.symbol.name:"{}",baseId:b.typeID});return d};h.prototype.lookupMemberType=function(a,b){var c=null;a.containedScope?c=a.containedScope.find(b,
!1,!0):a.members&&(c=a.members.allMembers.lookup(b),null==c&&a.ambientMembers&&(c=a.ambientMembers.allMembers.lookup(b)));if(null==c){var i=a.getAllEnclosedTypes(),f=a.getAllAmbientEnclosedTypes();i&&(c=i.allMembers.lookup(b),null==c&&f&&(c=f.allMembers.lookup(b)))}return c&&c.isType()?c.getType():null};h.prototype.findSymbolForDynamicModule=function(b,d,c){var i=b,f=c(b);if(null==f&&(f||(b=a.swapQuotes(i),f=c(b)),f||(b=a.stripQuotes(i)+".ts",f=c(b)),f||(b=a.stripQuotes(i)+".str",f=c(b)),f||(b=a.stripQuotes(i)+
".d.ts",f=c(b)),f||(b=a.stripQuotes(i)+".d.str",f=c(b)),!f&&!a.isRelative(i))){i=a.stripQuotes(i);for(d=a.getRootFilePath(a.switchToForwardSlashes(d));null==f&&""!=d&&"/"!=d;)b=a.normalizePath(d+i+".ts"),f=c(b),null==f&&(b=a.changePathToSTR(b),f=c(b)),null==f&&(b=a.changePathToDTS(b),f=c(b)),null==f&&(b=a.changePathToDSTR(b),f=c(b)),null==f&&(d=(d=a.normalizePath(d+".."))&&"/"!=d?d+"/":d)}return f};h.prototype.resolveTypeMember=function(b,d){var c=d.operand1,i=d.operand2,f=this.anyType,j=this.anyType;
if(c&&i&&i.nodeType==a.NodeType.Name){if(c.nodeType==a.NodeType.Dot)j=this.resolveTypeMember(b,c);else if(c.nodeType==a.NodeType.Name){var g=b.find(c.text,!1,!0);if(null==g)this.errorReporter.unresolvedSymbol(c,c.text);else if(g.isType()){if(g.aliasLink&&(!g.type&&g.aliasLink.alias.nodeType==a.NodeType.Name)&&(j=this.findSymbolForDynamicModule(g.aliasLink.alias.text,this.locationInfo.filename,function(a){return b.find(a,!1,!0)})))g.type=j.getType();if(a.optimizeModuleCodeGen&&g&&(j=g.getType())&&
g.aliasLink&&g.onlyReferencedAsTypeRef)if((j=j.symbol.declAST)&&a.hasFlag(j.modFlags,a.ModuleFlags.IsDynamic))g.onlyReferencedAsTypeRef=!this.resolvingBases;g.visible(b,this)||this.errorReporter.simpleError(c,"The symbol '"+c.text+"' is not visible at this point");j=g.getType();c.sym=g}else this.errorReporter.simpleError(c,"Expected type")}j||(j=this.anyType);j!=this.anyType&&(f=this.lookupMemberType(j,i.text),null==f?(f=this.anyType,this.errorReporter.simpleError(d,"Expected type")):f.symbol.visible(b,
this)||this.errorReporter.simpleError(c,"The symbol '"+i.text+"' is not visible at this point"),i.sym=f.symbol)}f.isClass()&&(f=f.instanceType);return f};h.prototype.resolveFuncDecl=function(a,b,c){var c=this.createFunctionSignature(a,b.container,b,c,!1).declAST.type.symbol,i;i=a.isConstructMember()?c.type.construct.signatures:a.isIndexerMember()?c.type.getInstanceType().index.signatures:c.type.call.signatures;i=i[i.length-1];for(var f=i.parameters.length,d=0;d<f;d++)this.resolveTypeLink(b,i.parameters[d].parameter.typeLink,
!0);f&&a.variableArgList&&!i.parameters[f-1].parameter.typeLink.type.elementType&&(this.errorReporter.simpleErrorFromSym(i.parameters[f-1].parameter.symbol,"... parameter must have array type"),i.parameters[f-1].parameter.typeLink.type.elementType=this.makeArrayType(i.parameters[f-1].parameter.typeLink.type));this.resolveTypeLink(b,i.returnType,a.isSignature());return c};h.prototype.resolveVarDecl=function(b,d){var c=new a.ValueLocation,i=new a.FieldSymbol(b.id.text,b.minChar,this.locationInfo.unitIndex,
(b.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,c);i.transferVarFlags(b.varFlags);c.symbol=i;i.declAST=b;c.typeLink=a.getTypeLink(b.typeExpr,this,null==b.init);this.resolveTypeLink(d,c.typeLink,!0);b.sym=i;b.type=c.typeLink.type;return i};h.prototype.resolveTypeLink=function(b,d,c){var i=0;if(null==d.type){var f=d.ast;if(f)for(;null==d.type;)switch(f.nodeType){case a.NodeType.Name:var j=f,g=b.find(j.text,!1,!0);null==g?(d.type=this.anyType,this.errorReporter.unresolvedSymbol(j,j.text)):g.isType()?
(g.visible(b,this)||this.errorReporter.simpleError(f,"The symbol '"+j.text+"' is not visible at this point"),j.sym=g,d.type=g.getType(),d.type?d.type.isClass()&&(d.type=d.type.instanceType):d.type=this.anyType):(d.type=this.anyType,this.errorReporter.simpleError(f,"Expected type"));break;case a.NodeType.Dot:d.type=this.resolveTypeMember(b,f);break;case a.NodeType.TypeRef:i=f.arrayCount;f=f.term;null==f&&(d.type=this.anyType);break;case a.NodeType.Interface:var m=f,j=new a.Type,g=new a.TypeSymbol(m.name.text,
f.minChar,this.locationInfo.unitIndex,j);j.symbol=g;j.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));j.containedScope=new a.SymbolTableScope(j.members,null,null,null,g);j.containedScope.container=g;j.memberScope=j.containedScope;for(var m=m.members.members,h=m.length,k=0;k<h;k++){var n=m[k],q=null,r=!0,s=null;n.nodeType==a.NodeType.FuncDecl?(s=n.name,q=j.members.allMembers.lookup(n.getNameText()),r=null==q,n.isSpecialFn()?(r=!1,q=this.resolveFuncDecl(n,
b,g)):q=this.resolveFuncDecl(n,b,q),n.type=q.type):(s=n.id,q=this.resolveVarDecl(n,b));r&&(s&&a.hasFlag(s.flags,a.ASTFlags.OptionalName)&&(q.flags|=a.SymbolFlags.Optional),j.members.allMembers.add(q.name,q)||this.errorReporter.duplicateIdentifier(f,q.name))}f.type=j;d.type=j;break;case a.NodeType.FuncDecl:j=this.resolveFuncDecl(f,b,null);d.type=j.type;break;default:d.type=this.anyType,this.errorReporter.simpleError(f,"Expected type")}for(b=i;0<b;b--)d.type=this.makeArrayType(d.type);c&&null==d.type&&
(d.type=this.anyType);d.ast&&(d.ast.type=d.type)}};h.prototype.findMostApplicableSignature=function(a,b){if(1==a.length)return{sig:a[0].signature,ambiguous:!1};for(var c=a[0],i=null,f=null,d=null,g=null,f=!1,m=1;m<a.length;m++){for(var i=a[m],h=0,h=0;b&&h<b.members.length;h++)if(f=b.members[h].type,d=h<c.signature.parameters.length?c.signature.parameters[h].getType():c.signature.parameters[c.signature.parameters.length-1].getType().elementType,g=h<i.signature.parameters.length?i.signature.parameters[h].getType():
i.signature.parameters[i.signature.parameters.length-1].getType().elementType,!this.typesAreIdentical(d,g))if(this.typesAreIdentical(f,d))break;else if(this.typesAreIdentical(f,g)){c=i;break}else if(this.sourceIsSubtypeOfTarget(d,g))break;else if(this.sourceIsSubtypeOfTarget(g,d)){c=i;break}else if(i.hadProvisionalErrors)break;else if(c.hadProvisionalErrors){c=i;break}f=!b||h==b.members.length?!this.findBestCommonType(c.signature.returnType.type,null,{getLength:function(){return 2},setTypeAtIndex:function(){},
getTypeAtIndex:function(a){return a?i.signature.returnType.type:c.signature.returnType.type}}):!1}return{sig:c.signature,ambiguous:f}};h.prototype.getApplicableSignatures=function(b,d,c){for(var i=[],f=null,j=!1,g=!1,m=0;m<b.length;m++){for(var j=!1,h=0;h<d.members.length;h++)if(!(h>=b[m].parameters.length)&&(f=b[m].parameters[h].getType(),b[m].declAST.variableArgList&&(h>=b[m].nonOptionalParameterCount-1&&f.isArray())&&(f=f.elementType),f!=this.anyType))if(d.members[h].nodeType==a.NodeType.FuncDecl){if(!(this.typeFlow.functionInterfaceType&&
f==this.typeFlow.functionInterfaceType))if(this.canContextuallyTypeFunction(f,d.members[h],!0)){if(this.typeCheckWithContextualType(f,!0,!0,d.members[h]),this.cleanStartedPTO(),g=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(d.members[h].type,f,c)||(c&&c.setMessage("Could not apply type '"+f.getTypeName()+"' to argument "+(h+1)+", which is of type '"+d.members[h].type.getTypeName()+"'"),j=!0),g&&(this.typeCheckWithContextualType(null,!0,!0,d.members[h]),this.sourceIsAssignableToTarget(d.members[h].type,
f)||(j=!0),this.cleanStartedPTO()),this.resetProvisionalErrors(),j)break}else if(this.canContextuallyTypeFunction(f,d.members[h],!1)){if(this.typeFlow.typeCheck(d.members[h]),!this.sourceIsAssignableToTarget(d.members[h].type,f,c))break}else break}else if(d.members[h].nodeType==a.NodeType.ObjectLit){if(!(this.typeFlow.objectInterfaceType&&f==this.typeFlow.objectInterfaceType)&&(this.typeCheckWithContextualType(f,!0,!0,d.members[h]),this.cleanStartedPTO(),g=this.hadProvisionalErrors(),this.sourceIsAssignableToTarget(d.members[h].type,
f,c)||(c&&c.setMessage("Could not apply type '"+f.getTypeName()+"' to argument "+(h+1)+", which is of type '"+d.members[h].type.getTypeName()+"'"),j=!0),g&&(this.typeCheckWithContextualType(null,!0,!0,d.members[h]),this.sourceIsAssignableToTarget(d.members[h].type,f)||(j=!0),this.cleanStartedPTO()),this.resetProvisionalErrors(),j))break}else if(d.members[h].nodeType==a.NodeType.ArrayLit&&!(this.typeFlow.arrayInterfaceType&&f==this.typeFlow.arrayInterfaceType)){this.typeCheckWithContextualType(f,!0,
!0,d.members[h]);this.cleanStartedPTO();g=this.hadProvisionalErrors();if(!this.sourceIsAssignableToTarget(d.members[h].type,f,c)){c&&c.setMessage("Could not apply type '"+f.getTypeName()+"' to argument "+(h+1)+", which is of type '"+d.members[h].type.getTypeName()+"'");break}g&&(this.typeCheckWithContextualType(null,!0,!0,d.members[h]),this.sourceIsAssignableToTarget(d.members[h].type,f)||(j=!0),this.cleanStartedPTO());this.resetProvisionalErrors();if(j)break}h==d.members.length&&(i[i.length]={signature:b[m],
hadProvisionalErrors:g});g=!1}return i};h.prototype.canContextuallyTypeFunction=function(a,b,c){if(b.isParenthesized||b.isMethod()||c&&b.returnTypeAnnotation||b.isInlineCallLiteral)return!1;c=c||this.typeFlow.functionInterfaceType==a;if(!c)return!0;b.signature||(this.createFunctionSignature(b,this.typeFlow.scope.container,this.typeFlow.scope,null,null),this.typeFlow.typeCheck(b));for(var b=b.signature,i=b.parameters.length,f=0;f<i;f++){var d=b.parameters[f].declAST;if(c&&d.typeExpr)return!1}if(a.construct&&
a.call)return!1;a=a.construct?a.construct:a.call;return!a||1<a.signatures.length?!1:!0};h.prototype.canContextuallyTypeObjectLiteral=function(b,d){if(b==this.typeFlow.objectInterfaceType)return!0;var c=d.operand;if(!c||!b.memberScope)return!1;for(var i=null,i=null,f="",j={},g=0;g<c.members.length;g++){i=c.members[g].operand1;if(i.nodeType==a.NodeType.Name)f=i.text;else if(i.nodeType==a.NodeType.QString)i=i.text,f=i.substring(1,i.length-1);else return!1;i=b.memberScope.find(f,!0,!1);if(!i)return!1;
j[f]=!0}c=b.memberScope.getAllValueSymbolNames(!0);for(g=0;g<c.length;g++)if(i=b.memberScope.find(c[g],!0,!1),!j[c[g]]&&!a.hasFlag(i.flags,a.SymbolFlags.Optional))return!1;return!0};h.prototype.widenType=function(a){return a==this.undefinedType||a==this.nullType?this.anyType:a};h.prototype.isNullOrUndefinedType=function(a){return a==this.undefinedType||a==this.nullType};h.prototype.findBestCommonType=function(a,b,c,i){var f=0,d=c.getLength(),g=0;b&&(a=a?a.mergeOrdered(b,this):b);for(var h=a;g<d;){for(f=
0;f<d;f++)if(f!=g){if(h&&(a=h.mergeOrdered(c.getTypeAtIndex(f),this,i)))h=a;if(a==this.anyType||null==a)break;else b&&c.setTypeAtIndex(f,b)}if(h&&a)break;g++;g<d&&(h=c.getTypeAtIndex(g))}return a};h.prototype.typesAreIdentical=function(b,d){if(b==d)return!0;if(!b||!d)return!1;var c=d.typeID<<16|b.typeID;if(this.identicalCache[c])return!0;if(b.typeFlags&a.TypeFlags.IsEnum||d.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||d.isArray()){if(!b.isArray()||!d.isArray())return!1;this.identicalCache[c]=
!1;var i=this.typesAreIdentical(b.elementType,d.elementType);this.subtypeCache[c]=i?!0:void 0;return i}if(b.primitiveTypeClass!=d.primitiveTypeClass)return!1;this.identicalCache[c]=!1;if(b.memberScope&&d.memberScope){var i=b.memberScope.getAllValueSymbolNames(!0).sort(),f=d.memberScope.getAllValueSymbolNames(!0).sort();if(i.length!=f.length)return this.identicalCache[c]=void 0,!1;for(var j=null,g=null,g=j=null,h=0;h<i.length;h++){if(i[h]!=f[h])return this.identicalCache[c]=void 0,!1;j=b.memberScope.find(i[h],
!1,!1);g=d.memberScope.find(f[h],!1,!1);if((j.flags&a.SymbolFlags.Optional)!=(g.flags&a.SymbolFlags.Optional))return this.identicalCache[c]=void 0,!1;j=j.getType();g=g.getType();if((!j||!(g&&void 0!=this.identicalCache[g.typeID<<16|j.typeID]))&&!this.typesAreIdentical(j,g))return this.identicalCache[c]=void 0,!1}}else if(b.memberScope||d.memberScope)return this.identicalCache[c]=void 0,!1;return!this.signatureGroupsAreIdentical(b.call,d.call)||!this.signatureGroupsAreIdentical(b.construct,d.construct)||
!this.signatureGroupsAreIdentical(b.index,d.index)?(this.identicalCache[c]=void 0,!1):this.identicalCache[c]=!0};h.prototype.signatureGroupsAreIdentical=function(a,b){if(a==b)return!0;if(!a||!b||a.signatures.length!=b.signatures.length)return!1;for(var c=null,i=null,f=!1,d=0;d<a.signatures.length;d++){for(var c=a.signatures[d],g=0;g<b.signatures.length;g++)if(i=b.signatures[g],this.signaturesAreIdentical(c,i)){f=!0;break}if(f)f=!1;else return!1}return!0};h.prototype.signaturesAreIdentical=function(a,
b){if(a.hasVariableArgList!=b.hasVariableArgList||a.nonOptionalParameterCount!=b.nonOptionalParameterCount||a.parameters.length!=b.parameters.length||!this.typesAreIdentical(a.returnType.type,b.returnType.type))return!1;for(var c=0;c<a.parameters.length;c++)if(!this.typesAreIdentical(a.parameters[c].parameter.typeLink.type,b.parameters[c].parameter.typeLink.type))return!1;return!0};h.prototype.sourceIsSubtypeOfTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};
h.prototype.signatureGroupIsSubtypeOfTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};h.prototype.signatureIsSubtypeOfTarget=function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!1,this.subtypeCache,c)};h.prototype.sourceIsAssignableToTarget=function(a,b,c){return this.sourceIsRelatableToTarget(a,b,!0,this.assignableCache,c)};h.prototype.signatureGroupIsAssignableToTarget=function(a,b,c){return this.signatureGroupIsRelatableToTarget(a,b,!0,
this.assignableCache,c)};h.prototype.signatureIsAssignableToTarget=function(a,b,c){return this.signatureIsRelatableToTarget(a,b,!0,this.assignableCache,c)};h.prototype.sourceIsRelatableToTarget=function(b,d,c,i,f){if(b==d||!b||!d)return!0;var j=b.typeID<<16|d.typeID;if(i[j])return!0;if(c){if(b==this.anyType||d==this.anyType)return!0}else if(d==this.anyType)return!0;if(b==this.undefinedType||b==this.nullType&&d!=this.undefinedType&&d!=this.voidType||d==this.numberType&&b.typeFlags&a.TypeFlags.IsEnum||
b==this.numberType&&d.typeFlags&a.TypeFlags.IsEnum)return!0;if(b.typeFlags&a.TypeFlags.IsEnum||d.typeFlags&a.TypeFlags.IsEnum)return!1;if(b.isArray()||d.isArray()){if(!b.isArray()||!d.isArray())return!1;i[j]=!1;f=this.sourceIsRelatableToTarget(b.elementType,d.elementType,c,i,f);i[j]=f?!0:void 0;return f}if(b.primitiveTypeClass!=d.primitiveTypeClass)if(d.primitiveTypeClass==a.Primitive.None)if(b==this.numberType&&this.typeFlow.numberInterfaceType)b=this.typeFlow.numberInterfaceType;else if(b==this.stringType&&
this.typeFlow.stringInterfaceType)b=this.typeFlow.stringInterfaceType;else if(b==this.booleanType&&this.typeFlow.booleanInterfaceType)b=this.typeFlow.booleanInterfaceType;else return!1;else return!1;i[j]=!1;if(b.hasBase(d))return i[j]=!0;if(this.typeFlow.objectInterfaceType&&d==this.typeFlow.objectInterfaceType||this.typeFlow.functionInterfaceType&&(b.call||b.construct)&&d==this.typeFlow.functionInterfaceType)return!0;if(d.isClass()||d.isClassInstance())return i[j]=void 0,!1;if(d.memberScope&&b.memberScope)for(var g=
d.memberScope.getAllValueSymbolNames(!0),h=null,k=null,u=null,n=k=null,q=0;q<g.length;q++)if(h=d.memberScope.find(g[q],!1,!1),k=b.memberScope.find(g[q],!1,!1),!(h.kind()==a.SymbolKind.Variable&&h.variable.typeLink.ast&&h.variable.typeLink.ast.nodeType==a.NodeType.Name&&"IArguments"==h.variable.typeLink.ast.text)){h.isInferenceSymbol()&&(n=h,n.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(h.declAST));u=h.getType();if(!k&&(this.typeFlow.objectInterfaceType&&(k=this.typeFlow.objectInterfaceType.memberScope.find(g[q],
!1,!1)),!k)){if(this.typeFlow.functionInterfaceType&&(u.call||u.construct))k=this.typeFlow.functionInterfaceType.memberScope.find(g[q],!1,!1);if(!k)if(h.flags&a.SymbolFlags.Optional)continue;else return i[j]=void 0,f&&(f.flags|=a.TypeRelationshipFlags.RequiredPropertyIsMissing,f.addMessageToFront("Type '"+b.getTypeName()+"' is missing property '"+g[q]+"' from type '"+d.getTypeName()+"'")),!1}k.isInferenceSymbol()&&(n=k,n.typeCheckStatus==a.TypeCheckStatus.NotStarted&&this.typeFlow.typeCheck(k.declAST));
k=k.getType();if((!u||!(k&&void 0!=i[k.typeID<<16|u.typeID]))&&!this.sourceIsRelatableToTarget(k,u,c,i,f))return i[j]=void 0,f&&(f.flags|=a.TypeRelationshipFlags.IncompatiblePropertyTypes,f.addMessageToFront("Types of property '"+h.name+"' of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible")),!1}return(b.call||d.call)&&!this.signatureGroupIsRelatableToTarget(b.call,d.call,c,i,f)?(f&&(b.call&&d.call?f.addMessageToFront("Call signatures of types '"+b.getTypeName()+"' and '"+d.getTypeName()+
"' are incompatible"):(c=d.call?d.getTypeName():b.getTypeName(),b=!d.call?d.getTypeName():b.getTypeName(),f.setMessage("Type '"+c+"' requires a call signature, but Type '"+b+"' lacks one")),f.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),i[j]=void 0,!1):(b.construct||d.construct)&&!this.signatureGroupIsRelatableToTarget(b.construct,d.construct,c,i,f)?(f&&(b.construct&&d.construct?f.addMessageToFront("Construct signatures of types '"+b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible"):
(c=d.construct?d.getTypeName():b.getTypeName(),b=!d.construct?d.getTypeName():b.getTypeName(),f.setMessage("Type '"+c+"' requires a construct signature, but Type '"+b+"' lacks one")),f.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),i[j]=void 0,!1):d.index&&!this.signatureGroupIsRelatableToTarget(!b.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:b.index,!d.index&&this.typeFlow.objectInterfaceType?this.typeFlow.objectInterfaceType.index:d.index,c,i,f)?(f&&(f.addMessageToFront("Index signatures of types '"+
b.getTypeName()+"' and '"+d.getTypeName()+"' are incompatible"),f.flags|=a.TypeRelationshipFlags.IncompatibleSignatures),i[j]=void 0,!1):i[j]=!0};h.prototype.signatureGroupIsRelatableToTarget=function(a,b,c,i,f){if(a==b)return!0;if(!a||!b)return!1;for(var d=null,g=null,h=!1,k=0;k<b.signatures.length;k++){for(var d=b.signatures[k],u=0;u<a.signatures.length;u++)if(g=a.signatures[u],this.signatureIsRelatableToTarget(g,d,c,i,f)){h=!0;break}if(h)h=!1;else return!1}return!0};h.prototype.signatureIsRelatableToTarget=
function(b,d,c,i,f){if(!b.parameters||!d.parameters)return!1;var j=d.hasVariableArgList?d.nonOptionalParameterCount-1:d.nonOptionalParameterCount,g=b.hasVariableArgList?b.nonOptionalParameterCount-1:b.nonOptionalParameterCount;if(g>j&&!d.hasVariableArgList)return f&&(f.flags|=a.TypeRelationshipFlags.SourceSignatureHasTooManyParameters,f.addMessageToFront("Call signature expects "+j+" or fewer parameters")),!1;var h=b.returnType.type,k=d.returnType.type;if(k!=this.voidType&&!this.sourceIsRelatableToTarget(h,
k,c,i,f))return f&&(f.flags|=a.TypeRelationshipFlags.IncompatibleReturnTypes),!1;for(var h=g<j&&b.hasVariableArgList?j:g,u=k=null,n=0,q=0;n<h;n++,q++)if(!b.hasVariableArgList||n<g?k=b.parameters[n].parameter.typeLink.type:n==g&&(k=b.parameters[n].parameter.typeLink.type,k.elementType&&(k=k.elementType)),q<d.parameters.length&&q<j?u=d.parameters[q].parameter.typeLink.type:d.hasVariableArgList&&q==j&&(u=d.parameters[q].parameter.typeLink.type,u.elementType&&(u=u.elementType)),!this.sourceIsRelatableToTarget(k,
u,c,i,f)&&!this.sourceIsRelatableToTarget(u,k,c,i,f))return f&&(f.flags|=a.TypeRelationshipFlags.IncompatibleParameterTypes),!1;return!0};a.TypeChecker=h})(TypeScript||(TypeScript={}));
(function(a){function d(c,b){if(c){var i=c.members.length;null==b&&(b=[]);for(var f=0;f<i;f++){var d=c.members[f];d.nodeType==a.NodeType.Call&&(d=d.target);var e=new a.TypeLink;e.ast=d;b[b.length]=e}}return b}function h(a,c){a.extendsTypeLinks=d(c.extendsList,a.extendsTypeLinks);a.implementsTypeLinks=d(c.implementsList,a.implementsTypeLinks)}function b(c){var b=new a.Signature;b.returnType=new a.TypeLink;b.returnType.type=c.instanceType;b.parameters=[];c.construct=new a.SignatureGroup;c.construct.addSignature(b)}
function k(a,c){var b=c.scope.find(a,!1,!0);null==b&&c.previous&&(b=k(a,c.previous));return b}function g(c,b){var i=null;switch(c.nodeType){case a.NodeType.Name:var f=c.text,i=function(){return b.members?b.members.lookup(f):k(f,b.topLevelScope)},i=a.isQuoted(f)?b.tcContext.checker.findSymbolForDynamicModule(f,b.tcContext.script.locationInfo.filename,i):i(f);break;case a.NodeType.Dot:var d=g(c.operand1,b);d&&d.getType()&&(i=g(c.operand2,b))}if(i)if(d=i.getType()){if(d=d.members)b.members=d.publicMembers}else b.tcContext.checker.errorReporter.simpleError(c,
"Potentially circular alias reference - could not obtain type of alias");return i}function e(c,b,i){var b=i.scopeChain,f=null,f=null,d=a.hasFlag(c.varFlags,a.VarFlags.Exported),e=g(c.alias,{topLevelScope:b,members:null,tcContext:i}),j=i.scopeChain.container==i.checker.gloMod;e&&(e=e.getType())&&(f=e);f=new a.TypeSymbol(c.id.text,c.minChar,i.checker.locationInfo.unitIndex,f);f.aliasLink=c;i.scopeChain.moduleDecl&&(f.declModule=i.scopeChain.moduleDecl);f.declAST=c;c.id.sym=f;b.scope.enter(b.container,
c,f,i.checker.errorReporter,d||j,!0,!1);b.scope.enter(b.container,c,f,i.checker.errorReporter,d||j,!1,!1);return!0}function l(c,b,i){var f=i.scopeChain,d=a.hasFlag(c.modFlags,a.ModuleFlags.Ambient),b=a.hasFlag(c.modFlags,a.ModuleFlags.IsEnum),e=i.scopeChain.container==i.checker.gloMod,j=a.hasFlag(c.modFlags,a.ModuleFlags.Exported),g=c.name.text;a.isQuoted(g);var h=f.scope.findLocal(g,!1,!1),l=null,k=null;null==h||h.kind()!=a.SymbolKind.Type?(null==k&&(k=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),h=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),k=new a.ModuleType(k,h),b&&(k.typeFlags|=a.TypeFlags.IsEnum),k.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),k.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),k.setHasImplementation()),l=new a.TypeSymbol(g,c.minChar,i.checker.locationInfo.unitIndex,k),i.scopeChain.moduleDecl&&
(l.declModule=i.scopeChain.moduleDecl),l.declAST=c,l.prettyName=c.prettyName,f.scope.enter(f.container,c,l,i.checker.errorReporter,j||e,!0,d),f.scope.enter(f.container,c,l,i.checker.errorReporter,j||e,!1,d),k.symbol=l):(h&&(h.declAST&&h.declAST.nodeType!=a.NodeType.Module)&&i.checker.errorReporter.simpleError(c,"Conflicting symbol name for module '"+g+"'"),l=h,k=l.type.getAllEnclosedTypes().publicMembers,k=null==k?new a.StringHashTable:k,k=new a.ScopedMembers(new a.DualStringHashTable(k,new a.StringHashTable)),
h=l.type.getAllAmbientEnclosedTypes().publicMembers,h=null==h?new a.StringHashTable:h,h=new a.ScopedMembers(new a.DualStringHashTable(h,new a.StringHashTable)),f=l.type.members.publicMembers,f=null==f?new a.StringHashTable:f,f=new a.ScopedMembers(new a.DualStringHashTable(f,new a.StringHashTable)),d=l.type.ambientMembers.publicMembers,d=null==d?new a.StringHashTable:d,d=new a.ScopedMembers(new a.DualStringHashTable(d,new a.StringHashTable)),k=new a.ModuleType(k,h),b&&(k.typeFlags|=a.TypeFlags.IsEnum),
k.members=f,k.ambientMembers=d,k.setHasImplementation(),k.symbol=l,l.addLocation(c.minChar),l.expansions.push(k));i.scopeChain.moduleDecl&&i.scopeChain.moduleDecl.recordNonInterface();j&&(l.flags|=a.SymbolFlags.Exported);if(i.scopeChain.moduleDecl||i.scopeChain.container==i.checker.gloMod)l.flags|=a.SymbolFlags.ModuleMember;c.mod=k;a.pushTypeCollectionScope(l,k.members,k.ambientMembers,k.enclosedTypes,k.ambientEnclosedTypes,i,null,null,c);return!0}function c(c,i,f){var d=f.scopeChain,e,j=null,i=c.name.text,
g=a.hasFlag(c.varFlags,a.VarFlags.Ambient),l=a.hasFlag(c.varFlags,a.VarFlags.Exported),k=f.scopeChain.container==f.checker.gloMod;e=!1;j=d.scope.findLocal(i,!1,!0);if(!j){var v=d.scope.findLocal(i,!1,!1);v&&(v.isType()&&v.declAST&&v.declAST.nodeType==a.NodeType.FuncDecl&&v.declAST.isSignature())&&(j=v,e=!0,l&&(j.flags|=a.SymbolFlags.Exported),g&&(j.flags|=a.SymbolFlags.Ambient),f.scopeChain.scope.enter(f.scopeChain.container,c,j,f.checker.errorReporter,l||k,!0,g))}j&&(!e&&j.declAST!=c&&!j.declAST.isOverload)&&
(j=null);if(null==j){v=d.scope.findLocal(i,!1,!1);d=new a.Type;d.setHasImplementation();e=new a.Type;e.setHasImplementation();d.instanceType=e;d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));var j=d,C=new a.ValueLocation;C.typeLink=new a.TypeLink;C.typeLink.ast=c;C.typeLink.type=j.instanceType;var x=new a.FieldSymbol("prototype",c.minChar,
f.checker.locationInfo.unitIndex,!0,C);x.flags|=a.SymbolFlags.Property|a.SymbolFlags.BuiltIn;C.symbol=x;x.declAST=c;j.members.addPublicMember("prototype",x);e.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));e.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable));j=new a.TypeSymbol(i,c.minChar,f.checker.locationInfo.unitIndex,d);j.declAST=c;j.instanceType=e;d.symbol=j;e.symbol=j;f.scopeChain.moduleDecl&&
(f.scopeChain.moduleDecl.recordNonInterface(),j.declModule=f.scopeChain.moduleDecl,j.flags|=a.SymbolFlags.ModuleMember);l&&(j.flags|=a.SymbolFlags.Exported);g&&(j.flags|=a.SymbolFlags.Ambient);c.type=d;f.scopeChain.scope.enter(f.scopeChain.container,c,j,f.checker.errorReporter,l||k,!0,g);null==v&&f.scopeChain.scope.enter(f.scopeChain.container,c,j,f.checker.errorReporter,l||k,!1,g)}else d=j.type,null==d.instanceType&&(d.instanceType=new a.Type,d.instanceType.setHasImplementation(),d.instanceType.members=
new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.instanceType.symbol=d.symbol,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable))),e=d.instanceType,c.type=d;c.constructorDecl||(j&&(j.declAST&&j.declAST.type&&j.declAST.type.call&&!j.declAST.isOverload)&&f.checker.errorReporter.duplicateIdentifier(j.declAST,
j.name),b(c.type));d.typeFlags|=a.TypeFlags.IsClass;e.typeFlags|=a.TypeFlags.IsClass;h(e,c);a.pushTypeCollectionScope(j,e.members,e.ambientMembers,null,null,f,e,d,null);return!0}function i(c,b,f){var b=f.scopeChain,i=null,d=null,e=a.hasFlag(c.varFlags,a.VarFlags.Exported),j=f.scopeChain.container==f.checker.gloMod,g=!0,g=!1,l=c.name.text,i=b.scope.findLocal(l,!1,!0);null==i?(d=new a.Type,i=new a.TypeSymbol(l,c.minChar,f.checker.locationInfo.unitIndex,d),d.symbol=i,d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable)),d.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),i.declAST=c,i.declModule=f.scopeChain.moduleDecl):(g=!0,d=i.type);d||(d=f.checker.anyType);c.type=d;h(d,c);e&&(i.flags|=a.SymbolFlags.Exported);f.scopeChain.moduleDecl&&(i.flags|=a.SymbolFlags.ModuleMember);g||f.scopeChain.scope.enter(f.scopeChain.container,c,i,f.checker.errorReporter,j||e,!0,!1);a.pushTypeCollectionScope(i,d.members,d.ambientMembers,null,null,f,d,null,
null);return!0}function f(c,b,f){if(a.hasFlag(c.varFlags,a.VarFlags.Public|a.VarFlags.Private)){var b=new a.ValueLocation,i=a.hasFlag(c.varFlags,a.VarFlags.Private),d=new a.FieldSymbol(c.id.text,c.minChar,f.checker.locationInfo.unitIndex,!a.hasFlag(c.varFlags,a.VarFlags.Readonly),b);d.transferVarFlags(c.varFlags);b.symbol=d;d.declAST=c;c.parameterPropertySym=d;f.scopeChain.scope.enter(f.scopeChain.container,c,d,f.checker.errorReporter,!i,!1,!1);b.typeLink=a.getTypeLink(c.typeExpr,f.checker,null==
c.init);c.sym=d}return!1}function j(c,b,f){var i=f.scopeChain,b=a.hasFlag(c.varFlags,a.VarFlags.Ambient),d=a.hasFlag(c.varFlags,a.VarFlags.Exported),e=f.scopeChain.container==f.checker.gloMod,j=a.hasFlag(c.varFlags,a.VarFlags.Property),g=a.hasFlag(c.varFlags,a.VarFlags.Static),h=a.hasFlag(c.varFlags,a.VarFlags.Private),l=a.hasFlag(c.id.flags,a.ASTFlags.OptionalName);f.scopeChain.moduleDecl&&f.scopeChain.moduleDecl.recordNonInterface();if(j||d||f.scopeChain.container==f.checker.gloMod||f.scopeChain.moduleDecl){if(b&&
(i=i.scope.findLocal(c.id.text,!1,!1)))return c.sym=i,!1;if(null==c.id)return f.checker.errorReporter.simpleError(c,"Expected variable identifier at this location"),!1;var i=new a.ValueLocation,k=new a.FieldSymbol(c.id.text,c.minChar,f.checker.locationInfo.unitIndex,(c.varFlags&a.VarFlags.Readonly)==a.VarFlags.None,i);k.transferVarFlags(c.varFlags);l&&(k.flags|=a.SymbolFlags.Optional);i.symbol=k;k.declAST=c;if(f.scopeChain.moduleDecl||f.scopeChain.container==f.checker.gloMod)k.flags|=a.SymbolFlags.ModuleMember,
k.declModule=f.scopeChain.moduleDecl;a.hasFlag(c.varFlags,a.VarFlags.Property)&&g&&f.scopeChain.classType?(f.scopeChain.classType.members.publicMembers.add(c.id.text,k)||f.checker.errorReporter.duplicateIdentifier(c,k.name),k.container=f.scopeChain.classType.symbol):f.scopeChain.scope.enter(f.scopeChain.container,c,k,f.checker.errorReporter,!h&&(j||d||e||g),!1,b);a.hasFlag(c.varFlags,a.VarFlags.Exported)&&(k.flags|=a.SymbolFlags.Exported);i.typeLink=a.getTypeLink(c.typeExpr,f.checker,null==c.init);
c.sym=k}return!1}function v(c,b,f){var i=f.scopeChain;f.scopeChain.moduleDecl&&f.scopeChain.moduleDecl.recordNonInterface();var b=null,d=c.getNameText(),e=a.hasFlag(c.fncFlags,a.FncFlags.Exported|a.FncFlags.ClassPropertyMethodExported),j=a.hasFlag(c.fncFlags,a.FncFlags.Static);a.hasFlag(c.fncFlags,a.FncFlags.Private);var g=c.isConstructMember()||c.isConstructor,h=(c.isMethod()&&j||c.isAccessor())&&f.scopeChain.classType?f.scopeChain.classType.symbol:f.scopeChain.container,l=f.scopeChain.scope,k=c.name&&
a.hasFlag(c.name.flags,a.ASTFlags.OptionalName),v=!1,D=!1;g&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)&&(h=h.container,l=i.previous.scope);c.unitIndex=f.checker.locationInfo.unitIndex;if(!c.isConstructor&&h&&h.declAST&&h.declAST.nodeType==a.NodeType.FuncDecl&&h.declAST.isConstructor&&!c.isMethod())return v;if(a.hasFlag(c.fncFlags,a.FncFlags.Signature)){i=f.scopeChain.thisType;d&&"__missing"!=d&&(j?b=h.type.members.allMembers.lookup(d):(b=l.findLocal(d,!1,!1),null==b&&(b=l.findLocal(d,!1,!0))),
b&&(D=!0,!c.isSignature()&&a.hasFlag(c.fncFlags,a.FncFlags.Ambient)!=a.hasFlag(b.flags,a.SymbolFlags.Ambient)&&(b=null)));if(null==b){if(b=c.isSpecialFn()?f.checker.createFunctionSignature(c,h,l,h,!1).declAST.type.symbol:f.checker.createFunctionSignature(c,h,l,null,!D).declAST.type.symbol,null==b.declAST||!c.isSpecialFn())b.declAST=c}else b.kind()==a.SymbolKind.Type?b=f.checker.createFunctionSignature(c,h,l,b,!1).declAST.type.symbol:f.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+
"' already declared as a property");c.type=c.isSpecialFn()&&!j?i?i:b.type:b.type}else{d&&(j?b=h.type.members.allMembers.lookup(d):(c.isConstructor&&f.scopeChain.previous&&(b=f.scopeChain.previous.scope.findLocal(d,!1,!1)),null==b&&(b=l.findLocal(d,!1,!1))),b&&(D=!0,!g&&(b.declAST.nodeType==a.NodeType.FuncDecl&&!b.declAST.isAccessor()&&!b.declAST.isSignature())&&(b=null,D=!1)));b&&(!b.isAccessor()&&b.type&&b.type.construct&&b.type.construct.signatures!=[]&&(null==b.type.construct.signatures[0].declAST||
!a.hasFlag(b.type.construct.signatures[0].declAST.fncFlags,a.FncFlags.Ambient))&&!c.isConstructor)&&f.checker.errorReporter.simpleError(c,"Functions may not have class overloads");b&&(b.kind()!=a.SymbolKind.Type&&c.isMethod()&&!c.isAccessor()&&!c.isConstructor)&&(f.checker.errorReporter.simpleError(c,"Function or method '"+c.name.text+"' already declared as a property"),b.type=f.checker.anyType);f.checker.createFunctionSignature(c,h,l,b,!D);if((!b||b.declAST.nodeType!=a.NodeType.FuncDecl)&&c.isAccessor()||
b&&b.isAccessor())c.accessorSymbol=f.checker.createAccessorSymbol(c,b,h.type,c.isMethod()&&j,!0,l,h);c.type.symbol.declAST=c;c.isConstructor&&(v=!0)}e&&(c.type.call&&(c.type.symbol.flags|=a.SymbolFlags.Exported),b&&(!b.isAccessor()&&b.type.call)&&(b.flags|=a.SymbolFlags.Exported));f.scopeChain.moduleDecl&&!c.isSpecialFn()&&(c.type.symbol.flags|=a.SymbolFlags.ModuleMember,c.type.symbol.declModule=f.scopeChain.moduleDecl);b&&k&&(b.flags|=a.SymbolFlags.Optional);return v}a.Continuation=function(a){this.normalBlock=
a;this.exceptionBlock=-1};a.createNewConstructGroupForType=b;a.cloneParentConstructGroupForChildType=function(c,f){c.construct=new a.SignatureGroup;var i=null;f.construct||b(f);for(var d=0;d<f.construct.signatures.length;d++)i=new a.Signature,i.parameters=f.construct.signatures[d].parameters,i.nonOptionalParameterCount=f.construct.signatures[d].nonOptionalParameterCount,i.typeCheckStatus=f.construct.signatures[d].typeCheckStatus,i.declAST=f.construct.signatures[d].declAST,i.returnType=new a.TypeLink,
i.returnType.type=c.instanceType,c.construct.addSignature(i)};a.globalId="__GLO";a.preCollectImportTypes=e;a.preCollectModuleTypes=l;a.preCollectClassTypes=c;a.preCollectInterfaceTypes=i;a.preCollectArgDeclTypes=f;a.preCollectVarDeclTypes=j;a.preCollectFuncDeclTypes=v;a.preCollectTypes=function(b,d,g){var h=g.state,k=!1;b.nodeType==a.NodeType.Script?(h.script=b,k=!0):b.nodeType==a.NodeType.List?k=!0:b.nodeType==a.NodeType.Import?k=e(b,d,h):b.nodeType==a.NodeType.With?k=!1:b.nodeType==a.NodeType.Module?
k=l(b,d,h):b.nodeType==a.NodeType.Class?k=c(b,d,h):b.nodeType==a.NodeType.Block?k=!0:b.nodeType==a.NodeType.Interface?k=i(b,d,h):b.nodeType==a.NodeType.ArgDecl?k=f(b,d,h):b.nodeType==a.NodeType.VarDecl?k=j(b,d,h):b.nodeType==a.NodeType.FuncDecl?k=v(b,d,h):b.isStatementOrExpression()&&h.scopeChain.moduleDecl&&h.scopeChain.moduleDecl.recordNonInterface();g.options.goChildren=k;return b};a.postCollectTypes=function(c,b,f){b=f.state;c.nodeType==a.NodeType.Module?a.popTypeCollectionScope(b):c.nodeType==
a.NodeType.Class?a.popTypeCollectionScope(b):c.nodeType==a.NodeType.Interface&&a.popTypeCollectionScope(b);return c}})(TypeScript||(TypeScript={}));
(function(a){var d;d=function(a,b,f){this.container=a;this.previous=b;this.scope=f};a.ScopeChain=d;var h=function(a){this.bb=a;this.defsBySymbol=[];this.useIndexBySymbol=[]};h.prototype.updateTop=function(){for(var a=new k(this.top.bitCount),b=0,f=this.bb.successors.length;b<f;b++){var d=this.bb.successors[b];d.useDef&&a.union(d.useDef.top)}a.difference(this.kill);a.union(this.gen);b=a.notEq(this.top);this.top=a;return b};h.prototype.initialize=function(c){var b=this,f=function(a,c){if(c.isLocalSym(a)){var f=
c.getSymbolIndex(a);b.useIndexBySymbol[f]=[];b.defsBySymbol[f]=!0}},d=new a.AstWalkOptions;d.reverseSiblings=!0;a.getAstWalkerFactory().walk(this.bb.content,function(c,d,e){var j=e.state;null==c&&(c=null);if(c.nodeType==a.NodeType.VarDecl)d=c,(d.init||a.hasFlag(d.varFlags,a.VarFlags.AutoInit))&&f(d.sym,j);else if(c.nodeType==a.NodeType.Name){if(d)if(d.nodeType==a.NodeType.Asg){if(d.operand1==c)return c}else if(d.nodeType==a.NodeType.VarDecl&&d.id==c)return c;e=c.sym;d=c;if(j.isLocalSym(e)){e=j.getSymbolIndex(e);
void 0==b.useIndexBySymbol[e]&&(b.useIndexBySymbol[e]=[]);var g=b.useIndexBySymbol[e],d=j.getUseIndex(d);j.addUse(e,d);g.push(d)}}else c.nodeType>=a.NodeType.Asg&&c.nodeType<=a.NodeType.LastAsg?(d=c,d.operand1&&d.operand1.nodeType==a.NodeType.Name&&(d=d.operand1,f(d.sym,j))):c.nodeType==a.NodeType.FuncDecl&&(e.options.goChildren=!1);return c},null,d,c)};h.prototype.initializeGen=function(a){var b=this.useIndexBySymbol.length;this.gen=new k(a.uses.length);for(a=0;a<b;a++){var f=this.useIndexBySymbol[a];
if(void 0!=f&&0<f.length)for(var d=0,e=f.length;d<e;d++)this.gen.set(f[d],!0)}this.top=this.gen};h.prototype.initializeKill=function(a){this.kill=new k(this.gen.bitCount);for(var b=0,f=this.defsBySymbol.length;b<f;b++)if(this.defsBySymbol[b]){var d=a.useIndexBySymbol[b];if(d)for(var e=0,g=d.length;e<g;e++)this.kill.set(d[e],!0)}};a.BBUseDefInfo=h;var b=function(){this.useIndexBySymbol=[];this.uses=[];this.symbols=[];this.symbolMap=new a.StringHashTable;this.symbolCount=0};b.prototype.getSymbolIndex=
function(a){var b=a.name,f=this.symbolMap.lookup(b);null==f&&(f=this.symbolCount++,this.symbols[f]=a,this.symbolMap.add(b,f));return f};b.prototype.addUse=function(a,b){var f=this.useIndexBySymbol[a];void 0==f&&(f=[],this.useIndexBySymbol[a]=f);f[f.length]=b};b.prototype.getUseIndex=function(a){this.uses[this.uses.length]=a;return this.uses.length-1};b.prototype.isLocalSym=function(c){return c&&c.container==this.func&&c.kind()==a.SymbolKind.Variable};b.prototype.killSymbol=function(a,b){for(var f=
this.symbolMap.lookup(a.name),f=this.useIndexBySymbol[f],d=0,e=f.length;d<e;d++)b.set(f[d],!0)};a.UseDefContext=b;var k,g=function(a){this.bitCount=a;this.firstBits=0;this.restOfBits=null;if(this.bitCount>g.packBits){this.restOfBits=[];for(var a=Math.floor(this.bitCount/g.packBits),b=0;b<a;b++)this.restOfBits[b]=0}};g.packBits=30;g.prototype.set=function(a,b){if(a<g.packBits)this.firstBits=b?this.firstBits|1<<a:this.firstBits&~(1<<a);else{var f=Math.floor(a/g.packBits)-1,d=a%g.packBits;this.restOfBits[f]=
b?this.restOfBits[f]|1<<d:this.restOfBits[f]&~(1<<d)}};g.prototype.map=function(a){var b;for(b=0;b<g.packBits;b++){if(b==this.bitCount)return;0!=(1<<b&this.firstBits)&&a(b)}if(this.restOfBits){var f,d=g.packBits;b=0;for(f=this.restOfBits.length;b<f;b++)for(var e=this.restOfBits[b],h=0;h<g.packBits;h++)if(0!=(1<<h&e)&&a(d),d++,d==this.bitCount)return}};g.prototype.union=function(a){this.firstBits|=a.firstBits;if(this.restOfBits)for(var b=0,f=this.restOfBits.length;b<f;b++)this.restOfBits[b]|=a.restOfBits[b]};
g.prototype.intersection=function(a){this.firstBits&=a.firstBits;if(this.restOfBits)for(var b=0,f=this.restOfBits.length;b<f;b++)this.restOfBits[b]&=a.restOfBits[b]};g.prototype.notEq=function(a){if(this.firstBits!=a.firstBits)return!0;if(this.restOfBits)for(var b=0,f=this.restOfBits.length;b<f;b++)if(this.restOfBits[b]!=a.restOfBits[b])return!0;return!1};g.prototype.difference=function(a){this.firstBits&=~a.firstBits;if(this.restOfBits)for(var b=0,f=this.restOfBits.length;b<f;b++)this.restOfBits[b]&=
~a.restOfBits[b]};k=g;a.BitVector=k;var e=function(){this.predecessors=[];this.index=-1;this.markValue=0;this.successors=[];this.useDef=null;this.content=new a.ASTList};e.prototype.marked=function(a){return this.markValue>a};e.prototype.mark=function(){this.markValue++};e.prototype.addSuccessor=function(a){this.successors[this.successors.length]=a;a.predecessors[a.predecessors.length]=this};a.BasicBlock=e;e=function(a,b){this.current=a;this.exit=b;this.unreachable=this.entry=null;this.noContinuation=
!1;this.statementStack=[];this.currentSwitch=[];this.markBase=0;this.linearBBs=[];this.entry=this.current};e.prototype.walk=function(a,b){return this.walker.walk(a,b)};e.prototype.pushSwitch=function(a){this.currentSwitch.push(a)};e.prototype.popSwitch=function(){return this.currentSwitch.pop()};e.prototype.reportUnreachable=function(c){if(this.unreachable&&0<this.unreachable.length)for(var b=this.unreachable.length,f=0;f<b;f++){var d=this.unreachable[f];d.nodeType!=a.NodeType.EndCode&&c.simpleError(d,
"unreachable code")}};e.prototype.printAST=function(c,b){var f=new a.PrintContext(b,null);f.increaseIndent();a.getAstWalkerFactory().walk(c,a.prePrintAST,a.postPrintAST,null,f);f.decreaseIndent()};e.prototype.printBlockContent=function(a,b){for(var f=a.content,d=0,e=f.members.length;d<e;d++)this.printAST(f.members[d],b)};e.prototype.bfs=function(a,b,f,d){var e=this.markBase++,g=[];for(g[g.length]=this.entry;0<g.length;){var h=g.pop();if(!h.marked(e)){h.mark();a&&a(h);var l=h.successors.length;if(0<
l){f&&f();for(l-=1;0<=l;l--){var k=h.successors[l];k.marked(this.markBase)||(b&&b(h,k),g[g.length]=k)}d&&d()}}}};e.prototype.useDef=function(a,d){var f=this,e=new b;e.func=d;this.bfs(function(a){a.useDef=new h(a);a.useDef.initialize(e);f.linearBBs[f.linearBBs.length]=a},null,null,null);var g,l;g=0;for(l=this.linearBBs.length;g<l;g++)this.linearBBs[g].useDef.initializeGen(e),this.linearBBs[g].useDef.initializeKill(e);for(var k=!0;k;){k=!1;for(g=0;g<l;g++)k=this.linearBBs[g].useDef.updateTop()||k}this.entry.useDef.top.map(function(b){b=
e.uses[b];a.simpleError(b,"use of variable '"+b.text+"' that is not definitely assigned")})};e.prototype.print=function(a){var b=this,f=0;this.bfs(function(d){0>d.index&&(d.index=f++);d==b.exit?a.WriteLine("Exit block with index "+d.index):(a.WriteLine("Basic block with index "+d.index),b.printBlockContent(d,a))},function(b,d){0>d.index&&(d.index=f++);a.Write(d.index+" ")},function(){a.Write("  Branches to ")},function(){a.WriteLine("")});if(null!=this.unreachable)for(var d=0,e=this.unreachable.length;d<
e;d++)a.WriteLine("Unreachable basic block ..."),this.printAST(this.unreachable[d],a)};e.prototype.pushStatement=function(a,b,f){this.statementStack.push({stmt:a,continueBB:b,breakBB:f})};e.prototype.popStatement=function(){return this.statementStack.pop()};e.prototype.returnStmt=function(){this.current.addSuccessor(this.exit);this.setUnreachable()};e.prototype.setUnreachable=function(){this.current=null;this.noContinuation=!0};e.prototype.addUnreachable=function(a){null===this.unreachable&&(this.unreachable=
[]);this.unreachable[this.unreachable.length]=a};e.prototype.unconditionalBranch=function(a,b){for(var f=null,d=0,e=this.statementStack.length;d<e;d++){var g=this.statementStack[d];if(g.stmt==a){f=b?g.continueBB:g.breakBB;break}}f&&this.current.addSuccessor(f);this.setUnreachable()};e.prototype.addContent=function(a){this.current&&this.current.content.append(a)};a.ControlFlowContext=e;var l=function(){this.cacheSize=16;this.rdCache=[];for(var a=this.nextUp=0;a<this.cacheSize;a++)this.rdCache[a]={actuals:[],
exactCandidates:[],conversionCandidates:[],id:a}};l.prototype.getResolutionData=function(){var a=null;this.nextUp<this.cacheSize&&(a=this.rdCache[this.nextUp]);null==a&&(this.cacheSize++,a={actuals:[],exactCandidates:[],conversionCandidates:[],id:this.cacheSize},this.rdCache[this.cacheSize]=a);this.nextUp++;return a};l.prototype.returnResolutionData=function(a){a.actuals.length=0;a.exactCandidates.length=0;a.conversionCandidates.length=0;this.nextUp=a.id};a.ResolutionDataCache=l;e=function(a,b,f,
d){this.logger=a;this.initScope=b;this.parser=f;this.checker=d;this.thisClassNode=this.thisFnc=null;this.enclosingFncIsMethod=!1;this.currentScript=this.booleanInterfaceType=this.numberInterfaceType=this.functionInterfaceType=this.objectInterfaceType=this.stringInterfaceType=this.arrayInterfaceType=null;this.inArrayElementTypeCheck=this.inTypeRefTypeCheck=this.inImportTypeCheck=this.inNewTargetTypeCheck=!1;this.resolutionDataCache=new l;this.nestingLevel=0;this.inSuperCall=this.inBoundPropTypeCheck=
!1;this.checker.typeFlow=this;this.globalScope=this.scope=this.initScope;this.doubleType=this.checker.numberType;this.booleanType=this.checker.booleanType;this.stringType=this.checker.stringType;this.regexType=this.anyType=this.checker.anyType;this.nullType=this.checker.nullType;this.voidType=this.checker.voidType;this.arrayAnyType=this.checker.makeArrayType(this.anyType)};e.prototype.initLibs=function(){var c=this.globalScope.find("Array",!1,!0);c&&c.kind()==a.SymbolKind.Type&&(this.arrayInterfaceType=
c.type);if((c=this.globalScope.find("String",!1,!0))&&c.kind()==a.SymbolKind.Type)this.stringInterfaceType=c.type;if((c=this.globalScope.find("Object",!1,!0))&&c.kind()==a.SymbolKind.Type)this.objectInterfaceType=c.type;if((c=this.globalScope.find("Function",!1,!0))&&c.kind()==a.SymbolKind.Type)this.functionInterfaceType=c.type;if((c=this.globalScope.find("Number",!1,!0))&&c.kind()==a.SymbolKind.Type)this.numberInterfaceType=c.type;if((c=this.globalScope.find("Boolean",!1,!0))&&c.kind()==a.SymbolKind.Type)this.booleanInterfaceType=
c.type;if((c=this.globalScope.find("RegExp",!1,!0))&&c.kind()==a.SymbolKind.Type)this.regexType=c.type};e.prototype.cast=function(a,b){return this.castWithCoercion(a,b,!0,!1)};e.prototype.castWithCoercion=function(c,b,f,d){var e=new a.TypeComparisonInfo;this.checker.sourceIsAssignableToTarget(c.type,b,e)||d&&this.checker.sourceIsAssignableToTarget(b,c.type,e)?f&&(c.type=null==b?this.anyType:b.isClass()?b.instanceType:b):this.checker.errorReporter.incompatibleTypes(c,c.type,b,null,this.scope,e);return c};
e.prototype.inScopeTypeCheck=function(c,b){var f=this.scope;this.scope=b;for(var d=this.thisFnc,e=this.thisType,g=this.thisClassNode,h=this.checker.currentModDecl,l=this.enclosingFncIsMethod,k=this.scope.container,q=null;k;){if(k.kind()==a.SymbolKind.Type){var r=k,s=r.type;s.call&&null==q&&(this.enclosingFncIsMethod=r.isMethod,q=k.declAST);if(s.isClass()){this.thisType=s.instanceType;r.declAST&&r.declAST.nodeType==a.NodeType.Class&&(this.thisClassNode=r.declAST);break}if(s.isModuleType()){this.checker.currentModDecl=
r.declAST;break}}k=k.container}this.thisFnc=q;k=this.typeCheck(c);this.thisFnc=d;this.thisType=e;this.thisClassNode=g;this.checker.currentModDecl=h;this.enclosingFncIsMethod=l;this.scope=f;return k};e.prototype.typeCheck=function(a){return a?a.typeCheck(this):null};e.prototype.inScopeTypeCheckDecl=function(c){c.nodeType==a.NodeType.VarDecl||c.nodeType==a.NodeType.ArgDecl?this.inScopeTypeCheckBoundDecl(c):c.nodeType==a.NodeType.FuncDecl&&c.isAccessor()&&this.typeCheckFunction(c)};e.prototype.inScopeTypeCheckBoundDecl=
function(c){var b=c.sym,f=this.thisFnc,d=this.thisType,e=this.enclosingFncIsMethod,g=this.checker.locationInfo;if(b&&b.container){var h=a.hasFlag(c.varFlags,a.VarFlags.ClassConstructorProperty)?b.container.getType().constructorScope:b.container.instanceScope();a.hasFlag(c.varFlags,a.VarFlags.Property)&&b.container.declAST.nodeType==a.NodeType.FuncDecl&&(this.thisFnc=b.container.declAST);if(h){var l=this.scope;this.scope=h;h=b.container;for(this.checker.locationInfo=this.checker.units&&0<=b.unitIndex&&
b.unitIndex<this.checker.units.length?this.checker.units[b.unitIndex]:a.unknownLocationInfo;h;){if(h.kind()==a.SymbolKind.Type){var b=h,k=b.type;k.call&&(this.enclosingFncIsMethod=b.isMethod);if(k.isClass()){this.thisType=k.instanceType;break}}h=h.container}this.typeCheckBoundDecl(c);this.scope=l}}this.thisFnc=f;this.thisType=d;this.checker.locationInfo=g;this.enclosingFncIsMethod=e};e.prototype.resolveBoundDecl=function(a){a.typeExpr?((null==a.typeExpr.type||a.typeExpr.type&&a.typeExpr.type==this.anyType&&
this.scope||null==a.typeExpr.type.symbol||!this.checker.typeStatusIsFinished(a.typeExpr.type.symbol.typeCheckStatus))&&this.typeCheck(a.typeExpr),a.type=a.typeExpr.type,a.sym&&a.sym.setType(a.type)):null==a.init&&(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(a,"type implicitly set to 'any'"),a.type=this.anyType,a.sym&&(a.sym.isType()?a.sym.isMethod?this.checker.errorReporter.simpleError(a,"Cannot bind method group to variable.  (Did you mean to use 'declare function' instead of 'declare var'?)"):
this.checker.errorReporter.simpleError(a,"Cannot bind type to variable"):a.sym.setType(a.type)))};e.prototype.typeCheckBoundDecl=function(c){var b=c.sym;if(null==b)c.init?(c.init=this.typeCheck(c.init),c.type=this.checker.widenType(c.init.type)):(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),c.type=this.anyType);else if(b.typeCheckStatus==a.TypeCheckStatus.Started)this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,
"type implicitly set to 'any'"),c.type=this.anyType,b.setType(this.anyType);else if(b.typeCheckStatus==a.TypeCheckStatus.NotStarted){b.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(b);var f=!1;null==c.type&&c.typeExpr&&(this.resolveBoundDecl(c),f=!0,c.type=c.typeExpr.type,b.typeCheckStatus=this.checker.getTypeCheckFinishedStatus());if(c.init){a.hasFlag(c.varFlags,a.VarFlags.Ambient)&&this.checker.errorReporter.simpleError(c,"Ambient variable can not have an initializer");var d=
a.hasFlag(c.varFlags,a.VarFlags.LocalStatic),e=this.scope,f=!c.init.isParenthesized;d&&(this.scope=c.sym.container.getType().memberScope);c.varFlags&a.VarFlags.Property&&(this.inBoundPropTypeCheck=!0);this.checker.typeCheckWithContextualType(c.type,this.checker.inProvisionalTypecheckMode(),f,c.init);this.inBoundPropTypeCheck&&(this.inBoundPropTypeCheck=!1);this.scope=e;c.type?(d=!1,e=null,c.init.type&&(e=c.init.type.containedScope,d=!0,c.init.type==this.voidType&&this.checker.errorReporter.simpleError(c,
"Cannot assign type 'void' to variable '"+c.id.text+"'")),c.init=this.castWithCoercion(c.init,c.type,f,!1),d&&null==c.init.type.containedScope&&(c.init.type.containedScope=e)):(c.type=this.checker.widenType(c.init.type),c.type==this.voidType&&(this.checker.errorReporter.simpleError(c,"Cannot assign type 'void' to variable '"+c.id.text+"'"),c.type=this.anyType));b.setType(c.type)}else f||this.resolveBoundDecl(c);b.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()}else this.checker.typeStatusIsFinished(b.typeCheckStatus)&&
b.declAST!=c&&c.init&&(c.init=this.typeCheck(c.init),c.type=b.getType(),c.init=this.cast(c.init,c.type));c.id&&c.sym&&(c.id.sym=c.sym);return c};e.prototype.typeCheckSuper=function(a){this.thisType&&this.enclosingFncIsMethod&&!this.thisFnc.isStatic()&&this.thisType.baseClass()?a.type=this.thisType.baseClass():(a.type=this.anyType,this.checker.errorReporter.invalidSuperReference(a));return a};e.prototype.typeCheckThis=function(c){var b=!1;if(null==this.thisFnc)this.thisType?this.thisClassNode&&this.thisClassNode.nty==
a.NodeType.Class?(b=!0,c.type=this.anyType):c.type=this.thisType:(this.checker.currentModDecl&&this.checker.errorReporter.simpleError(c,"'this' may not be referenced within module bodies"),c.type=this.anyType);else{if((this.inBoundPropTypeCheck||this.inSuperCall)&&this.thisClassNode&&this.thisClassNode.nty==a.NodeType.Class)b=!0;c.type=this.thisFnc.isMethod()||this.thisFnc.isConstructor||this.thisFnc.isTargetTypedAsMethod?this.thisType&&!(this.thisFnc.fncFlags&a.FncFlags.Static)?this.thisType:this.anyType:
this.anyType}if(!this.enclosingFncIsMethod&&this.thisFnc&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.IsFatArrowFunction))if(this.thisFnc.boundToProperty){var f=this.thisFnc.boundToProperty.sym.container;f.declAST.nodeType==a.NodeType.FuncDecl&&f.declAST.setHasSelfReference()}else{for(var d=f=this.thisFnc.enclosingFnc,e=!1;f;){if(f.isMethod()||f.isConstructor||f.hasSelfReference()){f.setHasSelfReference();e=!0;break}f=f.enclosingFnc}!e&&d&&d.setHasSelfReference();e&&this.thisType&&(c.type=this.thisType)}b&&
this.checker.errorReporter.simpleError(c,"Keyword 'this' cannot be referenced in initializers in a class body, or in super constructor calls");return c};e.prototype.setTypeFromSymbol=function(c,b){b.isVariable()?(b.isInferenceSymbol()&&(b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST),this.checker.styleSettings.innerScopeDeclEscape||b.declAST&&b.declAST.nodeType==a.NodeType.VarDecl&&this.nestingLevel<b.declAST.nestingLevel&&this.checker.errorReporter.styleError(c,
"Illegal reference to a variable defined in more nested scope")),c.type=b.getType(),b.writeable()||(c.flags&=~a.ASTFlags.Writeable)):b.isType()?(c.type=b.getType(),c.flags&=~a.ASTFlags.Writeable):(c.type=this.anyType,this.checker.errorReporter.symbolDoesNotReferToAValue(c,b.name))};e.prototype.typeCheckName=function(c){var b=this;if(this.checker.inWith)c.type=this.anyType;else{var f=c.text,d=a.isQuoted(c.text),e=this.scope.find(f,!1,!1);null==e&&d&&(e=this.checker.findSymbolForDynamicModule(f,this.currentScript.locationInfo.filename,
function(a){return b.scope.find(a,!1,!1)}));if(e){this.inNewTargetTypeCheck&&(e.isInferenceSymbol()&&!this.checker.typeStatusIsFinished(e.typeCheckStatus))&&this.checker.errorReporter.simpleError(c,"Symbol '"+c.text+"' is referenced before its declaration");if(a.optimizeModuleCodeGen&&e&&e.isType()&&(f=e.getType())&&e.aliasLink&&e.onlyReferencedAsTypeRef)if((f=f.symbol.declAST)&&a.hasFlag(f.modFlags,a.ModuleFlags.IsDynamic))e.onlyReferencedAsTypeRef=this.inTypeRefTypeCheck;e.declAST&&(e.declAST.nodeType==
a.NodeType.FuncDecl&&!e.declAST.returnTypeAnnotation&&e.declAST.signature.typeCheckStatus==a.TypeCheckStatus.Started)&&(e.declAST.type.symbol.flags|=a.SymbolFlags.RecursivelyReferenced,e.declAST.signature.returnType.type=this.anyType);this.setTypeFromSymbol(c,e);c.sym=e;this.thisFnc&&this.thisFnc.type&&e.container!=this.thisFnc.type.symbol&&(this.thisFnc.freeVariables[this.thisFnc.freeVariables.length]=e)}else c.isMissing()||this.checker.errorReporter.unresolvedSymbol(c,c.text),c.type=this.anyType}return c};
e.prototype.typeCheckScript=function(a){this.checker.locationInfo=a.locationInfo;this.scope=this.checker.globalScope;a.topLevelMod||this.addLocalsFromScope(this.scope,this.checker.gloMod,a.vars,this.checker.globals,!0);this.currentScript=a;a.bod=this.typeCheck(a.bod);this.currentScript=null;return a};e.prototype.typeCheckBitNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.doubleType;return a};e.prototype.typeCheckUnaryNumberOperator=function(a){a.operand=this.typeCheck(a.operand);a.type=
this.doubleType;return a};e.prototype.typeCheckLogNot=function(a){a.operand=this.typeCheck(a.operand);a.type=this.booleanType;return a};e.prototype.astIsWriteable=function(c){return a.hasFlag(c.flags,a.ASTFlags.Writeable)};e.prototype.typeCheckIncOrDec=function(c){var b=c;this.astIsWriteable(b)?(b=this.typeCheckUnaryNumberOperator(c),b.operand.type!=this.checker.numberType&&(b.operand.type!=this.checker.anyType&&!(b.operand.type.typeFlags&a.TypeFlags.IsEnum))&&this.checker.errorReporter.simpleError(c,
"'++' and '--' may only be applied to operands of type 'number' or 'any'")):(this.checker.errorReporter.valueCannotBeModified(b),b.type=this.doubleType);return b};e.prototype.typeCheckBitwiseOperator=function(c,b){var f=null;c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);var d=c.operand1.type,e=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);this.checker.styleSettings.bitwise&&this.checker.errorReporter.styleError(c,"use of "+
a.nodeTypeTable[c.nodeType]);if(this.checker.sourceIsSubtypeOfTarget(d,this.doubleType)&&this.checker.sourceIsSubtypeOfTarget(e,this.doubleType))f=this.doubleType;else if(d==this.booleanType&&e==this.booleanType)f=this.booleanType;else if(d==this.anyType){if(e==this.anyType||e==this.doubleType||e==this.booleanType)f=this.anyType}else if(e==this.anyType&&(d==this.anyType||d==this.doubleType||d==this.booleanType))f=this.anyType;null==f&&(f=this.anyType,this.checker.errorReporter.incompatibleTypes(c,
d,e,c.printLabel(),this.scope));c.type=f;return c};e.prototype.typeCheckArithmeticOperator=function(c,b){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);var f=c.operand1.type,d=c.operand2.type;b&&!this.astIsWriteable(c)&&this.checker.errorReporter.valueCannotBeModified(c);this.checker.styleSettings.bitwise&&(c.nodeType==a.NodeType.And||c.nodeType==a.NodeType.Or||c.nodeType==a.NodeType.AsgAnd||c.nodeType==a.NodeType.AsgOr)&&this.checker.errorReporter.styleError(c,"use of "+
a.nodeTypeTable[c.nodeType]);if(null==f||null==d)return this.checker.errorReporter.simpleError(c,"Could not typecheck arithmetic operation.  Possible recursive typecheck error?"),c.type=this.anyType,c;var e=c.nodeType;this.checker.isNullOrUndefinedType(f)&&(f=d);this.checker.isNullOrUndefinedType(d)&&(d=f);f=this.checker.widenType(f);d=this.checker.widenType(d);e==a.NodeType.Add||e==a.NodeType.AsgAdd?f==this.checker.stringType||d==this.checker.stringType?c.type=this.checker.stringType:f==this.checker.numberType&&
d==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(f,this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(d,this.checker.numberType)?c.type=this.checker.numberType:f==this.checker.anyType||d==this.checker.anyType?c.type=this.checker.anyType:(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,f,d,c.printLabel(),this.scope)):f==this.checker.numberType&&d==this.checker.numberType?c.type=this.checker.numberType:this.checker.sourceIsSubtypeOfTarget(f,
this.checker.numberType)&&this.checker.sourceIsSubtypeOfTarget(d,this.checker.numberType)?c.type=this.checker.numberType:f==this.checker.anyType||d==this.checker.anyType?c.type=this.checker.numberType:(c.type=this.anyType,this.checker.errorReporter.incompatibleTypes(c,f,d,c.printLabel(),this.scope));return c};e.prototype.typeCheckDotOperator=function(a){a.operand1=this.typeCheck(a.operand1);var b=a.operand1.type,d=null;if(b){if(b==this.anyType)return a.type=this.anyType,a;if(b==this.stringType)if(this.stringInterfaceType)d=
this.stringInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.doubleType)if(this.numberInterfaceType)d=this.numberInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b==this.booleanType)if(this.booleanInterfaceType)d=this.booleanInterfaceType.memberScope;else return a.type=this.anyType,a;else if((b.call||b.construct)&&null==b.members)if(this.functionInterfaceType)d=this.functionInterfaceType.memberScope;else return a.type=this.anyType,a;else if(b.elementType)if(this.arrayInterfaceType)d=
b.elementType.getArrayBase(this.arrayInterfaceType,this.checker).memberScope;else return a.type=this.anyType,a;else d=b.memberScope}if(null==d)this.checker.errorReporter.expectedClassOrInterface(a),a.type=this.anyType;else{var e=a.operand2,g=d.find(e.text,!(this.thisClassNode&&a.operand1.type==this.thisClassNode.type.instanceType),!1);if(!g&&(this.objectInterfaceType&&b)&&(b.isReferenceType()&&(g=this.objectInterfaceType.memberScope.find(e.text,!1,!1)),!g&&this.functionInterfaceType&&(b.call||b.construct)))g=
this.functionInterfaceType.memberScope.find(e.text,!1,!1);!g||!g.visible(d,this.checker)?(a.type=this.anyType,null==g?this.checker.errorReporter.simpleError(e,"The property '"+e.text+"' does not exist on value of type '"+b.getScopedTypeName(this.scope)+"'"):this.checker.errorReporter.simpleError(a,"The property '"+e.text+" on type '"+b.getScopedTypeName(this.scope)+"' is not visible")):(g.isVariable()&&g.isInferenceSymbol()&&(b=g,b.declAST&&!this.checker.typeStatusIsFinished(b.typeCheckStatus)&&this.inScopeTypeCheckDecl(b.declAST)),
e.sym=g,a.type=g.getType())}null==a.type&&(a.type=this.anyType);return a};e.prototype.typeCheckBooleanOperator=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,d=a.operand2.type;!this.checker.sourceIsAssignableToTarget(b,d)&&!this.checker.sourceIsAssignableToTarget(d,b)&&this.checker.errorReporter.incompatibleTypes(a,b,d,a.printLabel(),this.scope);a.type=this.booleanType;return a};e.prototype.typeCheckAsgOperator=function(a){var b=!a.operand2.isParenthesized;
a.operand1=this.typeCheck(a.operand1);this.checker.typeCheckWithContextualType(a.operand1.type,this.checker.inProvisionalTypecheckMode(),b,a.operand2);var d=a.operand1.type,e=a.operand2.type;this.astIsWriteable(a.operand1)||this.checker.errorReporter.valueCannotBeModified(a);var g=!1,h=null;a.operand2.type&&(h=a.operand2.type.containedScope,g=!0);a.operand2=this.castWithCoercion(a.operand2,d,b,!1);g&&null==a.operand2.type.containedScope&&(a.operand2.type.containedScope=h);a.type=e;return a};e.prototype.typeCheckIndex=
function(c){c.operand1=this.typeCheck(c.operand1);c.operand2=this.typeCheck(c.operand2);this.checker.styleSettings.literalSubscript||c.operand2.nodeType==a.NodeType.QString&&this.checker.errorReporter.styleError(c,"use literal subscript ('.') notation instead)");var b=c.operand1.type,d=c.operand2.type;b.elementType?d==this.checker.anyType||d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum)?c.type=b.elementType:(d!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,
"Illegal property access"),c.type=this.checker.anyType):b.index?d==this.checker.anyType||!(b.index.flags&a.SignatureFlags.IsStringIndexer||b.index.flags&a.SignatureFlags.IsNumberIndexer)||b.index.flags&a.SignatureFlags.IsStringIndexer&&d==this.checker.stringType||b.index.flags&a.SignatureFlags.IsNumberIndexer&&(d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum))?(b=this.resolveOverload(c,b.index),c.type=b?b.returnType.type:this.checker.anyType):(d!=this.checker.stringType&&this.checker.errorReporter.simpleError(c,
"Illegal property access"),c.type=this.checker.anyType):((!(b==this.checker.anyType||b==this.checker.stringType||b==this.checker.numberType||b==this.checker.booleanType||b.isReferenceType())||!(d==this.checker.anyType||d==this.checker.stringType||d==this.checker.numberType||a.hasFlag(d.typeFlags,a.TypeFlags.IsEnum)))&&this.checker.errorReporter.simpleError(c,"Illegal property access"),c.type=this.checker.anyType);return c};e.prototype.typeCheckInOperator=function(a){a.operand1=this.cast(this.typeCheck(a.operand1),
this.stringType);a.operand2=this.typeCheck(a.operand2);(!(a.operand1.type==this.checker.anyType||a.operand1.type==this.checker.stringType)||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.objectInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The in operator requires the left operand to be of type Any or the String primitive type, and the right operand to be of type Any or an object type");a.type=this.booleanType;return a};e.prototype.typeCheckShift=
function(a,b){a.operand1=this.cast(this.typeCheck(a.operand1),this.doubleType);a.operand2=this.cast(this.typeCheck(a.operand2),this.doubleType);b&&!this.astIsWriteable(a.operand1)&&this.checker.errorReporter.valueCannotBeModified(a);a.type=this.doubleType;return a};e.prototype.typeCheckQMark=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.operand3=this.typeCheck(a.operand3);var b=a.operand2.type,d=a.operand3.type;b==d?a.type=b:this.checker.sourceIsSubtypeOfTarget(b,
d)?a.type=d:this.checker.sourceIsSubtypeOfTarget(d,b)?a.type=b:(a.type=this.anyType,this.checker.errorReporter.incompatibleTypes(a,b,d,a.printLabel(),this.scope));return a};e.prototype.addFormals=function(a,b,d){for(var e=b.parameters.length,g=0;g<e;g++){var h=b.parameters[g];h.container=a;d.add(h.name,h)}};e.prototype.addLocalsFromScope=function(c,b,d,e,g){for(var h=d.members.length,l=!1,k=0;k<h;k++){var n=d.members[k];if(null==n.sym||n.sym.kind()!=a.SymbolKind.Field){var q=null;if(null==(q=e.lookup(n.id.text))){q=
new a.ValueLocation;q.typeLink=new a.TypeLink;var r=null;a.hasFlag(n.varFlags,a.VarFlags.Static)?(n.varFlags|=a.VarFlags.LocalStatic,r=new a.FieldSymbol(n.id.text,n.minChar,this.checker.locationInfo.unitIndex,!0,q)):r=new a.VariableSymbol(n.id.text,n.minChar,this.checker.locationInfo.unitIndex,q);r.transferVarFlags(n.varFlags);q.symbol=r;r.declAST=n;q.typeLink.ast=n.typeExpr;this.checker.resolveTypeLink(c,q.typeLink,!1);null==n.type&&null==n.init&&(n.type=this.anyType);q.typeLink.type=n.type;q.symbol.container=
b;n.sym=q.symbol;e.add(n.id.text,r);"arguments"==n.id.text&&(l=!0)}else n.type=q.getType(),n.sym=q}}!g&&!l&&(b=new a.ValueLocation,b.typeLink=new a.TypeLink,d=new a.VariableSymbol("arguments",d.minChar,this.checker.locationInfo.unitIndex,b),b.typeLink.ast=new a.Identifier("IArguments"),this.checker.resolveTypeLink(c,b.typeLink,!1),e.add("arguments",d))};e.prototype.addConstructorLocalArgs=function(c,b,d,e){if(b)for(var g=b.members.length,h=0;h<g;h++){var l=b.members[h];if(null==l.sym||e||l.sym.kind()!=
a.SymbolKind.Field){var k=null;if(null==(k=d.lookup(l.id.text))){this.resolveBoundDecl(l);k=new a.ValueLocation;k.typeLink=new a.TypeLink;var n=new a.ParameterSymbol(l.id.text,l.minChar,this.checker.locationInfo.unitIndex,k);n.declAST=l;k.symbol=n;k.typeLink.type=l.type;k.symbol.container=c;l.sym=k.symbol;d.add(l.id.text,n)}else l.type=k.getType(),l.sym=k}}};e.prototype.checkInitSelf=function(a){if(!a.isMethod())for(var b=a.freeVariables,d=0,e=b.length;d<e;d++)if(b[d].isInstanceProperty())return!0;
a=a.scopes;b=a.members.length;for(d=0;d<b;d++)if(this.checkInitSelf(a.members[d]))return!0;return!1};e.prototype.checkPromoteFreeVars=function(c,b){for(var d=c.freeVariables,e=0,g=d.length;e<g;e++){var h=d[e];!h.isInstanceProperty()&&h.container==b&&(a.instanceFilter.reset(),this.scope.search(a.instanceFilter,h.name,!1,!1)&&this.checker.errorReporter.simpleError(c,"Constructor-local variable shadows class property '"+h.name+"'. To access the class property, use 'self."+h.name+"'"),this.checker.errorReporter.simpleError(c,
"Constructor-local variables may not be accessed from instance method bodies. Consider changing local variable '"+h.name+"' to a class property"))}};e.prototype.allReturnsAreVoid=function(c){var b=!0;null==c.signature.returnType.type&&a.getAstWalkerFactory().walk(c.bod,function(c,d,e){d=!0;switch(c.nodeType){case a.NodeType.FuncDecl:d=!1;break;case a.NodeType.Return:c.returnExpression&&(d=b=!1)}e.options.goChildren=d;e.options.goNextSibling=d;return c});return b};e.prototype.classConstructorHasSuperCall=
function(c){var b=!1;a.getAstWalkerFactory().walk(c.bod,function(c,d,e){d=!0;switch(c.nodeType){case a.NodeType.FuncDecl:d=!1;break;case a.NodeType.Call:c.target.nodeType==a.NodeType.Super&&(d=!1,b=!0)}e.options.goChildren=d;return c});return b};e.prototype.typeCheckFunction=function(c){this.nestingLevel=0;var b=c.type,d=b.symbol,e=c.signature;if(this.checker.typeStatusIsFinished(e.typeCheckStatus))return c;if(e.typeCheckStatus==a.TypeCheckStatus.Started)return!c.returnTypeAnnotation&&c.bod&&!c.isSignature()&&
!c.isConstructor&&this.allReturnsAreVoid(c)?e.returnType.type=this.voidType:null==c.returnTypeAnnotation&&(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),e.returnType.type=this.anyType,d.flags|=a.SymbolFlags.RecursivelyReferenced),c;e.typeCheckStatus=a.TypeCheckStatus.Started;this.checker.addStartedPTO(e);var g=this.scope,h=this.thisFnc,l=this.enclosingFncIsMethod,k=this.thisClassNode;this.enclosingFncIsMethod=c.isMethod()||c.isConstructor;
this.thisFnc=c;var n=c.type.symbol,q=this.thisType,r=this.checker.locationInfo,s=null,t=!1,w=null,A=null,C=c.isAccessor()&&a.hasFlag(c.fncFlags,a.FncFlags.GetAccessor),x=c.isAccessor()&&a.hasFlag(c.fncFlags,a.FncFlags.SetAccessor),D=(C||x)&&c.accessorSymbol?c.accessorSymbol.getType():null,C=this.checker.currentModDecl;if(c.isConstructor&&!c.isOverload){if(null==b.instanceType)return this.checker.errorReporter.simpleError(c,"Malformed function body (is this a class named the same as an existing interface?)"),
c;var E=this.scope=b.instanceType.constructorScope,s=E.valueMembers.allMembers}else if(c.isOverload)s=c.symbols,!a.hasFlag(c.fncFlags,a.FncFlags.Static)&&b.containedScope&&(this.scope=b.containedScope);else if(c.bod&&(this.scope=b.containedScope),(E=this.scope)&&E.valueMembers)s=E.valueMembers.allMembers;if(c.isConstructor&&c.bod&&a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)){var y=a.hasFlag(c.classDecl.type.instanceType.typeFlags,a.TypeFlags.HasBaseType),H=!y||a.hasFlag(c.classDecl.type.instanceType.typeFlags,
a.TypeFlags.HasBaseTypeOfObject),B=a.hasFlag(c.classDecl.varFlags,a.VarFlags.ClassSuperMustBeFirstCallInConstructor);H&&this.classConstructorHasSuperCall(c)?this.checker.errorReporter.simpleError(c,"Calls to 'super' constructor are not allowed in classes that either inherit directly from 'Object' or have no base class"):y&&(B?(!c.bod||!c.bod.members.length||!(c.bod.members[0].nodeType==a.NodeType.Call&&c.bod.members[0].target.nodeType==a.NodeType.Super))&&this.checker.errorReporter.simpleError(c,
"If a derived class contains initialized properties or constructor parameter properties, the first statement in the constructor body must be a call to the super constructor"):this.classConstructorHasSuperCall(c)||this.checker.errorReporter.simpleError(c,"Constructors for derived classes must contain a call to the class's 'super' constructor"))}c.isMethod()&&c.type.enclosingType&&(y=null,c.type.enclosingType.symbol.declAST.nodeType==a.NodeType.FuncDecl?y=c.type.enclosingType.symbol.declAST.classDecl:
c.type.enclosingType.symbol.declAST.nodeType==a.NodeType.Class&&(y=c.type.enclosingType.symbol.declAST),y&&(this.thisClassNode=y));if(b.enclosingType){if((y=b.symbol.container)&&y.isType()&&y.getType().isClass())y=y.container;y&&(y.declAST&&y.declAST.nodeType==a.NodeType.Module)&&(this.checker.currentModDecl=y.declAST)}this.checker.locationInfo=this.checker.units&&0<=c.unitIndex&&c.unitIndex<this.checker.units.length?this.checker.units[c.unitIndex]:a.unknownLocationInfo;this.thisType=b.enclosingType?
b.enclosingType:q;y=e.parameters.length;if(!c.isConstructor&&c.bod&&!c.isSignature()){E=H=this.scope;if(!c.isMethod()&&null==c.returnTypeAnnotation){if(g&&c.name&&!c.name.isMissing()&&(B=g.findAmbient(c.name.text,!1,!1))&&B.declAST&&B.declAST.type)this.checker.setContextualType(B.declAST.type,!1),t=!0;if(this.checker.hasTargetType()){var B=this.checker.getTargetTypeContext(),z=B.contextualType;this.checker.canContextuallyTypeFunction(z,c,!0)?(B.targetSig=(z.construct?z.construct:z.call).signatures[0],
w=B.targetSig.parameters,A=B.targetSig.returnType.type,B.targetSig.declAST&&(B.targetSig.declAST.isConstructor?c.isTargetTypedAsMethod=!0:B.targetSig.declAST.isMethod()&&(c.isTargetTypedAsMethod=!0)),d.type=B.contextualType):z&&c.isAccessor()?(D=z,B.targetAccessorType=D):this.checker.killTargetType()}}E=E.valueMembers;this.scope=new a.SymbolScopeBuilder(E,null,null,null,g,n);for(z=0;z<y;z++){var G=e.parameters[z],F=G.declAST;this.checker.hasTargetType()&&w&&(this.checker.getTargetTypeContext().targetSig.hasVariableArgList||
z<w.length)?(B=this.checker.getTargetTypeContext(),F.type=B.targetSig.hasVariableArgList&&z>=w.length-1?w[w.length-1].getType().elementType:w[z].getType(),F.sym.setType(F.type),F.sym.typeCheckStatus=this.checker.getTypeCheckFinishedStatus()):this.typeCheck(F);x&&D&&(F=this.cast(F,D));G.container=n;E.publicMembers.add(G.name,G)}this.scope=H}else{this.typeCheck(c.args);for(z=0;z<y;z++)e.parameters[z].parameter.typeLink.type=c.args.members[z].type,c.args.members[z].parameterPropertySym&&c.args.members[z].parameterPropertySym.setType(c.args.members[z].type);
c.fncFlags&a.FncFlags.IndexerMember&&(!y||1<y?this.checker.errorReporter.simpleError(c,"Index signatures may take only one parameter"):c.args.members[0].type==this.checker.numberType?b.index.flags|=a.SignatureFlags.IsNumberIndexer:c.args.members[0].type==this.checker.stringType?b.index.flags|=a.SignatureFlags.IsStringIndexer:this.checker.errorReporter.simpleError(c,"Index signatures may only take 'string' or 'number' as their parameter"))}if(c.bod&&!c.isSignature()&&(c.isConstructor?(this.addConstructorLocalArgs(c.type.symbol,
c.args,s,a.hasFlag(c.fncFlags,a.FncFlags.ClassMethod)),this.thisClassNode&&this.thisClassNode.extendsList&&(n=this.scope,s=new a.ScopedMembers(s),this.scope=new a.FilteredSymbolScopeBuilder(s,g,c.type.symbol,function(c){return c.kind()==a.SymbolKind.Parameter}),this.typeCheckBaseCalls(this.thisClassNode.extendsList),this.scope=n)):this.addFormals(n,e,s),s=this.checker.currentModDecl,c.type&&(c.type.symbol&&!c.isMethod()&&c.type.symbol.declModule)&&(this.checker.currentModDecl=c.type.symbol.declModule),
this.typeCheck(c.bod),this.checker.currentModDecl=s,this.checker.checkControlFlow&&(s=c.buildControlFlow(),this.checker.printControlFlowGraph&&s.print(this.checker.errorReporter.outfile),s.reportUnreachable(this.checker.errorReporter),this.checker.checkControlFlowUseDef&&s.useDef(this.checker.errorReporter,c.type.symbol)),c.isConstructor)){s=c.scopes;n=s.members.length;for(w=0;w<n;w++)x=s.members[w],x.isSignature()||a.hasFlag(x.fncFlags,a.FncFlags.Method)&&!a.hasFlag(x.fncFlags,a.FncFlags.Static)&&
this.checkPromoteFreeVars(x,c.type.symbol)}this.scope=g;this.thisFnc=h;this.thisClassNode=k;this.enclosingFncIsMethod=l;this.thisType=q;this.checker.locationInfo=r;this.checker.currentModDecl=C;e.typeCheckStatus=this.checker.getTypeCheckFinishedStatus();c.returnTypeAnnotation?(this.checkForVoidConstructor(c.returnTypeAnnotation.type,c.returnTypeAnnotation),null==e.returnType.type&&this.checker.resolveTypeLink(this.scope,e.returnType,!1)):A&&(e.returnType.type=A);if(!(d.flags&a.SymbolFlags.RecursivelyReferenced)&&
0<c.returnStatementsWithExpressions.length)if(d=c.returnStatementsWithExpressions[0].type,d=this.checker.findBestCommonType(d,null,{getLength:function(){return c.returnStatementsWithExpressions.length},setTypeAtIndex:function(a,b){c.returnStatementsWithExpressions[a].type=b},getTypeAtIndex:function(a){return c.returnStatementsWithExpressions[a].type}}))e.returnType.type=this.checker.widenType(d);else{for(d=0;d<c.returnStatementsWithExpressions.length;d++)this.checker.errorReporter.simpleError(c.returnStatementsWithExpressions[d],
"Incompatible return type");e.returnType.type=this.anyType}null==e.returnType.type?a.hasFlag(c.fncFlags,a.FncFlags.HasReturnExpression)?(this.checker.styleSettings.implicitAny&&this.checker.errorReporter.styleError(c,"type implicitly set to 'any'"),e.returnType.type=this.anyType):e.returnType.type=this.voidType:e.returnType.type==this.nullType||e.returnType.type==this.checker.undefinedType?e.returnType.type=this.anyType:e.returnType.type!=this.voidType&&(e.returnType.type!=this.checker.undefinedType&&
e.returnType.type!=this.anyType)&&c.returnTypeAnnotation&&!c.isSignature()&&(!c.isConstructor&&!a.hasFlag(c.fncFlags,a.FncFlags.HasReturnExpression)&&!a.hasFlag(c.fncFlags,a.FncFlags.IsFatArrowFunction))&&(0<c.bod.members.length&&c.bod.members[0].nodeType==a.NodeType.Throw||this.checker.errorReporter.simpleError(c,"Function declared a non-void return type, but has no return expression"));t&&this.checker.unsetContextualType();c.accessorSymbol&&((D=c.accessorSymbol.getType())?(a.hasFlag(c.fncFlags,
a.FncFlags.GetAccessor)&&D!=e.returnType.type||0<c.args.members.length&&D!=c.args.members[0].type)&&this.checker.errorReporter.simpleError(c,"Getter and setter types do not agree"):a.hasFlag(c.fncFlags,a.FncFlags.GetAccessor)?c.accessorSymbol.setType(e.returnType.type):1!=c.args.members.length?this.checker.errorReporter.simpleError(c,"Setters may have one and only one argument"):c.accessorSymbol.setType(c.args.members[0].type));this.typeCheckOverloadSignatures(b,c);return c};e.prototype.typeCheckBases=
function(c){var b=!1,d=c.extendsList;if(d){var e=d.length;this.inNewTargetTypeCheck=!0;0<e&&(c.typeFlags|=a.TypeFlags.HasBaseType);for(var g=0;g<e;g++){var h=d[g];h.symbol&&("Object"==h.symbol.name&&h.symbol.container==this.checker.gloMod)&&(c.typeFlags|=a.TypeFlags.HasBaseTypeOfObject);if(h.isClassInstance())c.isClassInstance()&&(!this.checker.typeStatusIsFinished(h.symbol.typeCheckStatus)&&h.symbol.declAST)&&(this.checker.errorReporter.simpleErrorFromSym(h.symbol,"Base type '"+h.symbol.name+"' is referenced before its declaration"),
this.typeCheck(h.symbol.declAST)),this.currentScript&&(this.currentScript.requiresInherits=!0),c.isClassInstance()?b&&this.checker.errorReporter.simpleErrorFromSym(h.symbol,"Class may not follow interface as base type"):this.checker.errorReporter.simpleErrorFromSym(h.symbol,"Interface base type must be interface");else if(h.isModuleType())this.checker.errorReporter.simpleErrorFromSym(h.symbol,"Types may not be derived from module types");else if(h.members)b||(b=!0);else{c.isClassInstance()?this.checker.errorReporter.simpleErrorFromSym(h.symbol,
"Base type must be interface or class"):this.checker.errorReporter.simpleErrorFromSym(h.symbol,"Interface base type must be interface");break}}this.inNewTargetTypeCheck=!1}};e.prototype.checkMembersImplementInterfaces=function(c){c=c.getInstanceType();if(c.implementsList){var b=c.implementsList.length;this.inNewTargetTypeCheck=!0;for(var d=0;d<b;d++){var e=c.implementsList[d],g=new a.TypeComparisonInfo;this.checker.sourceIsSubtypeOfTarget(c,e,g)||(e="Class '"+c.getTypeName()+"' declares interface '"+
e.getTypeName()+"' but does not implement it",g.message?this.checker.errorReporter.simpleErrorFromSym(c.symbol,e+": "+g.message):this.checker.errorReporter.simpleErrorFromSym(c.symbol,e))}this.inNewTargetTypeCheck=!1}};e.prototype.typeCheckBaseCalls=function(c){if(null!=c)for(var b=c.members.length,d=0;d<b;d++){var e=c.members[d];e.nodeType==a.NodeType.Call&&this.typeCheckNew(e)}};e.prototype.assertUniqueNamesInBaseTypes=function(c,b,d,e){var g=this;if(b&&(b.members&&b.members.publicMembers.map(function(a,
h){var l=c.lookup(h.name);l?e&&g.checker.errorReporter.simpleError(d,"duplicate member name in bases for "+d.name.text+": "+b.symbol.name+" and "+l.container.name+" both contain member with name "+h.name):c.add(h.name,h)},null),b.extendsList))for(var h=b.extendsList.length,l=0;l<h;l++)b.extendsList[l].symbol.flags&a.SymbolFlags.RecursivelyReferenced||this.assertUniqueNamesInBaseTypes(c,b.extendsList[l],d,e)};e.prototype.checkBaseTypeMemberInheritance=function(c,b){var d=this,e=c.getInstanceType();
if(null!=e.extendsList){var g=e.extendsList.length;if(0<g){var h=new a.StringHashTable;if(e.isClassInstance())for(var l=0;l<g;l++)this.assertUniqueNamesInBaseTypes(h,e.extendsList[l],b,0<l);e.members&&e.members.publicMembers.map(function(c,h){for(var l=0;l<g;l++){var k=e.extendsList[l];if(null==k.memberScope)d.checker.errorReporter.simpleError(b,"Base type '"+k.symbol.name+"' lacks an implementation.");else if(k=k.memberScope.find(h.name,!1,!1)){var m=h.getType(),p=k.getType();d.checker.sourceIsSubtypeOfTarget(m,
p)?h.kind()==a.SymbolKind.Type&&k.kind()==a.SymbolKind.Field&&d.checker.errorReporter.simpleErrorFromSym(h,"Cannot override field '"+h.name+"' with method"):d.checker.errorReporter.simpleErrorFromSym(h,"Type of overridden member '"+h.name+"' is not subtype of original member defined by type '"+k.container.name+"'")}}},null)}}};e.prototype.typeCheckClass=function(c){var b=c.type.symbol;if(b.typeCheckStatus==a.TypeCheckStatus.Finished||b.typeCheckStatus==a.TypeCheckStatus.Started)return c;b.typeCheckStatus=
a.TypeCheckStatus.Started;this.checker.addStartedPTO(b);var d=this.scope,e=this.thisClassNode;this.thisClassNode=c;var g=c.type;this.typeCheckBases(g.instanceType);var h=this.thisType;this.thisType=g.instanceType;this.scope=g.instanceType.containedScope;c.constructorDecl&&(this.scope=g.instanceType.constructorScope,this.addConstructorLocalArgs(c.constructorDecl.type.symbol,c.constructorDecl.args,this.scope.valueMembers.allMembers,!0));this.typeCheck(c.members);b.typeCheckStatus=a.TypeCheckStatus.Finished;
this.checkBaseTypeMemberInheritance(g,c);this.checkMembersImplementInterfaces(g);this.typeCheckOverloadSignatures(g,c);this.typeCheckOverloadSignatures(g.instanceType,c);c.constructorDecl||c.baseClass&&(c.baseClass.members.length&&c.baseClass.members[0].type&&c.baseClass.members[0].type.symbol.type.isClass())&&a.cloneParentConstructGroupForChildType(c.type,c.baseClass.members[0].type.symbol.type);this.thisType=h;this.thisClassNode=e;this.scope=d;return c};e.prototype.typeCheckOverloadSignatures=function(a,
b){a.call&&a.call.typeCheck(this.checker,b,null!=a.construct);a.construct&&a.construct.typeCheck(this.checker,b,!1);a.index&&a.index.typeCheck(this.checker,b,!1)};e.prototype.typeCheckInterface=function(a){this.typeCheckBases(a.type);this.typeCheck(a.members);this.checkBaseTypeMemberInheritance(a.type,a);if(a.extendsList)for(var b=0;b<a.extendsList.members.length;b++)a.extendsList.members[b].type.call&&(a.type.call?a.type.call.signatures=a.type.call.signatures.concat(a.extendsList.members[b].type.call.signatures):
a.type.call=a.extendsList.members[b].type.call),a.extendsList.members[b].type.construct&&(a.type.construct?a.type.construct.signatures=a.type.construct.signatures.concat(a.extendsList.members[b].type.construct.signatures):a.type.construct=a.extendsList.members[b].type.construct),a.extendsList.members[b].type.index&&(a.type.index?a.type.index.signatures=a.type.index.signatures.concat(a.extendsList.members[b].type.index.signatures):a.type.index=a.extendsList.members[b].type.index);return a};e.prototype.typeCheckImportDecl=
function(c){var b=c.alias.type,d=null,e=this.inImportTypeCheck;this.inImportTypeCheck=!0;this.typeCheck(c.alias);b=c.alias.type;null==b&&(this.checker.errorReporter.simpleError(c.alias,"Could not resolve module alias '"+c.id.text+"'"),b=this.checker.anyType,c.id.sym.type=b);c.id.type=b;d=b.symbol;b.isModuleType()?(d.type=b,this.checker.currentModDecl&&this.checker.currentModDecl.mod&&this.checker.currentModDecl.mod.importedModules.push(c),c.id.sym.type=b,b.symbol&&b.symbol.declAST&&(b.symbol.declAST.modFlags&=
~a.ModuleFlags.ShouldEmitModuleDecl)):this.checker.errorReporter.simpleError(c.alias,"A module cannot be aliased to a non-module type");this.inImportTypeCheck=e;return c};e.prototype.typeCheckModule=function(c){if(!c.mod)return c;this.currentScript&&(this.currentScript.requiresGlobal=!0);var b=c.mod,d=null,e=this.scope,g=this.thisType,h=this.checker.currentModDecl;this.checker.currentModDecl=c;!this.inImportTypeCheck&&(h&&a.hasFlag(c.modFlags,a.ModuleFlags.IsDynamic)&&!a.hasFlag(c.modFlags,a.ModuleFlags.Ambient))&&
this.checker.errorReporter.simpleError(c,"Dynamic modules may not be nested within other modules");this.thisType=null;this.scope=b.containedScope;this.typeCheck(c.members);d=b.symbol;this.checker.currentModDecl=h;this.thisType=g;this.scope=e;c.type=b;d&&(d.typeCheckStatus=a.TypeCheckStatus.Finished);return c};e.prototype.typeCheckFor=function(a){a.init=this.typeCheck(a.init);this.nestingLevel++;a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.incr=this.typeCheck(a.incr);this.nestingLevel--;
a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"for statement");a.type=this.voidType;return a};e.prototype.typeCheckWith=function(a){this.checker.errorsOnWith&&this.checker.errorReporter.simpleError(a.expr,"All symbols within a 'with' block will be typed as 'any'");a.expr=this.typeCheck(a.expr);this.checker.inWith=!0;a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"with statement");this.checker.inWith=!1;return a};e.prototype.typeCheckForIn=function(b){b.obj=
this.typeCheck(b.obj);b.lval=this.cast(this.typeCheck(b.lval),this.checker.stringType);if(b.lval.nodeType==a.NodeType.VarDecl){var d=b.lval;d.typeExpr&&this.checker.errorReporter.simpleError(d,"Variable declarations for for/in expressions may not contain a type annotation");d.sym&&d.sym.setType(this.checker.stringType)}b.body=this.typeCheck(b.body);this.typeCheckCompoundStmtBlock(b.body,"for in statement");return b};e.prototype.typeCheckWhile=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);
a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"while statement");a.type=this.voidType;return a};e.prototype.typeCheckDoWhile=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.body=this.typeCheck(a.body);this.typeCheckCompoundStmtBlock(a.body,"do while statement");a.type=this.voidType;return a};e.prototype.typeCheckCondExpr=function(b){this.checker.styleSettings.assignmentInCond&&null!==b&&(b.nodeType>=a.NodeType.Asg&&b.nodeType<=a.NodeType.LastAsg)&&
this.checker.errorReporter.simpleError(b,"top-level assignment statement in conditional expression")};e.prototype.typeCheckCompoundStmtBlock=function(b,d){this.checker.styleSettings.blockInCompoundStmt&&b&&b.nodeType!=a.NodeType.Block&&this.checker.errorReporter.styleError(b,d+" requires a block")};e.prototype.typeCheckIf=function(a){a.cond=this.typeCheck(a.cond);this.typeCheckCondExpr(a.cond);a.thenBod=this.typeCheck(a.thenBod);a.elseBod=this.typeCheck(a.elseBod);this.typeCheckCompoundStmtBlock(a.thenBod,
"if statement");this.typeCheckCompoundStmtBlock(a.elseBod,"if statement");a.type=this.voidType;return a};e.prototype.typeFromAccessorFuncDecl=function(b){return!b.isAccessor()?null:a.hasFlag(b.fncFlags,a.FncFlags.GetAccessor)?b.type.call.signatures[0].returnType.type:b.type.call.signatures[0].parameters[0].getType()};e.prototype.typeCheckObjectLit=function(b){var d=new a.Type;d.symbol=new a.TypeSymbol(this.checker.anon,b.minChar,this.checker.locationInfo.unitIndex,d);d.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,
new a.StringHashTable));d.memberScope=new a.SymbolTableScope(d.members,null,null,null,null);var e=new a.SymbolAggregateScope(d.symbol);e.addParentScope(d.memberScope);e.addParentScope(this.scope);d.containedScope=e;var e=b.operand,g=this.thisType,h=!1,l=null;this.checker.hasTargetType()&&((l=this.checker.getTargetTypeContext().contextualType)&&l.symbol&&!this.checker.typeStatusIsFinished(l.symbol.typeCheckStatus)&&l.symbol.declAST&&this.typeCheck(l.symbol.declAST),h=!0);if(e)for(var k=0,u=e.members.length;k<
u;k++){var n=e.members[k],q=n.operand1,r,s=null,t=null;if(q.nodeType==a.NodeType.Name)r=q.text;else if(q.nodeType==a.NodeType.QString)r=q.text,r=r.substring(1,r.length-1);else{this.checker.errorReporter.simpleError(b,"malformed object literal");d=this.anyType;break}h&&l.memberScope&&(s=l.memberScope.find(r,!1,!1));if(n.operand2.nodeType==a.NodeType.FuncDecl&&n.operand2.isAccessor()){var t=n.operand2,w=d.members.publicMembers.lookup(r),w=this.checker.createAccessorSymbol(t,w,d,!0,!1,d.memberScope,
null),t=t.accessorSymbol=w;q.nodeType==a.NodeType.Name&&(q.sym=w)}this.checker.typeCheckWithContextualType(h&&s?s.getType():null,!1,h,n.operand2);if(h&&s){if(n.operand2.type==this.anyType||this.checker.sourceIsAssignableToTarget(n.operand2.type,s.getType())||n.operand2.nodeType==a.NodeType.FuncDecl&&n.operand2.isAccessor()&&this.typeFromAccessorFuncDecl(n.operand2)==s.getType())n.operand1.type=s.getType()}else n.operand2.type=n.operand2.type==this.checker.undefinedType?this.anyType:n.operand2.type;
null==t&&(n=n.operand2.type,s=new a.ValueLocation,t=new a.FieldSymbol(r,q.minChar,this.checker.locationInfo.unitIndex,!0,s),t.flags|=a.SymbolFlags.Property,s.symbol=t,t.typeCheckStatus=this.checker.getTypeCheckFinishedStatus(),s.typeLink=new a.TypeLink,s.typeLink.type=n,d.members.publicMembers.add(r,t));t.isObjectLitField=!0}this.thisType=g;b.type=d;l&&(b.targetType=l)};e.prototype.typeCheckArrayLit=function(b){var d=b.operand,e=this.anyType,g=null,h=new a.TypeComparisonInfo;h.onlyCaptureFirstError=
!0;if(this.checker.hasTargetType()){var l=this.checker.getTargetTypeContext().contextualType;l.elementType&&(g=l.elementType)}if(d&&(l=this.inArrayElementTypeCheck,this.inArrayElementTypeCheck=!0,this.checker.typeCheckWithContextualType(g,this.checker.inProvisionalTypecheckMode(),null!=g,d),this.inArrayElementTypeCheck=l,e=d.members[0].type,e=this.checker.findBestCommonType(e,g,{getLength:function(){return d.members.length},setTypeAtIndex:function(a,b){d.members[a].type=b},getTypeAtIndex:function(a){return d.members[a].type}},
h),e==this.checker.undefinedType||!l&&e==this.nullType))e=this.anyType;e?g&&this.checker.sourceIsAssignableToTarget(e,g)&&(e=g):(h.message?this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression: "+h.message):this.checker.errorReporter.simpleError(b,"Incompatible types in array literal expression"),e=this.anyType);b.type=this.checker.makeArrayType(e)};e.prototype.checkForVoidConstructor=function(a,b){if(a&&a.construct&&0<a.construct.signatures.length)for(var d=0;d<
a.construct.signatures.length;d++)if(a.construct.signatures[d].returnType.type==this.checker.voidType){this.checker.errorReporter.simpleError(b,"Constructors may not have a return type of 'void'");break}};e.prototype.typeCheckReturn=function(b){if(this.thisFnc){var d=null;if(this.checker.hasTargetType()){var e=this.checker.getTargetTypeContext().targetAccessorType;if(e)d=e;else if((e=this.checker.getTargetTypeContext().targetSig)&&e.returnType.type!=this.voidType)d=e.returnType.type}b.returnExpression?
(this.thisFnc.fncFlags|=a.FncFlags.HasReturnExpression,null==d&&(this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type&&this.thisFnc.returnTypeAnnotation.type!=this.voidType)&&(d=this.thisFnc.returnTypeAnnotation.type),this.checker.typeCheckWithContextualType(d,this.checker.inProvisionalTypecheckMode(),null!=d,b.returnExpression),(e=this.thisFnc.returnTypeAnnotation&&this.thisFnc.returnTypeAnnotation.type?this.thisFnc.returnTypeAnnotation.type:d)?e==this.voidType&&b.returnExpression.type!=
this.voidType?(this.checker.errorReporter.simpleError(b,"Return with value expression in void function"),b.type=b.returnExpression.type):(b.returnExpression=this.cast(b.returnExpression,e),b.type=e):(d&&(b.returnExpression.type!=this.voidType?b.returnExpression=this.cast(b.returnExpression,d):b.returnExpression.type=d),b.type=b.returnExpression.type),this.thisFnc.returnStatementsWithExpressions[this.thisFnc.returnStatementsWithExpressions.length]=b):b.type=null==d?this.checker.voidType:d}return b};
e.prototype.typeCheckInstOf=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);(!(a.operand1.type==this.checker.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand1.type,this.objectInterfaceType))||!(a.operand2.type==this.anyType||this.checker.sourceIsSubtypeOfTarget(a.operand2.type,this.functionInterfaceType)))&&this.checker.errorReporter.simpleError(a,"The instanceof operator requires the left operand to be of type Any or an object type, and the right operand to be of type Any or a subtype of the Function interface type");
a.type=this.booleanType;return a};e.prototype.typeCheckCommaOperator=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};e.prototype.typeCheckLogOr=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);var b=a.operand1.type,d=a.operand2.type;a.type=b==this.checker.anyType||d==this.checker.anyType?this.checker.anyType:b==this.checker.booleanType?d==this.checker.booleanType?this.checker.booleanType:
this.checker.anyType:b==this.checker.numberType?d==this.checker.numberType?this.checker.numberType:this.checker.anyType:b==this.checker.stringType?d==this.checker.stringType?this.checker.stringType:this.checker.anyType:this.checker.sourceIsSubtypeOfTarget(b,d)?d:this.checker.sourceIsSubtypeOfTarget(d,b)?b:this.checker.anyType;return a};e.prototype.typeCheckLogAnd=function(a){a.operand1=this.typeCheck(a.operand1);a.operand2=this.typeCheck(a.operand2);a.type=a.operand2.type;return a};e.prototype.tryAddCandidates=
function(a,b,d,e,g){var h=a.nonOptionalParameterCount,l=a.parameters.length,k=h,n=!1;if(b.length>=h&&(a.hasVariableArgList||b.length<=l))k=a.hasVariableArgList?a.parameters.length:b.length,n=!0;h=null;if(n||a.hasVariableArgList){a.hasVariableArgList&&(k-=1,h=a.parameters[k].parameter.typeLink.type,h=h.elementType,n=b.length>=k);for(var l=b.length,q=n,r=0;r<l;r++){var s;s=r<k?a.parameters[r].parameter.typeLink.type:h;var t=b[r];if(!s||!t||!this.checker.typesAreIdentical(s,t))q=!1;this.checker.sourceIsAssignableToTarget(t,
s,g)||(n=!1);if(!q&&!n)break}q?d[d.length]=a:n&&0==d.length&&(e[e.length]=a)}};e.prototype.resolveOverload=function(b,d){var e=this.resolutionDataCache.getResolutionData(),g=e.actuals,h=e.exactCandidates,l=e.conversionCandidates,k=null,u=1<d.signatures.length,n=new a.TypeComparisonInfo,q=null,r=null;if(b.nodeType==a.NodeType.Call||b.nodeType==a.NodeType.New){if(q=b.args,r=b.target,b.args)for(var s=b.args.members.length,t=0;t<s;t++)g[t]=b.args.members[t].type}else b.nodeType==a.NodeType.Index&&(r=
b.operand1,q=new a.ASTList,q.members[0]=b.operand2,g[0]=b.operand2.type);t=0;for(s=d.signatures.length;t<s;t++){var w=d.signatures[t];if(!u||w!=d.definitionSignature||this.checker.canCallDefinitionSignature)!w.returnType.type&&(w.declAST&&w.typeCheckStatus!=a.TypeCheckStatus.Finished)&&this.typeCheckFunction(w.declAST),this.tryAddCandidates(w,g,h,l,n)}if(0==h.length)h=this.checker.getApplicableSignatures(l,q,n),0<h.length?(q=this.checker.findMostApplicableSignature(h,q),q.ambiguous&&this.checker.errorReporter.simpleError(r,
"Ambiguous call expression - could not choose overload"),k=q.sig):n.message?this.checker.errorReporter.simpleError(r,"Supplied parameters do not match any signature of call target:\n\t"+n.message):this.checker.errorReporter.simpleError(r,"Supplied parameters do not match any signature of call target");else if(1<h.length){k=[];for(t=0;t<h.length;t++)k[t]={signature:h[t],hadProvisionalErrors:!1};q=this.checker.findMostApplicableSignature(k,q);q.ambiguous&&this.checker.errorReporter.simpleError(r,"Ambiguous call expression - could not choose overload");
k=q.sig}else k=h[0];this.resolutionDataCache.returnResolutionData(e);return k};e.prototype.typeCheckNew=function(a){a.target=this.typeCheck(a.target);var b=a.target;b.type.construct||b.type.call?this.preTypeCheckCallArgs(a.args):a.args=this.typeCheck(a.args);b.type==this.anyType?(a.type=this.anyType,a.args=this.typeCheck(a.args)):b.type.construct?(b=this.resolveOverload(a,b.type.construct),null==b?a.type=this.anyType:(a.type=b.returnType.type==this.voidType?this.anyType:b.returnType.type,a.signature=
b)):b.type.call?(b=this.resolveOverload(a,b.type.call),null==b?a.type=this.anyType:b.returnType.type==this.voidType||b.returnType.type==this.anyType?(a.type=this.anyType,a.signature=b):this.checker.errorReporter.simpleError(a.target,"new expression only valid on constructors")):b.type.elementType?a.type=b.type:(this.checker.errorReporter.invalidCall(a,a.nodeType,this.scope),a.type=this.anyType);this.postTypeCheckCallArgs(a);return a};e.prototype.preTypeCheckCallArgs=function(b){if(b)for(var d=0;d<
b.members.length;d++)switch(b.members[d].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:continue;default:this.typeCheck(b.members[d])}};e.prototype.postTypeCheckCallArgs=function(b){var d=!1,e=0;if(b.target&&b.target.type&&b.signature&&b.args){var g=b.signature;if(g&&b.args.members.length>=g.nonOptionalParameterCount)for(var d=!0,h=null,l=b.args.members.length<g.parameters.length?b.args.members.length:g.parameters.length,e=0;e<l;e++){if((h=g.parameters[e].getType())&&
g.hasVariableArgList&&e>=g.nonOptionalParameterCount-1)h=h.elementType;switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.checker.typeCheckWithContextualType(h,this.checker.inProvisionalTypecheckMode(),!g.parameters[e].declAST.isParenthesized,b.args.members[e])}}}if(!d&&b.args){this.checker.killTargetType();for(e=0;e<b.args.members.length;e++)switch(b.args.members[e].nodeType){case a.NodeType.FuncDecl:case a.NodeType.ObjectLit:case a.NodeType.ArrayLit:this.typeCheck(b.args.members[e])}}};
e.prototype.typeCheckCall=function(b){this.checker.styleSettings.newMustBeUsed&&b.nodeType==a.NodeType.New?a.hasFlag(b.flags,a.ASTFlags.IsStatement)&&this.checker.errorReporter.styleError(b,"use of new expression as a statement"):!this.checker.styleSettings.evalOK&&b.nodeType==a.NodeType.Call&&b.target.nodeType==a.NodeType.Name&&"eval"==b.target.text&&this.checker.errorReporter.styleError(b,"eval not permitted");b.target.nodeType==a.NodeType.FuncDecl&&(b.target.isInlineCallLiteral=!0);var d=this.inSuperCall;
b.target.nodeType==a.NodeType.Super&&(this.inSuperCall=!0);b.target=this.typeCheck(b.target);this.preTypeCheckCallArgs(b.args);var e=b.target;null==e.type||e.type==this.anyType||this.functionInterfaceType&&e.type==this.functionInterfaceType?b.type=this.anyType:(e=e.type,e.call?(e=this.resolveOverload(b,e.call),null==e?b.type=this.anyType:(b.type=e.returnType.type,b.signature=e)):b.target.nodeType==a.NodeType.Super&&this.thisFnc&&this.thisFnc.isConstructor&&a.hasFlag(this.thisFnc.fncFlags,a.FncFlags.ClassMethod)?
(e=e.symbol.type.construct?this.resolveOverload(b,e.symbol.type.construct):null,null==e?b.type=this.anyType:(b.flags|=a.ASTFlags.ClassBaseConstructorCall,b.type=e.returnType.type,b.signature=e)):(b.type=this.anyType,this.checker.errorReporter.invalidCall(b,b.nodeType,this.scope)));this.postTypeCheckCallArgs(b);this.inSuperCall=d;return b};e.prototype.assignScopes=function(b){this.checker.locationInfo=b.locationInfo;var e=new d(null,null,this.globalScope),e=new a.AssignScopeContext(e,this,[this.checker.currentModDecl]);
a.getAstWalkerFactory().walk(b,a.preAssignScopes,a.postAssignScopes,null,e)};e.prototype.findMemberScope=function(b,d){var e=b.getScope(),g=b.pos-b.getScriptFragmentPosition(),h=b.getScriptFragment(),g=new a.MemberScopeContext(this,g,d);g.scope=e;if(h.nodeType==a.NodeType.Name)return h.type.getMemberScope(this);a.getAstWalkerFactory().walk(h,a.preFindMemberScope,null,null,g);g.ast&&(b.enclosingClassDecl&&g.ast.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=!1);return g.type?g.type.getMemberScope(this):
null};e.prototype.findMemberScopeAt=function(b){return this.findMemberScope(b,a.ASTFlags.DotLHS)};e.prototype.findMemberScopeAtFullAst=function(b){var d=a.ASTFlags.DotLHS,e=b.pos,g=null,h=function(b,c,h){a.isValidAstNode(b)&&(a.hasFlag(b.flags,d)&&(b.minChar<e&&e<=b.limChar)&&(g=b),h.options.goChildren=b.minChar<=e&&e<=b.limChar);return b};a.getAstWalkerFactory().walk(b.script,function(b,c,h){if(a.isValidAstNode(b)){if(a.hasFlag(b.flags,d)&&(e==b.limChar||e-1==b.limChar))g=b,h.options.stopWalk();
h.options.goChildren=b.minChar<=e&&e<=b.limChar}return b});null==g&&a.getAstWalkerFactory().walk(b.script,h);g&&(b.enclosingClassDecl&&g.type==b.enclosingClassDecl.type.instanceType)&&(b.publicsOnly=!1);return g&&g.type?g.type.getMemberScope(this):null};a.TypeFlow=e})(TypeScript||(TypeScript={}));
(function(a){var d=a.Primitive||(a.Primitive={});d._map=[];d.None=0;d.Void=1;d.Double=2;d.String=4;d.Boolean=8;d.Any=16;d.Null=32;d.Undefined=64;var h=a.Primitive,b=function(){this.suffix=this.prefix=""};b.prototype.isString=function(){return!1};b.prototype.isArray=function(){return!1};b.prototype.toString=function(){return b.memberNameToString(this)};b.memberNameToString=function(a){var c=a.prefix;if(a.isString())c+=a.text;else for(var d=0;d<a.entries.length;d++)c+=b.memberNameToString(a.entries[d]),
c+=a.delim;return c+=a.suffix};b.create=function(a,b,c){if("string"==typeof a)return new k(a);var d=new g;b&&(d.prefix=b);c&&(d.suffix=c);d.entries.push(a);return d};a.MemberName=b;var k,d=function(a){b.call(this);this.text=a};__extends(d,b);d.prototype.isString=function(){return!0};k=d;a.MemberNameString=k;var g,d=function(){b.apply(this,arguments);this.delim="";this.entries=[]};__extends(d,b);d.prototype.isArray=function(){return!0};d.prototype.add=function(a){this.entries.push(a)};d.prototype.addAll=
function(a){for(var b=0;b<a.length;b++)this.entries.push(a[b])};g=d;a.MemberNameArray=g;var e=-1,l=function(){this.typeID=e++;this.index=this.call=this.construct=null;this.passTypeCreated=a.CompilerDiagnostics.analysisPass;this.primitiveTypeClass=h.None;this.typeFlags=a.TypeFlags.None};l.prototype.baseClass=function(){return this.extendsList&&0<this.extendsList.length?this.extendsList[0]:null};l.prototype.getArrayBase=function(a,b){return this.arrayCache.specialize(a,b)};l.prototype.isClass=function(){return null!=
this.instanceType};l.prototype.isArray=function(){return null!=this.elementType};l.prototype.isClassInstance=function(){return this.symbol&&!this.elementType&&this.symbol.type.isClass()};l.prototype.getInstanceType=function(){return this.isClass()?this.instanceType:this};l.prototype.hasImplementation=function(){return a.hasFlag(this.typeFlags,a.TypeFlags.HasImplementation)};l.prototype.setHasImplementation=function(){this.typeFlags|=a.TypeFlags.HasImplementation};l.prototype.isDouble=function(){return a.hasFlag(this.primitiveTypeClass,
h.Double)};l.prototype.isString=function(){return a.hasFlag(this.primitiveTypeClass,h.String)};l.prototype.isBoolean=function(){return a.hasFlag(this.primitiveTypeClass,h.Boolean)};l.prototype.isNull=function(){return a.hasFlag(this.primitiveTypeClass,h.Null)};l.prototype.getTypeName=function(){return this.getMemberTypeName("",!0,!1,null)};l.prototype.getScopedTypeName=function(a){return this.getMemberTypeName("",!0,!1,a)};l.prototype.getScopedTypeNameEx=function(a){return this.getMemberTypeNameEx("",
!0,!1,a)};l.prototype.callCount=function(){var a=0;this.call&&(a+=this.call.signatures.length);this.construct&&(a+=this.construct.signatures.length);this.index&&(a+=this.index.signatures.length);return a};l.prototype.getMemberTypeName=function(a,b,c,d){return this.getMemberTypeNameEx(a,b,c,d).toString()};l.prototype.getMemberTypeNameEx=function(c,d,e,h){if(this.elementType)return b.create(this.elementType.getMemberTypeNameEx(c,!1,!0,h),"","[]");if(this.symbol&&this.symbol.name&&"_anonymous"!=this.symbol.name&&
(null==this.call&&null==this.construct&&null==this.index||a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName)||this.members&&!this.isClass()))return d=this.symbol.scopeRelativeName(h),b.create("null"==d?"any":d);if(this.members||this.call||this.construct){if(a.hasFlag(this.typeFlags,a.TypeFlags.BuildingName))return b.create("this");this.typeFlags|=a.TypeFlags.BuildingName;var l=new g,k=e,u=e=0;this.members&&this.members.allMembers.map(function(c,d){if(!a.hasFlag(d.flags,a.SymbolFlags.BuiltIn)){var e=
d.getTypeName(h);2<=e.length&&"; "==e.substring(e.length-2)&&(e=e.substring(0,e.length-2));l.add(b.create(e));u++;d.kind()==a.SymbolKind.Type?1<d.type.callCount()&&(k=!0):k=!0}},null);var n,q=0,r=0==u&&1==this.callCount()&&d;r||(l.delim="; ");if(this.call){c=this.call.toStrings(c,r,h);n=0;for(q=c.length;n<q;n++)l.add(b.create(c[n])),e++}if(this.construct){c=this.construct.toStrings("new",r,h);n=0;for(q=c.length;n<q;n++)l.add(b.create(c[n])),e++}if(this.index){c=this.index.toStrings("",r,h);n=0;for(q=
c.length;n<q;n++)l.add(b.create(c[n])),e++}if(k||1<e&&d)l.prefix="{ ",l.suffix="}";this.typeFlags&=~a.TypeFlags.BuildingName;return 0==e&&0==u?b.create("{}"):l}return b.create("{}")};l.prototype.checkDecl=function(a){(this.isClassInstance()||this.isClass())&&this.symbol.declAST&&a.typeFlow.inScopeTypeCheckDecl(this.symbol.declAST)};l.prototype.getMemberScope=function(a){return this==a.anyType?null:this.isDouble()?a.numberInterfaceType?a.numberInterfaceType.memberScope:null:this.isBoolean()?a.booleanInterfaceType?
a.booleanInterfaceType.memberScope:null:this==a.stringType?a.stringInterfaceType?a.stringInterfaceType.memberScope:null:this.elementType?a.arrayInterfaceType?this.elementType.getArrayBase(a.arrayInterfaceType,a.checker).memberScope:null:this.memberScope};l.prototype.isReferenceType=function(){return this.members||this.extendsList||this.construct||this.call||this.index||this.elementType};l.prototype.specializeType=function(b,c,d,e){if(b==this)return c;var g=this;e?this.isReferenceType()&&(g=new l,
this.members&&(g.members=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),this.members.publicMembers.map(function(a,e){var h=e.specializeType(b,c,d);g.members.addPublicMember(h.name,h)},null),this.members.privateMembers.map(function(a,e){var h=e.specializeType(b,c,d);g.members.addPrivateMember(h.name,h)},null)),this.ambientMembers&&(g.ambientMembers=new a.ScopedMembers(new a.DualStringHashTable(new a.StringHashTable,new a.StringHashTable)),this.ambientMembers.publicMembers.map(function(a,
e){var h=e.specializeType(b,c,d);g.ambientMembers.addPublicMember(h.name,h)},null),this.ambientMembers.privateMembers.map(function(a,e){var h=e.specializeType(b,c,d);g.ambientMembers.addPrivateMember(h.name,h)},null)),g.containedScope=d.scopeOf(g),g.memberScope=g.containedScope):this.elementType?this.elementType==b?g=d.makeArrayType(c):this.elementType.elementType==b&&(g=d.makeArrayType(d.makeArrayType(c))):this.call&&(g=new l,g.call=this.call.specializeType(b,c,d));return g};l.prototype.hasBase=
function(a){if(a==this)return!0;if(this.extendsList)for(var b=0,c=this.extendsList.length;b<c;b++)if(this.extendsList[b].hasBase(a))return!0;return!1};l.prototype.mergeOrdered=function(a,b,c){if(this==b.anyType||a==b.anyType)return b.anyType;if(this==a||a==b.nullType&&this!=b.nullType)return this;if(this==b.nullType&&a!=b.nullType)return a;if(a==b.voidType&&this!=b.voidType)return this;if(this==b.voidType&&a!=b.voidType)return a;if(a==b.undefinedType&&this!=b.undefinedType)return this;if(this==b.undefinedType&&
a!=b.undefinedType)return a;if(this.elementType&&a.elementType){if(this.elementType==a.elementType)return this;a=this.elementType.mergeOrdered(a.elementType,b,c);return null==a?b.makeArrayType(b.anyType):b.makeArrayType(a)}return b.sourceIsSubtypeOfTarget(this,a,c)?a:b.sourceIsSubtypeOfTarget(a,this,c)?this:null};l.prototype.isModuleType=function(){return!1};l.prototype.hasMembers=function(){return null!=this.members};l.prototype.getAllEnclosedTypes=function(){return null};l.prototype.getAllAmbientEnclosedTypes=
function(){return null};l.prototype.getPublicEnclosedTypes=function(){return null};l.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.Type=l;d=function(a,b){l.call(this);this.enclosedTypes=a;this.ambientEnclosedTypes=b;this.importedModules=[]};__extends(d,l);d.prototype.isModuleType=function(){return!0};d.prototype.hasMembers=function(){return null!=this.members||null!=this.enclosedTypes};d.prototype.getAllEnclosedTypes=function(){return this.enclosedTypes};d.prototype.getAllAmbientEnclosedTypes=
function(){return this.ambientEnclosedTypes};d.prototype.getPublicEnclosedTypes=function(){return null};d.prototype.getpublicAmbientEnclosedTypes=function(){return null};a.ModuleType=d;var c;c=function(){this.ast=this.type=null};a.TypeLink=c;a.getTypeLink=function(a,b,d){var e=new c;e.ast=a;e.type=null==a&&d?b.anyType:null;return e}})(TypeScript||(TypeScript={}));
(function(a){function d(a){return a.replace('"',"").replace("'","").replace("'","").replace('"',"")}function h(a){return'"'+a+'"'}function b(a){return a.replace(/\\/g,"/")}function k(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)?a.substring(0,a.length-6):4<a.length&&".str"==a.substring(a.length-4,a.length)?a.substring(0,a.length-4):5<a.length&&".d.ts"==a.substring(a.length-5,a.length)?a.substring(0,a.length-5):3<a.length&&".ts"==a.substring(a.length-3,a.length)||3<a.length&&".js"==
a.substring(a.length-3,a.length)?a.substring(0,a.length-3):a}function g(a){return""==a?a:-1!=a.indexOf("/")?e(a):""}function e(a){a=b(a);a=a.split("/");return a.slice(0,a.length-1).join("/")+"/"}function l(a){for(var a=b(a),d="/"===a.charAt(0),a=a.split("/"),e=0;e<a.length;e++){if("."===a[e]||""===a[e])a.splice(e,1),e--;0<e&&(".."===a[e]&&".."!==a[e-1])&&(a.splice(e-1,2),e-=2)}return(d?"/":"")+a.join("/")}a.stripQuotes=d;a.isQuoted=function(a){return-1!=a.indexOf('"')||-1!=a.indexOf("'")||-1!=a.indexOf("'")||
-1!=a.indexOf('"')};a.quoteStr=h;a.swapQuotes=function(a){-1!=a.indexOf('"')?(a=a.replace('"',"'"),a=a.replace('"',"'")):(a=a.replace("'",'"'),a=a.replace("'",'"'));return a};a.switchToForwardSlashes=b;a.trimModName=k;a.isSTRFile=function(a){return 4<a.length&&".str"==a.substring(a.length-4,a.length)};a.isTSFile=function(a){return 3<a.length&&".ts"==a.substring(a.length-3,a.length)};a.isDSTRFile=function(a){return 6<a.length&&".d.str"==a.substring(a.length-6,a.length)};a.isDTSFile=function(a){return 5<
a.length&&".d.ts"==a.substring(a.length-5,a.length)};a.getPrettyName=function(a,e,f){"undefined"===typeof e&&(e=!0);"undefined"===typeof f&&(f=!1);f=(f?b(a):k(d(a))).split("/");return f.length?e?h(f[f.length-1]):f[f.length-1]:a};a.quoteBaseName=function(a){var b=k(d(a)),e=g(b);if(""==e)return a;a=b.split(e);return h(a[1<a.length?1:0])};a.changePathToSTR=function(a){return k(d(a))+".str"};a.changePathToDSTR=function(a){return k(d(a))+".d.str"};a.changePathToTS=function(a){return k(d(a))+".ts"};a.changePathToDTS=
function(a){return k(d(a))+".d.ts"};a.isRelative=function(a){return"."==a.charAt(0)};a.isRooted=function(a){return"\\"==a.charAt(0)||"/"==a.charAt(0)||-1!=a.indexOf(":\\")||-1!=a.indexOf(":/")};a.getRootFilePath=g;a.filePath=e;a.normalizeURL=function(a){var b=/^(https?:\/\/[\-\w\.]+(:\d+)?\/)(.*)$/i.exec(a);return b?b[1]+l(b[3]):l(a)};a.pathNormalizeRegExp=/\//g;a.normalizePath=l;a.normalizeImportPath=function(a){return l(a)}})(TypeScript||(TypeScript={}));
(function(a){var d=function(a,d){this.path=a;this.content=d};d.prototype.getText=function(a,d){return this.content.substring(a,d)};d.prototype.getLength=function(){return this.content.length};a.SourceUnit=d;a.CompilationEnvironment=function(a,d){this.compilationSettings=a;this.ioHost=d;this.residentCode=[];this.code=[]};var h=function(a){this.environment=a;this.visited={}};h.prototype.resolveCode=function(b,h,g,e){var l={content:"",path:b},c=this.environment.ioHost,i=a.isRelative(b),f=i?!1:a.isRooted(b),
j=i?c.resolvePath(h+"/"+b):f||!h||g?b:h+"/"+b;!a.isSTRFile(j)&&!a.isTSFile(j)&&(j+=".ts");var j=a.switchToForwardSlashes(a.stripQuotes(j)),v=this.environment.compilationSettings.useCaseSensitiveFileResolution?j:j.toLocaleUpperCase();if(!this.visited[v]){if(i||f||!g)try{a.CompilerDiagnostics.debugPrint("   Reading code from "+j);try{l.content=c.readFile(j)}catch(m){try{a.isSTRFile(j)?j=a.changePathToTS(j):a.isTSFile(j)&&(j=a.changePathToSTR(j)),a.CompilerDiagnostics.debugPrint("   Reading code from "+
j),l.content=c.readFile(j)}catch(p){j=a.changePathToDSTR(j);a.CompilerDiagnostics.debugPrint("   Reading code from "+j);try{l.content=c.readFile(j)}catch(u){j=a.changePathToDTS(j),a.CompilerDiagnostics.debugPrint("   Reading code from "+j),l.content=c.readFile(j)}}}a.CompilerDiagnostics.debugPrint("   Found code at "+j);l.path=j;this.visited[v]=!0}catch(n){a.CompilerDiagnostics.debugPrint("   Did not find code for "+b)}else l=c.findFile(h,j),l||(a.isSTRFile(j)?j=a.changePathToTS(j):a.isTSFile(j)&&
(j=a.changePathToSTR(j)),l=c.findFile(h,j)),l||(j=a.changePathToDTS(j),l=c.findFile(h,j),l||(j=a.changePathToDSTR(j),l=c.findFile(h,j))),l?(l.path=a.switchToForwardSlashes(a.stripQuotes(l.path)),a.CompilerDiagnostics.debugPrint(b+" resolved to: "+l.path),l.content=l.content,this.visited[v]=!0):a.CompilerDiagnostics.debugPrint("Could not find "+b);if(l&&l.content){h=c.dirName(l.path);l=new d(l.path,l.content);g=a.preProcessFile(l,this.environment.compilationSettings);for(i=0;i<g.referencedFiles.length;i++)f=
g.referencedFiles[i],j=a.isRooted(f.path)?f.path:h+"/"+f.path,j=c.resolvePath(j),b==j?e.postResolutionError(j,"File contains reference to itself",null):this.resolveCode(f.path,h,!1,e);for(i=0;i<g.importedFiles.length;i++)this.resolveCode(g.importedFiles[i].path,h,!0,e);e.postResolution(l.path,l)}}};a.CodeResolver=h})(TypeScript||(TypeScript={}));
(function(a){function d(a,b){var d=/^(\/\/\/\s*<style\s+)(([a-zA-Z])+=('|").+('|"))\s*\/>/igm.exec(a);if(d&&(d=/^([a-zA-Z]+=['"]on['|"])/igm.exec(d[2])))for(var h=0;h<d.length;h++){var c=d[h].split("=");switch(c[0]){case "blockInCompoundStmt":b.blockInCompoundStmt='"on"'==c[1];break;case "eqeqeq":b.eqeqeq='"on"'==c[1];break;case "forin":b.forin='"on"'==c[1];break;case "emptyBlocks":b.emptyBlocks='"on"'==c[1];break;case "newMustBeUsed":b.newMustBeUsed='"on"'==c[1];break;case "requireSemi":b.requireSemi=
'"on"'==c[1];break;case "assignmentInCond":b.assignmentInCond='"on"'==c[1];break;case "eqnull":b.eqnull='"on"'==c[1];break;case "evalOK":b.evalOK='"on"'==c[1];break;case "innerScopeDeclEscape":b.innerScopeDeclEscape='"on"'==c[1];break;case "funcInLoop":b.funcInLoop='"on"'==c[1];break;case "reDeclareLocal":b.reDeclareLocal='"on"'==c[1];break;case "literalSubscript":b.literalSubscript='"on"'==c[1];break;case "implicitAny":b.implicitAny='"on"'==c[1]}}}var h=function(){this.forin=this.eqeqeq=this.blockInCompoundStmt=
this.bitwise=!1;this.emptyBlocks=!0;this.eqnull=this.assignmentInCond=this.requireSemi=this.newMustBeUsed=!1;this.literalSubscript=this.reDeclareLocal=this.funcInLoop=this.innerScopeDeclEscape=this.evalOK=!0;this.implicitAny=!1};h.prototype.setOption=function(a,b){return void 0!==this[a]?(this[a]=b,!0):!1};h.prototype.parseOptions=function(a){for(var a=a.split(";"),b=0,d=a.length;b<d;b++){var h=a[b],c=!0,i=h.lastIndexOf(":");if(0<=i){var f=h.substring(i+1),h=h.substring(0,i);"off"==f&&(c=!1)}if(!this.setOption(h,
c))return!1}return!0};a.StyleSettings=h;var b=function(){this.styleSettings=new h;this.parseOnly=this.minWhitespace=this.propagateConstants=!1;this.outputMany=!0;this.exec=this.watch=this.emitComments=this.errorRecovery=!1;this.resolve=!0;this.controlFlowUseDef=this.printControlFlow=this.controlFlow=!1;this.preprocess=this.errorOnWith=!0;this.inferPropertiesFromThisAssignment=this.canCallDefinitionSignature=!1;this.useDefaultLib=!0;this.codeGenTarget=a.CodeGenTarget.ES3;this.moduleGenTarget=a.ModuleGenTarget.Synchronous;
this.errorFileName=this.outputFileName="";this.useCaseSensitiveFileResolution=this.generateDeclarationFiles=this.mapSourceFiles=!1};b.prototype.setStyleOptions=function(a){this.styleSettings.parseOptions(a)};b.prototype.outputOne=function(a){this.outputFileName=a;this.outputMany=!1};a.CompilationSettings=b;a.getAdditionalDependencyPath=function(a){return(a=/^(\/\/\/\s*<amd-dependency\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(a))?a[3]:null};a.getStyleSettings=d;a.preProcessFile=
function(h,g){"undefined"===typeof g&&(g=new b);var e=new a.Scanner;e.resetComments();e.setSourceText(h,a.LexMode.File);for(var l=e.scan(),c=[],i=null,c=[],f=g,j=[],v=[],m=!1;l.tokenId!=a.TokenID.EOF;){if(l.tokenId==a.TokenID.IMPORT&&(l=e.scan(),l.tokenId==a.TokenID.ID||a.convertTokToID(l,!1)))l=e.scan(),l.tokenId==a.TokenID.Asg&&(l=e.scan(),l.tokenId==a.TokenID.MODULE&&(l=e.scan(),l.tokenId==a.TokenID.LParen&&(l=e.scan(),l.tokenId==a.TokenID.QString&&(i={minChar:e.startPos,limChar:e.pos,path:a.stripQuotes(a.switchToForwardSlashes(l.getText())),
isResident:!1},v.push(i)))));l.tokenId==a.TokenID.LCurly&&c.push(l);l.tokenId==a.TokenID.RCurly&&c.pop();l=e.scan()}c=e.getComments();for(e=0;e<c.length;e++)if(i=c[e],!i.isBlock){var l=i.getText(),p=/^(\/\/\/\s*<reference\s+path=)('|")(.+?)\2\s*(static=('|")(.+?)\2\s*)*\/>/igm.exec(l);if(p){var l=a.normalizePath(p[3]),u=a.normalizePath(l);(p=7<=p.length&&"true"==p[6])&&a.CompilerDiagnostics.debugPrint(l+" is resident");l={minChar:0,limChar:0,path:a.switchToForwardSlashes(u),isResident:p}}else l=null;
l&&(l.minChar=i.startPos,l.limChar=l.minChar+i.value.length,j.push(l));d(i.getText(),f.styleSettings);(i=/^(\/\/\/\s*<reference\s+no-default-lib=)('|")(.+?)\2\s*\/>/igm.exec(i.getText()))&&(m="true"==i[3])}return{settings:f,referencedFiles:j,importedFiles:v,isLibFile:m}}})(TypeScript||(TypeScript={}));
(function(a){var d=function(d){this.logger=d;this.astLogger=new a.AstLogger(this.logger)};d.prototype.getEnclosingScopeContextIfSingleScopeEdit=function(d,b,k,g){this.logger.log('checkEditsInsideSingleScope("'+b+'")');if(null===g)throw Error("editRange should be valid");if(g.isUnknown())return this.logger.log("  Bailing out because edit range is unknown"),null;b=a.findEnclosingScopeAt(this.logger,d,k,g.minChar,!1);d=a.findEnclosingScopeAt(this.logger,d,k,g.limChar,!1);return null==b||null==d?(this.logger.log("  Bailing out because containing scopes cannot be determined"),
null):b.scopeStartAST!==d.scopeStartAST?(this.logger.log("  Bailing out because edit overlaps 2 disctint scopes"),null):0>=b.scopeStartAST.limChar-b.scopeStartAST.minChar+g.delta?(this.logger.log("  Bailing out because scope has been entirely removed from new source text"),null):b};d.prototype.attemptIncrementalUpdateUnit=function(d,b,k,g){this.logger.log('attemptIncrementalUpdateUnit("'+b+'")');if(null===g)throw Error("editRange should be valid");var e=this.getEnclosingScopeContextIfSingleScopeEdit(d,
b,k,g);if(null===e)return null;b=e.scopeStartAST.limChar-e.scopeStartAST.minChar+g.delta;if(b>=k.getLength()/2)return this.logger.log("  Bailing out because range of scope to reparse ("+b+" characters) is greater than half the size of the source text"),null;var l=[],k=a.quickParse(this.logger,e.scopeStartAST,k,e.scopeStartAST.minChar,e.scopeStartAST.minChar+b,function(b,c,d,e){l.push(new a.ErrorEntry(e,b,b+c,d))});if(k.endLexState!=a.LexState.Start)return this.logger.log("  Bailing out because scope contains unterminated comment"),
null;k=k.Script;if(0!==k.vars.members.length)return this.logger.log("  Bailing out because new source text defines variables"),null;if(1!==k.bod.members.length)return this.logger.log("  Bailing out because new source text defines more than one scope (or none)"),null;var e=e.scopeStartAST,c=k.bod.members[0];return e.nodeType!=c.nodeType?(this.logger.log("  Bailing out because new source text does not define the same scope type as the existing scope"),null):!e.leftCurlyCount||!e.rightCurlyCount?(this.logger.log("  Bailing out because sopce doesn't have left/right curly count"),
null):e.leftCurlyCount!==c.leftCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) left curly braces"),null):e.rightCurlyCount!==c.rightCurlyCount?(this.logger.log("  Bailing out because new source text contains more (or fewer) right curly braces"),null):0!==c.minChar?(this.logger.log("  Bailing out because new function declaration does not start at position 0"),null):c.limChar!==b?(this.logger.log("  Bailing out because new function declaration does not end at the new end position"),
null):a.UpdateUnitResult.singleScopeEdits(d,k,e,c,g,l)};d.prototype.mergeTrees=function(d){var b=this;a.timeFunction(this.logger,"mergeTrees()",function(){var k=new a.ScriptEditRange(d.scope1.minChar,d.scope1.limChar,d.editRange.delta);b.applyDeltaPosition(d.script1,k.limChar,k.delta);b.applyDeltaPosition(d.script2,0,k.minChar);b.mergeLocationInfo(d.script1,d.script2,k);b.replaceAST(d.script1,d.scope1,d.scope2)})};d.prototype.replaceAST=function(d,b,k){var g=this;a.getAstWalkerFactory().walk(d,function(d,
h,c){if(d===b)return k.preComments=d.preComments,k.postComments=d.postComments,g.logger.log("replaced old AST node with new one in script AST"),c.options.stopWalk(),k;if(a.isValidAstNode(d)&&(d.limChar<b.minChar||d.minChar>b.limChar))c.options.goChildren=!1;return d})};d.prototype.mergeLocationInfo=function(a,b,d){a=a.locationInfo.lineMap;b=b.locationInfo.lineMap;this.logger.information()&&(this.logger.log("lineMap1 (before):"),this.astLogger.logLinemap(a),this.logger.log("lineMap2 (quick parse):"),
this.astLogger.logLinemap(b),this.logger.log("EditRange="+d));for(var g=2,e=2,l=a.length,c=b.length;g<l||e<c;)g<l?a[g]<=d.minChar?g++:a[g]>=d.limChar?(a[g]+=d.delta,g++):e<c?(a.splice(g,0,b[e]+d.minChar),g++,l++,e++):(a.splice(g,1),l--):(a.push(b[e]+d.minChar),e++);this.logger.information()&&(this.logger.log("lineMap1 (after merge):"),this.astLogger.logLinemap(a))};d.prototype.applyDeltaPosition=function(d,b,k){var g=function(a){-1!==a.minChar&&a.minChar>=b&&(a.minChar+=k);-1!==a.limChar&&a.limChar>=
b&&(a.limChar+=k)},e=function(a){if(a&&0<a.length)for(var b=0;b<a.length;b++)g(a[b])};a.getAstWalkerFactory().walk(d,function(a,c,d){-1!==a.limChar&&a.limChar<b&&(d.options.goChildren=!1);g(a);e(a.preComments);e(a.postComments);return a})};a.IncrementalParser=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.UpdateUnitKind||(a.UpdateUnitKind={});d._map=[];d._map[0]="Unknown";d.Unknown=0;d._map[1]="NoEdits";d.NoEdits=1;d._map[2]="EditsInsideSingleScope";d.EditsInsideSingleScope=2;var h=a.UpdateUnitKind,b=function(a,b,d){this.minChar=a;this.limChar=b;this.delta=d};b.unknown=function(){return new b(-1,-1,-1)};b.prototype.isUnknown=function(){return-1===this.minChar&&-1===this.limChar&&-1===this.delta};b.prototype.containsPosition=function(a){return this.minChar<=a&&a<this.limChar||this.minChar<=
a&&a<this.limChar+this.delta};b.prototype.toString=function(){return"editRange(minChar="+this.minChar+", limChar="+this.limChar+", delta="+this.delta+")"};a.ScriptEditRange=b;var k=function(a,b,d,e){this.kind=a;this.unitIndex=b;this.script1=d;this.script2=e;this.editRange=this.scope2=this.scope1=null;this.parseErrors=[]};k.noEdits=function(a){return new k(h.NoEdits,a,null,null)};k.unknownEdits=function(a,b,d){a=new k(h.Unknown,a.locationInfo.unitIndex,a,b);a.parseErrors=d;return a};k.singleScopeEdits=
function(a,b,d,e,g,v){a=new k(h.EditsInsideSingleScope,a.locationInfo.unitIndex,a,b);a.scope1=d;a.scope2=e;a.editRange=g;a.parseErrors=v;return a};a.UpdateUnitResult=k;var g;g=function(a,b,d,e){this.unitIndex=a;this.minChar=b;this.limChar=d;this.message=e};a.ErrorEntry=g;a.defaultSettings=new a.CompilationSettings;d=function(b,c,d,e){"undefined"===typeof d&&(d=new a.NullLogger);"undefined"===typeof e&&(e=a.defaultSettings);this.outfile=b;this.errorOutput=c;this.logger=d;this.settings=e;this.parser=
new a.Parser;this.typeFlow=null;this.scripts=new a.ASTList;this.units=[];this.errorReporter=new a.ErrorReporter(this.outfile);this.persistentTypeState=new a.PersistentGlobalTypeState(this.errorReporter);this.errorReporter.parser=this.parser;this.initTypeChecker(this.errorOutput);this.parser.style_requireSemi=this.settings.styleSettings.requireSemi;this.parser.style_funcInLoop=this.settings.styleSettings.funcInLoop;this.parser.inferPropertiesFromThisAssignment=this.settings.inferPropertiesFromThisAssignment;
this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany};a.codeGenTarget=e.codeGenTarget};d.prototype.timeFunction=function(b,c){return a.timeFunction(this.logger,b,c)};d.prototype.initTypeChecker=function(){this.persistentTypeState.refreshPersistentState();this.typeChecker=new a.TypeChecker(this.persistentTypeState);
this.typeChecker.errorReporter=this.errorReporter;this.typeChecker.checkControlFlow=this.settings.controlFlow;this.typeChecker.checkControlFlowUseDef=this.settings.controlFlowUseDef;this.typeChecker.printControlFlowGraph=this.settings.printControlFlow;this.typeChecker.errorsOnWith=this.settings.errorOnWith;this.typeChecker.styleSettings=this.settings.styleSettings;this.typeChecker.canCallDefinitionSignature=this.settings.canCallDefinitionSignature;this.errorReporter.checker=this.typeChecker;this.setErrorOutput(this.errorOutput)};
d.prototype.setErrorOutput=function(a){this.errorOutput=a;this.errorReporter.setErrOut(a);this.parser.outfile=a};d.prototype.emitCommentsToOutput=function(){this.emitSettings={minWhitespace:this.settings.minWhitespace,propagateConstants:this.settings.propagateConstants,emitComments:this.settings.emitComments,path:this.settings.outputFileName,createFile:null,outputMany:this.settings.outputMany}};d.prototype.setErrorCallback=function(a){this.parser.errorCallback=a};d.prototype.updateUnit=function(b,
c,d){return this.updateSourceUnit(new a.StringSourceText(b),c,d)};d.prototype.updateSourceUnit=function(a,b,d){var e=this;return this.timeFunction("updateSourceUnit("+b+")",function(){var g=e.partialUpdateUnit(a,b,d);return e.applyUpdateResult(g)})};d.prototype.applyUpdateResult=function(b){switch(b.kind){case h.NoEdits:return!1;case h.Unknown:this.scripts.members[b.unitIndex]=b.script2;this.units[b.unitIndex]=b.script2.locationInfo;for(var c=0,d=b.parseErrors.length;c<d;c++){var e=b.parseErrors[c];
this.parser.errorCallback&&this.parser.errorCallback(e.minChar,e.limChar-e.minChar,e.message,e.unitIndex)}return!0;case h.EditsInsideSingleScope:return(new a.IncrementalParser(this.logger)).mergeTrees(b),!0}};d.prototype.partialUpdateUnit=function(a,b,d){var e=this;return this.timeFunction("partialUpdateUnit("+b+")",function(){for(var h=0,v=e.units.length;h<v;h++)if(e.units[h].filename==b){if(e.scripts.members[h].isResident)return k.noEdits(h);d&&e.parser.setErrorRecovery(null,0,0);var m=[],p=function(a,
b,c,d){m.push(new g(d,a,a+b,c))};if(v=e.parser.errorCallback)e.parser.errorCallback=p;p=e.scripts.members[h];h=e.parser.parse(a,b,h);v&&(e.parser.errorCallback=v);return k.unknownEdits(p,h,m)}throw Error('Unknown file "'+b+'"');})};d.prototype.addUnit=function(b,c,d){"undefined"===typeof d&&(d=!1);return this.addSourceUnit(new a.StringSourceText(b),c,d)};d.prototype.addSourceUnit=function(b,c,d){"undefined"===typeof d&&(d=!1);var e=this;return this.timeFunction("addSourceUnit("+c+", "+d+")",function(){var g=
e.parser.parse(b,c,e.units.length,a.AllowedElements.Global);g.isResident=d;e.persistentTypeState.setCollectionMode(d?a.TypeCheckCollectionMode.Resident:a.TypeCheckCollectionMode.Transient);e.units[e.units.length]=g.locationInfo;e.typeChecker.collectTypes(g);e.scripts.append(g);return g})};d.prototype.parseUnit=function(b,c){return this.parseSourceUnit(new a.StringSourceText(b),c)};d.prototype.parseSourceUnit=function(b,c){this.parser.setErrorRecovery(this.outfile,-1,-1);var d=this.parser.parse(b,
c,0),e=new a.PrintContext(this.outfile,this.parser);a.getAstWalkerFactory().walk(d,a.prePrintAST,a.postPrintAST,null,e)};d.prototype.typeCheck=function(){var b=this;return this.timeFunction("typeCheck()",function(){var c=new a.Binder(b.typeChecker);b.typeChecker.units=b.units;c.bind(b.typeChecker.globalScope,b.typeChecker.globals);c.bind(b.typeChecker.globalScope,b.typeChecker.ambientGlobals);c.bind(b.typeChecker.globalScope,b.typeChecker.globalTypes);c.bind(b.typeChecker.globalScope,b.typeChecker.ambientGlobalTypes);
b.typeFlow=new a.TypeFlow(b.logger,b.typeChecker.globalScope,b.parser,b.typeChecker);var c=0,d=null,e=b.scripts.members.length;b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Resident);for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident&&!d.hasBeenTypeChecked&&(b.typeFlow.typeCheck(d),d.hasBeenTypeChecked=!0);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);
e=b.scripts.members.length;for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||(b.typeFlow.assignScopes(d),b.typeFlow.initLibs());for(c=0;c<e;c++)d=b.scripts.members[c],d.isResident||b.typeFlow.typeCheck(d);return null})};d.prototype.cleanASTTypesForReTypeCheck=function(b){a.getAstWalkerFactory().walk(b,function(b){b.type=null;b.nodeType==a.NodeType.VarDecl?b.sym=null:b.nodeType==a.NodeType.ArgDecl?b.sym=null:b.nodeType==a.NodeType.Name?b.sym=null:b.nodeType==a.NodeType.FuncDecl?(b.signature=null,
b.freeVariables=[],b.symbols=null,b.accessorSymbol=null,b.scopeType=null):b.nodeType==a.NodeType.Module?b.mod=null:b.nodeType==a.NodeType.With?b.withSym=null:b.nodeType==a.NodeType.Catch&&(b.containedScope=null);return b})};d.prototype.cleanTypesForReTypeCheck=function(){var a=this;return this.timeFunction("cleanTypesForReTypeCheck()",function(){for(var b=0,d=a.scripts.members.length;b<d;b++){var e=a.scripts.members[b];e.isResident||(a.cleanASTTypesForReTypeCheck(e),a.typeChecker.collectTypes(e))}return null})};
d.prototype.attemptIncrementalTypeCheck=function(){return this.timeFunction("attemptIncrementalTypeCheck()",function(){return!1})};d.prototype.reTypeCheck=function(){var b=this;return this.timeFunction("reTypeCheck()",function(){a.CompilerDiagnostics.analysisPass++;b.initTypeChecker(b.errorOutput);b.persistentTypeState.setCollectionMode(a.TypeCheckCollectionMode.Transient);b.cleanTypesForReTypeCheck();return b.typeCheck()})};d.prototype.emit=function(b,c){var d=null;this.emitSettings.createFile=c;
for(var e=0,g=this.scripts.members.length;e<g;e++){var h=this.scripts.members[e];if(h.emitRequired()){var k=this.outfile;if(b){var p=this.units[e].filename,d=p.split(".");d.pop();var u=d.join(".")+".js";this.emitSettings.path=u;k=c(u);d=new a.Emitter(this.typeChecker,k,this.emitSettings);this.settings.mapSourceFiles&&d.setSourceMappings(new a.SourceMapper(p,u,k,c(u+a.SourceMapper.MapFileExtension)));this.settings.generateDeclarationFiles&&(p=a.isSTRFile(p)?a.changePathToDSTR(p):(a.isTSFile(p),a.changePathToDTS(p)),
d.setDeclarationFile(c(p)))}else null==d?(d=new a.Emitter(this.typeChecker,this.outfile,this.emitSettings),this.settings.mapSourceFiles&&d.setSourceMappings(new a.SourceMapper(h.locationInfo.filename,this.settings.outputFileName,this.outfile,c(this.settings.outputFileName+a.SourceMapper.MapFileExtension))),this.settings.generateDeclarationFiles&&(p=this.settings.outputFileName,p=a.isSTRFile(p)?a.changePathToDSTR(p):(a.isTSFile(p),a.changePathToDTS(p)),d.setDeclarationFile(c(p)))):this.settings.mapSourceFiles&&
d.setSourceMappings(new a.SourceMapper(h.locationInfo.filename,d.sourceMapper.jsFileName,this.outfile,d.sourceMapper.sourceMapOut));this.typeChecker.locationInfo=h.locationInfo;d.emitJavascript(h,a.TokenID.Comma,!1,d.canWriteDeclFile());b&&(this.settings.mapSourceFiles&&d.emitSourceMappings(),this.settings.generateDeclarationFiles&&d.declFile.Close(),k.Close())}}b||(this.settings.mapSourceFiles&&d.emitSourceMappings(),this.settings.generateDeclarationFiles&&d.declFile.Close())};d.prototype.emitToOutfile=
function(){var b=null;if(this.settings.mapSourceFiles)throw Error("Cannot generate source map");if(this.settings.generateDeclarationFiles)throw Error("Cannot generate declaration files");for(var c=0,d=this.scripts.members.length;c<d;c++){null==b&&(b=new a.Emitter(this.typeChecker,this.outfile,this.emitSettings));var e=this.scripts.members[c];this.typeChecker.locationInfo=e.locationInfo;b.emitJavascript(e,a.TokenID.Comma,!1)}};a.TypeScriptCompiler=d;var e;e=function(a,b,d){this.name=a;this.type=b;
this.sym=d};a.ScopeEntry=e;d=function(a){this.compiler=a};d.prototype.getScope=function(a){return a.enclosingObjectLit&&a.isMemberCompletion?a.getObjectLiteralScope():a.isMemberCompletion?a.useFullAst?this.compiler.typeFlow.findMemberScopeAtFullAst(a):this.compiler.typeFlow.findMemberScopeAt(a):a.getScope()};d.prototype.getScopeEntries=function(b){var c=this.getScope(b);if(null==c)return[];for(var d=new a.StringHashTable,e=c.getAllSymbolNames(b.isMemberCompletion),g=0;g<e.length;g++){var h=e[g];h==
a.globalId||("_Core"==h||"_element"==h)||d.add(h,"")}e=this.compiler.typeChecker.currentModDecl;this.compiler.typeChecker.currentModDecl=b.deepestModuleDecl;b=this.getTypeNamesForNames(b,d.getAllKeys(),c);this.compiler.typeChecker.currentModDecl=e;return b};d.prototype.getTypeNamesForNames=function(b,c,d){for(var f=[],g=b.getScope(),h=0;h<c.length;h++){var k=c[h],p=b.publicsOnly&&b.isMemberCompletion,u=d.find(k,p,!1);null==u&&(u=d.find(k,p,!0));p=u&&u.flags&a.SymbolFlags.Private?u.container==d.container:
!0;u?p&&(!a.isQuoted(u.name)&&!a.isRelative(u.name))&&(p=u.getType().getScopedTypeName(g),f.push(new e(k,p,u))):("true"==k||"false"==k)&&f.push(new e(k,"bool",this.compiler.typeChecker.booleanType.symbol))}return f};a.ScopeTraversal=d})(TypeScript||(TypeScript={}));
(function(a){var d=a.CompilerDiagnostics||(a.CompilerDiagnostics={}),h=function(a){d.diagnosticWriter&&d.diagnosticWriter.Alert(a)};d.debug=!1;d.diagnosticWriter=null;d.analysisPass=0;d.Alert=h;d.debugPrint=function(a){d.debug&&h(a)};d.assert=function(a,b){d.debug&&(a||h(b))};var b=function(){};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=
function(){};a.NullLogger=b;b=function(a){this.logger=a;this._information=this.logger.information();this._debug=this.logger.debug();this._warning=this.logger.warning();this._error=this.logger.error();this._fatal=this.logger.fatal()};b.prototype.information=function(){return this._information};b.prototype.debug=function(){return this._debug};b.prototype.warning=function(){return this._warning};b.prototype.error=function(){return this._error};b.prototype.fatal=function(){return this._fatal};b.prototype.log=
function(a){this.logger.log(a)};a.LoggerAdapter=b;b=function(){this.logContents=[]};b.prototype.information=function(){return!1};b.prototype.debug=function(){return!1};b.prototype.warning=function(){return!1};b.prototype.error=function(){return!1};b.prototype.fatal=function(){return!1};b.prototype.log=function(a){this.logContents.push(a)};a.BufferedLogger=b;a.timeFunction=function(a,b,d){var h=+new Date,d=d();a.log(b+" completed in "+(+new Date-h)+" msec");return d};a.stringToLiteral=function(a,b){var d=
"",h=function(b){switch(a.charCodeAt(b)){case 9:d+="\\t";break;case 10:d+="\\n";break;case 11:d+="\\v";break;case 12:d+="\\f";break;case 13:d+="\\r";break;case 34:d+='\\"';break;case 39:d+="\\'";break;case 92:d+="\\";break;default:d+=a.charAt(b)}};if(a.length>b){for(var c=b>>1,i=0;i<c;i++)h(i);d+="(...)";for(i=a.length-c;i<a.length;i++)h(i)}else{b=a.length;for(i=0;i<b;i++)h(i)}return d}})(TypeScript||(TypeScript={}));var TSCompiler;
(function(a){function d(a,b){"undefined"==typeof b&&(b=new l);var c=new TypeScript.CompilationSettings;c.generateDeclarationFiles=!0===a.produceDeclarations;c=new TypeScript.TypeScriptCompiler(b.emittedUnits.getDefaultStream(),null,new TypeScript.NullLogger,c);c.parser.errorRecovery=!0;c.setErrorCallback(b.getErrorCallback());for(var d=0;d<a.units.length;d++){var e=a.units[d];c.addUnit(e.data,e.name)}c.typeCheck();c.emit(!0,b.emittedUnits.getEmitCallback());return b.emittedUnits.getDefJS()}function h(a,
b,c){b||(b={units:[]});b.units.push({data:a,name:""});return d(b,c)}function b(a){var b=document.createElement("script");b.setAttribute("type","text/javascript");b.innerHTML=a;document.body.appendChild(b)}function k(a,c,d){"string"==typeof a&&(a=document.getElementById(a));if(!a||!a.tagName||"script"!=a.tagName.toLowerCase())throw Error("Invalid script block.");a=h(a.innerHTML,c,d);b(a)}function g(a,b){var c=!0,d=null;if(document.querySelectorAll){for(var c=!1,d="",e=0,f=a.length;e<f;e++)d+='script[type="'+
a[e]+'"]',e!=f-1&&(d+=",");d=document.querySelectorAll(d)}else d=document.getElementsByTagName("script");e=0;for(f=d.length;e<f;e++){var g=d[e];if(c){for(var h=g.getAttribute("type").toLowerCase(),i=!1,k=0,l=a.length;k<l;k++)if(h==a[k]){i=!0;break}if(!i)continue}b(g)}}function e(a,c,d,e,f){d||(d=function(){});"undefined"==typeof c&&(c=!0);if("undefined"==typeof f||null===f)f=new l;var g=new XMLHttpRequest;g.open("GET",a);g.onreadystatechange=function(){if(4==g.readyState)if(200==g.status){var a=h(g.responseText,
e,f);c&&b(a);d({result:a,compileInfo:f})}else d({error:!0})};g.send(null)}a.API_VERSION=0.1;var l,c=function(){this.errors=[];this.emittedUnits=new f};c.prototype.addError=function(a,b,c,d){this.errors.push({start:a,len:b,msg:c,block:d})};c.prototype.getErrorCallback=function(){var a=this;return function(){a.addError.apply(a,arguments)}};c.prototype.getErrorCount=function(){return this.errors.length};c.prototype.addOutputUnit=function(){};l=c;a.CompileInfo=l;var i=function(){this.data=""};i.prototype.Write=
function(a){this.data+=a};i.prototype.WriteLine=function(a){this.data+=a+"\n"};i.prototype.Close=function(){};var f,c=function(){this.units={};this.units[".js"]=new i};c.prototype.getEmitCallback=function(){var a=this;return function(b){return a.emitCallback.apply(a,[b])}};c.prototype.emitCallback=function(a){"undefined"==typeof this.units[a]&&(this.units[a]=new i);return this.units[a]};c.prototype.getDefaultStream=function(){return this.units[".js"]};c.prototype.getDefJS=function(){return this.units[".js"].data};
c.prototype.getDefDecl=function(){return this.units[".d.ts"]?this.units[".d.ts"].data:""};c.prototype.getUnit=function(a){return this.units[a].data};c.prototype.getAllUnits=function(){return this.units};f=c;a.compile=d;a.compileStr=h;a.runStr=function(a,c,d){a=h(a,c,d);b(a);return a};a.insertScriptBlock=b;a.runScriptBlock=k;a.filterScriptBlocks=g;a.runAllScriptBlocks=function(a,b,c){if("undefined"==typeof a||null===a)a=["text/typescript","application/typescript"];g(a,function(a){a.src?e(a.src):k(a,
b,c)})};a.compileExtern=e})(TSCompiler||(TSCompiler={}));
